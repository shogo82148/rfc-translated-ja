<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="info" consensus="true" docName="draft-ietf-cose-hash-algs-09" indexInclude="true" ipr="trust200902" number="9054" prepTime="2022-08-30T16:04:49" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-cose-hash-algs-09" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9054" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="COSE Hashes">CBOR Object Signing and Encryption (COSE): Hash Algorithms</title>
    <seriesInfo name="RFC" value="9054" stream="IETF"/>
    <author initials="J." surname="Schaad" fullname="Jim Schaad">
      <organization showOnFrontPage="true">August Cellars</organization>
      <address/>
    </author>
    <date month="08" year="2022"/>
    <area>Security</area>
    <workgroup>COSE Working Group</workgroup>
    <keyword>SHA-1 Hash Algorithm</keyword>
    <keyword>SHA-2 HAsh Algorithm</keyword>
    <keyword>SHAKE Algorithm</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">CBORオブジェクト署名および暗号化（COSE）構文（RFC 9052を参照）では、ハッシュアルゴリズムの直接的な使用方法は定義されていません。ただし、間接的な署名など、1つ以上の内容のハッシュが署名される場合や、X.509証明書や他のオブジェクトの識別に指紋を使用する場合など、ハッシュアルゴリズムが使用される場合があります。このドキュメントでは、COSEアルゴリズム識別子によって識別されるハッシュアルゴリズムを定義します。</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">この文書は、インターネットの標準トラック仕様ではありません。情報提供のために公開されています。</t>
        <t indent="0" pn="section-boilerplate.1-2">この文書はインターネットエンジニアリングタスクフォース（IETF）の製品です。IETFコミュニティの合意を表しています。これは公開レビューを受け、インターネットエンジニアリングステアリンググループ（IESG）によって出版承認されました。IESGによって承認されたすべての文書がインターネット標準のいかなるレベルの候補でもあるわけではありません。RFC 7841のセクション2を参照してください。</t>
        <t indent="0" pn="section-boilerplate.1-3">この文書の現在のステータス、誤り訂正情報、およびフィードバックの提供方法に関する情報は、<eref target="https://www.rfc-editor.org/info/rfc9054" brackets="none"/>で入手できます。</t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">© 2022 IETF Trustおよびドキュメントの著者として識別された個人。全著作権所有。</t>
        <t indent="0" pn="section-boilerplate.2-2">この文書は、<eref target="https://trustee.ietf.org/license-info" brackets="none"/>で定められたBCP 78およびIETF文書に関連するIETFトラストの法的規定に従うものとします。これらの文書については、この文書の発行日に有効なものが適用されますので、注意深くご確認ください。この文書から抽出されたコードのコンポーネントは、Trust Legal Provisionsのセクション4.eで説明されている通り、修正されたBSDライセンスのテキストを含める必要があります。また、修正されたBSDライセンスに記載されている通り、保証なしで提供されます。</t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-terminology">Requirements Terminology</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hash-algorithm-usage">Hash Algorithm Usage</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-cbor-hash-structure">
          Example CBOR Hash Structure
                  </xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hash-algorithm-identifiers">Hash Algorithm Identifiers</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-sha-1-hash-algorithm">SHA-1 Hash Algorithm</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.2">
                <t indent="0" pn="section-toc.1-1.3.2.2.1"><xref derivedContent="3.2" format="counter" sectionFormat="of" target="section-3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-sha-2-hash-algorithms">SHA-2 Hash Algorithms</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.3">
                <t indent="0" pn="section-toc.1-1.3.2.3.1"><xref derivedContent="3.3" format="counter" sectionFormat="of" target="section-3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-shake-algorithms">SHAKE Algorithms</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-algorithm-registry">COSE Algorithm Registry</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-address">Author's Address</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">COSE（CBORオブジェクト署名および暗号化）構文<xref target="RFC9052" format="default" sectionFormat="of" derivedContent="RFC9052"/>は、ハッシュアルゴリズムの使用に関する直接的な方法を定義していません。また、<xref target="RFC5652" format="default" sectionFormat="of" derivedContent="CMS"/>中のDigestedData ASN.1構造のような、ダイジェストされたオブジェクト構造をエンコードするために使用される構造構文も定義していません。この省略は意図的であり、ダイジェスト識別子、コンテンツ、ダイジェスト値のみからなる構造体はそれ自体で十分な強力なセキュリティサービスを提供しません。さらに、アプリケーションは、ハッシュする必要がある追加のデータとデータを取得する方法を含めることができるように、このタイプの構造を定義する方がより良いでしょう。</t>
      <t indent="0" pn="section-1-2">上記は事実ですが、一般的な識別子を使用してCOSEのためにいくつかの標準ハッシュアルゴリズムを定義することが理にかなっている場合があります。これらが使用されるケースのうちの2つは次のとおりです：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1-3">
        <li pn="section-1-3.1">コンテンツの間接的な署名、および</li>
        <li pn="section-1-3.2">オブジェクトの識別。</li>
      </ul>
      <t indent="0" pn="section-1-4">コンテンツの間接署名は、コンテンツが直接署名されず、代わりにコンテンツのハッシュ値が計算され、そのハッシュ値とハッシュアルゴリズムの識別子が署名されるコンテンツに含まれるパラダイムです。間接署名により、署名付きのコンテンツと関連するすべてのコンテンツを最初にダウンロードすることなく、署名を検証することができます。代わりに、署名はハッシュ値と関連コンテンツへのポインターすべてで検証されます。関連する部分はその後ダウンロードされ、その部分のハッシュ値が署名付きコンテンツのハッシュ値と比較されます。デバイスでは、署名付きのコンテンツのすべてが必要ではない場合でも、この機能が特に重要です。これがどのように使用されるかの例は、<xref target="I-D.ietf-suit-manifest" sectionFormat="of" section="5.4" format="default" derivedLink="https://datatracker.ietf.org/doc/html/draft-ietf-suit-manifest-19#section-5.4" derivedContent="SUIT-MANIFEST"/>で確認できます。</t>
      <t indent="0" pn="section-1-5">オブジェクトを識別するためにハッシュを使用することは非常に一般的です。セキュアメッセージでハッシュ関数によって識別される主なものの1つは、証明書です。これに関する2つの例は、<xref target="RFC2634" format="default" sectionFormat="of" derivedContent="ESS"/>およびCOSEの対応物である<xref target="I-D.ietf-cose-x509" format="default" sectionFormat="of" derivedContent="COSE-x509"/>で見つけることができます。</t>
      <section anchor="requirements-terminology" numbered="true" removeInRFC="false" toc="include" pn="section-1.1">
        <name slugifiedName="name-requirements-terminology">Requirements Terminology</name>
        <t indent="0" pn="section-1.1-1">以下の英文を日本語に翻訳します：

このドキュメントにおけるキーワード "<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">しなければなりません（MUST）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">してはなりません（MUST NOT）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">要求されています（REQUIRED）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">することになります（SHALL）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">することはありません（SHALL NOT）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">すべきです（SHOULD）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">すべきではありません（SHOULD NOT）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">推奨されます（RECOMMENDED）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">推奨されません（NOT RECOMMENDED）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">してもよいです（MAY）</bcp14>"、"<bcp14 xmlns：xi="http://www.w3.org/2001/XInclude">選択できます（OPTIONAL）</bcp14>" は、すべて大文字で表される場合に限り、BCP 14 <xref xmlns：xi="http://www.w3.org/2001/XInclude" target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref xmlns：xi="http://www.w3.org/2001/XInclude" target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/>で説明されているように解釈されます。</t>
      </section>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-hash-algorithm-usage">Hash Algorithm Usage</name>
      <t indent="0" pn="section-2-1">前のセクションで述べたように、ハッシュ関数はさまざまな目的に使用できます。これらの目的の一部では、ハッシュ関数が暗号的に強力である必要があります。これには、直接および間接の署名が含まれます。つまり、署名の一部としてハッシュを使用するか、署名するための本体としてハッシュを使用するかです。ハッシュ関数の他の用途では、同じレベルの強さが必要ない場合もあります。</t>
      <t indent="0" pn="section-2-2">このドキュメントには、暗号操作に使用するために設計されていないいくつかのハッシュ関数が含まれています。ハッシュ関数を使用するアプリケーションは、必要なハッシュの特性とそれらを提供するハッシュ関数を正確に評価する必要があります。また、暗号技術の進歩により、任意のハッシュ関数の強度が低下する可能性があるため、アプリケーションはハッシュ関数の変更可能性が基本設計の一部であることも確認する必要があります。</t>
      <t indent="0" pn="section-2-3">ハッシュ関数は、通常は大きなビット文字列から、通常は小さなビット文字列へのマップです。入力値の可能な数が出力値の可能な数よりもはるかに大きいため、衝突が発生することは避けられません。重要なのは、同じ出力値にマッピングする2つの値を見つけることが困難であることです。攻撃者が2つの異なるメッセージを同じハッシュ値にマッピングできるとき、それは「衝突攻撃」と呼ばれます。実用的な衝突攻撃に対して脆弱なハッシュ関数は、暗号目的には<bcp14>すべきではありません（SHOULD NOT）</bcp14>使用されるべきではありません。与えられたハッシュ関数に対する理論的な衝突攻撃の発見は、代替手段が利用可能で移行が可能な場合には、プロトコルの管理者とユーザーが継続的な適切性を再評価する<bcp14>すべきです（SHOULD）</bcp14>。そのようなハッシュ関数を使用する唯一の理由は、他に選択肢がまったくない場合（例：交換できないハードウェアセキュリティモジュール（HSM））であり、可能なセキュリティリスクを考慮した後にのみ使用されます。暗号目的には、署名の作成や間接的な署名にハッシュを使用することが含まれます。これらの機能は、非暗号目的にはまだ使用可能です。</t>
      <t indent="0" pn="section-2-4">ハッシュの非暗号化的な使用例としては、値のコレクションから候補となるセットを見つけるフィルタリングが挙げられます。その候補は、実際に使用できるかどうかを確認するためにチェックされます。具体的な例としては、証明書のクラシックな指紋があります。指紋が正しい証明書であることを確認するために使用される場合、それは暗号的な使用例であり、上記の衝突攻撃に関する警告が適用されます。しかし、指紋が署名の検証の目的で使用されるための証明書のコレクションからの絞り込みに使用される場合、単純なフィルタリング機能で十分です。この場合、公開鍵が署名を検証すること（および証明書が信頼できること）を確認する必要がありますが、署名を検証するキーを含まないすべての証明書は誤検出として破棄することができます。</t>
      <t indent="0" pn="section-2-5">これら2つの場合を区別するために、"COSE Algorithms" レジストリの「推奨」列に新しい値が追加されました。 "Filter Only" は、ハッシュ関数の唯一の目的が結果のフィルタリングであることを示しています。これは、暗号的に強力なアルゴリズムが必要なアプリケーションでは使用されないことを意味しています。</t>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-2.1">
        <name slugifiedName="name-example-cbor-hash-structure">
          Example CBOR Hash Structure
        </name>
        <t indent="0" pn="section-2.1-1"><xref target="RFC8152" format="default" sectionFormat="of" derivedContent="COSE"/>は、デフォルトの構造を提供していませんでした。それは、別個のハッシュアルゴリズムが定義されていないためです。また、構造の設定方法は、頻繁にアプリケーションに固有のものです。ハッシュ構造の一部としてよく含まれている4つのフィールドがあります。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-2.1-2">
          <li pn="section-2.1-2.1">ハッシュアルゴリズムの識別子。</li>
          <li pn="section-2.1-2.2">ハッシュ値。</li>
          <li pn="section-2.1-2.3">ハッシュされた値へのポインタ。これは、ファイルへのポインタ、ネットワークから取得できるオブジェクト、メッセージ内の特定の場所へのポインタ、または非常にアプリケーション固有のものである可能性があります。</li>
          <li pn="section-2.1-2.4">追加データ。これは単純なランダム値（例：ソルト）である場合もあります（ハッシュの衝突を見つけることがわずかに困難になります）。なぜなら、アプリケーションに渡されるペイロードは衝突が起こるように選択される可能性があるからです。また、指されたオブジェクトと一緒に使用される一連の処理命令のように複雑なものである場合もあります。追加データは、内容に前置または後置するなど、いくつかの方法で処理することができますが、固定の既知のサイズであるか、ハッシュされる部分の長さを含めることが強くお勧めされます。これにより、結果のバイト列が追加データとして唯一の解釈を持つようになります。（CBOR配列としてエンコードすると、この要件が達成されます。）</li>
        </ul>
        <t indent="0" pn="section-2.1-3">上記のすべてのフィールドが存在することを許可する構造の例は、次のようになります。</t>
        <sourcecode type="cddl" markers="false" pn="section-2.1-4">
COSE_Hash_V = (
    1 : int / tstr, # Algorithm identifier
    2 : bstr, # Hash value
    ? 3 : tstr, # Location of object that was hashed
    ? 4 : any   # object containing other details and things
    )
</sourcecode>
        <t indent="0" pn="section-2.1-5">以下は、一致するハッシュ値を検索する場合に使用可能な代替の構造です。この場合、場所は必要ありませんし、ハッシュに余分なデータを追加することは逆効果です。その結果、次のような構造が得られます：</t>
        <sourcecode type="cddl" markers="false" pn="section-2.1-6">
COSE_Hash_Find = [
    hashAlg : int / tstr,
    hashValue : bstr
]
</sourcecode>
      </section>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-hash-algorithm-identifiers">Hash Algorithm Identifiers</name>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.1">
        <name slugifiedName="name-sha-1-hash-algorithm">SHA-1 Hash Algorithm</name>
        <t indent="0" pn="section-3.1-1">SHA-1ハッシュアルゴリズム<xref target="RFC3174" format="default" sectionFormat="of" derivedContent="RFC3174"/>は、アメリカ合衆国国家安全保障局によって設計され、1995年に公開されました。その後、このアルゴリズムに対して多くの暗号解析が適用され、衝突攻撃が成功した<xref target="SHA-1-collision" format="default" sectionFormat="of" derivedContent="SHA-1-collision"/>されました。IETFは、公式にSHA-1の使用を避けることを始めました<xref target="RFC6194" format="default" sectionFormat="of" derivedContent="RFC6194"/>。</t>
        <t indent="0" pn="section-3.1-2">これらの事実にもかかわらず、SHA-1が必要な場合がまだあります。そのため、このハッシュアルゴリズムの使用のためのコードポイントの割り当ては合理的です。これらの状況のいくつかには、SHA-1のみが実装されている過去のHSMが関わっています。他の状況では、SHA-1の値がフィルタリングの目的で使用されるため、衝突耐性のプロパティは必要ありません。</t>
        <t indent="0" pn="section-3.1-3">既知のSHA-1の問題と使用されるべきではないという事実により、このアルゴリズムは「フィルタのみ」という推奨に基づいて登録されます。これにより、アルゴリズムの安全な使用方法についての指針が提供され、安全でない場合の使用が deshould されます。</t>
        <t indent="0" pn="section-3.1-4">
            The COSE capabilities for this algorithm is an empty array.
        </t>
        <table align="center" anchor="SHA1-Algs" pn="table-1">
          <name slugifiedName="name-sha-1-hash-algorithm-2">SHA-1 Hash Algorithm</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Capabilities</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
              <th align="left" colspan="1" rowspan="1">Recommended</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHA-1</td>
              <td align="left" colspan="1" rowspan="1">-14</td>
              <td align="left" colspan="1" rowspan="1">SHA-1 Hash</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Filter Only</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.2">
        <name slugifiedName="name-sha-2-hash-algorithms">SHA-2 Hash Algorithms</name>
        <t indent="0" pn="section-3.2-1">SHA-2ハッシュアルゴリズムのファミリー<xref target="FIPS-180-4" format="default" sectionFormat="of" derivedContent="FIPS-180-4"/>は、2001年にアメリカ国家安全保障局によって設計され、公開されました。その後、長さ拡張攻撃やパフォーマンスの問題に対処するために、元のセットにいくつかの追加アルゴリズムが追加されました。SHA-3ハッシュアルゴリズムは、その後も公開されていますが、SHA-2アルゴリズムは広く使用され続けています。</t>
        <t indent="0" pn="section-3.2-2">この文書に含まれるハッシュ関数のセットは、SHA-2ハッシュ関数のさまざまなパラメータに基づいており、関連するトレードオフのいくつかを考慮して選択されています。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-3.2-3">
          <li pn="section-3.2-3.1">
            <t indent="0" pn="section-3.2-3.1.1">
              <strong>SHA-256/64</strong>は切り詰められたハッシュを提供します。
              切り詰めの長さは、送信サイズを小さくするために設計されています。
              オッズは、衝突が発生する可能性が比例して増加するというトレードオフがあります。
              このハッシュ関数の使用には、衝突から生じる潜在的な問題の分析が必要です。または、ハッシュの目的が非暗号化の場合に制限される必要があります。
            </t>
            <t indent="0" pn="section-3.2-3.1.2">
                後者は、<xref target="I-D.ietf-cose-x509" format="default" sectionFormat="of" derivedContent="COSE-x509"/>で特定されたシナリオの一部に該当します。
                具体的には、ハッシュ値が可能な証明書の選択に使用される場合です：残っている複数の選択肢がある場合、各選択肢は公開鍵を使用してテストできます。
            </t>
          </li>
          <li pn="section-3.2-3.2">
            <xi:strong>SHA-256</xi:strong>は現在最も一般的に使用されているハッシュ関数でしょう。SHA-256は、32ビットハードウェアに対して効率的なハッシュアルゴリズムです。</li>
          <li pn="section-3.2-3.3">
            <bcp14>SHA-384</bcp14>および<bcp14>SHA-512</bcp14>ハッシュ関数は、64ビットハードウェアで効率的です。</li>
          <li pn="section-3.2-3.4">
            <bcp14>SHA-512/256</bcp14>は、64ビットハードウェア上でより効率的に動作するハッシュ関数でありながら、SHA-256と同じセキュリティレベルを提供します。</li>
        </ul>
        <aside pn="section-3.2-4">
          <t indent="0" pn="section-3.2-4.1">NOTE: SHA-256/64は、この仕様で定義されているSHA-256の64ビットのシンプルな切り詰めです。SHA-512/256は、<xref target="FIPS-180-4" format="default" sectionFormat="of" derivedContent="FIPS-180-4"/>で定義されているSHA-512を256ビットに切り詰めた変種です。</t>
        </aside>
        <t indent="0" pn="section-3.2-5">これらのアルゴリズムのためのCOSEの機能配列は空です。</t>
        <table align="center" anchor="SHA2-Algs" pn="table-2">
          <name slugifiedName="name-sha-2-hash-algorithms-2">SHA-2 Hash Algorithms</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Capabilities</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
              <th align="left" colspan="1" rowspan="1">Recommended</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHA-256/64</td>
              <td align="left" colspan="1" rowspan="1">-15</td>
              <td align="left" colspan="1" rowspan="1">SHA-2 256-bit Hash truncated to 64-bits</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Filter Only</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHA-256</td>
              <td align="left" colspan="1" rowspan="1">-16</td>
              <td align="left" colspan="1" rowspan="1">SHA-2 256-bit Hash</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHA-384</td>
              <td align="left" colspan="1" rowspan="1">-43</td>
              <td align="left" colspan="1" rowspan="1">SHA-2 384-bit Hash</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHA-512</td>
              <td align="left" colspan="1" rowspan="1">-44</td>
              <td align="left" colspan="1" rowspan="1">SHA-2 512-bit Hash</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHA-512/256</td>
              <td align="left" colspan="1" rowspan="1">-17</td>
              <td align="left" colspan="1" rowspan="1">SHA-2 512-bit Hash truncated to 256-bits</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Yes</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-3.3">
        <name slugifiedName="name-shake-algorithms">SHAKE Algorithms</name>
        <t indent="0" pn="section-3.3-1">SHA-3ハッシュアルゴリズムのファミリー<xref target="FIPS-202" format="default" sectionFormat="of" derivedContent="FIPS-202"/>は、NISTによるコンペティションの結果です。SHA-3のインスタンスであるSHAKE-128とSHAKE-256は、現在IETFで標準化されています。これが、このドキュメントにこれらのアルゴリズムを含める理由です。</t>
        <t indent="0" pn="section-3.3-2">SHA-3ハッシュアルゴリズムは、SHA-2ハッシュアルゴリズムとは大きく異なる構造を持っています。</t>
        <t indent="0" pn="section-3.3-3">SHA-2ハッシュ関数とは異なり、より短い長さのためにアルゴリズム識別子は作成されません。 SHAKE-128のハッシュ値の長さは256ビットであり、SHAKE-256のハッシュ値の長さは512ビットです。</t>
        <t indent="0" pn="section-3.3-4">これらのアルゴリズムのためのCOSE機能配列は空です。</t>
        <table align="center" anchor="SHAKE-Algs" pn="table-3">
          <name slugifiedName="name-shake-hash-functions">SHAKE Hash Functions</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Capabilities</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
              <th align="left" colspan="1" rowspan="1">Recommended</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHAKE128</td>
              <td align="left" colspan="1" rowspan="1">-18</td>
              <td align="left" colspan="1" rowspan="1">SHAKE-128 256-bit Hash Value</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">SHAKE256</td>
              <td align="left" colspan="1" rowspan="1">-45</td>
              <td align="left" colspan="1" rowspan="1">SHAKE-256 512-bit Hash Value</td>
              <td align="left" colspan="1" rowspan="1">[]</td>
              <td align="left" colspan="1" rowspan="1">RFC 9054</td>
              <td align="left" colspan="1" rowspan="1">Yes</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section anchor="iana-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <section anchor="cose-algorithm-registry" numbered="true" removeInRFC="false" toc="include" pn="section-4.1">
        <name slugifiedName="name-cose-algorithm-registry">COSE Algorithm Registry</name>
        <t indent="0" pn="section-4.1-1">イアナは、<eref target="https://www.iana.org/assignments/cose/" brackets="none">「COSEアルゴリズム」レジストリ</eref>に以下のアルゴリズムを登録しました。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-4.1-2">
          <li pn="section-4.1-2.1">SHA-1ハッシュ関数は、<xref target="SHA1-Algs" format="default" sectionFormat="of" derivedContent="Table 1"/>で見つかります。</li>
          <li pn="section-4.1-2.2">
            <xref target="SHA2-Algs" format="default" sectionFormat="of" derivedContent="Table 2"/> に含まれる SHA-2 ハッシュ関数のセットです。</li>
          <li pn="section-4.1-2.3">
            <xref target="SHAKE-Algs" format="default" sectionFormat="of" derivedContent="Table 3"/>にあるSHAKEハッシュ関数のセットです。</li>
        </ul>
        <t indent="0" pn="section-4.1-3">多くのハッシュ値は比較的長いものです。このため、2バイトのアルゴリズム識別子の使用は合理的です。SHA-1は「Filter Only」とタグ付けされているため、より長いアルゴリズム識別子が適切ですが、実際のハッシュ値は短くなっています。</t>
        <t indent="0" pn="section-4.1-4">IANAは、「Filter Only」の値を「Recommended」列の許可された値のセットに追加しました。この値はハッシュ関数にのみ使用され、衝突耐性が必要とされる目的には使用されないことを示します。この追加により、IANAはこのドキュメントを「COSE Algorithms」レジストリの参照として追加しました。</t>
      </section>
    </section>
    <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-5-1">プロトコルは、必要なハッシュ関数の特性とそれが可能な攻撃に対して慎重な分析を行う必要があります。特に、衝突耐性などの暗号特性が必要な使用法と、単にオブジェクトの識別に対応する特性が必要な使用法とを区別する必要があります。異なる攻撃は、誰または何が保護されているかに対応しています：攻撃者が送信者自体なのか、それとも第三者なのか？これが衝突耐性と第二原像耐性の違いです。一般的には、より長いハッシュ値の方が「良い」ですが、送信サイズ、タイムリネス、セキュリティのトレードオフもこの分析の一部として考慮する必要があります。多くの場合、ハッシュ化される値は公開値であり、それ故に（第一）原像耐性はこの分析の一部ではありません。</t>
      <t indent="0" pn="section-5-2">アルゴリズムの柔軟性は、ハッシュ関数の使用において要求事項として考慮される必要があります。<xref target="BCP201" format="default" sectionFormat="of" derivedContent="BCP201"/>。任意の暗号関数と同様に、ハッシュ関数は常に攻撃の対象となり、ハッシュアルゴリズムの暗号強度は時間とともに低下します。</t>
    </section>
  </middle>
  <back>
    <displayreference target="RFC2634" to="ESS"/>
    <displayreference target="RFC5652" to="CMS"/>
    <displayreference target="RFC8152" to="COSE"/>
    <displayreference target="I-D.ietf-cose-x509" to="COSE-x509"/>
    <displayreference target="I-D.ietf-suit-manifest" to="SUIT-MANIFEST"/>
    <references pn="section-6">
      <name slugifiedName="name-references">References</name>
      <references pn="section-6.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="FIPS-180-4" quoteTitle="true" target="https://doi.org/10.6028/NIST.FIPS.180-4" derivedAnchor="FIPS-180-4">
          <front>
            <title>Secure Hash Standard</title>
            <author>
              <organization showOnFrontPage="true">NIST</organization>
            </author>
            <date month="August" year="2015"/>
          </front>
          <seriesInfo name="FIPS PUB" value="180-4"/>
          <seriesInfo name="DOI" value="10.6028/NIST.FIPS.180-4"/>
        </reference>
        <reference anchor="FIPS-202" quoteTitle="true" target="https://doi.org/10.6028/NIST.FIPS.202" derivedAnchor="FIPS-202">
          <front>
            <title>SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions</title>
            <author initials="M.J." surname="Dworkin">
              <organization showOnFrontPage="true">National Institute of Standards and Technology</organization>
            </author>
            <date month="August" year="2015"/>
          </front>
          <seriesInfo name="FIPS PUB" value="202"/>
          <seriesInfo name="DOI" value="10.6028/NIST.FIPS.202"/>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized.  This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC3174" target="https://www.rfc-editor.org/info/rfc3174" quoteTitle="true" derivedAnchor="RFC3174">
          <front>
            <title>US Secure Hash Algorithm 1 (SHA1)</title>
            <author fullname="D. Eastlake 3rd" initials="D." surname="Eastlake 3rd"/>
            <author fullname="P. Jones" initials="P." surname="Jones"/>
            <date month="September" year="2001"/>
            <abstract>
              <t indent="0">The purpose of this document is to make the SHA-1 (Secure Hash Algorithm 1) hash algorithm conveniently available to the Internet community.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3174"/>
          <seriesInfo name="DOI" value="10.17487/RFC3174"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC9052" target="https://www.rfc-editor.org/info/rfc9052" quoteTitle="true" derivedAnchor="RFC9052">
          <front>
            <title>CBOR Object Signing and Encryption (COSE): Structures and Process</title>
            <author initials="J" surname="Schaad" fullname="Jim Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="August" year="2022"/>
          </front>
          <seriesInfo name="STD" value="96"/>
          <seriesInfo name="RFC" value="9052"/>
          <seriesInfo name="DOI" value="10.17487/RFC9052"/>
        </reference>
      </references>
      <references pn="section-6.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="BCP201" target="https://www.rfc-editor.org/info/bcp201" quoteTitle="true" derivedAnchor="BCP201">
          <front>
            <title>Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms</title>
            <author initials="R." surname="Housley" fullname="Russ Housley">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="November" year="2015"/>
          </front>
          <seriesInfo name="BCP" value="201"/>
          <seriesInfo name="RFC" value="7696"/>
        </reference>
        <reference anchor="RFC5652" target="https://www.rfc-editor.org/info/rfc5652" quoteTitle="true" derivedAnchor="CMS">
          <front>
            <title>Cryptographic Message Syntax (CMS)</title>
            <author fullname="R. Housley" initials="R." surname="Housley"/>
            <date month="September" year="2009"/>
            <abstract>
              <t indent="0">This document describes the Cryptographic Message Syntax (CMS).  This syntax is used to digitally sign, digest, authenticate, or encrypt arbitrary message content. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="70"/>
          <seriesInfo name="RFC" value="5652"/>
          <seriesInfo name="DOI" value="10.17487/RFC5652"/>
        </reference>
        <reference anchor="RFC8152" target="https://www.rfc-editor.org/info/rfc8152" quoteTitle="true" derivedAnchor="COSE">
          <front>
            <title>CBOR Object Signing and Encryption (COSE)</title>
            <author fullname="J. Schaad" initials="J." surname="Schaad"/>
            <date month="July" year="2017"/>
            <abstract>
              <t indent="0">Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size.  There is a need for the ability to have basic security services defined for this data format.  This document defines the CBOR Object Signing and Encryption (COSE) protocol.  This specification describes how to create and process signatures, message authentication codes, and encryption using CBOR for serialization.  This specification additionally describes how to represent cryptographic keys using CBOR.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8152"/>
          <seriesInfo name="DOI" value="10.17487/RFC8152"/>
        </reference>
        <reference anchor="I-D.ietf-cose-x509" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-cose-x509-08" derivedAnchor="COSE-x509">
          <front>
            <title>CBOR Object Signing and Encryption (COSE): Header parameters for carrying and referencing X.509 certificates</title>
            <author fullname="Jim Schaad">
              <organization showOnFrontPage="true">August Cellars</organization>
            </author>
            <date month="December" day="14" year="2020"/>
            <abstract>
              <t indent="0">   The CBOR Signing And Encrypted Message (COSE) structure uses
   references to keys in general.  For some algorithms, additional
   properties are defined which carry parameters relating to keys as
   needed.  The COSE Key structure is used for transporting keys outside
   of COSE messages.  This document extends the way that keys can be
   identified and transported by providing attributes that refer to or
   contain X.509 certificates.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-cose-x509-08"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-cose-x509-08.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="RFC2634" target="https://www.rfc-editor.org/info/rfc2634" quoteTitle="true" derivedAnchor="ESS">
          <front>
            <title>Enhanced Security Services for S/MIME</title>
            <author fullname="P. Hoffman" initials="P." role="editor" surname="Hoffman"/>
            <date month="June" year="1999"/>
            <abstract>
              <t indent="0">This document describes four optional security service extensions for S/MIME. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2634"/>
          <seriesInfo name="DOI" value="10.17487/RFC2634"/>
        </reference>
        <reference anchor="RFC6194" target="https://www.rfc-editor.org/info/rfc6194" quoteTitle="true" derivedAnchor="RFC6194">
          <front>
            <title>Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms</title>
            <author fullname="T. Polk" initials="T." surname="Polk"/>
            <author fullname="L. Chen" initials="L." surname="Chen"/>
            <author fullname="S. Turner" initials="S." surname="Turner"/>
            <author fullname="P. Hoffman" initials="P." surname="Hoffman"/>
            <date month="March" year="2011"/>
            <abstract>
              <t indent="0">This document includes security considerations for the SHA-0 and SHA-1 message digest algorithm.  This document is not an Internet Standards Track specification; it is published for informational purposes.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6194"/>
          <seriesInfo name="DOI" value="10.17487/RFC6194"/>
        </reference>
        <reference anchor="SHA-1-collision" target="https://shattered.io/static/shattered.pdf" quoteTitle="true" derivedAnchor="SHA-1-collision">
          <front>
            <title>The first collision for full SHA-1</title>
            <author initials="M." surname="Stevens"/>
            <author initials="E." surname="Bursztein"/>
            <author initials="P." surname="Karpman"/>
            <author initials="A." surname="Albertini"/>
            <author initials="Y." surname="Markov"/>
            <date month="Feb" year="2017"/>
          </front>
        </reference>
        <reference anchor="I-D.ietf-suit-manifest" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-suit-manifest-19" derivedAnchor="SUIT-MANIFEST">
          <front>
            <title>A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest</title>
            <author fullname="Brendan Moran">
              <organization showOnFrontPage="true">Arm Limited</organization>
            </author>
            <author fullname="Hannes Tschofenig">
              <organization showOnFrontPage="true">Arm Limited</organization>
            </author>
            <author fullname="Henk Birkholz">
              <organization showOnFrontPage="true">Fraunhofer SIT</organization>
            </author>
            <author fullname="Koen Zandberg">
              <organization showOnFrontPage="true">Inria</organization>
            </author>
            <date month="August" day="9" year="2022"/>
            <abstract>
              <t indent="0">   This specification describes the format of a manifest.  A manifest is
   a bundle of metadata about code/data obtained by a recipient (chiefly
   the firmware for an IoT device), where to find the that code/data,
   the devices to which it applies, and cryptographic information
   protecting the manifest.  Software updates and Trusted Invocation
   both tend to use sequences of common operations, so the manifest
   encodes those sequences of operations, rather than declaring the
   metadata.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-suit-manifest-19"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-suit-manifest-19.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
      </references>
    </references>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-authors-address">Author's Address</name>
      <author initials="J." surname="Schaad" fullname="Jim Schaad">
        <organization showOnFrontPage="true">August Cellars</organization>
        <address/>
      </author>
    </section>
  </back>
</rfc>
