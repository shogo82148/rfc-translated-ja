<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" docName="draft-ietf-appsawg-http-forwarded-10" indexInclude="true" number="7239" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-appsawg-http-forwarded-10" rel="prev"/>
<link href="https://dx.doi.org/10.17487/rfc7239" rel="alternate"/>
  <front>
    <title>Forwarded HTTP拡張</title>
    <seriesInfo name="RFC" value="7239" stream="IETF"/>
    <date year="2014" month="June"/>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">この文書では、プロキシコンポーネントがプロキシ処理で失われた情報、例えば、リクエストの発信IPアドレスやユーザーエージェント向けインターフェースのプロキシのIPアドレスを開示するためのHTTP拡張ヘッダフィールドを定義します。プロキシコンポーネントのパスでは、これにより、例えば、プロキシ化されたHTTPリクエストのチェーンで使用されたすべてのIPアドレスに、各後続コンポーネントがアクセスできるように配置することが可能になります。</t>
      <t indent="0" pn="section-abstract-2">この文書では、リクエストの発信元を匿名化するためのプロキシ管理者のガイドラインも指定します。</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">このメモのステータス</name>
        <t indent="0" pn="section-boilerplate.1.1">これはインターネット標準トラックの文書です。</t>
        <t indent="0" pn="section-boilerplate.1.2">この文書は、インターネットエンジニアリングタスクフォース（IETF）の製品です。これはIETFコミュニティの合意を表しています。公開レビューを受け、インターネットエンジニアリングステアリンググループ（IESG）により出版が承認されました。インターネット標準に関する詳細な情報は、RFC 5741のセクション2にあります。</t>
        <t indent="0" pn="section-boilerplate.1.3">この文書の現在のステータス、任意のエラータ、そしてそれに対するフィードバックの提供方法についての情報は、http://www.rfc-editor.org/info/rfc7239 で取得できます。</t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">著作権表示</name>
        <t indent="0" pn="section-boilerplate.2-1">Copyright (c) 2014 IETF Trust and the persons identified as the
document authors.  All rights reserved.</t>
        <t indent="0" pn="section-boilerplate.2-2">この文書は、BCP 78およびIETFドキュメントに関するIETFトラストの法的規定（<eref target="https://trustee.ietf.org/license-info" brackets="none"/>）にしたがう必要があります。これらの文書をよく確認し、この文書に関するあなたの権利と制限を説明しています。この文書から抽出されたコードコンポーネントには、Trust Legal Provisionsのセクション4.eに記載されているSimplified BSD Licenseのテキストが含まれている必要があり、Simplified BSD Licenseに記載されているように保証なしで提供されます。</t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">目次</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-notational-conventions">Notational Conventions</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-syntax-notations">Syntax Notations</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-forwarded-http-header-field">Forwarded HTTP Header Field</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-parameters">Parameters</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
            <li pn="section-toc.1-1.5.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-forwarded-by">Forwarded By</xref></t>
            </li>
            <li pn="section-toc.1-1.5.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-forwarded-for">Forwarded For</xref></t>
            </li>
            <li pn="section-toc.1-1.5.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-forwarded-host">Forwarded Host</xref></t>
            </li>
            <li pn="section-toc.1-1.5.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-forwarded-proto">Forwarded Proto</xref></t>
            </li>
            <li pn="section-toc.1-1.5.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extensions">Extensions</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-node-identifiers">Node Identifiers</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
            <li pn="section-toc.1-1.6.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ipv4-and-ipv6-identifiers">IPv4 and IPv6 Identifiers</xref></t>
            </li>
            <li pn="section-toc.1-1.6.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-the-&quot;unknown&quot;-identifier">The &quot;unknown&quot; Identifier</xref></t>
            </li>
            <li pn="section-toc.1-1.6.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.3.1"><xref derivedContent="6.3" format="counter" sectionFormat="of" target="section-6.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-obfuscated-identifier">Obfuscated Identifier</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-implementation-considerations">Implementation Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
            <li pn="section-toc.1-1.7.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-http-lists">HTTP Lists</xref></t>
            </li>
            <li pn="section-toc.1-1.7.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-field-preservation">Header Field Preservation</xref></t>
            </li>
            <li pn="section-toc.1-1.7.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.3.1"><xref derivedContent="7.3" format="counter" sectionFormat="of" target="section-7.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-relation-to-via">Relation to Via</xref></t>
            </li>
            <li pn="section-toc.1-1.7.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.4.1"><xref derivedContent="7.4" format="counter" sectionFormat="of" target="section-7.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-transition">Transition</xref></t>
            </li>
            <li pn="section-toc.1-1.7.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.5.1"><xref derivedContent="7.5" format="counter" sectionFormat="of" target="section-7.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-usage">Example Usage</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
            <li pn="section-toc.1-1.8.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-validity-and-integrity">Header Validity and Integrity</xref></t>
            </li>
            <li pn="section-toc.1-1.8.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-information-leak">Information Leak</xref></t>
            </li>
            <li pn="section-toc.1-1.8.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.3.1"><xref derivedContent="8.3" format="counter" sectionFormat="of" target="section-8.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-considerations">Privacy Considerations</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.2">
            <li pn="section-toc.1-1.10.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.1.1"><xref derivedContent="10.1" format="counter" sectionFormat="of" target="section-10.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
            </li>
            <li pn="section-toc.1-1.10.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.2.1"><xref derivedContent="10.2" format="counter" sectionFormat="of" target="section-10.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.A">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.A.1"><xref derivedContent="A" format="counter" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
      </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">はじめに</name>
      <t indent="0" pn="section-1-1">今日のHTTPの風景では、ユーザーエージェントの代理として機能するさまざまなアプリケーションがあります。多くの場合、これらのプロキシはエンドユーザーの行動や知識なしに存在します。これらのケースは、例えば、プロキシがウェブサーバーを運用する組織内のインフラの一部として存在するときに発生します。このようなプロキシは、ロードバランシングや暗号化オフロードのような機能に使用されることがあります。別の例は、プロキシがユーザーと同じ組織内で使用され、プロキシがリソースをキャッシュするために使用される場合です。しかし、これらのプロキシは、リクエストがプロキシのIPアドレスから発生したかのように見せ、元のリクエストの他の情報を変更する可能性があります。これは、元のリクエストからの情報の損失を表しています。</t>
      <t indent="0" pn="section-1-2">この情報の損失は、クライアントのIPアドレスを特定の目的で使用しているウェブサーバーに問題を引き起こす可能性があります。これは、プロキシのアドレスやプロキシによって変更された他の情報を使用しても満たされません。この情報の主な用途は、診断、アクセス制御、および不正利用管理です。診断機能には、イベントログ、トラブルシューティング、統計収集が含まれ、収集された情報は通常、特定の問題やクライアントからの苦情に対応して短期間だけ保存されます。アクセス制御は、アクセスが許可されるクライアントのIPアドレスのリストを設定することで運用できますが、プロキシを使用する場合、このアプローチは機能しません。ただし、プロキシが信頼されており、サーバーの許可されるクライアントアドレスのリストで設定されている場合は例外です。不正利用のケースでは、不正利用者の特定が必要であり、これは診断のために特定された多くの機能を使用します。</t>
      <t indent="0" pn="section-1-3">プロキシが使用されるほとんどの場合、この情報の損失はプロキシの使用の主な目的でも、望ましい効果でもありません。したがって、プロキシが使用中の場合に望ましい機能を復元するためには、HTTPレベルで元の情報を開示する方法が必要です。ただし、明らかに、プロキシを使用する目的がクライアントの匿名性を提供することである場合、プロキシはこの文書で定義されている機能を使用しません。</t>
      <t indent="0" pn="section-1-4">リバースプロキシの使用も情報を隠すことに注意すべきです。再度、情報の損失がリバースプロキシの使用の意図的な機能ではない場合、消費者がそれを見ることができるようにHTTPメッセージ内に情報をエンコードする方法を見つけることが望ましいです。</t>
      <t indent="0" pn="section-1-5">この情報を開示する一般的な方法は、X-Forwarded-For、X-Forwarded-By、およびX-Forwarded-Protoのような非標準のヘッダーフィールドを使用することです。一般的に望まれるプロトコル機能への標準化されたアプローチを使用することには多くの利点があります。その中でも最も重要なのは、実装間の相互運用性です。この文書では、"Forwarded"というヘッダーフィールドを標準化し、そのような情報を開示するための構文とセマンティクスを提供します。"Forwarded"は、すべての情報を1つのヘッダーフィールド内に組み合わせ、その情報を相関させることを可能にします。この文書で説明されているヘッダーフィールド形式を使用すると、プロキシが信頼されている限り、どの情報が一緒に属しているかを知ることが可能です。このような結論は、X-Forwardedクラスのヘッダーフィールドでは得ることができません。この文書で定義されているヘッダーフィールドはオプションであり、プライバシーを提供することを目的としたプロキシの実装は、ヘッダーフィールドを操作または実装することを必要としません。</t>
      <t indent="0" pn="section-1-6">プロキシで説明された問題と同様の問題がNATの使用でも発生することに注意してください。これについては、<xref target="RFC6269" format="default" sectionFormat="of" derivedContent="RFC6269"/>でさらに議論されています。</t>
    </section>
    <section anchor="notational-conventions" numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-notational-conventions">表記法の規則</name>
      <t indent="0" pn="section-2-1">キーワード「<bcp14>しなければなりません（MUST）</bcp14>」、「<bcp14>してはなりません（MUST NOT）</bcp14>」、
「<bcp14>要求されています（REQUIRED）</bcp14>」、
「<bcp14>することになります（SHALL）</bcp14>」、「<bcp14>することはありません（SHALL NOT）</bcp14>」、
「<bcp14>すべきです（SHOULD）</bcp14>」、「<bcp14>すべきではありません（SHOULD NOT）</bcp14>」、
「<bcp14>推奨されます（RECOMMENDED）</bcp14>」、「<bcp14>推奨されません（NOT RECOMMENDED）</bcp14>」、
「<bcp14>してもよいです（MAY）</bcp14>」、「<bcp14>選択できます（OPTIONAL）</bcp14>」は、
<xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/>に記載されているとおりに解釈されるものとします。</t>
    </section>
    <section anchor="syntax-notations" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-syntax-notations">構文表記</name>
      <t indent="0" pn="section-3-1">この仕様は、<xref target="RFC5234" format="default" sectionFormat="of" derivedContent="RFC5234"/>の拡張バッカス・ナウア形式（ABNF）表記法と、<xref target="RFC7230" section="7" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc7230#section-7" derivedContent="RFC7230"/>で定義されたリストルール拡張を使用します。</t>
    </section>
    <section anchor="forwarded-http-header-field" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-forwarded-http-header-field">Forwarded HTTPヘッダーフィールド</name>
      <t indent="0" pn="section-4-1">"Forwarded" HTTPヘッダーフィールドは、使用すると、プロキシがリクエストのパスに関与するときに変更されたり失われたりする情報を開示するパラメーター識別子ペアのリストを含む<bcp14>オプション</bcp14>のヘッダーフィールドです。このヘッダーフィールドで渡されるデータの性質がデリケートであるため（セクション8.2および8.3を参照）、このヘッダーフィールドはデフォルトでオフにする必要があります。さらに、各パラメーターは個別に設定する必要があります。"Forwarded"はHTTPリクエストでのみ使用し、HTTPレスポンスでは使用しません。これは、フォワーディングプロキシとリバースプロキシの両方に適用されます。このヘッダーフィールドで渡される情報には、例えば、リクエストのソースIPアドレス、プロキシの受信インターフェースのIPアドレス、またはHTTPまたはHTTPSが使用されたかどうかが含まれます。リクエストが複数のプロキシを通過している場合、各プロキシは一連のパラメーターを追加することができます。また、以前に追加された"Forwarded"ヘッダーフィールドを削除することもできます。</t>
      <t indent="0" pn="section-4-2">トップレベルのリストは、<xref target="RFC7230" section="3.2" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc7230#section-3.2" derivedContent="RFC7230"/>で定義されているHTTPヘッダーフィールド値のリストとして表現されます。このリストの最初の要素には、このヘッダーフィールドを実装し使用する最初のプロキシによって追加された情報が含まれ、各後続の要素には各後続のプロキシによって追加された情報が含まれます。このヘッダーフィールドはオプションなので、チェーン内の任意のプロキシがこのヘッダーフィールドを更新しないことを選択することができます。各フィールド値はセミコロンで区切られたリストであり、このサブリストはパラメーター識別子ペアで構成されます。パラメーター識別子ペアは等号でグループ化されます。各パラメーターは、フィールド値ごとに<bcp14>1回以上</bcp14>現れてはなりません。パラメーター名は大文字と小文字を区別しません。ヘッダーフィールド値はABNF構文で定義することができます。</t>
      <t indent="0" pn="section-4-3"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded   = 1#forwarded-element
]]></artwork>
</t>
      <t indent="0" pn="section-4-4"><artwork name="" type="" align="left" alt=""><![CDATA[
    forwarded-element =
        [ forwarded-pair ] *( ";" [ forwarded-pair ] )
]]></artwork>
</t>
      <t indent="0" pn="section-4-5"><artwork name="" type="" align="left" alt=""><![CDATA[
    forwarded-pair = token "=" value
    value          = token / quoted-string
]]></artwork>
</t>
      <t indent="0" pn="section-4-6"><artwork name="" type="" align="left" alt=""><![CDATA[
        token = <[RFC7230]のセクション3.2.6で定義>
        quoted-string = <[RFC7230]のセクション3.2.6で定義>
      ]]></artwork>
      </t>
      <t indent="0" pn="section-4-7">Examples:</t>
      <t indent="0" pn="section-4-8"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded: for="_gazonk"
    Forwarded: For="[2001:db8:cafe::17]:4711"
    Forwarded: for=192.0.2.60;proto=http;by=203.0.113.43
    Forwarded: for=192.0.2.43, for=198.51.100.17
]]></artwork>
</t>
      <t indent="0" pn="section-4-9">":"および"[]"は"token"では有効な文字ではないため、IPv6アドレスは"quoted-string"として記述されることに注意してください。</t>
      <t indent="0" pn="section-4-10">新しい&quot;Forwarded&quot;ヘッダーフィールド値を追加したいプロキシサーバーは、カンマ区切りの後に最後の既存の&quot;Forwarded&quot;ヘッダーフィールドに追加するか、ヘッダーブロックの最後に新しいフィールドを追加することができます。プロキシは<bcp14>可能であれば</bcp14>リクエストからすべての&quot;Forwarded&quot;ヘッダーフィールドを削除することができます。しかし、複数の&quot;Forwarded&quot;ヘッダーフィールドがある場合には、正しいヘッダーフィールドが更新されることを<bcp14>必ず</bcp14>確認する必要があります。</t>
    </section>
    <section anchor="parameters" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-parameters">パラメーター</name>
      <t indent="0" pn="section-5-1">この文書では、いくつかのパラメーターとそれぞれの有効な値を指定しています:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-5-2">
        <li pn="section-5-2.1"> &quot;by&quot;はプロキシのユーザーエージェント向けインターフェースを識別します。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-5-3">
        <li pn="section-5-3.1"> &quot;for&quot;はプロキシへのリクエストを行うノードを識別します。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-5-4">
        <li pn="section-5-4.1"> &quot;host&quot;はプロキシによって受信されたホストリクエストヘッダーフィールドです。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-5-5">
        <li pn="section-5-5.1"> &quot;proto&quot;はリクエストを行うために使用されたプロトコルを示します。</li>
      </ul>
      <section anchor="forwarded-by" numbered="true" removeInRFC="false" toc="include" pn="section-5.1">
        <name slugifiedName="name-forwarded-by">Forwarded By</name>
        <t indent="0" pn="section-5.1-1">&quot;by&quot;パラメータは、リクエストがプロキシサーバーに入ってきたインターフェースを開示するために使用されます。プロキシが&quot;by&quot;パラメータを使用することを選択した場合、そのデフォルトの設定は、セクション6.3で説明されているような難読化された識別子を<bcp14>含むべき</bcp14>です。プロキシ化されたリクエストを受信するサーバーが何らかのアドレスベースの機能を必要とする場合、このパラメータは代わりにIPアドレス（および可能性としてはポート番号）を<bcp14>含むことができます</bcp14>。3つ目のオプションは、セクション6.2で説明されている&quot;unknown&quot;識別子です。</t>
        <t indent="0" pn="section-5.1-2">潜在的なquoted-stringのアンエスケープ後の&quot;by&quot;値の構文は、セクション6で説明されている&quot;node&quot;のABNFに準拠します。</t>
        <t indent="0" pn="section-5.1-3">これは主に、この情報をバックエンドサーバーに転送したいリバースプロキシによって追加されます。また、マルチホーム環境では、どのリクエストが来たかをバックエンドサーバーに通知するのにも有用です。</t>
      </section>
      <section anchor="forwarded-for" numbered="true" removeInRFC="false" toc="include" pn="section-5.2">
        <name slugifiedName="name-forwarded-for">Forwarded For</name>
        <t indent="0" pn="section-5.2-1">&quot;for&quot;パラメータは、リクエストを開始したクライアントとプロキシチェーン内の後続のプロキシに関する情報を開示するために使用されます。プロキシが&quot;for&quot;パラメータを使用することを選択した場合、そのデフォルトの設定は、セクション6.3で説明されているような難読化された識別子を<bcp14>含むべき</bcp14>です。プロキシ化されたリクエストを受信するサーバーが何らかのアドレスベースの機能を必要とする場合、このパラメータは代わりにIPアドレス（および可能性としてはポート番号）を<bcp14>含むことができます</bcp14>。3つ目のオプションは、セクション6.2で説明されている&quot;unknown&quot;識別子です。</t>
        <t indent="0" pn="section-5.2-2">潜在的なquoted-stringのアンエスケープ後の&quot;for&quot;値の構文は、セクション6で説明されている&quot;node&quot;のABNFに準拠します。</t>
        <t indent="0" pn="section-5.2-3">これが完全に利用されているプロキシサーバーのチェーンでは、最初の&quot;for&quot;パラメータは、リクエストが最初に行われたクライアントを開示し、その後に続く任意のプロキシ識別子を続けます。チェーン内の最後のプロキシは&quot;for&quot;パラメータのリストの一部ではありません。ただし、最後のプロキシのIPアドレスと、オプションでポート番号は、トランスポート層のリモートIPアドレスとして容易に利用できます。ただし、存在する場合、先行する&quot;Forwarded&quot;ヘッダーフィールドの&quot;by&quot;パラメータから最後のプロキシに関する情報を読み取る方が関連性があります。</t>
      </section>
      <section anchor="forwarded-host" numbered="true" removeInRFC="false" toc="include" pn="section-5.3">
        <name slugifiedName="name-forwarded-host">Forwarded Host</name>
        <t indent="0" pn="section-5.3-1">&quot;host&quot;パラメータは、元の&quot;Host&quot;ヘッダーフィールドの値を転送するために使用されます。これは、例えば、リバースプロキシが&quot;Host&quot;ヘッダーフィールドを何らかの内部ホスト名に書き換えている場合、オリジンサーバーによって使用することができます。</t>
        <t indent="0" pn="section-5.3-2">潜在的なquoted-stringのアンエスケープ後の&quot;host&quot;値の構文は、<xref target="RFC7230" section="5.4" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc7230#section-5.4" derivedContent="RFC7230"/>で説明されているHost ABNFに<bcp14>準拠しなければなりません</bcp14>。</t>
      </section>
      <section anchor="forwarded-proto" numbered="true" removeInRFC="false" toc="include" pn="section-5.4">
        <name slugifiedName="name-forwarded-proto">Forwarded Proto</name>
        <t indent="0" pn="section-5.4-1">&quot;proto&quot;パラメータは、使用されたプロトコルタイプの値を持ちます。潜在的なquoted-stringのアンエスケープ後の&quot;proto&quot;値の構文は、<xref target="RFC3986" format="default" sectionFormat="of" derivedContent="RFC3986"/>のセクション3.1で定義されているURIスキーム名に<bcp14>準拠しなければなりません</bcp14>。そして、<xref target="RFC4395" format="default" sectionFormat="of" derivedContent="RFC4395"/>に従ってIANAに登録されます。典型的な値は&quot;http&quot;または&quot;https&quot;です。</t>
        <t indent="0" pn="section-5.4-2">例えば、リバースプロキシが暗号化オフローダとしても使用されている環境では、オリジンサーバーは、オリジンサーバーへのすべての接続が暗号化されていないHTTPであるにもかかわらず、ユーザーエージェントが要求した接続のタイプに合わせてドキュメント内のURLを書き換えることができます。</t>
      </section>
      <section anchor="extensions" numbered="true" removeInRFC="false" toc="include" pn="section-5.5">
        <name slugifiedName="name-extensions">拡張機能</name>
        <t indent="0" pn="section-5.5-1">拡張機能により、追加のパラメータと値が可能になります。拡張機能は、特にリバースプロキシ環境で特に有用です。すべての拡張パラメータは<bcp14>登録すべき</bcp14>です&quot;HTTP Forwarded Parameter&quot;レジストリに。特定の拡張機能が広範囲に展開されることが予想される場合、それらもまた標準化<bcp14>すべき</bcp14>です。これについてはセクション9でさらに議論されています。</t>
      </section>
    </section>
    <section anchor="node-identifiers" numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-node-identifiers">ノード識別子</name>
      <t indent="0" pn="section-6-1">ノード識別子は次のいずれかです:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-6-2">
        <li pn="section-6-2.1"> クライアントのIPアドレス、オプションでポート番号</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-6-3">
        <li pn="section-6-3.1"> クライアントのIPアドレスがプロキシサーバーには不明であることを示すトークン</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-6-4">
        <li pn="section-6-4.1"> トレースとデバッグを可能にする生成されたトークン、内部構造や機密情報を隠すことができます</li>
      </ul>
      <t indent="0" pn="section-6-5">ノード識別子は、次のABNF構文によって定義されます:</t>
      <t indent="0" pn="section-6-6"><artwork name="" type="" align="left" alt=""><![CDATA[
    node     = nodename [ ":" node-port ]
    nodename = IPv4address / "[" IPv6address "]" /
                "unknown" / obfnode
]]></artwork>
</t>
<t indent="0" pn="section-6-7"><artwork name="" type="" align="left" alt=""><![CDATA[
    IPv4address = <[RFC3986]のセクション3.2.2で定義>
    IPv6address = <[RFC3986]のセクション3.2.2で定義>
    obfnode = "_" 1*( ALPHA / DIGIT / "." / "_" / "-")
]]></artwork>
</t>
      <t indent="0" pn="section-6-8"><artwork name="" type="" align="left" alt=""><![CDATA[
    node-port     = port / obfport
    port          = 1*5DIGIT
    obfport       = "_" 1*(ALPHA / DIGIT / "." / "_" / "-")
]]></artwork>
</t>
      <t indent="0" pn="section-6-9"><artwork name="" type="" align="left" alt=""><![CDATA[
        DIGIT = <[RFC5234]のセクション3.4で定義>
        ALPHA = <[RFC5234]のセクションB.1で定義>
      ]]></artwork>
      </t>
      <t indent="0" pn="section-6-10">各識別子はオプションでポート識別子を持つことができ、例えば、NATed環境でのエンドポイントの識別を可能にします。&quot;node-port&quot;は、そのポート番号または実際のポート番号を隠蔽する生成されたトークンによって識別することができます。内部情報を明らかにしたくないが、例えばデバッグ目的でリクエストをトレースする能力をプロキシの所有者が欲しい場合に、隠蔽されたポートを使用することができます。</t>
      <t indent="0" pn="section-6-11">上記のABNFは、&quot;unknown&quot;識別子にポート番号を追加することも許可していることに注意してください。ただし、そのような表記の解釈は、ヘッダーフィールドにそのような値を追加するプロキシの所有者に委ねられています。&quot;obfport&quot;をポートから区別するために、&quot;obfport&quot;は<bcp14>必ず</bcp14>アンダースコアで始まる必要があります。さらに、それは<bcp14>必ず</bcp14>&quot;ALPHA&quot;、&quot;DIGIT&quot;、そして文字&quot;.&quot;、&quot;_&quot;、および&quot;-&quot;のみで構成される必要があります。</t>
      <t indent="0" pn="section-6-12">IPv6アドレスとノードポートが指定された任意のノード名は、&quot;:&quot;が&quot;token&quot;で許可されていない文字であるため、<bcp14>必ず</bcp14>引用符で囲む必要があることに注意が必要です。</t>
      <t indent="0" pn="section-6-13">例:</t>
      <t indent="0" pn="section-6-14"><artwork name="" type="" align="left" alt=""><![CDATA[
          "192.0.2.43:47011"
          "[2001:db8:cafe::17]:47011"
]]></artwork>
</t>
      <section anchor="ipv4-and-ipv6-identifiers" numbered="true" removeInRFC="false" toc="include" pn="section-6.1">
        <name slugifiedName="name-ipv4-and-ipv6-identifiers">IPv4とIPv6の識別子</name>
        <t indent="0" pn="section-6.1-1">&quot;IPv6address&quot;と&quot;IPv4address&quot;のABNFルールは、<xref target="RFC3986" format="default" sectionFormat="of" derivedContent="RFC3986"/>で定義されています。&quot;IPv6address&quot;は、テキスト表現の推奨事項<xref target="RFC5952" format="default" sectionFormat="of" derivedContent="RFC5952"/>（例えば、小文字、ゼロの圧縮）に<bcp14>準拠すべき</bcp14>です。</t>
        <t indent="0" pn="section-6.1-2">IPアドレスは、<xref target="RFC1918" format="default" sectionFormat="of" derivedContent="RFC1918"/>および<xref target="RFC4193" format="default" sectionFormat="of" derivedContent="RFC4193"/>で定義されている内部ネットのものである可能性があることに注意してください。また、IPv6アドレスは常に角括弧で囲まれていることに注意してください。</t>
      </section>
      <section anchor="the-&quot;unknown&quot;-identifier" numbered="true" removeInRFC="false" toc="include" pn="section-6.2">
        <name slugifiedName="name-the-&quot;unknown&quot;-identifier">&quot;unknown&quot;識別子</name>
        <t indent="0" pn="section-6.2-1">&quot;unknown&quot;識別子は、前のエンティティの識別が不明であるが、プロキシサーバーがリクエストの転送が行われたことを示したい場合に使用されます。一つの例として、直接的なアクセスなしに受信リクエストのTCPソケットを生成するプロキシサーバープロセスがあります。</t>
      </section>
      <section anchor="obfuscated-identifier" numbered="true" removeInRFC="false" toc="include" pn="section-6.3">
        <name slugifiedName="name-obfuscated-identifier">難読化された識別子</name>
        <t indent="0" pn="section-6.3-1">生成された識別子は、内部IPアドレスを秘密に保ちつつ、&quot;Forwarded&quot;ヘッダーフィールドをトレースとデバッグに使用したい場合に使用できます。これは、プロキシが何らかのインターフェースラベルを使用しており、IPアドレスではなくそれらを渡したいという願望がある場合にも便利です。識別子のサーバーによる使用に静的な識別子の割り当てが必要でない限り、難読化された識別子は<bcp14>各リクエストごとにランダムに生成すべき</bcp14>です。識別子がリクエストを超えて持続することがサーバーに必要な場合、それらは<bcp14>クライアントIPアドレスより長く持続すべきではない</bcp14>。難読化された識別子を他の識別子と区別するために、それは<bcp14>必ず</bcp14>先頭にアンダースコア&quot;_&quot;を持つ必要があります。さらに、それは<bcp14>必ず</bcp14>&quot;ALPHA&quot;、&quot;DIGIT&quot;、そして文字&quot;.&quot;、&quot;_&quot;、および&quot;-&quot;のみで構成される必要があります。
        例:</t>
        <t indent="0" pn="section-6.3-2"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded: for=_hidden, for=_SEVKISEK
]]></artwork>
</t>
      </section>
    </section>
    <section anchor="implementation-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-implementation-considerations">実装に関する考慮事項</name>
      <section anchor="http-lists" numbered="true" removeInRFC="false" toc="include" pn="section-7.1">
        <name slugifiedName="name-http-lists">HTTPリスト</name>
        <t indent="0" pn="section-7.1-1">HTTPリストでは、識別子の間に空白を許可し、リストは複数のヘッダーフィールドに分割することができることに注意してください。例として、ヘッダーフィールドは次のようになります。</t>
        <t indent="0" pn="section-7.1-2"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded: for=192.0.2.43,for="[2001:db8:cafe::17]",for=unknown
]]></artwork>
</t>
        <t indent="0" pn="section-7.1-3">は、ヘッダーフィールドと同等です</t>
        <t indent="0" pn="section-7.1-4"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded: for=192.0.2.43, for="[2001:db8:cafe::17]", for=unknown
]]></artwork>
</t>
        <t indent="0" pn="section-7.1-5">これは、ヘッダーフィールドと同等です</t>
        <t indent="0" pn="section-7.1-6"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded: for=192.0.2.43
    Forwarded: for="[2001:db8:cafe::17]", for=unknown
]]></artwork>
</t>
      </section>
      <section anchor="header-field-preservation" numbered="true" removeInRFC="false" toc="include" pn="section-7.2">
        <name slugifiedName="name-header-field-preservation">ヘッダーフィールドの保存</name>
        <t indent="0" pn="section-7.2-1">このヘッダーフィールドを保持すべき場合とそうでない場合があります。直接転送されたリクエストは、それを保持し、可能であれば拡張すべきです。単一の受信リクエストがプロキシに複数の送信リクエストを行わせる場合、ヘッダーフィールドを保持すべきかどうかを決定する際には特別な注意が必要です。多くの場合、ヘッダーフィールドは保持すべきですが、送信リクエストが受信リクエストの直接的な結果でない場合、ヘッダーフィールドは保持すべきではありません。また、プロキシが304レスポンスのコンテンツの不一致を検出し、<xref target="RFC7232" section="4" format="default" sectionFormat="comma" derivedLink="https://www.rfc-editor.org/rfc/rfc7232#section-4" derivedContent="RFC7232"/>.1の指示に従ってリクエストを無条件に繰り返す場合も考慮してください。この場合、新しいリクエストは基本的には元のリクエストの直接的な結果であり、ヘッダーフィールドはおそらく保持すべきです。</t>
      </section>
      <section anchor="relation-to-via" numbered="true" removeInRFC="false" toc="include" pn="section-7.3">
        <name slugifiedName="name-relation-to-via">Viaとの関係</name>
        <t indent="0" pn="section-7.3-1">&quot;Via&quot;ヘッダーフィールド（参照 <xref target="RFC7230" section="5" format="default" sectionFormat="comma" derivedLink="https://www.rfc-editor.org/rfc/rfc7230#section-5" derivedContent="RFC7230"/>.7.1）は、このヘッダーフィールドと同様の使用ケースを持つヘッダーフィールドです。しかし、&quot;Via&quot;ヘッダーフィールドは、プロキシ自体についての情報のみを提供し、プロキシサーバーに接続するクライアントについての情報は省略します。一方、&quot;Forwarded&quot;ヘッダーフィールドは、プロキシサーバーのクライアント対面側からの中継情報を主な目的としています。&quot;Via&quot;はすでに広く展開されているため、その形式を変更して&quot;Forwarded&quot;が解決する問題を対処することはできません。</t>
        <t indent="0" pn="section-7.3-2">このヘッダーフィールドからの情報とViaヘッダーフィールドからの情報を組み合わせることはできないことに注意してください。一部のプロキシは&quot;Forwarded&quot;ヘッダーフィールドを更新しない、一部のプロキシはViaヘッダーフィールドを更新しない、そして一部のプロキシは両方を更新します。</t>
      </section>
      <section anchor="transition" numbered="true" removeInRFC="false" toc="include" pn="section-7.4">
        <name slugifiedName="name-transition">移行</name>
        <t indent="0" pn="section-7.4-1">プロキシがX-Forwarded-*ヘッダーフィールドを含む受信リクエストを取得した場合、それをこのドキュメントで説明されているヘッダーフィールドに変換することが推奨されます。これは、それが適切な方法で行うことができる場合に限ります。リクエストが一種類のみを含む場合 -- 例えば、X-Forwarded-For -- これは、各要素の前に&quot;for=&quot;を追加することで&quot;Forwarded&quot;に変換できます。X-Forwarded-ForではIPv6アドレスは引用符で囲まれず、角括弧で囲まれませんが、&quot;Forwarded&quot;では引用符と角括弧で囲まれます。</t>
        <t indent="0" pn="section-7.4-2"><artwork name="" type="" align="left" alt=""><![CDATA[
    X-Forwarded-For: 192.0.2.43, 2001:db8:cafe::17
]]></artwork>
</t>
        <t indent="0" pn="section-7.4-3">次のようになります:</t>
        <t indent="0" pn="section-7.4-4"><artwork name="" type="" align="left" alt=""><![CDATA[
    Forwarded: for=192.0.2.43, for="[2001:db8:cafe::17]"
]]></artwork>
</t>
        <t indent="0" pn="section-7.4-5">ただし、例えば、X-Forwarded-ForとX-Forwarded-Byの両方が存在する場合には、特別な注意が必要です。そのような場合、既存のフィールドがどの順序で追加されたかを知ることができないため、変換を行うことができないかもしれません。また、X-Forwarded-Forヘッダーフィールドを削除すると、この新しいヘッダーフィールドのサポートをまだ実装していない当事者に問題を引き起こす可能性があることに注意してください。</t>
      </section>
      <section anchor="example-usage" numbered="true" removeInRFC="false" toc="include" pn="section-7.5">
        <name slugifiedName="name-example-usage">使用例</name>
        <t indent="0" pn="section-7.5-1">IPアドレス192.0.2.43のクライアントからのリクエストが、IPアドレス198.51.100.17のプロキシを経由し、その後IPアドレス203.0.113.60の別のプロキシを経由してオリジンサーバーに到達します。これは、例えば、企業のマルウェアフィルターの背後にあるオフィスクライアントが、リバースプロキシを経由してオリジンサーバーと通信する場合などです。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-7.5-2">
          <li pn="section-7.5-2.1">クライアントと最初のプロキシ間のHTTPリクエストには&quot;Forwarded&quot;ヘッダーフィールドはありません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-7.5-3">
          <li pn="section-7.5-3.1">最初のプロキシと二番目のプロキシ間のHTTPリクエストには&quot;Forwarded: for=192.0.2.43&quot;ヘッダーフィールドがあります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-7.5-4">
          <li pn="section-7.5-4.1">二番目のプロキシとオリジンサーバー間のHTTPリクエストには&quot;Forwarded: for=192.0.2.43, for=198.51.100.17;by=203.0.113.60;proto=http;host=example.com&quot;ヘッダーフィールドがあります。</li>
        </ul>
        <t indent="0" pn="section-7.5-5">接続チェーンの一部のポイントでは、このHTTP拡張のサポートがないため、またはこのネットワークコンポーネントに関する情報を公開しないというポリシー決定のため、&quot;Forwarded&quot;ヘッダーフィールドの情報が更新されない可能性があることに注意してください。</t>
      </section>
    </section>
    <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8">
      <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
      <section anchor="header-validity-and-integrity" numbered="true" removeInRFC="false" toc="include" pn="section-8.1">
        <name slugifiedName="name-header-validity-and-integrity">ヘッダーの有効性と完全性</name>
        <t indent="0" pn="section-8.1-1">&quot;Forwarded&quot; HTTPヘッダーフィールドは、間違ってまたは悪意を持って変更される可能性があり、リクエストを行うクライアントを含むサーバーへの道のり上のすべてのノードによって、正確であるとは限らないことに注意してください。</t>
        <t indent="0" pn="section-8.1-2">&quot;Forwarded&quot; HTTPヘッダーフィールドが正しいことを確認する一つの方法は、プロキシの正確さを検証し、それらを信頼できるものとしてホワイトリストに登録することです。この方法には少なくとも二つの弱点があります。第一に、リクエストがプロキシに到達する前にリストされたIPアドレスのチェーンは信頼できません。第二に、プロキシとエンドポイント間の通信が保護されていない限り、ネットワークにアクセス可能な攻撃者によってデータが改ざんされる可能性があります。</t>
      </section>
      <section anchor="information-leak" numbered="true" removeInRFC="false" toc="include" pn="section-8.2">
        <name slugifiedName="name-information-leak">情報漏洩</name>
        <t indent="0" pn="section-8.2-1">&quot;Forwarded&quot; HTTPヘッダーフィールドは、NATまたはプロキシ設定の背後にあるネットワーク構造を明らかにする可能性があり、これは望ましくないかもしれません。これは、難読化された要素を使用する、内部ノードがHTTPヘッダーフィールドを更新するのを防ぐ、または内部ネットワーク情報を明らかにするエントリを削除する出口プロキシを持つことで対処できます。</t>
        <t indent="0" pn="section-8.2-2">このヘッダーフィールドは、クライアントにプロキシチェーン全体を明らかにする可能性があるため、オリジンサーバーや中間者によってレスポンスメッセージにコピーされるべきではありません。副作用として、ホスティング環境では、&quot;Forwarded&quot;フィールドが使用されている場合にTRACEリクエストを許可しないように特別な注意が必要です。なぜなら、それはレスポンスメッセージの本文に表示されるからです。</t>
      </section>
      <section anchor="privacy-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8.3">
        <name slugifiedName="name-privacy-considerations">プライバシーに関する考慮事項</name>
        <t indent="0" pn="section-8.3-1">近年、プライバシーに対する懸念が高まっています。ユーザーのプライバシーを確保するという目標と、デバッグ、統計、位置依存のコンテンツ生成などに有用な情報を開示するという目標との間にはトレードオフが存在します。&quot;Forwarded&quot; HTTPヘッダーフィールドは、その設計上、ユーザーがプライバシーに敏感と考える情報を公開し、そのような用途を可能にします。任意のプロキシについて、HTTPリクエストがプライバシーのセマンティクスを特に要求するヘッダーフィールドを含む場合、プロキシは&quot;Forwarded&quot;ヘッダーフィールドを使用すべきではなく、また、IPアドレスなどのプライベート情報を次のホップに渡すべきではありません。</t>
        <t indent="0" pn="section-8.3-2">このヘッダーフィールドの&quot;for&quot;パラメータで転送される可能性があるクライアントのIPアドレスは、多くの人々にとってプライバシーに敏感な情報と考えられています。なぜなら、IPアドレスによってクライアントを一意に識別したり、ユーザーがどのオペレーターを使用しているか、おそらくユーザーが地理的にどこに位置しているかの大まかな推定を可能にするからです。</t>
        <t indent="0" pn="section-8.3-3">この拡張を使用するプロキシは、直接接続の情報を保持します。これは、エンドユーザーまたはデプロイヤーがこれが事実であることを知っているか、または予期しているかどうかに関係なく、エンドユーザーのプライバシーに影響を与えます。</t>
        <t indent="0" pn="section-8.3-4">このようなプロキシの実装者やデプロイヤーは、この拡張をデプロイすることがユーザープライバシーにどのように影響を与えるか、または影響を与えるかどうかを考慮する必要があります。</t>
        <t indent="0" pn="section-8.3-5">&quot;by&quot;パラメータと&quot;for&quot;パラメータのデフォルトの設定は、難読化された識別子を含むべきです。これらの識別子は、リクエストごとにランダムに生成されるべきです。リクエストを超えて持続する識別子が必要な場合、その寿命は制限され、クライアントのIPアドレスよりも長く持続するべきではありません。難読化された識別子を生成する際には、それらに潜在的に敏感な情報を含めないように注意を払う必要があります。</t>
        <t indent="0" pn="section-8.3-6">ユーザーのIPアドレスは、すでに広く使用されているヘッダーフィールドX-Forwarded-Forを使用してプロキシによって転送されている可能性があることに注意してください。また、ユーザーがプロキシを経由せずに直接接続を行っていた場合、クライアントのIPアドレスはウェブサーバーに送信されます。匿名化プロキシを積極的に選択しないユーザーは、IPアドレスが保護されることを期待することはできません。追跡のリスクを最小限に抑えたいと考えるこれらのユーザーは、ブラウザのヘッダーフィールドのフィンガープリントによって情報が漏洩する可能性がある他の方法にも注意を払う必要があります。クライアントの一意に識別する識別子なしで使用された場合でも、Forwardedヘッダーフィールド自体が、クライアントのリクエストが通過したプロキシのチェーンを明らかにすることで、フィンガープリントをより実行可能にする可能性があります。</t>
      </section>
    </section>
    <section anchor="iana-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-9">
      <name slugifiedName="name-iana-considerations">IANAに関する考慮事項</name>
      <t indent="0" pn="section-9-1">本文書では、以下に示すHTTPヘッダーフィールドを指定します。これは、<xref target="RFC3864" format="default" sectionFormat="of" derivedContent="RFC3864"/>で定義された&quot;Permanent Message Header Field Names&quot;レジストリに追加されました。</t>
      <t indent="0" pn="section-9-2">Header field: Forwarded
Applicable protocol: http
Status: standard
Author/Change controller:
    IETF (iesg@ietf.org)
    Internet Engineering Task Force
Specification document(s): this specification (Section 4)
Related information: None</t>
      <t indent="0" pn="section-9-3">&quot;Forwarded&quot;ヘッダーフィールドには、IANAが新たに作成し、現在維持している&quot;HTTP Forwarded Parameters&quot;という新しいレジストリに登録されたパラメータが含まれています。初期の登録は以下に示されています。将来の割り当てについては、登録手続きはIETF Review <xref target="RFC5226" format="default" sectionFormat="of" derivedContent="RFC5226"/>です。すべての新しいパラメータのセキュリティとプライバシーに関する影響は、十分に文書化されるべきです。新しいパラメータとその値は<bcp14>MUST</bcp14>、セクション4のABNFで定義されたforwarded-pairに準拠するべきです。さらに、登録時には短い説明を提供するべきです。</t>
      <t indent="0" pn="section-9-4"><table align="center">
<thead>
<tr>
<tr>
<td align="left">パラメーター名</td>
<td align="left">説明</td>
<td align="left">参照</td>
</tr>
</tr>
</thead>
<tbody>
<tr>
<td align="left"> by </td>
<td align="left">プロキシの入力インターフェースのIPアドレス</td>
<td align="left">セクション 5.1 </td>
</tr>
<tr>
<td align="left"> for </td>
<td align="left">プロキシを経由してリクエストを行うクライアントのIPアドレス</td>
<td align="left">セクション 5.2 </td>
</tr>
<tr>
<td align="left"> host </td>
<td align="left">着信リクエストのホストヘッダーフィールド</td>
<td align="left">セクション 5.3 </td>
</tr>
<tr>
<td align="left"> proto </td>
<td align="left">着信リクエストに使用されるアプリケーションプロトコル</td>
<td align="left">セクション 5.4 </td>
</tr>
</tbody>
</table>
</t>
      <t indent="0" pn="section-9-5"><artwork name="" type="" align="left" alt=""><![CDATA[
                    Table 1: Initial Assignments
]]></artwork>
</t>
    </section>
  </middle>
  <back>
    <references pn="section-10">
      <name slugifiedName="name-references">References</name>
      <references pn="section-10.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC1918" quoteTitle="true" derivedAnchor="RFC1918">
          <front>
            <title>Address Allocation for Private Internets</title>
            <date year="1996" month="February"/>
          </front>
          <seriesInfo name="BCP">5</seriesInfo>
          <seriesInfo name="RFC">1918</seriesInfo>
        </reference>
        <reference anchor="RFC2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <date year="1997" month="March"/>
          </front>
          <seriesInfo name="BCP">14</seriesInfo>
          <seriesInfo name="RFC">2119</seriesInfo>
        </reference>
        <reference anchor="RFC3864" quoteTitle="true" derivedAnchor="RFC3864">
          <front>
            <title>Registration Procedures for Message Header Fields</title>
            <date year="2004" month="September"/>
          </front>
          <seriesInfo name="BCP">90</seriesInfo>
          <seriesInfo name="RFC">3864</seriesInfo>
        </reference>
        <reference anchor="RFC3986" quoteTitle="true" derivedAnchor="RFC3986">
          <front>
            <title>Uniform Resource Identifier (URI): Generic Syntax</title>
            <date year="2005" month="January"/>
          </front>
          <seriesInfo name="STD">66</seriesInfo>
          <seriesInfo name="RFC">3986</seriesInfo>
        </reference>
        <reference anchor="RFC4193" quoteTitle="true" derivedAnchor="RFC4193">
          <front>
            <title>Unique Local IPv6 Unicast Addresses</title>
            <date year="2005" month="October"/>
          </front>
          <seriesInfo name="RFC">4193</seriesInfo>
        </reference>
        <reference anchor="RFC4395" quoteTitle="true" derivedAnchor="RFC4395">
          <front>
            <title>Guidelines and Registration Procedures for New URI Schemes</title>
            <date year="2006" month="February"/>
          </front>
          <seriesInfo name="BCP">35</seriesInfo>
          <seriesInfo name="RFC">4395</seriesInfo>
        </reference>
        <reference anchor="RFC5226" quoteTitle="true" derivedAnchor="RFC5226">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <date year="2008" month="May"/>
          </front>
          <seriesInfo name="BCP">26</seriesInfo>
          <seriesInfo name="RFC">5226</seriesInfo>
        </reference>
        <reference anchor="RFC5234" quoteTitle="true" derivedAnchor="RFC5234">
          <front>
            <title>Augmented BNF for Syntax Specifications: ABNF</title>
            <date year="2008" month="January"/>
          </front>
          <seriesInfo name="STD">68</seriesInfo>
          <seriesInfo name="RFC">5234</seriesInfo>
        </reference>
        <reference anchor="RFC5952" quoteTitle="true" derivedAnchor="RFC5952">
          <front>
            <title>A Recommendation for IPv6 Address Text Representation</title>
            <date year="2010" month="August"/>
          </front>
          <seriesInfo name="RFC">5952</seriesInfo>
        </reference>
        <reference anchor="RFC7230" quoteTitle="true" derivedAnchor="RFC7230">
          <front>
            <title>Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</title>
            <date year="2014" month="June"/>
          </front>
          <seriesInfo name="RFC">7230</seriesInfo>
        </reference>
        <reference anchor="RFC7232" quoteTitle="true" derivedAnchor="RFC7232">
          <front>
            <title>Hypertext Transfer Protocol (HTTP/1.1): Conditional Requests</title>
            <date year="2014" month="June"/>
          </front>
          <seriesInfo name="RFC">7232</seriesInfo>
        </reference>
      </references>
      <references pn="section-10.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="RFC6269" quoteTitle="true" derivedAnchor="RFC6269">
          <front>
            <title>Issues with IP Address Sharing</title>
            <date year="2011" month="June"/>
          </front>
          <seriesInfo name="RFC">6269</seriesInfo>
        </reference>
      </references>
    </references>
    <section anchor="acknowledgments" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.a-1">Thanks to Per Cederqvist, Alissa Cooper, Adrian Farrel, Stephen
Farrell, Ned Freed, Per Hedbor, Amos Jeffries, Poul-Henning Kamp,
Murray S. Kucherawy, Barry Leiba, Salvatore Loreto, Alexey Melnikov,
S. Moonesamy, Susan Nichols, Mark Nottingham, Julian Reschke, John
Sullivan, Willy Tarreau, and Dan Wing for their feedback.</t>
    </section>
  </back>
</rfc>
