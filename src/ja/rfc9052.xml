<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-cose-rfc8152bis-struct-15" indexInclude="true" ipr="trust200902" number="9052" obsoletes="8152" prepTime="2022-08-30T16:02:42" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-cose-rfc8152bis-struct-15" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9052" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="COSE Structure">CBORオブジェクト署名および暗号化（COSE）：構造とプロセス</title>
    <seriesInfo name="RFC" value="9052" stream="IETF"/>
    <seriesInfo name="STD" value="96" stream="IETF"/>
    <author initials="J." surname="Schaad" fullname="Jim Schaad">
      <organization showOnFrontPage="true">August Cellars</organization>
      <address>

      </address>
    </author>
    <date month="08" year="2022"/>
    <area>Security</area>
    <workgroup>COSE Working Group</workgroup>
    <keyword>Object Security</keyword>
    <keyword>COSE</keyword>
    <keyword>Constrained Devices</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">コンパクトバイナリーオブジェクト表現（CBOR）は、コードサイズとメッセージサイズを小さくするために設計されたデータ形式です。このデータ形式に対して基本的なセキュリティーサービスを定義できる必要があります。この文書は、CBORオブジェクト署名および暗号化（COSE）プロトコルを定義しています。この仕様では、シリアル化にCBORを使用して署名、メッセージ認証コード、および暗号化を作成および処理する方法について説明しています。さらに、この仕様では、CBORを使用して暗号鍵を表現する方法についても説明しています。</t>
      <t indent="0" pn="section-abstract-2">この文書は、RFC9053と共にRFC 8152を廃止します。</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">このメモのステータス</name>
        <t indent="0" pn="section-boilerplate.1-1">これはインターネット標準トラック文書です。</t>
        <t indent="0" pn="section-boilerplate.1-2">このドキュメントは、インターネットエンジニアリングタスクフォース（IETF）の成果物です。これはIETFコミュニティの合意を表しています。公開レビューが行われ、インターネットエンジニアリングステアリンググループ（IESG）によって公開が承認されました。インターネット標準に関する詳細な情報は、RFC 7841のセクション2に利用できます。</t>
        <t indent="0" pn="section-boilerplate.1-3">この文書の現在のステータス、誤記およびフィードバックを提供する方法の情報は、<eref target="https://www.rfc-editor.org/info/rfc9052" brackets="none"/>で入手することができます。</t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">著作権表示</name>
        <t indent="0" pn="section-boilerplate.2-1">Copyright (c) 2022 IETF Trust and the persons identified as the document authors. All rights reserved. </t>
        <t indent="0" pn="section-boilerplate.2-2">この文書は、BCP 78およびIETFドキュメントに関するIETFトラストの法的規定（<eref target="https://trustee.ietf.org/license-info" brackets="none"/>）にしたがう必要があります。これらの文書をよく確認し、この文書に関するあなたの権利と制限を説明しています。この文書から抽出されたコードコンポーネントには、Trust Legal Provisionsのセクション4.eに記載されているSimplified BSD Licenseのテキストが含まれている必要があり、Simplified BSD Licenseに記載されているように保証なしで提供されます。</t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">目次</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">はじめに</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-terminology">要件用語</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.2.1"><xref derivedContent="1.2" format="counter" sectionFormat="of" target="section-1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-changes-from-rfc-8152">RFC 8152からの変更点</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.3">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.3.1"><xref derivedContent="1.3" format="counter" sectionFormat="of" target="section-1.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-design-changes-from-jose">JOSEからの設計変更</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.4">
                <t indent="0" pn="section-toc.1-1.1.2.4.1"><xref derivedContent="1.4" format="counter" sectionFormat="of" target="section-1.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cddl-grammar-for-cbor-data-">CBORデータ構造のためのCDDL文法</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.5">
                <t indent="0" pn="section-toc.1-1.1.2.5.1"><xref derivedContent="1.5" format="counter" sectionFormat="of" target="section-1.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-related-terminology">CBOR関連の用語</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.6">
                <t indent="0" pn="section-toc.1-1.1.2.6.1"><xref derivedContent="1.6" format="counter" sectionFormat="of" target="section-1.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-document-terminology">文書の用語</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-basic-cose-structure">基本的なCOSE構造</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-parameters">ヘッダーパラメーター</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-common-cose-header-paramete">共通のCOSEヘッダーパラメーター</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-objects">署名オブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-with-one-or-more-si">1人以上の署名者で署名する</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-with-one-signer">1人の署名者で署名する</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-externally-supplied-data">外部から供給されるデータ</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-and-verification-pr">署名と検証プロセス</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-encryption-objects">暗号化オブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-enveloped-cose-structure">包含されたCOSE構造</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2.1.2">
                  <li pn="section-toc.1-1.5.2.1.2.1">
                    <t indent="0" pn="section-toc.1-1.5.2.1.2.1.1"><xref derivedContent="5.1.1" format="counter" sectionFormat="of" target="section-5.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-content-key-distribution-me">コンテンツキー配布方法</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-recipient-encrypted">単一受信者暗号化</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-how-to-encrypt-and-decrypt-">AEADアルゴリズムの暗号化と復号化の方法</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-how-to-encrypt-and-decrypt-f">AEアルゴリズムの暗号化と復号化の方法</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-mac-objects">MACオブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-maced-message-with-recipien">受信者付きMACメッセージ</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-maced-messages-with-implici">MACed Messages with Implicit Key</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.3">
                <t indent="0" pn="section-toc.1-1.6.2.3.1"><xref derivedContent="6.3" format="counter" sectionFormat="of" target="section-6.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-how-to-compute-and-verify-a">How to Compute and Verify a MAC</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-objects">キーオブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-common-parameters">COSEキー共通パラメーター</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-taxonomy-of-algorithms-used">Taxonomy of Algorithms Used by COSE</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signature-algorithms">Signature Algorithms</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.2">
                <t indent="0" pn="section-toc.1-1.8.2.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-message-authentication-code">Message Authentication Code (MAC) Algorithms</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.3">
                <t indent="0" pn="section-toc.1-1.8.2.3.1"><xref derivedContent="8.3" format="counter" sectionFormat="of" target="section-8.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-content-encryption-algorith">Content Encryption Algorithms</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.4">
                <t indent="0" pn="section-toc.1-1.8.2.4.1"><xref derivedContent="8.4" format="counter" sectionFormat="of" target="section-8.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-derivation-functions-kd">Key Derivation Functions (KDFs)</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.5">
                <t indent="0" pn="section-toc.1-1.8.2.5.1"><xref derivedContent="8.5" format="counter" sectionFormat="of" target="section-8.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-content-key-distribution-met">Content Key Distribution Methods</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2.5.2">
                  <li pn="section-toc.1-1.8.2.5.2.1">
                    <t indent="0" pn="section-toc.1-1.8.2.5.2.1.1"><xref derivedContent="8.5.1" format="counter" sectionFormat="of" target="section-8.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-encryption">Direct Encryption</xref></t>
                  </li>
                  <li pn="section-toc.1-1.8.2.5.2.2">
                    <t indent="0" pn="section-toc.1-1.8.2.5.2.2.1"><xref derivedContent="8.5.2" format="counter" sectionFormat="of" target="section-8.5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-wrap">Key Wrap</xref></t>
                  </li>
                  <li pn="section-toc.1-1.8.2.5.2.3">
                    <t indent="0" pn="section-toc.1-1.8.2.5.2.3.1"><xref derivedContent="8.5.3" format="counter" sectionFormat="of" target="section-8.5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-transport">Key Transport</xref></t>
                  </li>
                  <li pn="section-toc.1-1.8.2.5.2.4">
                    <t indent="0" pn="section-toc.1-1.8.2.5.2.4.1"><xref derivedContent="8.5.4" format="counter" sectionFormat="of" target="section-8.5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-key-agreement">Direct Key Agreement</xref></t>
                  </li>
                  <li pn="section-toc.1-1.8.2.5.2.5">
                    <t indent="0" pn="section-toc.1-1.8.2.5.2.5.1"><xref derivedContent="8.5.5" format="counter" sectionFormat="of" target="section-8.5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-agreement-with-key-wrap">Key Agreement with Key Wrap</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-encoding-restrictions">CBOR Encoding Restrictions</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-application-profiling-consi">Application Profiling Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
              <li pn="section-toc.1-1.11.2.1">
                <t indent="0" pn="section-toc.1-1.11.2.1.1"><xref derivedContent="11.1" format="counter" sectionFormat="of" target="section-11.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-header-parameters-regi">COSE Header Parameters Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.2">
                <t indent="0" pn="section-toc.1-1.11.2.2.1"><xref derivedContent="11.2" format="counter" sectionFormat="of" target="section-11.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-common-parameters-">COSE Key Common Parameters Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.3">
                <t indent="0" pn="section-toc.1-1.11.2.3.1"><xref derivedContent="11.3" format="counter" sectionFormat="of" target="section-11.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-media-type-registrations">Media Type Registrations</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2.3.2">
                  <li pn="section-toc.1-1.11.2.3.2.1">
                    <t indent="0" pn="section-toc.1-1.11.2.3.2.1.1"><xref derivedContent="11.3.1" format="counter" sectionFormat="of" target="section-11.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-security-message">COSE Security Message</xref></t>
                  </li>
                  <li pn="section-toc.1-1.11.2.3.2.2">
                    <t indent="0" pn="section-toc.1-1.11.2.3.2.2.1"><xref derivedContent="11.3.2" format="counter" sectionFormat="of" target="section-11.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-media-type">COSE Key Media Type</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.11.2.4">
                <t indent="0" pn="section-toc.1-1.11.2.4.1"><xref derivedContent="11.4" format="counter" sectionFormat="of" target="section-11.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-content-formats-regist">CoAP Content-Formats Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.5">
                <t indent="0" pn="section-toc.1-1.11.2.5.1"><xref derivedContent="11.5" format="counter" sectionFormat="of" target="section-11.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-tags-registry">CBOR Tags Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.6">
                <t indent="0" pn="section-toc.1-1.11.2.6.1"><xref derivedContent="11.6" format="counter" sectionFormat="of" target="section-11.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-expert-review-instructions">Expert Review Instructions</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="13" format="counter" sectionFormat="of" target="section-13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
              <li pn="section-toc.1-1.13.2.1">
                <t indent="0" pn="section-toc.1-1.13.2.1.1"><xref derivedContent="13.1" format="counter" sectionFormat="of" target="section-13.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.2">
                <t indent="0" pn="section-toc.1-1.13.2.2.1"><xref derivedContent="13.2" format="counter" sectionFormat="of" target="section-13.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-guidelines-for-external-dat">Guidelines for External Data Authentication of Algorithms</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" pn="section-toc.1-1.15.1"><xref derivedContent="Appendix B" format="default" sectionFormat="of" target="section-appendix.b"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-two-layers-of-recipient-inf">Two Layers of Recipient Information</xref></t>
          </li>
          <li pn="section-toc.1-1.16">
            <t indent="0" pn="section-toc.1-1.16.1"><xref derivedContent="Appendix C" format="default" sectionFormat="of" target="section-appendix.c"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples">Examples</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2">
              <li pn="section-toc.1-1.16.2.1">
                <t indent="0" pn="section-toc.1-1.16.2.1.1"><xref derivedContent="C.1" format="counter" sectionFormat="of" target="section-appendix.c.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-signed-messages">Examples of Signed Messages</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.1.2">
                  <li pn="section-toc.1-1.16.2.1.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.1.2.1.1"><xref derivedContent="C.1.1" format="counter" sectionFormat="of" target="section-appendix.c.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-signature">Single Signature</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.1.2.2">
                    <t indent="0" pn="section-toc.1-1.16.2.1.2.2.1"><xref derivedContent="C.1.2" format="counter" sectionFormat="of" target="section-appendix.c.1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multiple-signers">Multiple Signers</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.1.2.3">
                    <t indent="0" pn="section-toc.1-1.16.2.1.2.3.1"><xref derivedContent="C.1.3" format="counter" sectionFormat="of" target="section-appendix.c.1.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signature-with-criticality">Signature with Criticality</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.16.2.2">
                <t indent="0" pn="section-toc.1-1.16.2.2.1"><xref derivedContent="C.2" format="counter" sectionFormat="of" target="section-appendix.c.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-signer-examples">Single Signer Examples</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.2.2">
                  <li pn="section-toc.1-1.16.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.2.2.1.1"><xref derivedContent="C.2.1" format="counter" sectionFormat="of" target="section-appendix.c.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-ecdsa-signature">Single ECDSA Signature</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.16.2.3">
                <t indent="0" pn="section-toc.1-1.16.2.3.1"><xref derivedContent="C.3" format="counter" sectionFormat="of" target="section-appendix.c.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-enveloped-messa">Examples of Enveloped Messages</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.3.2">
                  <li pn="section-toc.1-1.16.2.3.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.3.2.1.1"><xref derivedContent="C.3.1" format="counter" sectionFormat="of" target="section-appendix.c.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-ecdh">Direct ECDH</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.3.2.2">
                    <t indent="0" pn="section-toc.1-1.16.2.3.2.2.1"><xref derivedContent="C.3.2" format="counter" sectionFormat="of" target="section-appendix.c.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-plus-key-derivation">Direct Plus Key Derivation</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.3.2.3">
                    <t indent="0" pn="section-toc.1-1.16.2.3.2.3.1"><xref derivedContent="C.3.3" format="counter" sectionFormat="of" target="section-appendix.c.3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-encrypted-content-with-exte">Encrypted Content with External Data</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.16.2.4">
                <t indent="0" pn="section-toc.1-1.16.2.4.1"><xref derivedContent="C.4" format="counter" sectionFormat="of" target="section-appendix.c.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-encrypted-messa">Examples of Encrypted Messages</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.4.2">
                  <li pn="section-toc.1-1.16.2.4.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.4.2.1.1"><xref derivedContent="C.4.1" format="counter" sectionFormat="of" target="section-appendix.c.4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-simple-encrypted-message">Simple Encrypted Message</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.4.2.2">
                    <t indent="0" pn="section-toc.1-1.16.2.4.2.2.1"><xref derivedContent="C.4.2" format="counter" sectionFormat="of" target="section-appendix.c.4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-encrypted-message-with-a-pa">Encrypted Message with a Partial IV</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.16.2.5">
                <t indent="0" pn="section-toc.1-1.16.2.5.1"><xref derivedContent="C.5" format="counter" sectionFormat="of" target="section-appendix.c.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-maced-messages">Examples of MACed Messages</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.5.2">
                  <li pn="section-toc.1-1.16.2.5.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.5.2.1.1"><xref derivedContent="C.5.1" format="counter" sectionFormat="of" target="section-appendix.c.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-shared-secret-direct-mac">Shared Secret Direct MAC</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.5.2.2">
                    <t indent="0" pn="section-toc.1-1.16.2.5.2.2.1"><xref derivedContent="C.5.2" format="counter" sectionFormat="of" target="section-appendix.c.5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ecdh-direct-mac">ECDH Direct MAC</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.5.2.3">
                    <t indent="0" pn="section-toc.1-1.16.2.5.2.3.1"><xref derivedContent="C.5.3" format="counter" sectionFormat="of" target="section-appendix.c.5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-wrapped-mac">Wrapped MAC</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.5.2.4">
                    <t indent="0" pn="section-toc.1-1.16.2.5.2.4.1"><xref derivedContent="C.5.4" format="counter" sectionFormat="of" target="section-appendix.c.5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multi-recipient-maced-messa">Multi-Recipient MACed Message</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.16.2.6">
                <t indent="0" pn="section-toc.1-1.16.2.6.1"><xref derivedContent="C.6" format="counter" sectionFormat="of" target="section-appendix.c.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-mac0-messages">Examples of MAC0 Messages</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.6.2">
                  <li pn="section-toc.1-1.16.2.6.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.6.2.1.1"><xref derivedContent="C.6.1" format="counter" sectionFormat="of" target="section-appendix.c.6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-shared-secret-direct-mac-2">Shared-Secret Direct MAC</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.16.2.7">
                <t indent="0" pn="section-toc.1-1.16.2.7.1"><xref derivedContent="C.7" format="counter" sectionFormat="of" target="section-appendix.c.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-keys">COSE Keys</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2.7.2">
                  <li pn="section-toc.1-1.16.2.7.2.1">
                    <t indent="0" pn="section-toc.1-1.16.2.7.2.1.1"><xref derivedContent="C.7.1" format="counter" sectionFormat="of" target="section-appendix.c.7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-public-keys">Public Keys</xref></t>
                  </li>
                  <li pn="section-toc.1-1.16.2.7.2.2">
                    <t indent="0" pn="section-toc.1-1.16.2.7.2.2.1"><xref derivedContent="C.7.2" format="counter" sectionFormat="of" target="section-appendix.c.7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-private-keys">Private Keys</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.17">
            <t indent="0" pn="section-toc.1-1.17.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.d"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.18">
            <t indent="0" pn="section-toc.1-1.18.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.e"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-address">Author's Address</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">はじめに</name>
      <t indent="0" pn="section-1-1">インターネット・オブ・シングス（IoT）を構成する小型で制約のあるデバイスに焦点が置かれています。これにより、「簡潔なバイナリーオブジェクト表現（CBOR）」という標準の1つが生まれました。CBORは、バイナリーデータなどの変更を許可することで、JavaScriptオブジェクト表記（JSON）のデータモデルを拡張しました。CBORは、IoTのデータ構造をエンコードするための方法として、IETFの複数の作業部会で採用されています。CBORは、メッセージの輸送容量と実装サイズの両方において小さく、スキーマフリーのデコーダを持つよう設計されています。IoT向けのメッセージセキュリティーサービスを提供する必要があり、メッセージエンコード形式としてCBORを使用することは合理的です。</t>
      <t indent="0" pn="section-1-2">JOSEワーキンググループは、暗号化、署名、メッセージ認証コード（MAC）操作の処理方法とJSONを使用したキーのエンコード方法を指定する一連の文書<xref target="RFC7515" format="default" sectionFormat="of" derivedContent="RFC7515"/> <xref target="RFC7516" format="default" sectionFormat="of" derivedContent="RFC7516"/> <xref target="RFC7517" format="default" sectionFormat="of" derivedContent="RFC7517"/> <xref target="RFC7518" format="default" sectionFormat="of" derivedContent="RFC7518"/>を作成しました。この文書では、CBORエンコーディング形式に対して同じことを行うCBOR Object Signing and Encryption (COSE)標準を定義しています。この文書は、初期の一連のアルゴリズムを提供する<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>と組み合わせています。元のJSON Object Signing and Encryption (JOSE)文書の風味を保つ強い試みがありますが、以下の二つの考慮事項があります:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1-3">
        <li pn="section-1-3.1">CBORはJSONには存在しない機能を持っており、使用するのに適しています。その一つの例として、CBORはバイナリーデータをBase64エンコードされたテキスト文字列に変換せずに直接エンコードする方法を持っていることが挙げられます。</li>
        <li pn="section-1-3.2">COSEはJOSE仕様の直接的なコピーではありません。COSEを作成する過程で、JOSEのために行われた決定事項が再評価されました。多くの場合、基準が常に同じでなかったため、異なる結果が決定されました。</li>
      </ul>
      <t indent="0" pn="section-1-4">この文書には以下が含まれています：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1-5">
        <li pn="section-1-5.1">ワイヤー上で転送されるCBORオブジェクトの構造に関する説明。暗号化、署名、メッセージ認証のためにそれぞれ2つのオブジェクトが定義されています。キーの転送のために1つのオブジェクト、およびキーのグループの転送のために1つのオブジェクトが定義されています。</li>
        <li pn="section-1-5.2">各構造に必要な暗号関数の入力を構築するために使用される手順。</li>
        <li pn="section-1-5.3">異なるセキュリティーオブジェクトに適用される属性の集合です。</li>
      </ul>
      <t indent="0" pn="section-1-6">この文書には、特定の暗号アルゴリズムの使用ルールや手順は含まれていません。特定のアルゴリズムの詳細は、<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>および<xref target="RFC8230" format="default" sectionFormat="of" derivedContent="RFC8230"/>に示されています。追加のアルゴリズムの詳細については、将来の文書で定義されることが予想されています。</t>
      <t indent="0" pn="section-1-7">COSEは、最初は制約付きRESTful環境（CoRE）へのセキュリティーを提供するためのソリューションの一部として設計されました。これは、<xref target="RFC8613" format="default" sectionFormat="of" derivedContent="RFC8613"/>および<xref target="I-D.ietf-core-groupcomm-bis" format="default" sectionFormat="of" derivedContent="CORE-GROUPCOMM"/>を使用して行われています。ただし、COSEはこれらのケースに制限されず、セキュリティーサービスの提供を目的としてJOSEまたは暗号メッセージ構文（CMS）<xref target="RFC5652" format="default" sectionFormat="of" derivedContent="RFC5652"/>のいずれかを検討する場所ならどこでも使用できます。COSEは、JOSEやCMSと同様に、ストア・アンド・フォワードまたはオフラインのプロトコルでのみ使用されます。暗号化を必要とするオンラインプロトコルでCOSEを使用する場合は、オンラインの鍵確立プロセスがオブジェクトの送受信の前に行われる必要があります。セキュリティーサービスにCOSEを使用するアプリケーションは、まず必要なセキュリティーサービスを特定し、それに基づいて適切なCOSE構造と暗号アルゴリズムを選択する必要があります。<xref target="app-considerations" format="default" sectionFormat="of" derivedContent="Section 10"/>では、COSEの使用時にアプリケーションが指定する必要がある追加情報が提供されています。</t>
      <t indent="0" pn="section-1-8">この標準で存在しないCMSには、この標準には存在しないダイジェスト構造があります。この省略は意図的です。各プロトコルで構造を定義することが望ましいです。なぜなら、異なるプロトコルでは構造の一部として異なるフィールドのセットを含めたい場合があるからです。アルゴリズム識別子とダイジェスト値はすべてのアプリケーションに共通であるが、2つの値が常に隣接しているわけではなく、アルゴリズムは複数の値で一度に定義することができるからです。アプリケーションは構造の一部として追加のデータフィールドを定義することもできます。アプリケーション固有の要素の1つとして、ハッシュされているデータが取得できる場所へのURIや他のポインタを含めることがあります。 <xref target="RFC9054" format="default" sectionFormat="of" derivedContent="RFC9054"/> はそのような可能な構造の1つを含み、ダイジェストアルゴリズムのセットを定義しています。</t>
      <t indent="0" pn="section-1-9">COSEをインターネット標準化する過程で、COSE_Sign1構造体のカウンターサインのセキュリティー特性の説明が間違っていることがわかりました。説明されていたセキュリティー特性は、作業部会が望んでいた真のカウンターサインのものでしたので、このドキュメントのカウンターサインのテキストをすべて削除し、古いカウンターサインのアルゴリズムとヘッダーパラメーターを非推奨にし、望ましいセキュリティー特性を持つ新しいアルゴリズムとヘッダーパラメーターを定義するために、新たなドキュメント<xref target="I-D.ietf-cose-countersign" format="default" sectionFormat="of" derivedContent="COSE-COUNTERSIGN"/>を作成することに決定しました。</t>
      <section anchor="requirements-terminology" numbered="true" removeInRFC="false" toc="include" pn="section-1.1">
        <name slugifiedName="name-requirements-terminology">要件用語</name>
        <t indent="0" pn="section-1.1-1">キーワード「<bcp14>しなければなりません（MUST）</bcp14>」、「<bcp14>してはなりません（MUST NOT）</bcp14>」、
「<bcp14>要求されています（REQUIRED）</bcp14>」、
「<bcp14>することになります（SHALL）</bcp14>」、「<bcp14>することはありません（SHALL NOT）</bcp14>」、
「<bcp14>すべきです（SHOULD）</bcp14>」、「<bcp14>すべきではありません（SHOULD NOT）</bcp14>」、
「<bcp14>推奨されます（RECOMMENDED）</bcp14>」、「<bcp14>推奨されません（NOT RECOMMENDED）</bcp14>」、
「<bcp14>してもよいです（MAY）</bcp14>」、「<bcp14>選択できます（OPTIONAL）</bcp14>」は、
BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/>に記載されているとおりに解釈されるものとします。
ただし、ここに示すようにすべて大文字で表示される場合に限ります。</t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-1.2">
        <name slugifiedName="name-changes-from-rfc-8152">RFC 8152からの変更点</name>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.2-1">
          <li pn="section-1.2-1.1">元の文書をこの文書と<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>に分割します。</li>
          <li pn="section-1.2-1.2">COSEによってダイジェスト構造が定義されていない理由について説明するテキストを追加しました。</li>
          <li pn="section-1.2-1.3">用語の明確化や変更を行いました。</li>
          <li pn="section-1.2-1.4">
            <xref target="I-D.ietf-cose-countersign" format="default" sectionFormat="of" derivedContent="COSE-COUNTERSIGN"/>に関連するすべての詳細を削除しました。</li>
        </ul>
      </section>
      <section anchor="design-changes-from-jose" numbered="true" removeInRFC="false" toc="include" pn="section-1.3">
        <name slugifiedName="name-design-changes-from-jose">JOSEからの設計変更</name>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.3-1">
          <li pn="section-1.3-1.1">暗号化、署名、およびMACが行われたメッセージを簡単に特定できるように、1つの完全なメッセージ構造が定義されています。これにより、一貫した表示が可能になります。</li>
          <li pn="section-1.3-1.2">署名付きメッセージは、コンテンツに関連する保護されたヘッダーパラメーターと、署名に関連するものとを区別します。</li>
          <li pn="section-1.3-1.3">MACしたメッセージは署名付きメッセージから分離されます。</li>
          <li pn="section-1.3-1.4">MAC認証を行うメッセージは、MAC認証キーを取得するために、封入されたメッセージと同じ受信者アルゴリズムを使用することができます。</li>
          <li pn="section-1.3-1.5">バイナリーエンコーディングは、バイナリーデータをエンコードするために使用されます。base64urlエンコーディングではなく、バイナリーエンコーディングが使用されます。</li>
          <li pn="section-1.3-1.6">暗号化アルゴリズムの認証タグは、暗号文と組み合わせられました。</li>
          <li pn="section-1.3-1.7">暗号アルゴリズムのセットは、いくつかの方向で拡大され、他の方向では縮小されています。</li>
        </ul>
      </section>
      <section anchor="cbor-grammar" numbered="true" removeInRFC="false" toc="include" pn="section-1.4">
        <name slugifiedName="name-cddl-grammar-for-cbor-data-">CBORデータ構造のためのCDDL文法</name>
        <t indent="0" pn="section-1.4-1">COSEが最初に作成されたとき、簡潔なデータ定義言語（CDDL）<xref target="RFC8610" format="default" sectionFormat="of" derivedContent="RFC8610"/>はまだRFCとして公開されていなかったため、COSEで使用されるCBORデータ構造を形式的に説明するためのデータ記述言語として使用することはできませんでした。そのため、ここで定義されているCBORデータオブジェクトは、文章で説明されています。COSEデータオブジェクトの追加の（非規範的な）説明は、以下で述べるCDDLのサブセットで提供されます。</t>
        <t indent="0" pn="section-1.4-2">このドキュメントは、まず文法を作成し、それに関連する文書を作成することで開発されました。これにより、この文書はConcise Data Definition Language（CDDL）で定義されたプリミティブ型の文字列を使用して書かれました。この仕様では、以下のプリミティブ型が使用されます：</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-1.4-3">
          <dt pn="section-1.4-3.1">any:</dt>
          <dd pn="section-1.4-3.2">すべてのCBOR値をここに配置することを許可する非特異的な値。</dd>
          <dt pn="section-1.4-3.3">bool:</dt>
          <dd pn="section-1.4-3.4">ブール値（true: メジャータイプ7、値21; false: メジャータイプ7、値20）。</dd>
          <dt pn="section-1.4-3.5">bstr:</dt>
          <dd pn="section-1.4-3.6">バイト文字列（メジャータイプ2）。</dd>
          <dt pn="section-1.4-3.7">int:</dt>
          <dd pn="section-1.4-3.8">符号なし整数または負の整数。</dd>
          <dt pn="section-1.4-3.9">nil:</dt>
          <dd pn="section-1.4-3.10">null値（メジャータイプ7、値22）。</dd>
          <dt pn="section-1.4-3.11">nint:</dt>
          <dd pn="section-1.4-3.12">負の整数（メジャータイプ1）。</dd>
          <dt pn="section-1.4-3.13">tstr:</dt>
          <dd pn="section-1.4-3.14">UTF-8テキスト文字列（メジャータイプ3）。</dd>
          <dt pn="section-1.4-3.15">uint:</dt>
          <dd pn="section-1.4-3.16">符号なし整数（メジャータイプ0）。</dd>
        </dl>
        <t indent="0" pn="section-1.4-4">このドキュメントでは、CDDLからの3つの構文が省略形として表示されます。これらは次の通りです：</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-1.4-5">
          <dt pn="section-1.4-5.1">FOO / BAR:</dt>
          <dd pn="section-1.4-5.2">ここにはFOOまたはBARが表示できることを示します。</dd>
          <dt pn="section-1.4-5.3">[+ FOO]:</dt>
          <dd pn="section-1.4-5.4">型FOOが配列内に1回以上現れることを示します。</dd>
          <dt pn="section-1.4-5.5">* FOO:</dt>
          <dd pn="section-1.4-5.6">型FOOが0回以上現れることを示します。</dd>
        </dl>
        <t indent="0" pn="section-1.4-6">このドキュメントでも、CDDLで定義されている制約のうち2つが使用されています。これらは次のとおりです：</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-1.4-7">
          <dt pn="section-1.4-7.1">type1 .cbor type2:</dt>
          <dd pn="section-1.4-7.2">type1の内容（通常はbstr）がtype2の値を含むことを示します。</dd>
          <dt pn="section-1.4-7.3">type1 .size integer:</dt>
          <dd pn="section-1.4-7.4">type1の内容がintegerバイトであることを示します。</dd>
        </dl>
        <t indent="0" pn="section-1.4-8">CBORデータ構造に関しては、これまでに述べたCDDLの一部において、プローズ記述に加えて文法の説明も提供されます。CDDLの文法は情報提供的ですが、プローズ記述は規範的です。</t>
        <t indent="0" pn="section-1.4-9">次のXPath式を使用して、このドキュメントのXMLバージョンから収集されたCDDLを抽出できます（使用しているXPath評価器によっては、"&gt;"を実体として扱う必要がある場合もあります）。</t>
        <sourcecode type="xpath" markers="false" pn="section-1.4-10">
//sourcecode[@type='cddl']/text()
</sourcecode>
        <t indent="0" pn="section-1.4-11">CDDLは、初期の非終端記号がファイル内の最初の記号であることを期待しています。そのため、最初のCDDLのフラグメントをここに示します。</t>
        <sourcecode type="cddl" markers="false" pn="section-1.4-12">
start = COSE_Messages / COSE_Key / COSE_KeySet / Internal_Types

; This is defined to make the tool quieter:
Internal_Types = Sig_structure / Enc_structure / MAC_structure
</sourcecode>
        <t indent="0" pn="section-1.4-13">非終端記号 Internal_Types は、この文書の作成中に使用される自動検証ツールの処理を行うために定義されます。これはセキュリティー計算に使用される非終端記号を参照しますが、輸送用には出力されません。</t>
      </section>
      <section anchor="label" numbered="true" removeInRFC="false" toc="include" pn="section-1.5">
        <name slugifiedName="name-cbor-related-terminology">CBOR関連の用語</name>
        <t indent="0" pn="section-1.5-1">JSONでは、マップは「オブジェクト」と呼ばれ、テキスト文字列の一種しか持ちません。COSEでは、マップのキーとしてテキスト文字列、負の整数、および符号なし整数を使用します。整数はエンコードのコンパクトさと簡単な比較のために使用されます。テキスト文字列の含まれていることにより、追加の範囲の短いエンコード値が使用されることも可能です。単語「キー」は、主に暗号鍵としての意味で使用されるため、このマップのキーの用途には「ラベル」という用語を使用します。</t>
        <t indent="0" pn="section-1.5-2">この仕様で定義されたCBORマップにおいて、テキスト文字列または整数ではないラベルの存在はエラーです。アプリケーションは処理を失敗するか、不正なラベルを無視してメッセージを処理することができますが、不正なラベルを持つメッセージを作成<bcp14>してはなりません（MUST NOT）</bcp14>。</t>
        <t indent="0" pn="section-1.5-3">CDDLの文法フラグメントでは、前の段落と同様に非終端記号 "label" と "values" が定義されており、"values" は任意の値の使用を許可しています。</t>
        <sourcecode type="cddl" markers="false" pn="section-1.5-4">
label = int / tstr
values = any
</sourcecode>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-1.6">
        <name slugifiedName="name-document-terminology">文書の用語</name>
        <t indent="0" pn="section-1.6-1">この文書では、以下の用語を使用します:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-1.6-2">
          <dt pn="section-1.6-2.1">Byte:</dt>
          <dd pn="section-1.6-2.2">オクテットの同義語。</dd>
          <dt pn="section-1.6-2.3">Constrained Application Protocol (CoAP):</dt>
          <dd pn="section-1.6-2.4">制約システムで使用するための特化したウェブ転送プロトコル。これは<xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/>で定義されています。</dd>
          <dt pn="section-1.6-2.5">Authenticated Encryption (AE) algorithms <xref target="RFC5116" format="default" sectionFormat="of" derivedContent="RFC5116"/>:
          </dt>
          <dd pn="section-1.6-2.6">内容の認証チェックと暗号化サービスを提供する暗号化アルゴリズム。
          COSEで使用されるAEアルゴリズムの一例はAES Key Wrap <xref target="RFC3394" format="default" sectionFormat="of" derivedContent="RFC3394"/>です。
          これらのアルゴリズムはキー暗号化に使用されますが、関連データ付きの認証暗号化（AEAD）アルゴリズムが好まれます。
          </dd>
          <dt pn="section-1.6-2.7">AEAD algorithms <xref target="RFC5116" format="default" sectionFormat="of" derivedContent="RFC5116"/>:</dt>
          <dd pn="section-1.6-2.8">AEアルゴリズムと同じ認証サービスを内容に提供し、暗号化された本文の一部ではない関連データを認証サービスに含めることを可能にする暗号化アルゴリズム。COSEで使用されるAEADアルゴリズムの一例はAES-GCM <xref target="RFC5116" format="default" sectionFormat="of" derivedContent="RFC5116"/>です。これらのアルゴリズムは内容の暗号化に使用され、キーの暗号化にも使用できます。</dd>
        </dl>
        <t indent="0" pn="section-1.6-3">「コンテキスト」は、COSEメッセージの一部ではない情報を表すために文書全体で使用されます。コンテキストの一部となる情報は、プロトコルの相互作用、関連するキー構造、およびプログラムの構成など、複数の異なるソースから提供されることがあります。使用するコンテキストは、暗黙的なものであるか、<xref target="RFC8613" format="default" sectionFormat="of" derivedContent="RFC8613"/>で定義された「kid context」ヘッダーパラメーターを使用して特定することもできます。または、プロトコル固有の識別子によって特定されることもあります。一般的には、暗号構築にコンテキストを含めるべきです。詳細については、<xref target="Extern_AAD" format="default" sectionFormat="of" derivedContent="Section 4.3"/>を参照してください。</t>
        <t indent="0" pn="section-1.6-4">「バイト列」という用語は、バイトの連続性を表すために使用されます。一方、「テキスト文字列」という用語は、文字の連続性を表すために使用されます。</t>
      </section>
    </section>
    <section anchor="the-cosemsg-structure" numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-basic-cose-structure">基本的なCOSE構造</name>
      <t indent="0" pn="section-2-1">COSEオブジェクトの構造は、異なるタイプのセキュリティーメッセージの解析と処理時に共通のコードを大量に存在できるように設計されています。すべてのメッセージの構造は、CBOR配列タイプに基づいて構築されています。配列の最初の3つの要素は常に同じ情報を含んでいます：</t>
      <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-2-2">
        <li pn="section-2-2.1" derivedCounter="1.">保護されたヘッダーパラメーターは、bstrでエンコードされてラップされます。</li>
        <li pn="section-2-2.2" derivedCounter="2.">マップ形式の保護されていないヘッダーパラメーター。</li>
        <li pn="section-2-2.3" derivedCounter="3.">メッセージの内容です。内容は、適切な場合には平文または暗号文です。内容は切り離される場合があります（つまり、COSE構造から別々に転送される場合でも）、しかし場所は引き続き使用されます。内容は、存在する場合にはbstrでラップされ、切り離された場合にはnil値です。</li>
      </ol>
      <t indent="0" pn="section-2-3">このポイント以降の要素は、特定のメッセージタイプに依存します。</t>
      <t indent="0" pn="section-2-4">COSEメッセージは、異なる種類の暗号化概念を分離するためのレイヤーの概念を使用して構築されます。これがどのように機能するかの例として、COSE_Encryptメッセージ（<xref target="EnvelopedData" format="default" sectionFormat="of" derivedContent="Section 5.1"/>）を考えてみましょう。このメッセージタイプは、コンテンツレイヤーと受信者レイヤーの2つのレイヤーに分割されます。コンテンツレイヤーには、暗号化された平文と暗号化メッセージに関する情報が含まれています。受信者レイヤーには、各受信者ごとに暗号化されたコンテンツ暗号化キー（CEK）とその暗号化方法に関する情報が含まれています。暗号化メッセージCOSE_Encrypt0の単層バージョン（<xref target="EnvelopedData0" format="default" sectionFormat="of" derivedContent="Section 5.2"/>）は、CEKが事前共有されている場合に提供されます。</t>
      <t indent="0" pn="section-2-5">以下の方法によって、どのタイプのメッセージが提示されているかの識別が行われます：</t>
      <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-2-6">
        <li pn="section-2-6.1" derivedCounter="1.">特定のメッセージタイプは、文脈から判明します。これは、含まれる構造内のマーカーまたはアプリケーションプロトコルで指定された制限によって定義される場合があります。</li>
        <li pn="section-2-6.2" derivedCounter="2.">メッセージのタイプはCBORタグで識別されます。CBORタグを持つメッセージは、この仕様ではタグ付きメッセージとして知られており、CBORタグを持たないメッセージは非タグ付きメッセージとして知られています。このドキュメントでは、各メッセージ構造に対してCBORタグを定義しています。これらのタグは、<xref target="CBOR-Tags" format="default" sectionFormat="of" derivedContent="Table 1"/>で見つけることができます。</li>
        <li pn="section-2-6.3" derivedCounter="3.">COSEオブジェクトが「application/cose」のメディアタイプで運ばれる場合、「cose-type」というオプションのパラメーターを使用して埋め込まれたオブジェクトを識別することができます。このパラメーターは、構造体のタグ付けバージョンが使用されている場合、<bcp14>選択できます（OPTIONAL）</bcp14>。一方、構造体のタグ付けが使用されていない場合、このパラメーターは<bcp14>要求されています（REQUIRED）</bcp14>。各構造体に対してパラメーターとして使用する値は、<xref target="CBOR-Tags" format="default" sectionFormat="of" derivedContent="Table 1"/>に記載されています。</li>
        <li pn="section-2-6.4" derivedCounter="4.">COSEオブジェクトがCoAPペイロードとして運ばれる場合、CoAPのコンテンツフォーマットオプションを使用してメッセージのコンテンツを識別することができます。CoAPのコンテンツフォーマットの値は、<xref target="CoAP_content_type" format="default" sectionFormat="of" derivedContent="Table 2"/>に記載されています。メッセージの構造に対するCBORタグは必要ありません。なぜなら、各セキュリティーメッセージが一意に識別されているからです。</li>
      </ol>
      <table anchor="CBOR-Tags" align="center" pn="table-1">
        <name slugifiedName="name-cose-message-identification">COSE Message Identification</name>
        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">CBOR Tag</th>
            <th align="left" colspan="1" rowspan="1">cose-type</th>
            <th align="left" colspan="1" rowspan="1">Data Item</th>
            <th align="left" colspan="1" rowspan="1">Semantics</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">98</td>
            <td align="left" colspan="1" rowspan="1">cose-sign</td>
            <td align="left" colspan="1" rowspan="1">COSE_Sign</td>
            <td align="left" colspan="1" rowspan="1">COSE Signed Data Object</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">18</td>
            <td align="left" colspan="1" rowspan="1">cose-sign1</td>
            <td align="left" colspan="1" rowspan="1">COSE_Sign1</td>
            <td align="left" colspan="1" rowspan="1">COSE Single Signer Data Object</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">96</td>
            <td align="left" colspan="1" rowspan="1">cose-encrypt</td>
            <td align="left" colspan="1" rowspan="1">COSE_Encrypt</td>
            <td align="left" colspan="1" rowspan="1">COSE Encrypted Data Object</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">16</td>
            <td align="left" colspan="1" rowspan="1">cose-encrypt0</td>
            <td align="left" colspan="1" rowspan="1">COSE_Encrypt0</td>
            <td align="left" colspan="1" rowspan="1">COSE Single Recipient Encrypted Data Object</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">97</td>
            <td align="left" colspan="1" rowspan="1">cose-mac</td>
            <td align="left" colspan="1" rowspan="1">COSE_Mac</td>
            <td align="left" colspan="1" rowspan="1">COSE MACed Data Object</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">17</td>
            <td align="left" colspan="1" rowspan="1">cose-mac0</td>
            <td align="left" colspan="1" rowspan="1">COSE_Mac0</td>
            <td align="left" colspan="1" rowspan="1">COSE Mac w/o Recipients Object</td>
          </tr>
        </tbody>
      </table>
      <table anchor="CoAP_content_type" align="center" pn="table-2">
        <name slugifiedName="name-coap-content-formats-for-co">CoAP Content-Formats for COSE</name>
        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">Media Type</th>
            <th align="left" colspan="1" rowspan="1">Encoding</th>
            <th align="left" colspan="1" rowspan="1">ID</th>
            <th align="left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose; cose-type="cose-sign"</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">98</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose; cose-type="cose-sign1"</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">18</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose; cose-type="cose-encrypt"</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">96</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose; cose-type="cose-encrypt0"</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">16</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose; cose-type="cose-mac"</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">97</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose; cose-type="cose-mac0"</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">17</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose-key</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">101</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">application/cose-key-set</td>
            <td align="left" colspan="1" rowspan="1"/>
            <td align="left" colspan="1" rowspan="1">102</td>
            <td align="left" colspan="1" rowspan="1">RFC 9052</td>
          </tr>
        </tbody>
      </table>
      <t indent="0" pn="section-2-9">以下のCDDLフラグメントは、このドキュメントで定義された全てのトップメッセージを識別します。 タグ付きとタグなしのバージョンのメッセージ用に別々の非終端子が定義されています。</t>
      <sourcecode type="cddl" markers="false" pn="section-2-10">
COSE_Messages = COSE_Untagged_Message / COSE_Tagged_Message

COSE_Untagged_Message = COSE_Sign / COSE_Sign1 /
    COSE_Encrypt / COSE_Encrypt0 /
    COSE_Mac / COSE_Mac0

COSE_Tagged_Message = COSE_Sign_Tagged / COSE_Sign1_Tagged /
    COSE_Encrypt_Tagged / COSE_Encrypt0_Tagged /
    COSE_Mac_Tagged / COSE_Mac0_Tagged
</sourcecode>
    </section>
    <section anchor="header-parameters" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-header-parameters">ヘッダーパラメーター</name>
      <t indent="0" pn="section-3-1">COSEの構造は、ペイロード自体の一部とは見なされない情報を保持するための2つのバケットを持つように設計されていますが、これらはコンテンツ、アルゴリズム、キー、またはレイヤーの処理に関する評価ヒントに関する情報を保存するために使用されます。これらの2つのバケットは、キーを除くすべての構造で使用できます。これらのバケットは存在するものの、すべてのインスタンスで常に使用可能ではありません。たとえば、受信者構造の一部として保護バケットが定義されている場合でも、受信者構造に使用される一部のアルゴリズムでは認証データが提供されない場合があります。その場合、保護バケットは空になります。</t>
      <t indent="0" pn="section-3-2">どちらのバケットもCBORマップとして実装されています。マップのキーは「ラベル」（<xref target="label" format="default" sectionFormat="of" derivedContent="Section 1.5"/>）です。値の部分は、ラベルの定義に依存します。両方のマップは、同じセットのラベル/値のペアを使用します。ラベルの整数値とテキスト文字列値は、標準範囲、プライベート使用範囲、および選択されたアルゴリズムに依存する範囲に分割されています。定義されたラベルは、「COSEヘッダーパラメーター」IANAレジストリ（<xref target="cose-header-key-table" format="default" sectionFormat="of" derivedContent="Section 11.1"/>）で見つけることができます。</t>
      <t indent="0" pn="section-3-3">2 つのバケットは次のようになります。</t>
      <dl newline="false" indent="3" spacing="normal" pn="section-3-4">
        <dt pn="section-3-4.1">protected:</dt>
        <dd pn="section-3-4.2">
          <t indent="0" pn="section-3-4.2.1">現在のレイヤーに関する暗号化されたパラメーターを含んでいます。このバケットは、暗号化された計算に含まれる予定がない場合は空である<bcp14>必要があります（MUST）</bcp14>。このバケットは、メッセージ内でバイナリーオブジェクトとしてエンコードされます。この値は、保護されたマップをCBORエンコードし、bstrオブジェクトでラップすることによって取得されます。送信者は、長さゼロのマップを長さゼロのバイト列としてエンコードする<bcp14>すべきです（SHOULD）</bcp14>（h'a0'としてエンコードされた長さゼロのマップではなく）。長さゼロのバイト列のエンコードが推奨されています。それは短く、暗号化計算のための直列化構造で使用されるバージョンでもあります。受信者は、長さゼロのバイト列とバイト列でエンコードされた長さゼロのマップの両方を受け入れる<bcp14>必要があります（MUST）</bcp14>。</t>
          <t indent="0" pn="section-3-4.2.2">エンコーディングをバイト文字列でラッピングすることにより、保護されたマップが送信中に誤って変更される可能性が低くなります。（不正な挙動をする中間処理はデコードして再エンコードするかもしれませんが、デコードしたバイト文字列と再エンコードしたバイト文字列が同じでない限り、検証に失敗します。）これにより、暗号操作のためにマップの共通の正準化エンコーディングを行う必要があるすべての関係者に対応する問題が回避されます。</t>
        </dd>
        <dt pn="section-3-4.3">unprotected:</dt>
        <dd pn="section-3-4.4">現在のレイヤーに関するパラメーターを含み、これらは暗号化による保護がされていません。</dd>
      </dl>
      <t indent="0" pn="section-3-5">現在のレイヤーに関連するヘッダーパラメーターのみがそのレイヤーに配置されます。例として、ヘッダーパラメーター「コンテンツタイプ」は、メッセージに含まれるメッセージの内容を説明しています。したがって、このヘッダーパラメーターはコンテンツレイヤーにのみ配置され、受信者または署名レイヤーには配置されません。原則として、他のレイヤーを参照せずに任意のレイヤーを処理できる必要があります。COSE_Sign構造を除いて、レイヤーを越えて渡す必要があるデータは暗号鍵のみです。</t>
      <t indent="0" pn="section-3-6">このドキュメントで定義されたすべてのセキュリティーオブジェクトには、バケットが存在します。順番に、「保護された」バケット（CBORの「bstr」タイプ）と「保護されていない」バケット（CBORの「map」タイプ）があります。両方のバケットの存在が必要です。バケットに含まれるヘッダーパラメーターは、IANAの「COSEヘッダーパラメーター」レジストリ（<bcp14>第11.1節</bcp14>）から取得されます。一部のヘッダーパラメーターは、次の節で定義されています。</t>
      <t indent="0" pn="section-3-7">各マップのラベルは一意である<bcp14>必要があります（MUST）</bcp14>。メッセージを処理する際、ラベルが複数回現れる場合、そのメッセージは形式が不正であるとして拒否<bcp14>しなければなりません（MUST）</bcp14>。アプリケーションは、同じラベルが保護されたヘッダーパラメーターと保護されていないヘッダーパラメーターの両方に存在しないことを確認<bcp14>すべきです（SHOULD）</bcp14>。メッセージが形式が不正であるとして拒否されない場合、属性は保護されたバケットから取得<bcp14>しなければなりません（MUST）</bcp14>。その属性が保護されたバケットに見つからない場合のみ、その属性を保護されていないバケットから取得できます。</t>
      <t indent="0" pn="section-3-8">次のCDDLの断片は、2つのヘッダーパラメーターのバケットを表しています。CDDLでは、属性が配置される2つのバケットを表す「Headers」というグループが定義されています。このグループは、これら2つのフィールドを一貫してすべての場所で提供するために使用されます。共通ヘッダーパラメーターのマップを表す型も定義されています。</t>
      <sourcecode type="cddl" markers="false" pn="section-3-9">
Headers = (
    protected : empty_or_serialized_map,
    unprotected : header_map
)

header_map = {
    Generic_Headers,
    * label =&gt; values
}

empty_or_serialized_map = bstr .cbor header_map / bstr .size 0

</sourcecode>
      <section anchor="cose-headers" numbered="true" removeInRFC="false" toc="include" pn="section-3.1">
        <name slugifiedName="name-common-cose-header-paramete">共通のCOSEヘッダーパラメーター</name>
        <t indent="0" pn="section-3.1-1">このセクションでは、一連の共通ヘッダーパラメーターを定義します。これらのヘッダーパラメーターの概要は、<xref target="Header-Table" format="default" sectionFormat="of" derivedContent="Table 3"/>に記載されています。このテーブルは、ラベルの値と値のタイプを判断するために参照する必要があります。</t>
        <t indent="0" pn="section-3.1-2">このセクションで定義されたヘッダーパラメーターのセットは以下のとおりです：</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-3.1-3">
          <dt pn="section-3.1-3.1">alg:</dt>
          <dd pn="section-3.1-3.2">このヘッダーパラメーターは、セキュリティー処理に使用されるアルゴリズムを示すために使用されます。このヘッダーパラメーターは、その能力が存在する場所で認証されなければなりません（MUST）。このサポートは、AEADアルゴリズムまたは構造（例：COSE_SignおよびCOSE_Mac0）によって提供されます。この認証は、ヘッダーパラメーターを保護されたヘッダーパラメーターバケットに配置するか、外部から提供されるデータの一部として行うことができます（<xref target="Extern_AAD" format="default" sectionFormat="of" derivedContent="Section 4.3"/>参照）。値は"COSE Algorithms"レジストリから取得されます（<xref target="COSE.Algorithms" format="default" sectionFormat="of" derivedContent="COSE.Algorithms"/>参照）。</dd>
          <dt pn="section-3.1-3.3">crit:</dt>
          <dd pn="section-3.1-3.4">
            <t indent="0" pn="section-3.1-3.4.1">このヘッダーパラメーターは、メッセージを処理しているアプリケーションが理解する必要がある保護ヘッダーパラメーターを示すために使用されます。このドキュメントで定義されたヘッダーパラメーターは、すべての実装が理解できる必要があるため、含める必要はありません。さらに、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>で定義されたヘッダーパラメーター「counter signature」（ラベル7）は、新しい実装が理解する必要があります。これは、そのドキュメントに従っており、すべての実装がそれを理解すると想定されている送信者との互換性を維持するためです。存在する場合、「crit」ヘッダーパラメーターは保護ヘッダーパラメーターのバケット内に配置される<bcp14>必要があります（MUST）</bcp14>。配列は少なくとも1つの値を持つ<bcp14>必要があります（MUST）</bcp14>。</t>
            <t indent="0" pn="section-3.1-3.4.2">「crit」ヘッダーパラメーターには、すべてのヘッダーパラメーターラベルを含める必要はありません。配列にどのヘッダーパラメーターが配置されるかを決定するルールは次のとおりです：</t>
            <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-3.1-3.4.3">
              <li pn="section-3.1-3.4.3.1">0から7の範囲内の整数ラベルは省略<bcp14>すべきです（SHOULD）</bcp14></li>
              <li pn="section-3.1-3.4.3.2">整数ラベルの範囲が-1から-128の場合、省略することができます。 アルゴリズムは、ラベルのコンテンツを処理する能力がアルゴリズムの実装の中核であると考えられる場合、この範囲内でラベルを割り当てることができます。 アルゴリズムは、ラベルのコンテンツの処理能力がコアの機能ではないが、このインスタンスを正しく処理するために理解する必要がある場合に、この範囲外でラベルを割り当て、それらを「crit」ヘッダーパラメーターに含めることができます。 -129から-65536の範囲内の整数ラベルを含む<bcp14>べきです（SHOULD）</bcp14>。 これらのラベルは一般的にサポートされない可能性のある一般的でないヘッダーパラメーターです。</li>
              <li pn="section-3.1-3.4.3.3">headerパラメーターに必要なラベルは、省略<bcp14>してもよいです（MAY）</bcp14>。アプリケーションは、ラベルを省略できるかどうかを宣言する文を持つべきです。</li>
            </ul>
            <t indent="0" pn="section-3.1-3.4.4">
            "crit"によって示されるヘッダーパラメーターは、セキュリティーライブラリを使用するアプリケーションまたはセキュリティーライブラリコードによって処理することができます。唯一の要件は、ヘッダーパラメーターが処理されることです。"crit"の値リストに、保護されたヘッダーパラメーターのバケットにないヘッダーパラメーターのラベルが含まれている場合、これはメッセージの処理における致命的なエラーです。
            </t>
          </dd>
          <dt pn="section-3.1-3.5">content type:</dt>
          <dd pn="section-3.1-3.6">このヘッダーパラメーターは、"payload"または"ciphertext"フィールドのデータのコンテンツタイプを示すために使用されます。整数は"CoAP Content-Formats" IANAレジストリテーブル<xref target="COAP.Formats" format="default" sectionFormat="of" derivedContent="COAP.Formats"/>から取得されます。テキスト値は"&lt;type-name&gt;/&lt;subtype-name&gt;"の構文に従います。ここで、&lt;type-name&gt;と&lt;subtype-name&gt;は<xref target="RFC6838" sectionFormat="of" section="4.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6838#section-4.2" derivedContent="RFC6838"/>で定義されています。先頭と末尾の空白は許可されません。テキストのコンテンツタイプ値、パラメーター、およびサブパラメーターは、IANAの"Media Types"レジストリを使用して検索できます。コンテンツ構造が曖昧になる可能性がある場合、アプリケーションはこのヘッダーパラメーターを提供<bcp14>すべきです（SHOULD）</bcp14>。</dd>
          <dt pn="section-3.1-3.7">kid:</dt>
          <dd pn="section-3.1-3.8">このヘッダーパラメーターは、必要な暗号化キーを見つけるための入力として使用できるデータの一部を識別します。このヘッダーパラメーターの値は、COSE_Key構造の"kid"メンバーと一致させることができます。他のキー配布方法は、一致させるための同等のフィールドを定義できます。アプリケーションは"kid"値が一意であると仮定<bcp14>してはなりません（MUST NOT）</bcp14>。同じ"kid"値を持つキーが複数存在する可能性があるため、この"kid"に関連するすべてのキーをチェックする必要があるかもしれません。"kid"値の内部構造は定義されておらず、アプリケーションによって依存されてはなりません。キー識別子の値は、どのキーを使用するべきかについてのヒントです。これはセキュリティー上重要なフィールドではありません。このため、保護されていないヘッダーパラメーターバケットに配置することができます。</dd>
          <dt pn="section-3.1-3.9">IV:</dt>
          <dd pn="section-3.1-3.10">このヘッダーパラメーターは初期化ベクトル（IV）の値を保持します。一部の対称暗号化アルゴリズムでは、これをnonceと呼ぶこともあります。IVは保護されていないバケットに配置することができ、なぜならAEおよびAEADアルゴリズムでは、IVを変更すると復号化が失敗するからです。</dd>
          <dt pn="section-3.1-3.11">Partial IV:</dt>
          <dd pn="section-3.1-3.12">
            <t indent="0" pn="section-3.1-3.12.1">このヘッダーパラメーターはIV値の一部を保持します。COSE_Encrypt0構造を使用する場合、IVの一部はキーと関連付けられたコンテキストIVであり、一部は各メッセージごとに変更されることができる（部分IV）。このフィールドは、IVが各メッセージごとに変更される原因となる値を運ぶために使用されます。部分IVは保護されていないバケットに配置することができますが、値を変更すると、復号化結果の平文が乱れたものとして容易に検出できます。"Initialization Vector"および"Partial Initialization Vector"のヘッダーパラメーターは、同じセキュリティーレイヤー内に<bcp14>してはなりません（MUST NOT）</bcp14>。</t>
            <t indent="0" pn="section-3.1-3.12.2">メッセージIVは、次の手順で生成されます：</t>
            <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-3.1-3.12.3">
              <li pn="section-3.1-3.12.3.1" derivedCounter="1.">Partial IVをゼロで左側をパディングして、IVの長さ（アルゴリズムによって決定される）に合わせてください。</li>
              <li pn="section-3.1-3.12.3.2" derivedCounter="2.">パディングされた部分IVをコンテキストIVとXORします。</li>
            </ol>
          </dd>
        </dl>
        <table anchor="Header-Table" align="center" pn="table-3">
          <name slugifiedName="name-common-header-parameters">共通ヘッダーパラメーター</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Label</th>
              <th align="left" colspan="1" rowspan="1">Value Type</th>
              <th align="left" colspan="1" rowspan="1">Value Registry</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">alg</td>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">int / tstr</td>
              <td align="left" colspan="1" rowspan="1">COSE Algorithms registry</td>
              <td align="left" colspan="1" rowspan="1">使用する暗号化アルゴリズム</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">crit</td>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="left" colspan="1" rowspan="1">[+ label]</td>
              <td align="left" colspan="1" rowspan="1">COSE Header Parameters registry</td>
              <td align="left" colspan="1" rowspan="1">理解する必要がある重要なヘッダーパラメーター</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">content type</td>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="left" colspan="1" rowspan="1">tstr / uint</td>
              <td align="left" colspan="1" rowspan="1">CoAP Content-Formats or Media Types registries</td>
              <td align="left" colspan="1" rowspan="1">ペイロードのコンテンツタイプ</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">kid</td>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="left" colspan="1" rowspan="1">bstr</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">キー識別子</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">IV</td>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="left" colspan="1" rowspan="1">bstr</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">完全な初期化ベクトル</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">Partial IV</td>
              <td align="left" colspan="1" rowspan="1">6</td>
              <td align="left" colspan="1" rowspan="1">bstr</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">部分的な初期化ベクトル</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-3.1-5">このセクションで定義されたヘッダーパラメーターのセットを表すCDDLフラグメントは以下の通りです。各ヘッダーパラメーターはオプションとしてタグ付けされています。なぜなら、すべてのマップに含まれる必要はないためです。特定のマップで必要とされるヘッダーパラメーターについては、上記で説明されています。</t>
        <sourcecode type="cddl" markers="false" pn="section-3.1-6">
Generic_Headers = (
    ? 1 =&gt; int / tstr,  ; algorithm identifier
    ? 2 =&gt; [+label],    ; criticality
    ? 3 =&gt; tstr / int,  ; content type
    ? 4 =&gt; bstr,        ; key identifier
    ? ( 5 =&gt; bstr //    ; IV
        6 =&gt; bstr )     ; Partial IV
)
</sourcecode>
      </section>
    </section>
    <section anchor="signing-structure" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-signing-objects">署名オブジェクト</name>
      <t indent="0" pn="section-4-1">COSEは、2つの異なる署名構造をサポートしています。COSE_Signは、同一のコンテンツに1つ以上の署名を適用することができます。一方、COSE_Sign1は単一の署名者に制限されています。これらの構造は互換性がなく、署名の計算には使用されている構造を識別するパラメーターが含まれているため、変換された構造は署名の検証に失敗します。</t>
      <section anchor="full-signature" numbered="true" removeInRFC="false" toc="include" pn="section-4.1">
        <name slugifiedName="name-signing-with-one-or-more-si">1人以上の署名者で署名する</name>
        <t indent="0" pn="section-4.1-1">COSE_Sign構造体では、1つ以上の署名をメッセージのペイロードに適用することができます。コンテンツに関連するヘッダーパラメーターと署名に関連するヘッダーパラメーターは、署名自体と共に運ばれます。これらのヘッダーパラメーターは、署名によって認証される場合もあれば、単に存在するだけの場合もあります。コンテンツに関するヘッダーパラメーターの例としては、コンテンツタイプのヘッダーパラメーターがあります。署名に関するヘッダーパラメーターの例としては、署名を作成するために使用されるアルゴリズムと鍵があります。</t>
        <t indent="0" pn="section-4.1-2"><xref target="RFC5652" format="default" sectionFormat="of" derivedContent="RFC5652"/> は、次のことを示しています：</t>
        <blockquote pn="section-4.1-3">
          When more than one signature is present, the successful validation of one signature associated with a given signer is usually treated as a successful signature by that signer.  However, there are some application environments where other rules are needed.  An application that employs a rule other than one valid signature for each signer must specify those rules.  Also, where simple matching of the signer identifier is not sufficient to determine whether the signatures were generated by the same signer, the application specification must describe how to determine which signatures were generated by the same signer.  Support of different communities of recipients is the primary reason that signers choose to include more than one signature.
        </blockquote>
        <t indent="0" pn="section-4.1-4">たとえば、COSE_Sign構造は、エドワーズ曲線デジタル署名アルゴリズム（EdDSA）<xref target="RFC8032" format="default" sectionFormat="of" derivedContent="RFC8032"/>および楕円曲線デジタル署名アルゴリズム（ECDSA）<xref target="DSS" format="default" sectionFormat="of" derivedContent="DSS"/>で生成された署名を含む場合があります。これにより、受信者はどちらかのアルゴリズムに関連付けられた署名を検証することができます。複数の署名評価に関する詳細は、<xref target="RFC5752" format="default" sectionFormat="of" derivedContent="RFC5752"/>で見つけることができます。</t>
        <t indent="0" pn="section-4.1-5">署名構造は、使用される文脈に応じて、タグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Sign構造は、CBORタグ98で識別されます。これを表すCDDLフラグメントは次のとおりです：</t>
        <sourcecode type="cddl" markers="false" pn="section-4.1-6">
COSE_Sign_Tagged = #6.98(COSE_Sign)
</sourcecode>
        <t indent="0" pn="section-4.1-7">COSE署名メッセージは2つの部分で定義されています。メッセージの本体と情報を運ぶCBORオブジェクトはCOSE_Sign構造と呼ばれます。署名と署名に関する情報を運ぶCBORオブジェクトはCOSE_Signature構造と呼ばれます。COSE署名メッセージの例は、<xref target="SignedExamples" format="default" sectionFormat="of" derivedContent="Appendix C.1"/>で見つけることができます。</t>
        <t indent="0" pn="section-4.1-8">COSE_Sign構造体は、CBOR配列です。配列のフィールドは、順に以下の通りです：</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-4.1-9">
          <dt pn="section-4.1-9.1">protected:</dt>
          <dd pn="section-4.1-9.2">これは<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-4.1-9.3">unprotected:</dt>
          <dd pn="section-4.1-9.4">これは<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-4.1-9.5">payload:</dt>
          <dd pn="section-4.1-9.6">
            <t indent="0" pn="section-4.1-9.6.1">このフィールドには署名されるシリアライズされたコンテンツが含まれています。メッセージにペイロードが存在しない場合は、アプリケーションは別途ペイロードを提供する必要があります。ペイロードは、変更なしで輸送されることを確保するために、bstrでラップされます。ペイロードが別途輸送される場合（「分離されたコンテンツ」）、この場所には nil のCBORオブジェクトが配置され、アプリケーションはそれが変更なしで輸送されることを保証する責任を持つ必要があります。</t>
            <t indent="0" pn="section-4.1-9.6.2">注：メッセージ回復アルゴリズムを使用した場合（<xref target="SigAlgs" format="default" sectionFormat="of" derivedContent="Section 8.1"/>）、回復できる最大バイト数は元のペイロードの長さです。エンコードされたペイロードのサイズは、回復されるバイト数だけ減少します。元のペイロードのすべてのバイトが消費された場合、送信ペイロードは不在ではなく、長さゼロのバイト文字列としてエンコードされます。</t>
          </dd>
          <dt pn="section-4.1-9.7">signatures:</dt>
          <dd pn="section-4.1-9.8">このフィールドは署名の配列です。各署名はCOSE_Signature構造として表されます。</dd>
        </dl>
        <t indent="0" pn="section-4.1-10">上記のテキストのCOSE_Sign用のCDDLフラグメントは、次のようになります。</t>
        <sourcecode type="cddl" markers="false" pn="section-4.1-11">
COSE_Sign = [
    Headers,
    payload : bstr / nil,
    signatures : [+ COSE_Signature]
]
</sourcecode>
        <t indent="0" pn="section-4.1-12">COSE_Signature構造体はCBOR配列です。配列のフィールドは、次の順序で配置されます。</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-4.1-13">
          <dt pn="section-4.1-13.1">protected:</dt>
          <dd pn="section-4.1-13.2">This is as described in <xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>.  </dd>
          <dt pn="section-4.1-13.3">unprotected:</dt>
          <dd pn="section-4.1-13.4">This is as described in <xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>.  </dd>
          <dt pn="section-4.1-13.5">signature:</dt>
          <dd pn="section-4.1-13.6">This field contains the computed signature value.  The type of the field is a bstr.  Algorithms <bcp14>MUST</bcp14> specify padding if the signature value is not a multiple of 8 bits.  </dd>
        </dl>
        <t indent="0" pn="section-4.1-14">上記のテキストを表すCOSE_SignatureのCDDLフラグメントは次の通りです。</t>
        <sourcecode type="cddl" markers="false" pn="section-4.1-15">
COSE_Signature =  [
    Headers,
    signature : bstr
]
</sourcecode>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-4.2">
        <name slugifiedName="name-signing-with-one-signer">1人の署名者で署名する</name>
        <t indent="0" pn="section-4.2-1">COSE_Sign1署名構造は、メッセージに1つの署名のみを配置する場合に使用されます。コンテンツおよび署名に関連するヘッダーパラメーターは、COSE_Signの分離ではなく、同じブケットに配置されます。</t>
        <t indent="0" pn="section-4.2-2">構造は、使用されるコンテキストに応じてタグ付きまたはタグなしでエンコードできます。タグ付きのCOSE_Sign1構造は、CBORタグ18で識別されます。これを示すCDDLフラグメントは次のようになります：</t>
        <sourcecode type="cddl" markers="false" pn="section-4.2-3">
COSE_Sign1_Tagged = #6.18(COSE_Sign1)
</sourcecode>
        <t indent="0" pn="section-4.2-4">COSE_Sign1構造体は、本文、署名、本文と署名に関する情報を含むCBORオブジェクトを運ぶものです。COSE_Sign1メッセージの例は、<xref target="Sign1_Examples" format="default" sectionFormat="of" derivedContent="Appendix C.2"/>にあります。</t>
        <t indent="0" pn="section-4.2-5">COSE_Sign1構造体は、CBOR配列です。配列の順序でフィールドが以下になります：</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-4.2-6">
          <dt pn="section-4.2-6.1">protected:</dt>
          <dd pn="section-4.2-6.2">これは<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-4.2-6.3">unprotected:</dt>
          <dd pn="section-4.2-6.4">これは<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-4.2-6.5">payload:</dt>
          <dd pn="section-4.2-6.6">これは<xref target="full-signature" format="default" sectionFormat="of" derivedContent="Section 4.1"/>で説明されている通りです。</dd>
          <dt pn="section-4.2-6.7">signature:</dt>
          <dd pn="section-4.2-6.8">このフィールドには計算された署名値が含まれます。フィールドのタイプはbstrです。</dd>
        </dl>
        <t indent="0" pn="section-4.2-7">上記のテキストに対応するCOSE_Sign1のCDDLフラグメントは以下の通りです。</t>
        <sourcecode type="cddl" markers="false" pn="section-4.2-8">
COSE_Sign1 = [
    Headers,
    payload : bstr / nil,
    signature : bstr
]
</sourcecode>
      </section>
      <section anchor="Extern_AAD" numbered="true" removeInRFC="false" toc="include" pn="section-4.3">
        <name slugifiedName="name-externally-supplied-data">外部から供給されるデータ</name>
        <t indent="0" pn="section-4.3-1">COSEで提供される機能の1つは、COSEオブジェクトの一部として運ばれることはないが、認証される追加データをアプリケーションが提供する能力です。これをサポートする主な理由は、CoAPメッセージ構造<xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/>を見ることで理解できます。CoAPメッセージのペイロードの前にオプションを運ぶための仕組みが存在します。この場所に配置できるデータの例としては、CoAPコードやCoAPオプションがあります。データがCoAPメッセージのヘッダーにある場合、プロキシがプロキシ操作を行う際に使用することができます。たとえば、プロキシはAcceptオプションを使用して、プロキシのキャッシュに適切な値が含まれているかどうかを判断することができます。送信者は、追加データの機能を使用して、プロキシまたは攻撃者によってAccept値のセットに行われた変更を検出することができます。外部から提供されたデータにフィールドを含めることで、後続の変更はサーバーのメッセージ処理に失敗を引き起こします。</t>
        <t indent="0" pn="section-4.3-2">この文書は、外部から供給された認証データのバイト配列を使用するプロセスについて説明します。バイト配列の構築方法は、アプリケーションの関数です。この機能を使用するアプリケーションは、外部から供給された認証データの構築方法を定義する必要があります。そのような構築は、以下の問題を考慮する必要があります：<bcp14>しなければなりません（MUST）</bcp14>。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-4.3-3">
          <li pn="section-4.3-3.1">複数のアイテムが含まれている場合、アプリケーションは、異なる入力がある場合に同じバイト文字列が生成されないようにする必要があります。問題が発生する可能性のあるシナリオの例として、「AB」と「CDE」というテキスト文字列を連結するか、「ABC」と「DE」というテキスト文字列を連結することが挙げられます。これは通常、フィールドを固定幅にするか、出力の一部としてフィールドの長さをエンコードすることで対処されます。CoAPのオプションを使用する場合、これらのフィールドはTLV構造を使用して連結することができ、問題はありません。</li>
          <li pn="section-4.3-3.2">複数の項目が含まれる場合、各項目の順序が定義される必要があります。CoAPのオプションを例にすると、アプリケーションはフィールドの順序をオプション番号で指定することができます。</li>
          <li pn="section-4.3-3.3">アプリケーションは、バイト文字列が両側で同じになることを確認する必要があります。CoAPのオプションを使用すると、同じ相対番号が保持される場合に問題が発生する可能性があります。中間ノードはオプションを挿入または削除することができ、相対番号付けが変更されます。アプリケーションは、相対番号が外部データにあるオプションにのみ相対的であるように再エンコードされる必要があることを指定する必要があります。</li>
        </ul>
      </section>
      <section anchor="Sig_structure" numbered="true" removeInRFC="false" toc="include" pn="section-4.4">
        <name slugifiedName="name-signing-and-verification-pr">署名と検証プロセス</name>
        <t indent="0" pn="section-4.4-1">署名を作成するためには、明確に定義されたバイト文字列が必要です。Sig_structureは正規形を作成するために使用されます。この署名および検証プロセスでは、本文情報（COSE_SignまたはCOSE_Sign1）、署名者情報（COSE_Signature）、およびアプリケーションデータ（外部ソース）を受け取ります。Sig_structureはCBOR配列です。Sig_structureのフィールドは、順序どおりに次のとおりです：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-4.4-2">
          <li pn="section-4.4-2.1" derivedCounter="1.">
            <t indent="0" pn="section-4.4-2.1.1">
  承認の文脈を識別する文脈テキスト文字列です。文脈テキスト文字列は次のとおりです：
</t>
            <ul empty="true" bare="false" indent="3" spacing="normal" pn="section-4.4-2.1.2">
              <li pn="section-4.4-2.1.2.1">COSE_Signature構造を使用する署名の場合、「Signature」とします。</li>
              <li pn="section-4.4-2.1.2.2">COSE_Sign1構造を使用する署名の場合、「Signature1」とします。</li>
            </ul>
          </li>
          <li pn="section-4.4-2.2" derivedCounter="2.">本文構造から保護された属性を、bstrタイプでエンコードします。保護された属性がない場合は、長さゼロのバイト列が使用されます。</li>
          <li pn="section-4.4-2.3" derivedCounter="3.">署名者構造体からの保護属性は、bstr型でエンコードされます。保護属性が存在しない場合は、長さがゼロのバイト列が使用されます。このフィールドは、COSE_Sign1署名構造体では省略されます。</li>
          <li pn="section-4.4-2.4" derivedCounter="4.">アプリケーションからの外部で提供されるデータは、bstr型でエンコードされます。このフィールドが提供されていない場合、長さがゼロのバイト文字列としてデフォルト値が設定されます。このフィールドの構築に関するアプリケーションのガイダンスについては、<xref target="Extern_AAD" format="default" sectionFormat="of" derivedContent="Section 4.3"/>を参照してください。</li>
          <li pn="section-4.4-2.5" derivedCounter="5.">署名されるべきペイロードは、bstr型でエンコードされます。ここでは、それがどのように輸送されるかに関係なく、完全なペイロードが使用されます。</li>
        </ol>
        <t indent="0" pn="section-4.4-3">上記のテキストを記述するCDDLフラグメントは次の通りです：</t>
        <sourcecode type="cddl" markers="false" pn="section-4.4-4">
Sig_structure = [
    context : "Signature" / "Signature1",
    body_protected : empty_or_serialized_map,
    ? sign_protected : empty_or_serialized_map,
    external_aad : bstr,
    payload : bstr
]
</sourcecode>
        <t indent="0" pn="section-4.4-5">署名の計算方法:</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-4.4-6">
          <li pn="section-4.4-6.1" derivedCounter="1.">Sig_structureを作成し、適切なフィールドでそれを埋めます。</li>
          <li pn="section-4.4-6.2" derivedCounter="2.">
            <xref target="CBOR-Canonical" format="default" sectionFormat="of" derivedContent="Section 9"/>で説明されているエンコーディングを使用して、Sig_structureをバイト文字列にエンコードして、値ToBeSignedを作成します。</li>
          <li pn="section-4.4-6.3" derivedCounter="3.">K (署名に使用するキー)、alg (署名に使用するアルゴリズム)、および ToBeSigned (署名する値) を指定して、署名作成アルゴリズムを呼び出します。</li>
          <li pn="section-4.4-6.4" derivedCounter="4.">生成された署名値を適切な位置に配置します。これは、COSE_SignatureまたはCOSE_Sign1構造体の「signature」フィールドです。</li>
        </ol>
        <t indent="0" pn="section-4.4-7">署名を検証する手順は次の通りです：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-4.4-8">
          <li pn="section-4.4-8.1" derivedCounter="1.">適切なフィールドを持つSig_structureを作成し、それを埋める。</li>
          <li pn="section-4.4-8.2" derivedCounter="2.">Sig_structureをバイト文字列にエンコードして、encodingに<xref target="CBOR-Canonical" format="default" sectionFormat="of" derivedContent="Section 9"/>で説明されたエンコーディングを使用して、ToBeSignedの値を作成します。</li>
          <li pn="section-4.4-8.3" derivedCounter="3.">署名検証アルゴリズムを呼び出し、K（検証に使用するキー）、alg（署名に使用するアルゴリズム）、ToBeSigned（署名する値）、sig（検証する署名）を渡します。</li>
        </ol>
        <t indent="0" pn="section-4.4-9">アプリケーションは、署名の検証を行うだけでなく、アクションを実行する前に、キーが署名者の身元と正しくペアリングされていること、および署名者の身元が認証されていることを確認するための適切なチェックを行います。</t>
      </section>
    </section>
    <section anchor="encryption-object" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-encryption-objects">暗号化オブジェクト</name>
      <t indent="0" pn="section-5-1">COSEは2つの異なる暗号化構造をサポートしています。COSE_Encrypt0は、使用する鍵が暗黙的にわかっているために、受信者の構造が必要ない場合に使用されます。COSE_Encryptは、その他の場合に使用されます。これには、複数の受信者がある場合や、直接以外の受信者アルゴリズム（つまり、事前共有された秘密）が使用される場合が含まれます。</t>
      <section anchor="EnvelopedData" numbered="true" removeInRFC="false" toc="include" pn="section-5.1">
        <name slugifiedName="name-enveloped-cose-structure">包含されたCOSE構造</name>
        <t indent="0" pn="section-5.1-1">送られるメッセージには、1人以上の受信者が存在する場合、封入構造が利用されます。メッセージ内には、コンテンツに関するヘッダーパラメーターと受信者情報に関するヘッダーパラメーターに関する規定があります。コンテンツに関連する保護されたヘッダーパラメーターは、コンテンツの暗号化アルゴリズムによって認証されます。受信者に関連する保護されたヘッダーパラメーター（アルゴリズムがサポートしている場合）は、受信者のアルゴリズムによって認証されます。コンテンツに関するヘッダーパラメーターの例は、コンテンツの種類とコンテンツの暗号化アルゴリズムです。受信者に関するヘッダーパラメーターの例は、受信者の鍵識別子と受信者の暗号化アルゴリズムです。</t>
        <t indent="0" pn="section-5.1-2">同じ技術とほぼ同じ構造が、平文とキーの両方を暗号化するために使用されます。これは、「暗号メッセージ構文（CMS）」<xref target="RFC5652" format="default" sectionFormat="of" derivedContent="RFC5652"/>と「JSON Web Encryption（JWE）」<xref target="RFC7516" format="default" sectionFormat="of" derivedContent="RFC7516"/>の両方が使用するアプローチとは異なります。異なる構造がコンテンツ層と受信者層に使用されるのに対して、2つの構造が定義されています。COSE_Encryptは暗号化されたコンテンツを保持し、COSE_recipientは受信者の暗号化されたキーを保持します。封入されたメッセージの例は、<xref target="EnvelopedExamples" format="default" sectionFormat="of" derivedContent="Appendix C.3"/>で見つけることができます。</t>
        <t indent="0" pn="section-5.1-3">COSE_Encrypt構造体は、使用されるコンテキストに応じて、taggedまたはuntaggedのいずれかとしてエンコードされることがあります。taggedなCOSE_Encrypt構造体は、CBORタグ96によって識別されます。これを表すCDDLフラグメントは次の通りです：</t>
        <sourcecode type="cddl" markers="false" pn="section-5.1-4">
COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)
</sourcecode>
        <t indent="0" pn="section-5.1-5">COSE_Encrypt構造体はCBOR配列です。配列のフィールドは、以下の順序であります：</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-5.1-6">
          <dt pn="section-5.1-6.1">protected:</dt>
          <dd pn="section-5.1-6.2">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-5.1-6.3">unprotected:</dt>
          <dd pn="section-5.1-6.4">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-5.1-6.5">ciphertext:</dt>
          <dd pn="section-5.1-6.6">このフィールドには、bstrとしてエンコードされた暗号文が含まれています。暗号文が暗号化プロセスの制御情報（つまり、分離されたコンテンツ）から独立して輸送される場合、このフィールドはnil値としてエンコードされます。</dd>
          <dt pn="section-5.1-6.7">recipients:</dt>
          <dd pn="section-5.1-6.8">このフィールドには、受信者情報構造の配列が含まれています。受信者情報構造のタイプはCOSE_recipientです。</dd>
        </dl>
        <t indent="0" pn="section-5.1-7">上記のテキストに対応するCDDLフラグメントは以下の通りです：</t>
        <sourcecode type="cddl" markers="false" pn="section-5.1-8">
COSE_Encrypt = [
    Headers,
    ciphertext : bstr / nil,
    recipients : [+COSE_recipient]
]
</sourcecode>
        <t indent="0" pn="section-5.1-9">COSE_recipient構造はCBOR配列です。配列のフィールドは、順に次の通りです。</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-5.1-10">
          <dt pn="section-5.1-10.1">protected:</dt>
          <dd pn="section-5.1-10.2">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-5.1-10.3">unprotected:</dt>
          <dd pn="section-5.1-10.4">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-5.1-10.5">ciphertext:</dt>
          <dd pn="section-5.1-10.6">このフィールドには、bstrとしてエンコードされた暗号化キーが含まれています。すべてのエンコードされたキーは対称キーであり、キーのバイナリ値が内容です。暗号化キーがない場合、このフィールドはnil値としてエンコードされます。</dd>
          <dt pn="section-5.1-10.7">recipients:</dt>
          <dd pn="section-5.1-10.8">このフィールドには、受信者情報構造の配列が含まれています。受信者情報構造のタイプはCOSE_recipientであり、その例は<xref target="three-layer" format="default" sectionFormat="of" derivedContent="Appendix B"/>にあります。受信者情報構造がない場合、この要素は存在しません。</dd>
        </dl>
        <t indent="0" pn="section-5.1-11">上記のテキストに対応するCOSE_recipientのCDDLフラグメントは次の通りです：</t>
        <sourcecode type="cddl" markers="false" pn="section-5.1-12">
COSE_recipient = [
    Headers,
    ciphertext : bstr / nil,
    ? recipients : [+COSE_recipient]
]
</sourcecode>
        <section anchor="key-management-methods" numbered="true" removeInRFC="false" toc="include" pn="section-5.1.1">
          <name slugifiedName="name-content-key-distribution-me">コンテンツキー配布方法</name>
          <t indent="0" pn="section-5.1.1-1">暗号化されたメッセージは、1人以上の受信者のための暗号化されたコンテンツと暗号化されたCEKで構成されます。CEKは、各受信者に固有のキーを使用して暗号化されます。この暗号化の詳細は、受信者のアルゴリズムがどのクラスに属するかに依存します。各クラスの詳細については、<xref target="key-management-algs" format="default" sectionFormat="of" derivedContent="Section 8.5"/>に記載されています。5つのコンテンツキー分配方式の概要は次のとおりです：</t>
          <dl newline="false" indent="3" spacing="normal" pn="section-5.1.1-2">
            <dt pn="section-5.1.1-2.1">direct:</dt>
            <dd pn="section-5.1.1-2.2">CEKは、以前に配布された対称キーと同じか、以前に配布された秘密から派生します。メッセージにはCEKが輸送されません。</dd>
            <dt pn="section-5.1.1-2.3">symmetric key-encryption keys (KEKs):</dt>
            <dd pn="section-5.1.1-2.4">CEKは、以前に配布された対称KEKを使用して暗号化されます。これはキーラップとも呼ばれます。</dd>
            <dt pn="section-5.1.1-2.5">key agreement:</dt>
            <dd pn="section-5.1.1-2.6">
              受信者の公開鍵と送信者の秘密鍵が使用されてペアワイズの秘密が生成され、キー導出関数（KDF）が適用されてキーが導出され、その後、CEKは導出されたキー自体または導出されたキーによって暗号化されます。
            </dd>
            <dt pn="section-5.1.1-2.7">key transport:</dt>
            <dd pn="section-5.1.1-2.8">
              CEKは受信者の公開鍵で暗号化されます。
            </dd>
            <dt pn="section-5.1.1-2.9">passwords:</dt>
            <dd pn="section-5.1.1-2.10">
              CEKは、パスワードから派生したKEKで暗号化されます。
              この文書が公開された時点では、パスワードアルゴリズムは定義されていません。
            </dd>
          </dl>
        </section>
      </section>
      <section anchor="EnvelopedData0" numbered="true" removeInRFC="false" toc="include" pn="section-5.2">
        <name slugifiedName="name-single-recipient-encrypted">単一受信者暗号化</name>
        <t indent="0" pn="section-5.2-1">COSE_Encrypt0の暗号化された構造体には、メッセージの受信者を指定する機能がありません。この構造体は、オブジェクトの受信者がメッセージを復号化するために使用されるキーの識別子をすでに知っていることを前提としています。受信者にキーを識別する必要がある場合は、封入された構造体を使用するべきです。</t>
        <t indent="0" pn="section-5.2-2">暗号化されたメッセージの例は、<xref target="EncryptExamples" format="default" sectionFormat="of" derivedContent="Appendix C.4"/>にあります。</t>
        <t indent="0" pn="section-5.2-3">COSE_Encrypt0の構造は、使用されるコンテキストに応じて、タグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Encrypt0構造は、CBORタグ16によって識別されます。これを示すCDDLフラグメントは次のとおりです:</t>
        <sourcecode type="cddl" markers="false" pn="section-5.2-4">
COSE_Encrypt0_Tagged = #6.16(COSE_Encrypt0)
</sourcecode>
        <t indent="0" pn="section-5.2-5">COSE_Encrypt0構造体はCBOR配列です。配列のフィールドは以下の順序であります:</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-5.2-6">
          <dt pn="section-5.2-6.1">protected:</dt>
          <dd pn="section-5.2-6.2">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-5.2-6.3">unprotected:</dt>
          <dd pn="section-5.2-6.4">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-5.2-6.5">ciphertext:</dt>
          <dd pn="section-5.2-6.6">これは、<xref target="EnvelopedData" format="default" sectionFormat="of" derivedContent="Section 5.1"/>で説明されている通りです。</dd>
        </dl>
        <t indent="0" pn="section-5.2-7">上記のテキストに対応するCOSE_Encrypt0のCDDLフラグメントは以下の通りです：</t>
        <sourcecode type="cddl" markers="false" pn="section-5.2-8">
COSE_Encrypt0 = [
    Headers,
    ciphertext : bstr / nil,
]
</sourcecode>
      </section>
      <section anchor="encryption-algorithm-for-aead-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-5.3">
        <name slugifiedName="name-how-to-encrypt-and-decrypt-">AEADアルゴリズムの暗号化と復号化の方法</name>
        <t indent="0" pn="section-5.3-1">AEADアルゴリズムの暗号化アルゴリズムは非常にシンプルです。最初のステップは、認証データ構造のために一貫性のあるバイト文字列を作成することです。この目的のために、Enc_structureを使用します。Enc_structureはCBOR配列です。Enc_structureのフィールドは、順番に以下の通りです：

</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-5.3-2">
          <li pn="section-5.3-2.1" derivedCounter="1.">
            <t indent="0" pn="section-5.3-2.1.1">認証されたデータ構造のコンテキストを識別するためのコンテキストテキスト文字列です。コンテキストテキスト文字列は次のとおりです：</t>
            <ul empty="true" bare="false" indent="3" spacing="normal" pn="section-5.3-2.1.2">
              <li pn="section-5.3-2.1.2.1">COSE_Encrypt0データ構造のコンテンツ暗号化のための「Encrypt0」。</li>
              <li pn="section-5.3-2.1.2.2">COSE_Encryptデータ構造の最初のレイヤー（つまり、コンテンツの暗号化）のための「Encrypt」。</li>
              <li pn="section-5.3-2.1.2.3">COSE_Encryptデータ構造に配置するための受信者エンコーディングのための「Enc_Recipient」。</li>
              <li pn="section-5.3-2.1.2.4">MAC付きメッセージ構造に配置するための受信者エンコーディングのための「Mac_Recipient」。</li>
              <li pn="section-5.3-2.1.2.5">受信者構造に配置するための受信者エンコーディングのための「Rec_Recipient」。</li>
            </ul>
          </li>
          <li pn="section-5.3-2.2" derivedCounter="2.">本文構造から保護された属性は、bstr型でエンコードされます。保護された属性がない場合、長さゼロのバイト文字列が使用されます。</li>
          <li pn="section-5.3-2.3" derivedCounter="3.">アプリケーションから提供される外部データは、bstr型でエンコードされます。このフィールドが提供されていない場合、ゼロ長のバイト文字列にデフォルトで設定されます。（このフィールドの作成に関するアプリケーションガイドラインについては、<xref target="Extern_AAD" format="default" sectionFormat="of" derivedContent="Section 4.3"/>を参照してください。）</li>
        </ol>
        <t indent="0" pn="section-5.3-3">上記のテキストを記述するCDDLフラグメントは次の通りです：</t>
        <sourcecode type="cddl" markers="false" pn="section-5.3-4">
Enc_structure = [
    context : "Encrypt" / "Encrypt0" / "Enc_Recipient" /
        "Mac_Recipient" / "Rec_Recipient",
    protected : empty_or_serialized_map,
    external_aad : bstr
]
</sourcecode>
        <t indent="0" pn="section-5.3-5">メッセージを暗号化する方法：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-5.3-6">
          <li pn="section-5.3-6.1" derivedCounter="1.">適切なフィールドでEnc_structureを作成して、それを埋めます。</li>
          <li pn="section-5.3-6.2" derivedCounter="2.">
            <bcp14>Enc_structure</bcp14>をバイト文字列（追加認証データ（AAD））にエンコードし、<xref target="CBOR-Canonical" format="default" sectionFormat="of" derivedContent="Section 9"/> で説明されているエンコーディングを使用してください。</li>
          <li pn="section-5.3-6.3" derivedCounter="3.">
            <t indent="0" pn="section-5.3-6.3.1">暗号化鍵（K）を決定します。このステップは、使用されている受信者のアルゴリズムのクラスに依存します。次の場合について：
            </t>
            <dl newline="false" indent="3" spacing="normal" pn="section-5.3-6.3.2">
              <dt pn="section-5.3-6.3.2.1">受信者なし：</dt>
              <dd pn="section-5.3-6.3.2.2">使用される鍵は、現在のレイヤーのアルゴリズムと鍵によって決定されます。例えば、キーラップキー（<xref target="key_wrap_algs" format="default" sectionFormat="of" derivedContent="セクション 8.5.2"/>）や事前共有の秘密です。 </dd>
              <dt pn="section-5.3-6.3.2.3">直接暗号化および直接鍵合意：</dt>
              <dd pn="section-5.3-6.3.2.4">
  鍵は、受信者構造内の鍵とアルゴリズムによって決定されます。使用される暗号化アルゴリズムと鍵のサイズは、受信者のために使用されるKDFの入力です。
  （直接の場合、KDFは同一演算と考えることができます。）
  これらのアルゴリズムの例は、<xref target="RFC9053" section="6.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-6.1" derivedContent="RFC9053"/>および<xref target="RFC9053" section="6.3" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-6.3" derivedContent="RFC9053"/>のセクションで見つけることができます。
</dd>
              <dt pn="section-5.3-6.3.2.5">その他：</dt>
              <dd pn="section-5.3-6.3.2.6">鍵はランダムに生成されます。  </dd>
            </dl>
          </li>
          <li pn="section-5.3-6.4" derivedCounter="4.">暗号化キーK、平文P、およびAADで暗号化アルゴリズムを呼び出します。構造体の「ciphertext」フィールドに返された暗号文を格納します。</li>
          <li pn="section-5.3-6.5" derivedCounter="5.">メッセージの受信者が非直接アルゴリズムを使用している場合、暗号化キーKを平文として、その受信者のために暗号化アルゴリズムを再帰的に実行してください。</li>
        </ol>
        <t indent="0" pn="section-5.3-7">メッセージを復号化する方法：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-5.3-8">
          <li pn="section-5.3-8.1" derivedCounter="1.">適切なフィールドでEnc_structureを作成し、それを埋める。</li>
          <li pn="section-5.3-8.2" derivedCounter="2.">
            AADとして、<xref target="CBOR-Canonical" format="default" sectionFormat="of" derivedContent="Section 9"/>で記述されたエンコーディングを使用して、<bcp14>Enc_structure</bcp14>をバイト文字列にエンコードします。</li>
          <li pn="section-5.3-8.3" derivedCounter="3.">
            <t indent="0" pn="section-5.3-8.3.1">暗号化の鍵を決定します。このステップは受取人アルゴリズムのクラスに依存しています。対象が以下の場合:
            </t>
            <dl newline="false" indent="3" spacing="normal" pn="section-5.3-8.3.2">
              <dt pn="section-5.3-8.3.2.1">受取人がいない場合:</dt>
              <dd pn="section-5.3-8.3.2.2">使用する鍵は、現在のレイヤーのアルゴリズムと鍵によって決定されます。例として、キーラップキー（<xref target="key_wrap_algs" format="default" sectionFormat="of" derivedContent="セクション8.5.2"/>）や事前共有された秘密などがあります。</dd>
              <dt pn="section-5.3-8.3.2.3">直接暗号化および直接鍵合意の場合:</dt>
              <dd pn="section-5.3-8.3.2.4">
鍵は、受取人構造内の鍵とアルゴリズムによって決定されます。
使用する暗号化アルゴリズムと鍵のサイズは、受取人のために使用されるKDFの入力です。
（ダイレクトの場合、KDFは同一演算と考えることができます。）
</dd>
              <dt pn="section-5.3-8.3.2.5">その他の場合:</dt>
              <dd pn="section-5.3-8.3.2.6">鍵は、受取人構造の1つをデコードおよび復号することによって決定されます。</dd>
            </dl>
          </li>
          <li pn="section-5.3-8.4" derivedCounter="4.">K (使用する復号鍵)、C (暗号文)、および AAD で復号アルゴリズムを呼び出します。</li>
        </ol>
      </section>
      <section anchor="encryption-algorithm-for-ae-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-5.4">
        <name slugifiedName="name-how-to-encrypt-and-decrypt-f">AEアルゴリズムの暗号化と復号化の方法</name>
        <t indent="0" pn="section-5.4-1">メッセージを暗号化する方法：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-5.4-2">
          <li pn="section-5.4-2.1" derivedCounter="1.">「protected」フィールドがゼロ長のバイト文字列であることを確認してください。</li>
          <li pn="section-5.4-2.2" derivedCounter="2.">この操作に対して外部から追加の認証データが提供されていないことを確認してください。</li>
          <li pn="section-5.4-2.3" derivedCounter="3.">
            <t indent="0" pn="section-5.4-2.3.1">暗号化キーを決定します。このステップは使用されている受信者アルゴリズムのクラスに依存します。次の場合について：
</t>
            <dl newline="false" indent="3" spacing="normal" pn="section-5.4-2.3.2">
              <dt pn="section-5.4-2.3.2.1">受信者がない場合：</dt>
              <dd pn="section-5.4-2.3.2.2">使用されるキーは、現在のレイヤーでのアルゴリズムとキーによって決定されます。キーラップキー（<xref target="key_wrap_algs" format="default" sectionFormat="of" derivedContent="Section  8.5.2"/>）や共有シークレットが例です。</dd>
              <dt pn="section-5.4-2.3.2.3">直接暗号化および直接鍵合意の場合：</dt>
              <dd pn="section-5.4-2.3.2.4">キーは、受信者構造のキーとアルゴリズムによって決定されます。使用される暗号化アルゴリズムとキーのサイズは、受信者向けに使用されるKDF（鍵導出関数）の入力となります。直接の場合、KDFは同一操作と考えることができます。これらのアルゴリズムの例は、<xref target="RFC9053" section="6.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-6.1" derivedContent="RFC9053"/>および<xref target="RFC9053" section="6.3" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-6.3" derivedContent="RFC9053"/>の<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>に記載されています。</dd>
              <dt pn="section-5.4-2.3.2.5">その他：</dt>
              <dd pn="section-5.4-2.3.2.6">キーはランダムに生成されます。</dd>
            </dl>
          </li>
          <li pn="section-5.4-2.4" derivedCounter="4.">暗号化アルゴリズムを呼び出し、K（使用する暗号化キー）とP（平文）を渡します。返された暗号文を構造体の「暗号文」フィールドに配置します。</li>
          <li pn="section-5.4-2.5" derivedCounter="5.">非ダイレクトアルゴリズムを使用するメッセージの受信者に対しては、平文として暗号化キーKを使用して、その受信者のために再帰的に暗号化アルゴリズムを実行してください。</li>
        </ol>
        <t indent="0" pn="section-5.4-3">メッセージを復号化する方法：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-5.4-4">
          <li pn="section-5.4-4.1" derivedCounter="1.">「protected」フィールドがゼロの長さのバイト列であることを確認してください。</li>
          <li pn="section-5.4-4.2" derivedCounter="2.">この操作に対して、外部からの追加の認証データが供給されていないことを確認してください。</li>
          <li pn="section-5.4-4.3" derivedCounter="3.">
            <t indent="0" pn="section-5.4-4.3.1">復号キーを決定します。このステップは使用されている受信者アルゴリズムのクラスに依存します。具体的には以下のとおりです：
            </t>
            <dl newline="false" indent="3" spacing="normal" pn="section-5.4-4.3.2">
              <dt pn="section-5.4-4.3.2.1">受信者がいない場合：</dt>
              <dd pn="section-5.4-4.3.2.2">使用するキーは、現在の層のアルゴリズムとキーによって決定されます。例として、キーラップキー（<xref target="key_wrap_algs" format="default" sectionFormat="of" derivedContent="Section 8.5.2"/>）や事前共有キーがあります。</dd>
              <dt pn="section-5.4-4.3.2.3">直接暗号化と直接鍵合意の場合：</dt>
              <dd pn="section-5.4-4.3.2.4">キーは、受信者構造のキーとアルゴリズムによって決定されます。暗号化アルゴリズムおよび使用するキーのサイズは、受信者用のKDF（派生鍵導出関数）の入力です。（直接鍵合意の場合、KDFは恒等演算と考えることができます。）
これらのアルゴリズムの例は、<xref target="RFC9053" section="6.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-6.1" derivedContent="RFC9053"/>および<xref target="RFC9053" section="6.3" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-6.3" derivedContent="RFC9053"/>の<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>で見つけることができます。</dd>
              <dt pn="section-5.4-4.3.2.5">その他の場合：</dt>
              <dd pn="section-5.4-4.3.2.6">キーは、受信者構造の1つをデコードおよび復号化することによって決定されます。</dd>
            </dl>
          </li>
          <li pn="section-5.4-4.4" derivedCounter="4.">K（使用する復号鍵）とC（暗号文）を用いて復号化アルゴリズムを呼び出します。</li>
        </ol>
      </section>
    </section>
    <section anchor="mac-objects" numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-mac-objects">MACオブジェクト</name>
      <t indent="0" pn="section-6-1">COSEは2つの異なるMAC構造をサポートしています。COSE_Mac0は、使用するキーが暗黙にわかっているため、受信者の構造が必要ない場合に使用されます。COSE_Macは、その他のすべての場合に使用されます。これには、複数の受信者が必要な要件、キーが不明な場合、または直接以外の受信者アルゴリズムが含まれます。</t>
      <t indent="0" pn="section-6-2">このセクションでは、COSEにおけるMAC認証の構造と方法について説明します。このドキュメントでは、暗号化に許可されているすべての受信者アルゴリズムの同じクラスの使用が可能です。</t>
      <t indent="0" pn="section-6-3">MAC（メッセージ認証符号）操作は、2つのモードで使用することができます。最初のモードは、MACが計算されてからコンテンツが変更されていないことを確認するためのものです。この目的のために、受信者アルゴリズムの任意のクラスを使用できます。2番目のモードは、MACが計算されてからコンテンツが変更されていないだけでなく、受信者アルゴリズムを使用して誰が送信したかを確認するためのものです。このようなサポートを提供する受信者アルゴリズムのクラスとしては、事前共有の秘密を使用するものや、Static-Static（SS）鍵合意（キーラップステップなし）を行うものがあります。これらの場合、メッセージMACを作成して送信したエンティティを検証することができます。（送信者の知識は、2者のみが関与しており、自分自身にメッセージを送信していない場合を前提としています。）MACメッセージ構造の両方で、発信元の特性を取得することができます。</t>
      <section anchor="Mac_n" numbered="true" removeInRFC="false" toc="include" pn="section-6.1">
        <name slugifiedName="name-maced-message-with-recipien">受信者付きMACメッセージ</name>
        <t indent="0" pn="section-6.1-1">複数の受信者のMAC付きメッセージでは、2つの構造を使用します。このセクションで定義されているCOSE_Mac構造は、本体を運ぶために使用され、COSE_recipient構造（<xref target="EnvelopedData" format="default" sectionFormat="of" derivedContent="Section 5.1"/>で定義されています）は、MAC計算に使用されるキーを保持します。MAC付きメッセージの例は<xref target="MacExamples" format="default" sectionFormat="of" derivedContent="Appendix C.5"/>にあります。</t>
        <t indent="0" pn="section-6.1-2">MAC構造は、使用される文脈に応じて、タグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Mac構造は、CBORタグ97によって識別されます。これを表すCDDLフラグメントは次のようです:</t>
        <sourcecode type="cddl" markers="false" pn="section-6.1-3">
COSE_Mac_Tagged = #6.97(COSE_Mac)
</sourcecode>
        <t indent="0" pn="section-6.1-4">COSE_Mac構造体は、CBOR配列です。配列のフィールドは、順番に次の通りです：</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-6.1-5">
          <dt pn="section-6.1-5.1">protected:</dt>
          <dd pn="section-6.1-5.2">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-6.1-5.3">unprotected:</dt>
          <dd pn="section-6.1-5.4">これは、<xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>で説明されている通りです。</dd>
          <dt pn="section-6.1-5.5">payload:</dt>
          <dd pn="section-6.1-5.6">このフィールドには、MAC化されるべきシリアライズされたコンテンツが含まれています。ペイロードがメッセージに存在しない場合、アプリケーションはペイロードを別途提供する必要があります。ペイロードはbstrにラップされて、変更なしで転送されることを保証します。ペイロードが別途転送される場合（つまり、分離されたコンテンツ）、この位置にはnilのCBOR値が配置され、変更なしで転送されることをアプリケーションが保証する責任があります。</dd>
          <dt pn="section-6.1-5.7">tag:</dt>
          <dd pn="section-6.1-5.8">このフィールドにはMAC値が含まれています。</dd>
          <dt pn="section-6.1-5.9">recipients:</dt>
          <dd pn="section-6.1-5.10">これは、<xref target="EnvelopedData" format="default" sectionFormat="of" derivedContent="Section 5.1"/>で説明されている通りです。</dd>
        </dl>
        <t indent="0" pn="section-6.1-6">上記のテキストに対応するCOSE_Mac用のCDDLフラグメントは次のとおりです。</t>
        <sourcecode type="cddl" markers="false" pn="section-6.1-7">
COSE_Mac = [
   Headers,
   payload : bstr / nil,
   tag : bstr,
   recipients : [+COSE_recipient]
]
</sourcecode>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-6.2">
        <name slugifiedName="name-maced-messages-with-implici">MACed Messages with Implicit Key</name>
        <t indent="0" pn="section-6.2-1">このセクションでは、受信者が暗黙的にわかっている場合にMAC認証を行う際に使用される構造と方法について説明します。</t>
        <t indent="0" pn="section-6.2-2">以下は、このセクションで定義されたCOSE_Mac0構造を使用して本文を運ぶMAC付きメッセージです。暗黙の鍵を持つMAC付きメッセージの例は、<xref target="Mac0Examples" format="default" sectionFormat="of" derivedContent="Appendix C.6"/>に記載されています。</t>
        <t indent="0" pn="section-6.2-3">MAC構造体は、使用されるコンテキストに応じて、タグの付いた形式またはタグのない形式でエンコードされることがあります。タグ付きのCOSE_Mac0構造体は、CBORタグ17で識別されます。これを表すCDDLフラグメントは次のとおりです：</t>
        <sourcecode type="cddl" markers="false" pn="section-6.2-4">
COSE_Mac0_Tagged = #6.17(COSE_Mac0)
</sourcecode>
        <t indent="0" pn="section-6.2-5">COSE_Mac0構造体はCBOR配列です。配列のフィールドは、順番に次のとおりです：</t>
        <dl newline="false" indent="3" spacing="normal" pn="section-6.2-6">
          <dt pn="section-6.2-6.1">protected:</dt>
          <dd pn="section-6.2-6.2">This is as described in <xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>.</dd>
          <dt pn="section-6.2-6.3">unprotected:</dt>
          <dd pn="section-6.2-6.4">This is as described in <xref target="header-parameters" format="default" sectionFormat="of" derivedContent="Section 3"/>.</dd>
          <dt pn="section-6.2-6.5">payload:</dt>
          <dd pn="section-6.2-6.6">This is as described in <xref target="Mac_n" format="default" sectionFormat="of" derivedContent="Section 6.1"/>.</dd>
          <dt pn="section-6.2-6.7">tag:</dt>
          <dd pn="section-6.2-6.8">This field contains the MAC value.</dd>
        </dl>
        <t indent="0" pn="section-6.2-7">上記のテキストに対応するCDDLフラグメントは次のとおりです：</t>
        <sourcecode type="cddl" markers="false" pn="section-6.2-8">
COSE_Mac0 = [
   Headers,
   payload : bstr / nil,
   tag : bstr,
]
</sourcecode>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-6.3">
        <name slugifiedName="name-how-to-compute-and-verify-a">How to Compute and Verify a MAC</name>
        <t indent="0" pn="section-6.3-1">データを認証するための一貫したエンコーディングを得るために、MAC_structureは正規形を作成するために使用されます。MAC_structureはCBOR配列です。MAC_structureのフィールドは、順番に以下の通りです：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-6.3-2">
          <li pn="section-6.3-2.1" derivedCounter="1.">符号化されている構造を識別するコンテキストテキスト文字列。COSE_Mac構造の場合、このコンテキストテキスト文字列は「MAC」です。COSE_Mac0構造の場合、このコンテキストテキスト文字列は「MAC0」です。</li>
          <li pn="section-6.3-2.2" derivedCounter="2.">本文構造から保護された属性。保護された属性がない場合、長さゼロのbstrが使用されます。</li>
          <li pn="section-6.3-2.3" derivedCounter="3.">アプリケーションから外部に供給されるデータで、bstr型でエンコードされます。このフィールドが提供されていない場合、長さ0のバイト文字列にデフォルトで設定されます。（このフィールドの構築に関するアプリケーションのガイダンスについては、<xref target="Extern_AAD" format="default" sectionFormat="of" derivedContent="Section 4.3"/>を参照してください。）</li>
          <li pn="section-6.3-2.4" derivedCounter="4.">
            <bcp14>MUST</bcp14>：運ばれる方法に関係なく、bstr型でエンコードされたMAC化するペイロード。
<bcp14>SHOULD</bcp14>：使用されるbstr型は、どのように輸送されているかに関係なく、完全なペイロードです。</li>
        </ol>
        <t indent="0" pn="section-6.3-3">上記のテキストに対応するCDDLフラグメントは次のとおりです：</t>
        <sourcecode type="cddl" markers="false" pn="section-6.3-4">
MAC_structure = [
     context : "MAC" / "MAC0",
     protected : empty_or_serialized_map,
     external_aad : bstr,
     payload : bstr
]
</sourcecode>
        <t indent="0" pn="section-6.3-5">MACを計算する手順は次のとおりです：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-6.3-6">
          <li pn="section-6.3-6.1" derivedCounter="1.">適切なフィールドでMAC_structureを作成し、それを埋めます。</li>
          <li pn="section-6.3-6.2" derivedCounter="2.">「<bcp14>CBOR-Canonical</bcp14>」のセクション9に記載されているエンコードを使用して、MAC_structureをバイト文字列にエンコードし、値ToBeMacedを作成します。</li>
          <li pn="section-6.3-6.3" derivedCounter="3.">
            <bcp14>キー（使用するキー）</bcp14>、<bcp14>アルゴリズム（MAC処理をするためのアルゴリズム）</bcp14>、および<bcp14>MACを計算する値（ToBeMaced）</bcp14>を渡して、MAC作成アルゴリズムを呼び出します。</li>
          <li pn="section-6.3-6.4" derivedCounter="4.">COSE_MacまたはCOSE_Mac0構造体の「tag」フィールドに、結果のMACを配置します。</li>
          <li pn="section-6.3-6.5" derivedCounter="5.">COSE_Mac構造に対して、メッセージの各受信者のMACキーを暗号化してエンコードしてください。</li>
        </ol>
        <t indent="0" pn="section-6.3-7">MACの検証手順は次のとおりです：</t>
        <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-6.3-8">
          <li pn="section-6.3-8.1" derivedCounter="1.">適切なフィールドでMAC_structureを作成し、それを満たすように設定してください。</li>
          <li pn="section-6.3-8.2" derivedCounter="2.">MAC構造をエンコードして、<xref target="CBOR-Canonical" format="default" sectionFormat="of" derivedContent="Section 9"/>で説明されているエンコーディングを使用して、バイト文字列ToBeMacedを作成してください。</li>
          <li pn="section-6.3-8.3" derivedCounter="3.">COSE_Mac構造については、受信者構造のうちの1つをデコードし、復号化して暗号鍵を取得します。</li>
          <li pn="section-6.3-8.4" derivedCounter="4.">MACの作成アルゴリズムを呼び出し、K（使用する鍵）、alg（MACを計算するアルゴリズム）、およびToBeMaced（MACを計算する値）を渡します。</li>
          <li pn="section-6.3-8.5" derivedCounter="5.">COSE_MacまたはCOSE_Mac0構造体の「tag」フィールドとMACの値を比較します。</li>
        </ol>
      </section>
    </section>
    <section anchor="key-structure" numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-key-objects">キーオブジェクト</name>
      <t indent="0" pn="section-7-1">COSEキー構造はCBORマップに基づいて構築されます。COSEキーに現れる可能性のある一般的なパラメーターのセットは、IANAの"COSE Key Common Parameters"レジストリ<xref target="COSE.KeyParameters" format="default" sectionFormat="of" derivedContent="COSE.KeyParameters"/>（<xref target="cose-key-map-registry" format="default" sectionFormat="of" derivedContent="Section 11.2"/>参照）で見つけることができます。特定のキータイプに定義された追加のパラメーターは、IANAの"COSE Key Type Parameters"レジストリ<xref target="COSE.KeyTypes" format="default" sectionFormat="of" derivedContent="COSE.KeyTypes"/>で見つけることができます。</t>
      <t indent="0" pn="section-7-2">COSEキー・セットは、その基本的な型としてCBOR配列オブジェクトを使用します。配列要素の値はCOSEキーです。COSEキー・セットは、配列内に少なくとも1つの要素持つ<bcp14>必要があります（MUST）</bcp14>。COSEキー・セットの例は、<xref target="COSE_KEYS" format="default" sectionFormat="of" derivedContent="付録C.7"/>にあります。</t>
      <t indent="0" pn="section-7-3">COSEキーのセット内の各要素は、独立して処理される<bcp14>必要があります（MUST）</bcp14>。COSEキーのセット内の1つの要素が異常であるか、またはアプリケーションによって理解されないキーを使用している場合、そのキーは無視され、他のキーは通常通り処理されます。</t>
      <t indent="0" pn="section-7-4">"kty"要素は、COSE_Keyマップに必須の要素です。</t>
      <t indent="0" pn="section-7-5">COSE_KeyおよびCOSE_KeySetを記述するCDDL文法は次の通りです。</t>
      <sourcecode type="cddl" markers="false" pn="section-7-6">
COSE_Key = {
    1 =&gt; tstr / int,          ; kty
    ? 2 =&gt; bstr,              ; kid
    ? 3 =&gt; tstr / int,        ; alg
    ? 4 =&gt; [+ (tstr / int) ], ; key_ops
    ? 5 =&gt; bstr,              ; Base IV
    * label =&gt; values
}

COSE_KeySet = [+COSE_Key]
</sourcecode>
      <section anchor="COSE_KEY_KEYS" numbered="true" removeInRFC="false" toc="include" pn="section-7.1">
        <name slugifiedName="name-cose-key-common-parameters">COSEキー共通パラメーター</name>
        <t indent="0" pn="section-7.1-1">この文書は、COSEキー オブジェクトの一連の共通パラメーターを定義します。このセクションで定義されているパラメーターの概要については、<xref target="x-table-key-labels" format="default" sectionFormat="of" derivedContent="Table 4"/> を参照してください。また、特定のキータイプに対して定義されているパラメーターもあります。キータイプ固有のパラメーターについては、<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/> を参照してください。</t>
        <table anchor="x-table-key-labels" align="center" pn="table-4">
          <name slugifiedName="name-key-map-labels">キーマップラベル</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Label</th>
              <th align="left" colspan="1" rowspan="1">CBOR Type</th>
              <th align="left" colspan="1" rowspan="1">Value Registry</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">kty</td>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">tstr / int</td>
              <td align="left" colspan="1" rowspan="1">COSE Key Types</td>
              <td align="left" colspan="1" rowspan="1">キータイプの識別</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">kid</td>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="left" colspan="1" rowspan="1">bstr</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">キー識別値 -- メッセージ内の"kid"と一致</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">alg</td>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="left" colspan="1" rowspan="1">tstr / int</td>
              <td align="left" colspan="1" rowspan="1">COSE Algorithms</td>
              <td align="left" colspan="1" rowspan="1">このアルゴリズムへのキー使用制限</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">key_ops</td>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="left" colspan="1" rowspan="1">[+ (tstr/int)]</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">許可される操作のセットを制限する</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">Base IV</td>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="left" colspan="1" rowspan="1">bstr</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">部分的なIVとXORを行うための基本IV</td>
            </tr>
          </tbody>
        </table>
        <dl newline="false" indent="3" spacing="normal" pn="section-7.1-3">
          <dt pn="section-7.1-3.1">kty:</dt>
          <dd pn="section-7.1-3.2">このパラメーターは、この構造のキーのファミリーを識別し、したがって、見つけるべきキータイプ固有のパラメーターのセットを識別するために使用されます。このドキュメントで定義されている値のセットは、<xref target="COSE.KeyTypes" format="default" sectionFormat="of" derivedContent="COSE.KeyTypes"/>で見つけることができます。このパラメーターはキーオブジェクトに存在<bcp14>しなければなりません（MUST）</bcp14>。実装は、キータイプが処理されているアルゴリズムに適していることを確認<bcp14>しなければなりません（MUST）</bcp14>。キータイプは信頼決定プロセスの一部として含まれている<bcp14>必要があります（MUST）</bcp14>。</dd>
          <dt pn="section-7.1-3.3">alg:</dt>
          <dd pn="section-7.1-3.4">このパラメーターは、キーと一緒に使用されるアルゴリズムを制限するために使用されます。このパラメーターがキー構造に存在する場合、アプリケーションは<bcp14>必ず</bcp14>このアルゴリズムがキーが使用されているアルゴリズムと一致することを確認しなければなりません。アルゴリズムが一致しない場合、このキーオブジェクトは暗号化操作を実行するために<bcp14>使用してはならない</bcp14>。同じキーが異なるキー構造にあり、異なるアルゴリズムが指定されているか、アルゴリズムが指定されていない場合がありますが、これはセキュリティー上の良くない実践と考えられます。</dd>
          <dt pn="section-7.1-3.5">kid:</dt>
          <dd pn="section-7.1-3.6">このパラメーターは、キーの識別子を提供するために使用されます。識別子は構造化されておらず、ユーザーが提供したバイト文字列から公開キーの部分に対して計算された値まで何でも可能です。このフィールドは、メッセージ内の"kid"パラメーターと一致させるために、チェックする必要があるキーセットを絞り込むために意図されています。
          識別子の値は一意の値ではなく、他のキーオブジェクト、さらには異なるキーでも発生することがあります。
          </dd>
          <dt pn="section-7.1-3.7">key_ops:</dt>
          <dd pn="section-7.1-3.8">This parameter is defined to restrict the set of operations that a key is to be used for.  The value of the field is an array of values from <xref target="x-table-key-ops" format="default" sectionFormat="of" derivedContent="Table 5"/>.  Algorithms define the values of key ops that are permitted to appear and are required for specific operations.  The set of values matches that in <xref target="RFC7517" format="default" sectionFormat="of" derivedContent="RFC7517"/> and <xref target="W3C.WebCrypto" format="default" sectionFormat="of" derivedContent="W3C.WebCrypto"/>.  </dd>
          <dt pn="section-7.1-3.9">Base IV:</dt>
          <dd pn="section-7.1-3.10">
            <t indent="0" pn="section-7.1-3.10.1">このパラメーターは、IVの基本部分を運ぶように定義されています。これは、<xref target="cose-headers" format="default" sectionFormat="of" derivedContent="Section 3.1"/>で定義されたPartial IVヘッダーパラメーターと共に使用することを目的としています。このフィールドは、Base IVをキーと関連付ける能力を提供し、それはPartial IVによってメッセージごとに変更されます。</t>
            <t indent="0" pn="section-7.1-3.10.2">アプリケーションでBase IVを使用する際には、非常に注意が必要です。同じIVが2回使用されると、多くの暗号化アルゴリズムはセキュリティーを失います。</t>
            <t indent="0" pn="section-7.1-3.10.3">異なる送信者ごとにキーが派生される場合、同じ基底IVから始まることがこの条件を満たす可能性が高いです。<bcp14>もし同じキーが複数の送信者で使用される場合、アプリケーションは送信者間でIVスペースを分割する方法を提供する必要があります。</bcp14>これは、異なる基点から始めるか、または異なる部分IVから始めて再鍵交換前に送信されるメッセージの数を制限することで実現できます。</t>
          </dd>
        </dl>
        <table anchor="x-table-key-ops" align="center" pn="table-5">
          <name slugifiedName="name-key-operation-values">キー操作値</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">名前</th>
              <th align="left" colspan="1" rowspan="1">値</th>
              <th align="left" colspan="1" rowspan="1">説明</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">sign</td>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">キーは署名を作成するために使用されます。プライベートキーフィールドが必要です。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">verify</td>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="left" colspan="1" rowspan="1">キーは署名の検証に使用されます。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">encrypt</td>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="left" colspan="1" rowspan="1">キーはキートランスポート暗号化に使用されます。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">decrypt</td>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="left" colspan="1" rowspan="1">キーはキートランスポート復号化に使用されます。プライベートキーフィールドが必要です。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">wrap key</td>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="left" colspan="1" rowspan="1">キーはキーラップ暗号化に使用されます。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">unwrap key</td>
              <td align="left" colspan="1" rowspan="1">6</td>
              <td align="left" colspan="1" rowspan="1">キーはキーラップ復号化に使用されます。プライベートキーフィールドが必要です。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">derive key</td>
              <td align="left" colspan="1" rowspan="1">7</td>
              <td align="left" colspan="1" rowspan="1">キーはキーの導出に使用されます。プライベートキーフィールドが必要です。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">derive bits</td>
              <td align="left" colspan="1" rowspan="1">8</td>
              <td align="left" colspan="1" rowspan="1">キーは、キーとして使用されないビットを導出するために使用されます。プライベートキーフィールドが必要です。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">MAC create</td>
              <td align="left" colspan="1" rowspan="1">9</td>
              <td align="left" colspan="1" rowspan="1">キーはMACの作成に使用されます。</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">MAC verify</td>
              <td align="left" colspan="1" rowspan="1">10</td>
              <td align="left" colspan="1" rowspan="1">キーはMACの検証に使用されます。</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-8">
      <name slugifiedName="name-taxonomy-of-algorithms-used">Taxonomy of Algorithms Used by COSE</name>
      <t indent="0" pn="section-8-1">このセクションでは、COSEで使用できるさまざまなアルゴリズムのタイプの分類が示されています。この分類は完全なものではないと考えるべきです。この分類に適合しない新しいアルゴリズムが作成されるでしょう。</t>
      <section anchor="SigAlgs" numbered="true" removeInRFC="false" toc="include" pn="section-8.1">
        <name slugifiedName="name-signature-algorithms">Signature Algorithms</name>
        <t indent="0" pn="section-8.1-1">署名アルゴリズムは、データの生成とデータの完全性のサービスを提供します。 データ生成は、データに署名を行った人物を推測する能力を提供します。 データの完全性は、データが署名された後に変更されていないことを検証する能力を提供します。</t>
        <t indent="0" pn="section-8.1-2">二つの一般的な署名アルゴリズムスキームが存在します。最初のスキームは、付録を持つ署名です。このスキームでは、メッセージの内容が処理され、署名が生成されます。この署名は付録と呼ばれます。このスキームは、ECDSAやRSA確率的署名スキーム（RSASSA-PSS）などのアルゴリズムで使用されます。（実際、RSASSA-PSSのSSAは「付録を持つ署名スキーム」を表しています。）</t>
        <t indent="0" pn="section-8.1-3">このスキームの署名関数は次の通りです：</t>
        <sourcecode type="pseudocode" markers="false" pn="section-8.1-4">
signature = Sign(message content, key)

valid = Verification(message content, key, signature)
</sourcecode>
        <t indent="0" pn="section-8.1-5">2番目の方式は、メッセージリカバリ付きの署名です。このようなアルゴリズムの例として、<xi:xref target="PVSig" format="default" sectionFormat="of" derivedContent="PVSig"/>があります。この方式では、メッセージ内容は処理されますが、その一部が署名に含まれます。メッセージ内容のバイトを署名に移動することにより、サイズの小さな署名付きメッセージが作成できます。署名サイズは依然として大きい場合がありますが、メッセージ内容は縮小されます。これは、これらのアルゴリズムを実装するシステムおよびそれらを使用するアプリケーションに影響を与えます。最初の影響は、メッセージの内容が署名が検証されるまで完全に利用できないことです。そのポイントまで、署名の内部に含まれるメッセージの一部は復旧不可能です。2番目の影響は、署名の強度のセキュリティー分析が、メッセージ内容の構造に非常に依存する可能性があることです。最後に、複数の署名がメッセージに適用される場合、すべての署名アルゴリズムは同じバイトのメッセージ内容を消費する必要があります。つまり、メッセージ内で署名付きメッセージリカバリと署名付き付録の方式を混在させることはサポートされていません。</t>
        <t indent="0" pn="section-8.1-6">このスキームの署名関数は次のとおりです：</t>
        <sourcecode type="pseudocode" markers="false" pn="section-8.1-7">
signature, message sent = Sign(message content, key)

valid, message content = Verification(message sent, key, signature)
</sourcecode>
        <t indent="0" pn="section-8.1-8">COSEには、メッセージの回復に関する署名アルゴリズムがまだ正式に定義されていません。この仕組みから生じる新たな制約があるため、既にいくつかの問題が特定されていますが、メッセージの回復署名アルゴリズムを統合する際には追加の問題が発生する可能性が非常に高いです。最初に定義されるアルゴリズムは、これらの問題についての決定を行う必要があり、それらの決定は今後定義される他のアルゴリズムにも拘束力を持つ可能性があります。</t>
        <t indent="0" pn="section-8.1-9">私たちは以下の用語を使用します:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.1-10">
          <dt pn="section-8.1-10.1">message content bytes:</dt>
          <dd pn="section-8.1-10.2">The byte string provided by the application to be signed.</dd>
          <dt pn="section-8.1-10.3">to-be-signed bytes:</dt>
          <dd pn="section-8.1-10.4">The byte string passed into the signature algorithm.</dd>
          <dt pn="section-8.1-10.5">recovered bytes:</dt>
          <dd pn="section-8.1-10.6">The bytes recovered during the signature verification process.</dd>
        </dl>
        <t indent="0" pn="section-8.1-11">すでに特定されている問題の一部は以下の通りです：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1-12">
          <li pn="section-8.1-12.1">署名前のバイトは、メッセージの内容のバイトとは異なります。これは、署名処理中に大きな署名前メッセージを構築するためです。回復したバイトの長さは、メッセージの内容の長さを超える場合がありますが、署名前のバイトの長さを超えることはありません。例えば、外部から提供されるデータに機密情報が含まれる場合、これはプライバシーに関する考慮事項につながる可能性があります。</li>
          <li pn="section-8.1-12.2">「復元されたバイトが署名対象のバイトと一致する場所を特定することに困難があるかもしれません。なぜなら、復元されたバイトにはメッセージ内容のバイトに含まれていないデータが含まれているからです。そのような場合、一つの選択肢としてパディングスキームを作成してそれを防ぐことが考えられます。」</li>
          <li pn="section-8.1-12.3">
            <bcp14>しなければならない</bcp14>メッセージ回復署名アルゴリズムには、署名されるバイトの終わりから回復されるバイトを取るものがすべてではありません。これは問題です、なぜならメッセージの内容バイトは署名されるバイトの終わりにあります。回復するバイトが署名されるバイトの始めから取られる場合、デフォルトではメッセージの内容バイトのいずれも回復されたバイトに含まれない可能性があります。この場合、対処するための1つのオプションは、回復されるバイトが署名されるバイトの終わりではなく始めから取られる場合に、署名されるデータを逆にすることです。</li>
        </ul>
        <t indent="0" pn="section-8.1-13">署名アルゴリズムはCOSE_SignatureとCOSE_Sign1の構造と共に使用されます。本文執筆時点では、COSEとの使用のために付録を持った署名のみが定義されていますが、有効なサイズの削減が可能となる署名-メッセージ回復アルゴリズムの使用に関して、非常に興味が示されています。</t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-8.2">
        <name slugifiedName="name-message-authentication-code">Message Authentication Code (MAC) Algorithms</name>
        <t indent="0" pn="section-8.2-1">メッセージ認証コード（MAC）はデータの認証と整合性保護を提供します。MACはデータの発信元を証明するためには使用できません（あるいは非常に制限されています）。例えば、MACは送信者の身元を第三者に証明するために使用することはできません。</t>
        <t indent="0" pn="section-8.2-2">MAC（メッセージ認証コード）は、署名と同様の方式を使用します。メッセージの内容が処理され、認証コードが生成されます。この認証コードは、しばしば「タグ」と呼ばれます。</t>
        <t indent="0" pn="section-8.2-3">MAC（メッセージ認証符号）の機能は、次のとおりです：</t>
        <sourcecode type="pseudocode" markers="false" pn="section-8.2-4">
tag = MAC_Create(message content, key)

valid = MAC_Verify(message content, key, tag)
</sourcecode>
        <t indent="0" pn="section-8.2-5">MACアルゴリズムは、ブロック暗号アルゴリズム（すなわち、AES-MAC）またはハッシュアルゴリズム（すなわち、ハッシュベースのメッセージ認証コード（HMAC））に基づいています。 <xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>は、これらの構築を使用したMACアルゴリズムを定義しています。</t>
        <t indent="0" pn="section-8.2-6">MACアルゴリズムは、COSE_MacおよびCOSE_Mac0構造体で使用されます。</t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-8.3">
        <name slugifiedName="name-content-encryption-algorith">Content Encryption Algorithms</name>
        <t indent="0" pn="section-8.3-1">コンテンツ暗号化アルゴリズムは、対称キーを使用して、潜在的に大きなデータブロックのデータ機密性を提供します。これらは、暗号化されたデータの整合性を提供しますが、送信者のアイデンティティを第三者に証明するために使用することはできません（例えば、使用することはできません）。データの発生源を提供する能力は、CEKの取得方法に関連しています。</t>
        <t indent="0" pn="section-8.3-2">COSEは、コンテンツおよび追加データの両方の認証をサポートする暗号化アルゴリズムのセットを制限します。暗号化プロセスは、認証値のある種類を生成しますが、その値はアルゴリズムの定義において明示的または暗黙的にすることができます。単純化のために、認証コードは通常、暗号文のストリームに追加されるように定義されます。暗号化関数は以下の通りです：</t>
        <sourcecode type="pseudocode" markers="false" pn="section-8.3-3">
ciphertext = Encrypt(message content, key, additional data)

valid, message content = Decrypt(ciphertext, key, additional data)
</sourcecode>
        <t indent="0" pn="section-8.3-4">ほとんどのAEADアルゴリズムは、復号が有効である場合にのみメッセージの内容を返すように論理的に定義されています。実装の多くはこの規則に従うでしょうが、すべての実装が必ずしも従うわけではありません。復号が検証されない場合、メッセージの内容を使用しては<bcp14>してはなりません（MUST NOT）</bcp14>。</t>
        <t indent="0" pn="section-8.3-5">これらのアルゴリズムは、COSE_EncryptおよびCOSE_Encrypt0で使用されます。</t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-8.4">
        <name slugifiedName="name-key-derivation-functions-kd">Key Derivation Functions (KDFs)</name>
        <t indent="0" pn="section-8.4-1">KDF（鍵導出関数）は、いくつかの秘密値を入力として別の値を生成するために使用されます。秘密値には3つの種類があります：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.4-2">
          <li pn="section-8.4-2.1">一様にランダムな秘密情報。これは、良好な乱数生成器によって作成される種類の秘密情報です。</li>
          <li pn="section-8.4-2.2">一様にランダムではない秘密。これは、鍵共有などの操作によって作成されるタイプの秘密です。</li>
          <li pn="section-8.4-2.3">ランダムでない秘密。これは、パスワードなどのために人々が生成するタイプの秘密です。</li>
        </ul>
        <t indent="0" pn="section-8.4-3">一般的なKDF（キーダービベレーション関数）は、最初のタイプの秘密とうまく機能します。第二のタイプの秘密についてもそれなりの結果を得ることができ、最後のタイプの秘密に対しては一般的にうまく機能しません。Argon2などの関数は、ランダムでない秘密に使用する必要があります。</t>
        <t indent="0" pn="section-8.4-4">同じKDFは、最初の2つの種類の秘密情報に異なる方法で対応するために設定できます。 <xref target="RFC9053" sectionFormat="of" section="5.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9053#section-5.1" derivedContent="RFC9053"/>で定義されたKDFは、そのような機能です。これは、HMACベースのExtract-and-Expand鍵派生関数（HKDF）を中心としたアルゴリズムのセットに反映されています。</t>
        <t indent="0" pn="section-8.4-5">KDFを使用する際には、コンテキスト情報という要素が含まれます。コンテキスト情報は、同じ秘密から異なる鍵情報を派生させるために使用されます。コンテキストベースの鍵材料の使用は、良いセキュリティーの実践と考えられています。</t>
      </section>
      <section anchor="key-management-algs" numbered="true" removeInRFC="false" toc="include" pn="section-8.5">
        <name slugifiedName="name-content-key-distribution-met">Content Key Distribution Methods</name>
        <t indent="0" pn="section-8.5-1">
        Content key distribution methods (recipient algorithms) can be defined into a number of different classes. 
        COSE has the ability to support many classes of recipient algorithms. 
        In this section, a number of classes are listed. For the recipient algorithm classes defined in <xref target="RFC7516" format="default" sectionFormat="of" derivedContent="RFC7516"/>, the same names are used. 
        Other specifications use different terms for the recipient algorithm classes or do not support some of the recipient algorithm classes.
        </t>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-8.5.1">
          <name slugifiedName="name-direct-encryption">Direct Encryption</name>
          <t indent="0" pn="section-8.5.1-1">直接暗号化アルゴリズムのDirect Encryptionクラスは、送信者と受信者の間で共有される秘密を、CEKとして直接または操作後に使用します。直接暗号化モードが使用される場合、メッセージで使用される<bcp14>しなければなりません（MUST）</bcp14>。</t>
          <t indent="0" pn="section-8.5.1-2">The COSE_Recipient structure for the recipient is organized as follows: </t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.5.1-3">
            <li pn="section-8.5.1-3.1">"<bcp14>MUST</bcp14> be a zero-length byte string unless it is used in the computation of the content key."

「"protected"フィールド<bcp14>は、</bcp14>コンテンツキーの計算に使用されない限り、ゼロ長のバイト文字列でなければなりません。」</li>
            <li pn="section-8.5.1-3.2">The "alg" header parameter <bcp14>MUST</bcp14> be present.  </li>
            <li pn="section-8.5.1-3.3">A header parameter identifying the shared secret <bcp14>SHOULD</bcp14> be present.  </li>
            <li pn="section-8.5.1-3.4">"ciphertext"フィールドは、ゼロ長のバイト列である<bcp14>しなければなりません（MUST）</bcp14>。</li>
            <li pn="section-8.5.1-3.5">"recipients" フィールド<bcp14>しなければなりません（MUST）</bcp14> は存在してはなりません。</li>
          </ul>
        </section>
        <section anchor="key_wrap_algs" numbered="true" removeInRFC="false" toc="include" pn="section-8.5.2">
          <name slugifiedName="name-key-wrap">Key Wrap</name>
          <t indent="0" pn="section-8.5.2-1">キーラップモードでは、CEK（Content Encryption Key）はランダムに生成され、そのキーは送信者と受信者の間で共有された秘密によって暗号化されます。COSEの現在定義されているすべてのキーラップアルゴリズムはAE（Authenticated Encryption）アルゴリズムです。キーラップモードは、システムがランダムキー生成の機能を持っている場合、直接暗号化よりも優れていると考えられています。なぜなら、共有キーは組織化された程度のデータではなく、実際に同じ内容を繰り返している可能性のあるランダムデータをラップするためです。キーラップの使用により、直接暗号化アルゴリズムによって提供される弱いデータの元の特定性が失われます。</t>
          <t indent="0" pn="section-8.5.2-2">受信者用のCOSE_Recipient構造体は、以下のように構成されます：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.5.2-3">
            <li pn="section-8.5.2-3.1">
              <bcp14>しなければなりません（MUST）</bcp14> キーウラップアルゴリズムがAEアルゴリズムの場合、"protected"フィールドはゼロ長のバイト文字列でなければなりません。</li>
            <li pn="section-8.5.2-3.2">「recipients（受信者）」フィールドは通常存在しませんが、使用することができます。アプリケーションは、サポートされていないアルゴリズムを使用して存在する「recipients（受信者）」フィールドを処理する<bcp14>しなければなりません（MUST）</bcp14>。特定の受信者の複合化に失敗することは、それに対処する許容される方法です。メッセージの処理に失敗することは、それに対処する許容される方法ではありません。</li>
            <li pn="section-8.5.2-3.3">平文を暗号化するデータは、通常は下位のレイヤー（通常はコンテンツレイヤー）からのキーです。</li>
            <li pn="section-8.5.2-3.4">最低限、「unprotected」フィールドは「alg」ヘッダーパラメーターを含み、共有シークレットを識別するヘッダーパラメーターを含んでいる<bcp14>しなければなりません（MUST）</bcp14>。</li>
          </ul>
        </section>
        <section anchor="KeyTransport" numbered="true" removeInRFC="false" toc="include" pn="section-8.5.3">
          <name slugifiedName="name-key-transport">Key Transport</name>
          <t indent="0" pn="section-8.5.3-1">鍵輸送モードは一部の標準では鍵暗号化モードと呼ばれています。鍵輸送モードは、鍵を保護するために対称暗号化アルゴリズムではなく非対称暗号化アルゴリズムを使用する点で鍵ラップモードと異なります。鍵輸送アルゴリズムのセットは、<xref target="RFC8230" format="default" sectionFormat="of" derivedContent="RFC8230"/>で定義されています。</t>
          <t indent="0" pn="section-8.5.3-2">キー輸送アルゴリズムを使用する場合、受信者のCOSE_Recipient構造は以下のように構成されます：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.5.3-3">
            <li pn="section-8.5.3-3.1">
              <bcp14>保護</bcp14>フィールドは、長さゼロのバイト文字列で<bcp14>しなければなりません（MUST）</bcp14>。</li>
            <li pn="section-8.5.3-3.2">暗号化される平文は、通常、下の階層（通常はコンテンツ層）からのキーです。</li>
            <li pn="section-8.5.3-3.3">少なくとも、「unprotected」フィールドには「alg」ヘッダーパラメーターが含まれていなければならず、「SHOULD」には非対称キーを識別するパラメーターが含まれるべきです。</li>
          </ul>
        </section>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-8.5.4">
          <name slugifiedName="name-direct-key-agreement">Direct Key Agreement</name>
          <t indent="0" pn="section-8.5.4-1">The Direct Key Agreement class of recipient algorithms uses a key agreement method to create a shared secret.  A KDF is then applied to the shared secret to derive a key to be used in protecting the data.  This key is normally used as a CEK or MAC key but could be used for other purposes if more than two layers are in use (see <xref target="three-layer" format="default" sectionFormat="of" derivedContent="Appendix B"/>).  </t>
          <t indent="0" pn="section-8.5.4-2">最も一般的に使用される鍵合意アルゴリズムはDiffie-Hellmanですが、他のバリアントも存在します。COSEはオンライン環境ではなく、ストア・アンド・フォワード環境に設計されているため、多くのDHのバリアントは使用できません。なぜなら、メッセージの受信者は動的な鍵素材を提供することができないからです。これの一つの副作用は、前方秘匿性（<xref target="RFC4949" format="default" sectionFormat="of" derivedContent="RFC4949"/>を参照）が実現できないことです。COSEオブジェクトの受信者には常に静的な鍵が使用されます。</t>
          <t indent="0" pn="section-8.5.4-3">サポートされるDHの2つのバリアントは次のとおりです：</t>
          <dl indent="3" newline="false" spacing="normal" pn="section-8.5.4-4">
            <dt pn="section-8.5.4-4.1">Ephemeral-Static (ES) DH:</dt>
            <dd pn="section-8.5.4-4.2">The sender of the message creates a one-time DH key and uses a static key for the recipient.  The use of the ephemeral sender key means that no additional random input is needed, as this is randomly generated for each message.</dd>
            <dt pn="section-8.5.4-4.3">Static-Static (SS) DH:</dt>
            <dd pn="section-8.5.4-4.4">A static key is used for both the sender and the recipient.  The use of static keys allows for the recipient to get a weak version of data origination for the message.  When Static-Static key agreement is used, then some piece of unique data for the KDF is required to ensure that a different key is created for each message.</dd>
          </dl>
          <t indent="0" pn="section-8.5.4-5">When direct key agreement mode is used, there <bcp14>MUST</bcp14> be only one recipient in the message.  This method creates the key directly, and that makes it difficult to mix with additional recipients.  If multiple recipients are needed, then the version with key wrap needs to be used.  </t>
          <t indent="0" pn="section-8.5.4-6">受信者のためのCOSE_Recipient構造は以下のように組織化されています：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.5.4-7">
            <li pn="section-8.5.4-7.1">最低限、ヘッダー<bcp14>はしなければなりません（MUST）</bcp14>、「alg」ヘッダー・パラメーターを含むことと、<bcp14>推奨されます（SHOULD）</bcp14>、受信者の非対称キーを識別するヘッダー・パラメーターを含むこと。</li>
            <li pn="section-8.5.4-7.2">The headers <bcp14>SHOULD</bcp14> identify the sender's key for the Static-Static versions and <bcp14>MUST</bcp14> contain the sender's ephemeral key for the ephemeral-static versions.  </li>
          </ul>
        </section>
        <section anchor="ECDH-Direct" numbered="true" removeInRFC="false" toc="include" pn="section-8.5.5">
          <name slugifiedName="name-key-agreement-with-key-wrap">Key Agreement with Key Wrap</name>
          <t indent="0" pn="section-8.5.5-1">キーラップを使用したキー合意は、ランダムに生成されたCEKを使用します。その後、CEKはキーラップアルゴリズムとキー合意アルゴリズムによって計算された共有秘密の鍵で暗号化されます。このための関数は次のとおりです:</t>
          <sourcecode type="pseudocode" markers="false" pn="section-8.5.5-2">
encryptedKey = KeyWrap(KDF(DH-Shared, context), CEK)
</sourcecode>
          <t indent="0" pn="section-8.5.5-3">受信者に対するCOSE_Recipient構造は、次のように組織されています:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.5.5-4">
            <li pn="section-8.5.5-4.1">「protected」フィールドは、KDF（鍵派生関数）コンテキスト構造にフィードされます。</li>
            <li pn="section-8.5.5-4.2">暗号化される平文は、通常、下位のレイヤー（通常はコンテンツレイヤー）からのキーです。</li>
            <li pn="section-8.5.5-4.3">"alg"ヘッダーパラメーターは、レイヤーに<bcp14>存在しなければなりません（MUST）</bcp14>。</li>
            <li pn="section-8.5.5-4.4">受信者の鍵を識別するヘッダーパラメーターは<bcp14>すべきです（SHOULD）</bcp14>存在している必要があります。送信者の鍵を識別するヘッダーパラメーターは<bcp14>すべきです（SHOULD）</bcp14>存在している必要があります。</li>
          </ul>
        </section>
      </section>
    </section>
    <section anchor="CBOR-Canonical" numbered="true" removeInRFC="false" toc="include" pn="section-9">
      <name slugifiedName="name-cbor-encoding-restrictions">CBOR Encoding Restrictions</name>
      <t indent="0" pn="section-9-1">この文書は、CBORエンコーダがどのように動作する必要があるかに対して課す制限を限定しています。新たなエンコーディングの制約は、<xref sectionFormat="of" section="4.2.1" target="STD94" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8949#section-4.2.1" derivedContent="STD94">RFC 8949</xref>で指定されたコア決定論エンコーディング要件と一致しています。以下の制限に絞られました：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9-2">
        <li pn="section-9-2.1">制約は、Sig_structure、Enc_structure、およびMAC_structureのエンコーディングに適用されます。</li>
        <li pn="section-9-2.2">
          Encoding <bcp14>MUST</bcp14> be done using definite lengths, and the length of
     the (encoded) argument <bcp14>MUST</bcp14> be the minimum possible length.  This
     means that the integer 1 is encoded as "0x01" and not "0x1801".
        </li>
        <li pn="section-9-2.3">アプリケーションは、単一のマップで2回使用される同じラベルをキーとして持つメッセージを生成してはなりません。アプリケーションは、単一のマップで2回使用される同じラベルをキーとして持つメッセージを解析して処理してはなりません。アプリケーションは、パースステップで失敗するパーサーを使用するか、すべてのキーをアプリケーションに渡し、アプリケーションが重複したキーをチェックすることで、パースおよび処理の要件を強制することができます。</li>
      </ul>
    </section>
    <section anchor="app-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-10">
      <name slugifiedName="name-application-profiling-consi">Application Profiling Considerations</name>
      <t indent="0" pn="section-10-1">このドキュメントは、特定の使用に対してアルゴリズムの実装要件を課すことなく、セキュリティーサービスの一連を提供するように設計されています。相互運用性の要件は、個々のサービスの使用方法およびアルゴリズムの相互運用性について提供されます。どのアルゴリズムとどのサービスが必要かに関する要件は、各アプリケーションに委ねられています。</t>
      <t indent="0" pn="section-10-2">プロファイルの例は、CoAPヘッダーと組み合わせてコンテンツを運ぶために開発されたものである<xref target="RFC8613" format="default" sectionFormat="of" derivedContent="RFC8613"/>で見ることができます。</t>
      <t indent="0" pn="section-10-3">このドキュメントに対して特定のアプリケーションの相互運用性の要件を定義する目的で、このドキュメントのプロファイルが作成されることを意図しています。このセクションでは、このドキュメントをプロファイリングする際に考慮すべきガイドラインとトピックのセットを提供します。</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10-4">
        <li pn="section-10-4.1">アプリケーションは、使用するこのドキュメントで定義されたメッセージのセットを特定する必要があります。メッセージのセットは、必要なセキュリティーサービスとセキュリティーレベルのセットにかなり直接対応します。</li>
        <li pn="section-10-4.2">アプリケーションは特定の目的のために新しいヘッダーパラメーターを定義することができます。「IV」または「Partial IV」ヘッダーパラメーターを使用するかどうかは、アプリケーションがしばしば選択します。例えば、アプリケーションは通常、IVヘッダーパラメーターまたはPartial IVヘッダーパラメーターのいずれかを使用することを指定します。Partial IVヘッダーパラメーターが指定された場合、アプリケーションは固定部分のIVがどのように決定されるかも定義する必要があります。</li>
        <li pn="section-10-4.3">アプリケーションが外部で定義された認証データを使用する場合、そのデータのエンコード方法を定義する必要があります。このドキュメントでは、データがバイト文字列として提供されることを前提としています。詳細は、<xref target="Extern_AAD" format="default" sectionFormat="of" derivedContent="Section 4.3"/>に記載されています。</li>
        <li pn="section-10-4.4">アプリケーションは使用されるセキュリティーアルゴリズムのセットを決定する必要があります。強制実装セットとして使用されるアルゴリズムを選択する際には、特定の目的で2つ選ばれる場合は異なるタイプのアルゴリズムを選択することが考慮されるべきです。これの例として、HMAC-SHA512とAES-CMAC（Cipher-Based Message Authentication Code）を異なるMACアルゴリズムとして選択することが挙げられます。これら2つのアルゴリズムの構成は大きく異なっています。これは、1つのアルゴリズムの弱体化が他のアルゴリズムの弱体化につながる可能性が低いことを意味します。もちろん、これらのアルゴリズムは同じレベルのセキュリティーを提供せず、したがって望ましいセキュリティー機能との比較ができない場合があります。詳細なガイダンスについては、<xref target="BCP201" format="default" sectionFormat="of" derivedContent="BCP201"/>を参照してください。</li>
        <li pn="section-10-4.5">
          <t indent="0" pn="section-10-4.5.1">アプリケーションでは、複数のアルゴリズムやメッセージ構造が許可されている場合には、何らかの形式の調停や検出方法を提供する必要がある場合があります。その方法は、アルゴリズムの事前設定を要求するだけであるか、プロトコルに組み込まれた検出方法など非常に単純なものから、さまざまな方法があります。S/MIMEでは、アプリケーションが問題にアプローチするために選択できるさまざまな方法を提供しました:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10-4.5.2">
            <li pn="section-10-4.5.2.1">メッセージ内での広告（S/MIMEの機能）<xref target="RFC8551" format="default" sectionFormat="の" derivedContent="RFC8551"/>。</li>
            <li pn="section-10-4.5.2.2">証明書内での広告（機能拡張）<xref target="RFC4262" format="default" sectionFormat="の" derivedContent="RFC4262"/>。</li>
            <li pn="section-10-4.5.2.3">時間とともに更新されたS/MIMEの最小要件<xref target="RFC2633" format="default" sectionFormat="の" derivedContent="RFC2633"/><xref target="RFC3851" format="default" sectionFormat="の" derivedContent="RFC3851"/><xref target="RFC5751" format="default" sectionFormat="の" derivedContent="RFC5751"/><xref target="RFC8551" format="default" sectionFormat="の" derivedContent="RFC8551"/>（<xref target="RFC2633" format="default" sectionFormat="の" derivedContent="RFC2633"/>は<xref target="RFC3851" format="default" sectionFormat="の" derivedContent="RFC3851"/>、<xref target="RFC3851" format="default" sectionFormat="の" derivedContent="RFC3851"/>は<xref target="RFC5751" format="default" sectionFormat="の" derivedContent="RFC5751"/>、<xref target="RFC5751" format="default" sectionFormat="の" derivedContent="RFC5751"/>は<xref target="RFC8551" format="default" sectionFormat="の" derivedContent="RFC8551"/>によって陳腐化されました）。</li>
          </ul>
        </li>
      </ul>
    </section>
    <section anchor="iana-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-11">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-11-1">以下に示すレジストリと登録は、RFC 8152によって定義されました。<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>。以下のほとんどのアクションは、このドキュメントを指すように参照を更新することです。</t>
      <t indent="0" pn="section-11-2">ここで、<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>に関しても、最初に<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>によって確立されたレジストリと登録の更新が行われます。ただし、要求された更新は相互に排他的です。この文書で要求された更新は、<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>で要求された更新とは競合または重複しませんし、その逆もまた然りです。</t>
      <section anchor="cose-header-key-table" numbered="true" removeInRFC="false" toc="include" pn="section-11.1">
        <name slugifiedName="name-cose-header-parameters-regi">COSE Header Parameters Registry</name>
        <t indent="0" pn="section-11.1-1">「COSEヘッダーパラメーター」レジストリは、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/> によって定義されました。IANAは、このレジストリの参照を<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>ではなくこの文書を指すように更新しました。また、IANAは「カウンタ署名」と「CounterSignature0」を除くすべてのエントリを、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>への参照ではなく、この文書を参照するように更新しました。「カウンタ署名」と「CounterSignature0」の参照は引き続き<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>を参照しています。</t>
      </section>
      <section anchor="cose-key-map-registry" numbered="true" removeInRFC="false" toc="include" pn="section-11.2">
        <name slugifiedName="name-cose-key-common-parameters-">COSE Key Common Parameters Registry</name>
        <t indent="0" pn="section-11.2-1">「COSE Key Common Parameters」レジストリは、<xref target="COSE.KeyParameters" format="default" sectionFormat="of" derivedContent="COSE.KeyParameters"/>で定義されていました。IANAはこのレジストリの参照を、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>ではなく、このドキュメントを指すように更新しました。IANAはまた、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>を参照していたエントリをこのドキュメントを参照するように更新しました。</t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-11.3">
        <name slugifiedName="name-media-type-registrations">Media Type Registrations</name>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-11.3.1">
          <name slugifiedName="name-cose-security-message">COSE Security Message</name>
          <t indent="0" pn="section-11.3.1-1">IANAは、"Media Types"レジストリにおいて"application/cose"メディアタイプを登録しました。このメディアタイプは、コンテンツがCOSEメッセージであることを示すために使用されます。</t>
          <dl indent="3" newline="false" spacing="normal" pn="section-11.3.1-2">
            <dt pn="section-11.3.1-2.1">Type name:</dt>
            <dd pn="section-11.3.1-2.2">application</dd>
            <dt pn="section-11.3.1-2.3">Subtype name:</dt>
            <dd pn="section-11.3.1-2.4">cose</dd>
            <dt pn="section-11.3.1-2.5">Required parameters:</dt>
            <dd pn="section-11.3.1-2.6">N/A</dd>
            <dt pn="section-11.3.1-2.7">Optional parameters:</dt>
            <dd pn="section-11.3.1-2.8">cose-type</dd>
            <dt pn="section-11.3.1-2.9">Encoding considerations:</dt>
            <dd pn="section-11.3.1-2.10">binary</dd>
            <dt pn="section-11.3.1-2.11">Security considerations:</dt>
            <dd pn="section-11.3.1-2.12">See the Security Considerations section of RFC 9052.</dd>
            <dt pn="section-11.3.1-2.13">Interoperability considerations:</dt>
            <dd pn="section-11.3.1-2.14">N/A</dd>
            <dt pn="section-11.3.1-2.15">Published specification:</dt>
            <dd pn="section-11.3.1-2.16">RFC 9052</dd>
            <dt pn="section-11.3.1-2.17">Applications that use this media type:</dt>
            <dd pn="section-11.3.1-2.18">IoT applications sending security content over HTTP(S) transports.</dd>
            <dt pn="section-11.3.1-2.19">Fragment identifier considerations:</dt>
            <dd pn="section-11.3.1-2.20">N/A</dd>
            <dt pn="section-11.3.1-2.21">Additional information:</dt>
            <dd pn="section-11.3.1-2.22">
              <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.3.1-2.22.1">
                <li pn="section-11.3.1-2.22.1.1">Deprecated alias names for this type: N/A</li>
                <li pn="section-11.3.1-2.22.1.2">マジックナンバー（複数形）：N/A</li>
                <li pn="section-11.3.1-2.22.1.3">ファイルの拡張子: cbor</li>
                <li pn="section-11.3.1-2.22.1.4">Macintoshファイルタイプコード：N/A</li>
              </ul>
            </dd>
            <dt pn="section-11.3.1-2.23">Person &amp; email address to contact for further information:</dt>
            <dd pn="section-11.3.1-2.24">
              <br/>iesg@ietf.org</dd>
            <dt pn="section-11.3.1-2.25">Intended usage:</dt>
            <dd pn="section-11.3.1-2.26">COMMON</dd>
            <dt pn="section-11.3.1-2.27">Restrictions on usage:</dt>
            <dd pn="section-11.3.1-2.28">N/A</dd>
            <dt pn="section-11.3.1-2.29">Author:</dt>
            <dd pn="section-11.3.1-2.30">Jim Schaad</dd>
            <dt pn="section-11.3.1-2.31">Change Controller:</dt>
            <dd pn="section-11.3.1-2.32">IESG</dd>
            <dt pn="section-11.3.1-2.33">Provisional registration?</dt>
            <dd pn="section-11.3.1-2.34">No</dd>
          </dl>
        </section>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-11.3.2">
          <name slugifiedName="name-cose-key-media-type">COSE Key Media Type</name>
          <t indent="0" pn="section-11.3.2-1">IANAは、「Media Types」レジストリに「application/cose-key」と「application/cose-key-set」のメディアタイプを登録しました。これらのメディアタイプは、それぞれコンテンツがCOSE_KeyまたはCOSE_KeySetオブジェクトであることを示すために使用されます。</t>
          <t indent="0" pn="section-11.3.2-2">「application/cose-key」のテンプレートは以下のようになります：</t>
          <dl indent="3" newline="false" spacing="normal" pn="section-11.3.2-3">
            <dt pn="section-11.3.2-3.1">Type name:</dt>
            <dd pn="section-11.3.2-3.2">application</dd>
            <dt pn="section-11.3.2-3.3">Subtype name:</dt>
            <dd pn="section-11.3.2-3.4">cose-key</dd>
            <dt pn="section-11.3.2-3.5">Required parameters:</dt>
            <dd pn="section-11.3.2-3.6">N/A</dd>
            <dt pn="section-11.3.2-3.7">Optional parameters:</dt>
            <dd pn="section-11.3.2-3.8">N/A</dd>
            <dt pn="section-11.3.2-3.9">Encoding considerations:</dt>
            <dd pn="section-11.3.2-3.10">binary</dd>
            <dt pn="section-11.3.2-3.11">Security considerations:</dt>
            <dd pn="section-11.3.2-3.12">See the Security Considerations section of RFC 9052.</dd>
            <dt pn="section-11.3.2-3.13">Interoperability considerations:</dt>
            <dd pn="section-11.3.2-3.14">N/A</dd>
            <dt pn="section-11.3.2-3.15">Published specification:</dt>
            <dd pn="section-11.3.2-3.16">RFC 9052</dd>
            <dt pn="section-11.3.2-3.17">Applications that use this media type:</dt>
            <dd pn="section-11.3.2-3.18">Distribution of COSE-based keys for IoT applications.</dd>
            <dt pn="section-11.3.2-3.19">Fragment identifier considerations:</dt>
            <dd pn="section-11.3.2-3.20">N/A</dd>
            <dt pn="section-11.3.2-3.21">Additional information:</dt>
            <dd pn="section-11.3.2-3.22">
              <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.3.2-3.22.1">
                <li pn="section-11.3.2-3.22.1.1">このタイプの非推奨のエイリアス名: N/A</li>
                <li pn="section-11.3.2-3.22.1.2">マジックナンバー：なし</li>
                <li pn="section-11.3.2-3.22.1.3">ファイルの拡張子：cbor</li>
                <li pn="section-11.3.2-3.22.1.4">Macintoshファイルタイプコード（複数形）：N/A</li>
              </ul>
            </dd>
            <dt pn="section-11.3.2-3.23">Person &amp; email address to contact for further information:</dt>
            <dd pn="section-11.3.2-3.24">
              <br/>iesg@ietf.org</dd>
            <dt pn="section-11.3.2-3.25">Intended usage:</dt>
            <dd pn="section-11.3.2-3.26">COMMON</dd>
            <dt pn="section-11.3.2-3.27">Restrictions on usage:</dt>
            <dd pn="section-11.3.2-3.28">N/A</dd>
            <dt pn="section-11.3.2-3.29">Author:</dt>
            <dd pn="section-11.3.2-3.30">Jim Schaad</dd>
            <dt pn="section-11.3.2-3.31">Change Controller:</dt>
            <dd pn="section-11.3.2-3.32">IESG</dd>
            <dt pn="section-11.3.2-3.33">Provisional registration?</dt>
            <dd pn="section-11.3.2-3.34">No</dd>
          </dl>
          <t indent="0" pn="section-11.3.2-4">「application/cose-key-set」を登録するためのテンプレートは、以下の通りです：</t>
          <dl indent="3" newline="false" spacing="normal" pn="section-11.3.2-5">
            <dt pn="section-11.3.2-5.1">Type name:</dt>
            <dd pn="section-11.3.2-5.2">application</dd>
            <dt pn="section-11.3.2-5.3">Subtype name:</dt>
            <dd pn="section-11.3.2-5.4">cose-key-set</dd>
            <dt pn="section-11.3.2-5.5">Required parameters:</dt>
            <dd pn="section-11.3.2-5.6">N/A</dd>
            <dt pn="section-11.3.2-5.7">Optional parameters:</dt>
            <dd pn="section-11.3.2-5.8">N/A</dd>
            <dt pn="section-11.3.2-5.9">Encoding considerations:</dt>
            <dd pn="section-11.3.2-5.10">binary</dd>
            <dt pn="section-11.3.2-5.11">Security considerations:</dt>
            <dd pn="section-11.3.2-5.12">See the Security Considerations section of RFC 9052.</dd>
            <dt pn="section-11.3.2-5.13">Interoperability considerations:</dt>
            <dd pn="section-11.3.2-5.14">N/A</dd>
            <dt pn="section-11.3.2-5.15">Published specification:</dt>
            <dd pn="section-11.3.2-5.16">RFC 9052</dd>
            <dt pn="section-11.3.2-5.17">Applications that use this media type:</dt>
            <dd pn="section-11.3.2-5.18">Distribution of COSE-based keys for IoT applications.</dd>
            <dt pn="section-11.3.2-5.19">Fragment identifier considerations:</dt>
            <dd pn="section-11.3.2-5.20">N/A</dd>
            <dt pn="section-11.3.2-5.21">Additional information:</dt>
            <dd pn="section-11.3.2-5.22">
              <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.3.2-5.22.1">
                <li pn="section-11.3.2-5.22.1.1">この型に対する非推奨のエイリアス名：N/A</li>
                <li pn="section-11.3.2-5.22.1.2">マジックナンバー（複数形）：N/A</li>
                <li pn="section-11.3.2-5.22.1.3">ファイル拡張子（複数形）：cbor</li>
                <li pn="section-11.3.2-5.22.1.4">マッキントッシュのファイルタイプコード：N/A</li>
              </ul>
            </dd>
            <dt pn="section-11.3.2-5.23">Person &amp; email address to contact for further information:</dt>
            <dd pn="section-11.3.2-5.24">iesg@ietf.org</dd>
            <dt pn="section-11.3.2-5.25">Intended usage:</dt>
            <dd pn="section-11.3.2-5.26">COMMON</dd>
            <dt pn="section-11.3.2-5.27">Restrictions on usage:</dt>
            <dd pn="section-11.3.2-5.28">N/A</dd>
            <dt pn="section-11.3.2-5.29">Author:</dt>
            <dd pn="section-11.3.2-5.30">Jim Schaad</dd>
            <dt pn="section-11.3.2-5.31">Change Controller:</dt>
            <dd pn="section-11.3.2-5.32">IESG</dd>
            <dt pn="section-11.3.2-5.33">Provisional registration?</dt>
            <dd pn="section-11.3.2-5.34">No</dd>
          </dl>
        </section>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-11.4">
        <name slugifiedName="name-coap-content-formats-regist">CoAP Content-Formats Registry</name>
        <t indent="0" pn="section-11.4-1">IANAは、「CoAPコンテンツフォーマット」登録にエントリーを追加しました。これは<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>で示されています。 IANAは、参照をこのドキュメントに更新し、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>の代わりにこのドキュメントを指すようにしました。</t>
      </section>
      <section numbered="true" removeInRFC="false" toc="include" pn="section-11.5">
        <name slugifiedName="name-cbor-tags-registry">CBOR Tags Registry</name>
        <t indent="0" pn="section-11.5-1">IANAは、<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>で示されているように、「CBOR タグ」レジストリへのエントリを追加しました。 IANAは、参照をこのドキュメントを指すように更新しました。以前の参照先は<xref target="RFC8152" format="default" sectionFormat="of" derivedContent="RFC8152"/>でした。</t>
      </section>
      <section anchor="review" numbered="true" removeInRFC="false" toc="include" pn="section-11.6">
        <name slugifiedName="name-expert-review-instructions">Expert Review Instructions</name>
        <t indent="0" pn="section-11.6-1"><bcp14>RFC8152</bcp14>で設立されたすべてのIANAレジストリは、少なくとも一部がExpert Review <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>として定義されています。このセクションでは、専門家が探すべき一般的なガイドラインを提供しますが、彼らは専門家として指定されているため、大きな裁量を与える必要があります。</t>
        <t indent="0" pn="section-11.6-2">専門的なレビューアは、以下を考慮する必要があります：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.6-3">
          <li pn="section-11.6-3.1">ポイントのスクワッティングは desu。レビュアーが登録リクエストのための十分な情報を取得することが推奨されています。これにより、使用が既存の登録と重複せず、コードポイントが展開で使用される可能性が高いことが確認されます。プライベート使用とタグ付けされた範囲は、テスト目的および閉じられた環境向けです。他の範囲のコードポイントはテストに割り当てられるべきではありません。</li>
          <li pn="section-11.6-3.2">Standards TrackまたはBCP RFCは、Standards Action範囲でコードポイントを登録することが必要です。Specification Required範囲には仕様が存在するべきですが、RFCが利用可能になる前の早期割り当ては許容されるものと見なされます。仕様は、クローズド環境外で相互運用可能に利用される場合に、ファーストカム・ファーストサーブ範囲についても必要です。仕様が提供されない場合、提供された記述には、ポイントがどのように使用されているかを識別するための十分な情報が必要です。</li>
          <li pn="section-11.6-3.3">専門家は、コードポイントの割り当てを承認する際に、フィールドの予想使用状況を考慮すべきです。Standards Action範囲がStandards Trackドキュメントにのみ利用可能であるという事実は、Standards Trackドキュメントがその範囲外にポイントを割り当てることができないという意味ではありません。符号化された値の長さは、その長さのコードポイントが残っている数と、それが使用されるデバイスのサイズとのバランスを考慮すべきです。</li>
          <li pn="section-11.6-3.4">アルゴリズムが登録される際は、自己満足的な登録を desync Preftechdis 後りするべきです。これを実現するためには、アルゴリズムのセキュリティー分析に関する追加の文書提出を登録に要求することがあります。また、Crypto Forum Research Group（CFRG）からアルゴリズムに関する意見を求めることも検討すべきです。登録に適しているためには、アルゴリズムがコミュニティのセキュリティー要件とメッセージ構造の要件を満たすことが期待されます。</li>
        </ul>
      </section>
    </section>
    <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-12">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-12-1">この仕様を実装する者は、考慮すべきセキュリティーに関する点がいくつかあります。ここでは一部の考慮事項を示しましたが、参照文献にリストされている文書に追加の考慮事項が存在する場合があります。</t>
      <t indent="0" pn="section-12-2">実装は、すべての個人の秘密鍵情報を保護する必要があります。この文書では、この問題に関していくつかのケースが強調される必要があります。</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12-3">
        <li pn="section-12-3.1">同じ鍵を2つの異なるアルゴリズムで使用すると、鍵に関する情報が漏洩する可能性があります。したがって、鍵は1つのアルゴリズムに制限されることが推奨されます。</li>
        <li pn="section-12-3.2">「直接」を受信者アルゴリズムと組み合わせた場合、第二の受信者に直接の鍵が公開されます。第8.5節の<xref target="key-management-algs" format="default" sectionFormat="of" derivedContent="Section 8.5"/>では、「直接」の受信者アルゴリズムを他のモードと組み合わせることは禁止されています。</li>
        <li pn="section-12-3.3">いくつかのアルゴリズムは、鍵が情報漏洩することなく使用できる回数に制限があります。詳細は、<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>をご覧ください。</li>
      </ul>
      <t indent="0" pn="section-12-4">エリプティックカーブディフィーヘルマン（ECDH）およびダイレクトプラスKDF（キーラップなし）の使用は、秘密鍵の漏洩に直接つながることはありません。KDFのワンウェイ関数によってそれが防止されます。ただし、対処する必要がある別の問題があります。2つの受信者がある場合、CEKは2つの受信者間で共有される必要があります。したがって、2番目の受信者は、弱い原点の証明に使用される可能性のある素材から派生したCEKを持っています。2番目の受信者は同じCEKを使用してメッセージを作成し、それを最初の受信者に送信することができます。最初の受信者は、Static-Static ECDHまたはダイレクトプラスKDFのいずれかの場合、CEKが証明のために使用される可能性があると仮定し、それが誤ったエンティティからのものであるにもかかわらず、証明のために使用できるとします。キーラップステップが追加されると、原点の証明は暗示されず、これは問題ではありません。</t>
      <t indent="0" pn="section-12-5">以前にも言及されていますが、複数のアルゴリズムに単一のキーを使用することは、いくつかの場合においてキーに関する情報が漏洩し、攻撃者が整合性タグを偽造したり、暗号化されたコンテンツの情報を取得する機会を提供することが示されています。キーを単一のアルゴリズムにバインドすることで、これらの問題を防ぐことができます。キーの作成者とキーの利用者は、異なるアルゴリズムごとに新しいキーを作成するだけでなく、そのアルゴリズムの選択をキー素材の配布に含め、キー構造とメッセージ構造のアルゴリズムが一致することを厳密に強制することを強く推奨されます。アルゴリズムが正しいことを確認するだけでなく、キーの形式もチェックする必要があります。「OKP」というキーが期待される場所で「EC2」というキーを使用しないでください。</t>
      <t indent="0" pn="section-12-6">送信に鍵を使用する前、または受信した情報に対して行動する前に、鍵の信頼性に関する判断を行う必要があります。データや行動が、鍵に関連するエンティティが見る権利や要求する権利を持っているものであるかどうかは、信頼性判断に関連するいくつかの要素があります。以下にいくつかを強調します。</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12-7">
        <li pn="section-12-7.1">キーオーナーに関連する許可は何ですか？</li>
        <li pn="section-12-7.2">現在のコンテキストでの暗号アルゴリズムは許容されていますか？</li>
        <li pn="section-12-7.3">
          <bcp14>キーに関連する制約事項（アルゴリズムや鮮度など）は確認されており、正しいですか？</bcp14></li>
        <li pn="section-12-7.4">現在のアプリケーションの状態を考慮して、リクエストが合理的なものかどうかは、そのリクエストの内容に基づいて判断されますか？</li>
        <li pn="section-12-7.5">Have any security considerations that are part of the message been enforced (as specified by the application or "crit" header parameter)?</li>
      </ul>
      <t indent="0" pn="section-12-8">暗号化されたメッセージのトラフィック解析に基づくメッセージの長さに関する露出を受けている領域の1つは、パディングの一元的な提供方法を提供しないという点です。 <xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>で定義されているすべてのコンテンツ暗号化アルゴリズムに基づいて、(例えば、"YES"と"NO"のように)観察者は2つの異なるメッセージを長さによって区別することができます。これは、メッセージ構造の一部としてパディングを提供するために、アプリケーションがどのようにコンテンツのパディングを行うかを文書化する必要があることを意味します。これにより、そのような解析を防止または妨害するために、テキスト文字列は「YES」と「NO 」のように定義されることがあります。</t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-core-groupcomm-bis" to="CORE-GROUPCOMM"/>
    <displayreference target="I-D.ietf-cose-countersign" to="COSE-COUNTERSIGN"/>
    <references pn="section-13">
      <name slugifiedName="name-references">References</name>
      <references pn="section-13.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized.  This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC9053" target="https://www.rfc-editor.org/info/rfc9053" quoteTitle="true" derivedAnchor="RFC9053">
          <front>
            <title>CBOR Object Signing and Encryption (COSE): Initial Algorithms</title>
            <author initials="J" surname="Schaad" fullname="Jim Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="August" year="2022"/>
          </front>
          <seriesInfo name="RFC" value="9053"/>
          <seriesInfo name="DOI" value="10.17487/RFC9053"/>
        </reference>
        <reference anchor="STD94" target="https://www.rfc-editor.org/info/std94" quoteTitle="true" derivedAnchor="STD94">
          <front>
            <title>Concise Binary Object Representation (CBOR)</title>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="December"/>
          </front>
          <seriesInfo name="STD" value="94"/>
          <seriesInfo name="RFC" value="8949"/>
        </reference>
      </references>
      <references pn="section-13.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="BCP201" target="https://www.rfc-editor.org/info/bcp201" quoteTitle="true" derivedAnchor="BCP201">
          <front>
            <title>Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms</title>
            <author initials="R." surname="Housley" fullname="Russ Housley">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="November" year="2015"/>
          </front>
          <seriesInfo name="BCP" value="201"/>
          <seriesInfo name="RFC" value="7696"/>
        </reference>
        <reference anchor="COAP.Formats" target="https://www.iana.org/assignments/core-parameters/" quoteTitle="true" derivedAnchor="COAP.Formats">
          <front>
            <title>CoAP Content-Formats</title>
            <author>
              <organization showOnFrontPage="true">IANA</organization>
            </author>
            <date/>
          </front>
        </reference>
        <reference anchor="I-D.ietf-core-groupcomm-bis" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-07" derivedAnchor="CORE-GROUPCOMM">
          <front>
            <title>Group Communication for the Constrained Application Protocol (CoAP)</title>
            <author fullname="Esko Dijk">
              <organization showOnFrontPage="true">IoTconsultancy.nl</organization>
            </author>
            <author fullname="Chonggang Wang">
              <organization showOnFrontPage="true">InterDigital</organization>
            </author>
            <author fullname="Marco Tiloca">
              <organization showOnFrontPage="true">RISE AB</organization>
            </author>
            <date month="July" day="11" year="2022"/>
            <abstract>
              <t indent="0">   This document specifies the use of the Constrained Application
   Protocol (CoAP) for group communication, including the use of UDP/IP
   multicast as the default underlying data transport.  Both unsecured
   and secured CoAP group communication are specified.  Security is
   achieved by use of the Group Object Security for Constrained RESTful
   Environments (Group OSCORE) protocol.  The target application area of
   this specification is any group communication use cases that involve
   resource-constrained devices or networks that support CoAP.  This
   document replaces RFC 7390, while it updates RFC 7252 and RFC 7641.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-core-groupcomm-bis-07"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-07.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="I-D.ietf-cose-countersign" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-cose-countersign-08" derivedAnchor="COSE-COUNTERSIGN">
          <front>
            <title>CBOR Object Signing and Encryption (COSE): Countersignatures</title>
            <author fullname="Jim Schaad">
              <organization showOnFrontPage="true">August Cellars</organization>
            </author>
            <author fullname="Russ Housley">
              <organization showOnFrontPage="true">Vigil Security, LLC</organization>
            </author>
            <date month="August" day="22" year="2022"/>
            <abstract>
              <t indent="0">   Concise Binary Object Representation (CBOR) is a data format designed
   for small code size and small message size.  CBOR Object Signing and
   Encryption (COSE) defines a set of security services for CBOR.  This
   document defines a countersignature algorithm along with the needed
   header parameters and CBOR tags for COSE.  This document updates RFC
   INSERT the number assigned to [I-D.ietf-cose-rfc8152bis-struct].

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-cose-countersign-08"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-cose-countersign-08.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="COSE.Algorithms" target="https://www.iana.org/assignments/cose/" quoteTitle="true" derivedAnchor="COSE.Algorithms">
          <front>
            <title>COSE Algorithms</title>
            <author>
              <organization showOnFrontPage="true">IANA</organization>
            </author>
            <date/>
          </front>
        </reference>
        <reference anchor="COSE.KeyParameters" target="https://www.iana.org/assignments/cose/" quoteTitle="true" derivedAnchor="COSE.KeyParameters">
          <front>
            <title>COSE Key Common Parameters</title>
            <author>
              <organization showOnFrontPage="true">IANA</organization>
            </author>
            <date/>
          </front>
        </reference>
        <reference anchor="COSE.KeyTypes" target="https://www.iana.org/assignments/cose/" quoteTitle="true" derivedAnchor="COSE.KeyTypes">
          <front>
            <title>COSE Key Types</title>
            <author>
              <organization showOnFrontPage="true">IANA</organization>
            </author>
            <date/>
          </front>
        </reference>
        <reference anchor="DSS" target="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" quoteTitle="true" derivedAnchor="DSS">
          <front>
            <title>Digital Signature Standard (DSS)</title>
            <author>
              <organization showOnFrontPage="true">National Institute of Standards and Technology</organization>
            </author>
            <date year="2013" month="July"/>
          </front>
          <seriesInfo name="FIPS" value="186-4"/>
          <seriesInfo name="DOI" value="10.6028/NIST.FIPS.186-4"/>
        </reference>
        <reference anchor="GitHub-Examples" target="https://github.com/cose-wg/Examples" quoteTitle="true" derivedAnchor="GitHub-Examples">
          <front>
            <title>GitHub Examples of COSE</title>
            <author/>
            <date month="June" day="3" year="2020"/>
          </front>
          <refcontent>commit 3221310</refcontent>
        </reference>
        <reference anchor="PVSig" target="https://www.certicom.com/content/dam/certicom/images/pdfs/CerticomWP-PVSigSec_login.pdf" quoteTitle="true" derivedAnchor="PVSig">
          <front>
            <title>Formal Security Proofs for a Signature Scheme with Partial Message Recovery</title>
            <author initials="D.R.L." surname="Brown"/>
            <author initials="D.B." surname="Johnson"/>
            <date year="2000" month="June"/>
          </front>
          <seriesInfo name="DOI" value="10.1007/3-540-45353-9_11"/>
          <refcontent>LNCS Volume 2020</refcontent>
        </reference>
        <reference anchor="RFC2633" target="https://www.rfc-editor.org/info/rfc2633" quoteTitle="true" derivedAnchor="RFC2633">
          <front>
            <title>S/MIME Version 3 Message Specification</title>
            <author fullname="B. Ramsdell" initials="B." role="editor" surname="Ramsdell"/>
            <date month="June" year="1999"/>
            <abstract>
              <t indent="0">This document describes a protocol for adding cryptographic signature and encryption services to MIME data. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2633"/>
          <seriesInfo name="DOI" value="10.17487/RFC2633"/>
        </reference>
        <reference anchor="RFC3394" target="https://www.rfc-editor.org/info/rfc3394" quoteTitle="true" derivedAnchor="RFC3394">
          <front>
            <title>Advanced Encryption Standard (AES) Key Wrap Algorithm</title>
            <author fullname="J. Schaad" initials="J." surname="Schaad"/>
            <author fullname="R. Housley" initials="R." surname="Housley"/>
            <date month="September" year="2002"/>
          </front>
          <seriesInfo name="RFC" value="3394"/>
          <seriesInfo name="DOI" value="10.17487/RFC3394"/>
        </reference>
        <reference anchor="RFC3851" target="https://www.rfc-editor.org/info/rfc3851" quoteTitle="true" derivedAnchor="RFC3851">
          <front>
            <title>Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</title>
            <author fullname="B. Ramsdell" initials="B." role="editor" surname="Ramsdell"/>
            <date month="July" year="2004"/>
            <abstract>
              <t indent="0">This document defines Secure/Multipurpose Internet Mail Extensions (S/MIME) version 3.1.  S/MIME provides a consistent way to send and receive secure MIME data.  Digital signatures provide authentication, message integrity, and non-repudiation with proof of origin.  Encryption provides data confidentiality.  Compression can be used to reduce data size.  This document obsoletes RFC 2633. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3851"/>
          <seriesInfo name="DOI" value="10.17487/RFC3851"/>
        </reference>
        <reference anchor="RFC4262" target="https://www.rfc-editor.org/info/rfc4262" quoteTitle="true" derivedAnchor="RFC4262">
          <front>
            <title>X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities</title>
            <author fullname="S. Santesson" initials="S." surname="Santesson"/>
            <date month="December" year="2005"/>
            <abstract>
              <t indent="0">This document defines a certificate extension for inclusion of Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities in X.509 public key certificates, as defined by RFC 3280.  This certificate extension provides an optional method to indicate the cryptographic capabilities of an entity as a complement to the S/MIME Capabilities signed attribute in S/MIME messages according to RFC 3851. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4262"/>
          <seriesInfo name="DOI" value="10.17487/RFC4262"/>
        </reference>
        <reference anchor="RFC4949" target="https://www.rfc-editor.org/info/rfc4949" quoteTitle="true" derivedAnchor="RFC4949">
          <front>
            <title>Internet Security Glossary, Version 2</title>
            <author fullname="R. Shirey" initials="R." surname="Shirey"/>
            <date month="August" year="2007"/>
            <abstract>
              <t indent="0">This Glossary provides definitions, abbreviations, and explanations of terminology for information system security.  The 334 pages of entries offer recommendations to improve the comprehensibility of written material that is generated in the Internet Standards Process (RFC 2026).  The recommendations follow the principles that such writing should (a) use the same term or definition whenever the same concept is mentioned; (b) use terms in their plainest, dictionary sense; (c) use terms that are already well-established in open publications; and (d) avoid terms that either favor a particular vendor or favor a particular technology or mechanism over other, competing techniques that already exist or could be developed.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="FYI" value="36"/>
          <seriesInfo name="RFC" value="4949"/>
          <seriesInfo name="DOI" value="10.17487/RFC4949"/>
        </reference>
        <reference anchor="RFC5116" target="https://www.rfc-editor.org/info/rfc5116" quoteTitle="true" derivedAnchor="RFC5116">
          <front>
            <title>An Interface and Algorithms for Authenticated Encryption</title>
            <author fullname="D. McGrew" initials="D." surname="McGrew"/>
            <date month="January" year="2008"/>
            <abstract>
              <t indent="0">This document defines algorithms for Authenticated Encryption with Associated Data (AEAD), and defines a uniform interface and a registry for such algorithms.  The interface and registry can be used as an application-independent set of cryptoalgorithm suites.  This approach provides advantages in efficiency and security, and promotes the reuse of crypto implementations. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5116"/>
          <seriesInfo name="DOI" value="10.17487/RFC5116"/>
        </reference>
        <reference anchor="RFC5652" target="https://www.rfc-editor.org/info/rfc5652" quoteTitle="true" derivedAnchor="RFC5652">
          <front>
            <title>Cryptographic Message Syntax (CMS)</title>
            <author fullname="R. Housley" initials="R." surname="Housley"/>
            <date month="September" year="2009"/>
            <abstract>
              <t indent="0">This document describes the Cryptographic Message Syntax (CMS).  This syntax is used to digitally sign, digest, authenticate, or encrypt arbitrary message content. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="70"/>
          <seriesInfo name="RFC" value="5652"/>
          <seriesInfo name="DOI" value="10.17487/RFC5652"/>
        </reference>
        <reference anchor="RFC5751" target="https://www.rfc-editor.org/info/rfc5751" quoteTitle="true" derivedAnchor="RFC5751">
          <front>
            <title>Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification</title>
            <author fullname="B. Ramsdell" initials="B." surname="Ramsdell"/>
            <author fullname="S. Turner" initials="S." surname="Turner"/>
            <date month="January" year="2010"/>
            <abstract>
              <t indent="0">This document defines Secure/Multipurpose Internet Mail Extensions (S/MIME) version 3.2.  S/MIME provides a consistent way to send and receive secure MIME data.  Digital signatures provide authentication, message integrity, and non-repudiation with proof of origin.  Encryption provides data confidentiality.  Compression can be used to reduce data size.  This document obsoletes RFC 3851. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5751"/>
          <seriesInfo name="DOI" value="10.17487/RFC5751"/>
        </reference>
        <reference anchor="RFC5752" target="https://www.rfc-editor.org/info/rfc5752" quoteTitle="true" derivedAnchor="RFC5752">
          <front>
            <title>Multiple Signatures in Cryptographic Message Syntax (CMS)</title>
            <author fullname="S. Turner" initials="S." surname="Turner"/>
            <author fullname="J. Schaad" initials="J." surname="Schaad"/>
            <date month="January" year="2010"/>
            <abstract>
              <t indent="0">Cryptographic Message Syntax (CMS) SignedData includes the SignerInfo structure to convey per-signer information.  SignedData supports multiple signers and multiple signature algorithms per signer with multiple SignerInfo structures.  If a signer attaches more than one SignerInfo, there are concerns that an attacker could perform a downgrade attack by removing the SignerInfo(s) with the \'strong' algorithm(s).  This document defines the multiple-signatures attribute, its generation rules, and its processing rules to allow signers to convey multiple SignerInfo objects while protecting against downgrade attacks.  Additionally, this attribute may assist during periods of algorithm migration. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5752"/>
          <seriesInfo name="DOI" value="10.17487/RFC5752"/>
        </reference>
        <reference anchor="RFC5990" target="https://www.rfc-editor.org/info/rfc5990" quoteTitle="true" derivedAnchor="RFC5990">
          <front>
            <title>Use of the RSA-KEM Key Transport Algorithm in the Cryptographic Message Syntax (CMS)</title>
            <author fullname="J. Randall" initials="J." surname="Randall"/>
            <author fullname="B. Kaliski" initials="B." surname="Kaliski"/>
            <author fullname="J. Brainard" initials="J." surname="Brainard"/>
            <author fullname="S. Turner" initials="S." surname="Turner"/>
            <date month="September" year="2010"/>
            <abstract>
              <t indent="0">The RSA-KEM Key Transport Algorithm is a one-pass (store-and-forward) mechanism for transporting keying data to a recipient using the recipient's RSA public key. ("KEM" stands for "key encapsulation mechanism".) This document specifies the conventions for using the RSA-KEM Key Transport Algorithm with the Cryptographic Message Syntax (CMS).  The ASN.1 syntax is aligned with an expected forthcoming change to American National Standard (ANS) X9.44.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5990"/>
          <seriesInfo name="DOI" value="10.17487/RFC5990"/>
        </reference>
        <reference anchor="RFC6838" target="https://www.rfc-editor.org/info/rfc6838" quoteTitle="true" derivedAnchor="RFC6838">
          <front>
            <title>Media Type Specifications and Registration Procedures</title>
            <author fullname="N. Freed" initials="N." surname="Freed"/>
            <author fullname="J. Klensin" initials="J." surname="Klensin"/>
            <author fullname="T. Hansen" initials="T." surname="Hansen"/>
            <date month="January" year="2013"/>
            <abstract>
              <t indent="0">This document defines procedures for the specification and registration of media types for use in HTTP, MIME, and other Internet protocols.  This memo documents an Internet Best Current Practice.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="13"/>
          <seriesInfo name="RFC" value="6838"/>
          <seriesInfo name="DOI" value="10.17487/RFC6838"/>
        </reference>
        <reference anchor="RFC7252" target="https://www.rfc-editor.org/info/rfc7252" quoteTitle="true" derivedAnchor="RFC7252">
          <front>
            <title>The Constrained Application Protocol (CoAP)</title>
            <author fullname="Z. Shelby" initials="Z." surname="Shelby"/>
            <author fullname="K. Hartke" initials="K." surname="Hartke"/>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <date month="June" year="2014"/>
            <abstract>
              <t indent="0">The Constrained Application Protocol (CoAP) is a specialized web transfer protocol for use with constrained nodes and constrained (e.g., low-power, lossy) networks. The nodes often have 8-bit microcontrollers with small amounts of ROM and RAM, while constrained networks such as IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs) often have high packet error rates and a typical throughput of 10s of kbit/s. The protocol is designed for machine- to-machine (M2M) applications such as smart energy and building automation.</t>
              <t indent="0">CoAP provides a request/response interaction model between application endpoints, supports built-in discovery of services and resources, and includes key concepts of the Web such as URIs and Internet media types. CoAP is designed to easily interface with HTTP for integration with the Web while meeting specialized requirements such as multicast support, very low overhead, and simplicity for constrained environments.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7252"/>
          <seriesInfo name="DOI" value="10.17487/RFC7252"/>
        </reference>
        <reference anchor="RFC7515" target="https://www.rfc-editor.org/info/rfc7515" quoteTitle="true" derivedAnchor="RFC7515">
          <front>
            <title>JSON Web Signature (JWS)</title>
            <author fullname="M. Jones" initials="M." surname="Jones"/>
            <author fullname="J. Bradley" initials="J." surname="Bradley"/>
            <author fullname="N. Sakimura" initials="N." surname="Sakimura"/>
            <date month="May" year="2015"/>
            <abstract>
              <t indent="0">JSON Web Signature (JWS) represents content secured with digital signatures or Message Authentication Codes (MACs) using JSON-based data structures.  Cryptographic algorithms and identifiers for use with this specification are described in the separate JSON Web Algorithms (JWA) specification and an IANA registry defined by that specification.  Related encryption capabilities are described in the separate JSON Web Encryption (JWE) specification.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7515"/>
          <seriesInfo name="DOI" value="10.17487/RFC7515"/>
        </reference>
        <reference anchor="RFC7516" target="https://www.rfc-editor.org/info/rfc7516" quoteTitle="true" derivedAnchor="RFC7516">
          <front>
            <title>JSON Web Encryption (JWE)</title>
            <author fullname="M. Jones" initials="M." surname="Jones"/>
            <author fullname="J. Hildebrand" initials="J." surname="Hildebrand"/>
            <date month="May" year="2015"/>
            <abstract>
              <t indent="0">JSON Web Encryption (JWE) represents encrypted content using JSON-based data structures.  Cryptographic algorithms and identifiers for use with this specification are described in the separate JSON Web Algorithms (JWA) specification and IANA registries defined by that specification.  Related digital signature and Message Authentication Code (MAC) capabilities are described in the separate JSON Web Signature (JWS) specification.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7516"/>
          <seriesInfo name="DOI" value="10.17487/RFC7516"/>
        </reference>
        <reference anchor="RFC7517" target="https://www.rfc-editor.org/info/rfc7517" quoteTitle="true" derivedAnchor="RFC7517">
          <front>
            <title>JSON Web Key (JWK)</title>
            <author fullname="M. Jones" initials="M." surname="Jones"/>
            <date month="May" year="2015"/>
            <abstract>
              <t indent="0">A JSON Web Key (JWK) is a JavaScript Object Notation (JSON) data structure that represents a cryptographic key.  This specification also defines a JWK Set JSON data structure that represents a set of JWKs.  Cryptographic algorithms and identifiers for use with this specification are described in the separate JSON Web Algorithms (JWA) specification and IANA registries established by that specification.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7517"/>
          <seriesInfo name="DOI" value="10.17487/RFC7517"/>
        </reference>
        <reference anchor="RFC7518" target="https://www.rfc-editor.org/info/rfc7518" quoteTitle="true" derivedAnchor="RFC7518">
          <front>
            <title>JSON Web Algorithms (JWA)</title>
            <author fullname="M. Jones" initials="M." surname="Jones"/>
            <date month="May" year="2015"/>
            <abstract>
              <t indent="0">This specification registers cryptographic algorithms and identifiers to be used with the JSON Web Signature (JWS), JSON Web Encryption (JWE), and JSON Web Key (JWK) specifications.  It defines several IANA registries for these identifiers.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7518"/>
          <seriesInfo name="DOI" value="10.17487/RFC7518"/>
        </reference>
        <reference anchor="RFC8032" target="https://www.rfc-editor.org/info/rfc8032" quoteTitle="true" derivedAnchor="RFC8032">
          <front>
            <title>Edwards-Curve Digital Signature Algorithm (EdDSA)</title>
            <author fullname="S. Josefsson" initials="S." surname="Josefsson"/>
            <author fullname="I. Liusvaara" initials="I." surname="Liusvaara"/>
            <date month="January" year="2017"/>
            <abstract>
              <t indent="0">This document describes elliptic curve signature scheme Edwards-curve Digital Signature Algorithm (EdDSA).  The algorithm is instantiated with recommended parameters for the edwards25519 and edwards448 curves.  An example implementation and test vectors are provided.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8032"/>
          <seriesInfo name="DOI" value="10.17487/RFC8032"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author fullname="M. Cotton" initials="M." surname="Cotton"/>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <author fullname="T. Narten" initials="T." surname="Narten"/>
            <date month="June" year="2017"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters. To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper. For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed. This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8152" target="https://www.rfc-editor.org/info/rfc8152" quoteTitle="true" derivedAnchor="RFC8152">
          <front>
            <title>CBOR Object Signing and Encryption (COSE)</title>
            <author fullname="J. Schaad" initials="J." surname="Schaad"/>
            <date month="July" year="2017"/>
            <abstract>
              <t indent="0">Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size.  There is a need for the ability to have basic security services defined for this data format.  This document defines the CBOR Object Signing and Encryption (COSE) protocol.  This specification describes how to create and process signatures, message authentication codes, and encryption using CBOR for serialization.  This specification additionally describes how to represent cryptographic keys using CBOR.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8152"/>
          <seriesInfo name="DOI" value="10.17487/RFC8152"/>
        </reference>
        <reference anchor="RFC8230" target="https://www.rfc-editor.org/info/rfc8230" quoteTitle="true" derivedAnchor="RFC8230">
          <front>
            <title>Using RSA Algorithms with CBOR Object Signing and Encryption (COSE) Messages</title>
            <author fullname="M. Jones" initials="M." surname="Jones"/>
            <date month="September" year="2017"/>
            <abstract>
              <t indent="0">The CBOR Object Signing and Encryption (COSE) specification defines cryptographic message encodings using Concise Binary Object Representation (CBOR).  This specification defines algorithm encodings and representations enabling RSA algorithms to be used for COSE messages.  Encodings are specified for the use of RSA Probabilistic Signature Scheme (RSASSA-PSS) signatures, RSA Encryption Scheme - Optimal Asymmetric Encryption Padding (RSAES-OAEP) encryption, and RSA keys.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8230"/>
          <seriesInfo name="DOI" value="10.17487/RFC8230"/>
        </reference>
        <reference anchor="RFC8551" target="https://www.rfc-editor.org/info/rfc8551" quoteTitle="true" derivedAnchor="RFC8551">
          <front>
            <title>Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification</title>
            <author fullname="J. Schaad" initials="J." surname="Schaad"/>
            <author fullname="B. Ramsdell" initials="B." surname="Ramsdell"/>
            <author fullname="S. Turner" initials="S." surname="Turner"/>
            <date month="April" year="2019"/>
            <abstract>
              <t indent="0">This document defines Secure/Multipurpose Internet Mail Extensions (S/MIME) version 4.0.  S/MIME provides a consistent way to send and receive secure MIME data.  Digital signatures provide authentication, message integrity, and non-repudiation with proof of origin.  Encryption provides data confidentiality.  Compression can be used to reduce data size.  This document obsoletes RFC 5751.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8551"/>
          <seriesInfo name="DOI" value="10.17487/RFC8551"/>
        </reference>
        <reference anchor="RFC8610" target="https://www.rfc-editor.org/info/rfc8610" quoteTitle="true" derivedAnchor="RFC8610">
          <front>
            <title>Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures</title>
            <author fullname="H. Birkholz" initials="H." surname="Birkholz"/>
            <author fullname="C. Vigano" initials="C." surname="Vigano"/>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <date month="June" year="2019"/>
            <abstract>
              <t indent="0">This document proposes a notational convention to express Concise Binary Object Representation (CBOR) data structures (RFC 7049).  Its main goal is to provide an easy and unambiguous way to express structures for protocol messages and data formats that use CBOR or JSON.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8610"/>
          <seriesInfo name="DOI" value="10.17487/RFC8610"/>
        </reference>
        <reference anchor="RFC8613" target="https://www.rfc-editor.org/info/rfc8613" quoteTitle="true" derivedAnchor="RFC8613">
          <front>
            <title>Object Security for Constrained RESTful Environments (OSCORE)</title>
            <author fullname="G. Selander" initials="G." surname="Selander"/>
            <author fullname="J. Mattsson" initials="J." surname="Mattsson"/>
            <author fullname="F. Palombini" initials="F." surname="Palombini"/>
            <author fullname="L. Seitz" initials="L." surname="Seitz"/>
            <date month="July" year="2019"/>
            <abstract>
              <t indent="0">This document defines Object Security for Constrained RESTful Environments (OSCORE), a method for application-layer protection of the Constrained Application Protocol (CoAP), using CBOR Object Signing and Encryption (COSE). OSCORE provides end-to-end protection between endpoints communicating using CoAP or CoAP-mappable HTTP. OSCORE is designed for constrained nodes and networks supporting a range of proxy operations, including translation between different transport protocols.</t>
              <t indent="0">Although an optional functionality of CoAP, OSCORE alters CoAP options processing and IANA registration. Therefore, this document updates RFC 7252.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8613"/>
          <seriesInfo name="DOI" value="10.17487/RFC8613"/>
        </reference>
        <reference anchor="RFC9054" target="https://www.rfc-editor.org/info/rfc9054" quoteTitle="true" derivedAnchor="RFC9054">
          <front>
            <title>CBOR Object Signing and Encryption (COSE): Hash Algorithms</title>
            <author initials="J" surname="Schaad" fullname="Jim Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="August" year="2022"/>
          </front>
          <seriesInfo name="RFC" value="9054"/>
          <seriesInfo name="DOI" value="10.17487/RFC9054"/>
        </reference>
        <reference anchor="RFC9106" target="https://www.rfc-editor.org/info/rfc9106" quoteTitle="true" derivedAnchor="RFC9106">
          <front>
            <title>Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications</title>
            <author fullname="A. Biryukov" initials="A." surname="Biryukov"/>
            <author fullname="D. Dinu" initials="D." surname="Dinu"/>
            <author fullname="D. Khovratovich" initials="D." surname="Khovratovich"/>
            <author fullname="S. Josefsson" initials="S." surname="Josefsson"/>
            <date month="September" year="2021"/>
            <abstract>
              <t indent="0">This document describes the Argon2 memory-hard function for password hashing and proof-of-work applications.  We provide an implementer-oriented description with test vectors.  The purpose is to simplify adoption of Argon2 for Internet protocols.  This document is a product of the Crypto Forum Research Group (CFRG) in the IRTF.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9106"/>
          <seriesInfo name="DOI" value="10.17487/RFC9106"/>
        </reference>
        <reference anchor="STD90" target="https://www.rfc-editor.org/info/std90" quoteTitle="true" derivedAnchor="STD90">
          <front>
            <title>The JavaScript Object Notation (JSON) Data Interchange Format</title>
            <author initials="T." surname="Bray" fullname="T. Bray" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="December" year="2017"/>
          </front>
          <seriesInfo name="STD" value="90"/>
          <seriesInfo name="RFC" value="8259"/>
        </reference>
        <reference anchor="W3C.WebCrypto" target="https://www.w3.org/TR/WebCryptoAPI/" quoteTitle="true" derivedAnchor="W3C.WebCrypto">
          <front>
            <title>Web Cryptography API</title>
            <author initials="M." surname="Watson" role="editor"/>
            <date year="2017" month="January" day="26"/>
          </front>
          <refcontent>W3C Recommendation</refcontent>
        </reference>
      </references>
    </references>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-guidelines-for-external-dat">Guidelines for External Data Authentication of Algorithms</name>
      <t indent="0" pn="section-appendix.a-1">COSEの開発中に、アルゴリズム識別子が保護された属性内に配置される必要性は、mustからshouldへと緩和されました。この立場を支持するには2つの基本的な理由があります。まず、CoAP環境で最も一般的なメッセージからアルゴリズム識別子を省略することで、結果としてメッセージがより小さくなります。次に、アルゴリズム識別子が配置される異なる場所（メッセージ自体、アプリケーションの文書、送信者が所持する鍵構造、受信者が所持する鍵構造）の間で正確に完全なチェックが実行されない場合に生じる潜在的なバグがあります。</t>
      <t indent="0" pn="section-appendix.a-2">この付録では、そのような変更が行われる方法と、このオプションを使用するためにアプリケーションが特定する必要のある詳細について説明します。2つの異なる詳細セットが指定されています：アルゴリズム識別子を省略するために必要な詳細と、自体に関する属性を含まないカウンタ署名属性の変体を使用するために必要な詳細です。</t>
      <t indent="0" pn="section-appendix.a-3">推奨事項は3つのセットに分けられます。最初のセットの推奨事項は、COSEオブジェクトの単一のレイヤーに対して暗黙のアルゴリズムを識別する場合に適用されます。2番目のセットの推奨事項は、COSEオブジェクトの複数のレイヤーに対して複数の暗黙のアルゴリズムを識別する場合に適用されます。3番目のセットの推奨事項は、複数のCOSEオブジェクト構築に対して暗黙のアルゴリズムを持つ場合に適用されます。</t>
      <t indent="0" pn="section-appendix.a-4">BCP 14（<xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/>および<xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/>）のキーワードを意図的に使用していません。この仕様では推奨を提供することはできますが、それを強制することはできません。</t>
      <t indent="0" pn="section-appendix.a-5">この推奨事項は、アプリケーションが固定のアルゴリズムとキー情報を1つのCOSEオブジェクトで使用するために配布している場合に適用されます。通常、これはCOSEオブジェクトの中で最も小さいもの、具体的にはCOSE_Sign1、COSE_Mac0、COSE_Encrypt0に適用されますが、他の構造にも適用できます。</t>
      <t indent="0" pn="section-appendix.a-6">次の項目に留意する必要があります:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.a-7">
        <li pn="section-appendix.a-7.1">アプリケーションは、暗黙的なアルゴリズムが使用されるCOSE構造のセットをリストアップする必要があります。アプリケーションは、これらの構造のいずれかに明示的なアルゴリズム識別子が含まれている場合、メッセージが拒否されることを要求する必要があります。この要件は、どのアルゴリズムが使用されるべきか、暗黙的なアルゴリズムか明示的なアルゴリズムかについての疑問が生じることがないように述べられています。これは、輸送されたアルゴリズム識別子が保護された属性である場合でも適用されます。また、輸送されたアルゴリズムが暗黙的なアルゴリズムと同じでも適用されます。</li>
        <li pn="section-appendix.a-7.2">アプリケーションは、アルゴリズム識別子を省略する際に、コンテキストの一部として考慮される情報のセットを定義する必要があります。最低限、これにはキー識別子（必要な場合）、キー、アルゴリズム、および使用されるCOSE構造が含まれます。アプリケーションは、単一のキーを単一のアルゴリズムに制限する必要があります。いくつかのアルゴリズムについては、異なる関連するアルゴリズムで同じキーを使用することは、キーに関する情報の漏洩、データに関する漏洩、または偽造を行う能力につながる可能性があることが<xref target="RFC9053" format="default" sectionFormat="of" derivedContent="RFC9053"/>で述べられています。</li>
        <li pn="section-appendix.a-7.3">多くの場合、アルゴリズム識別子を暗黙的にするアプリケーションは、同じ理由でコンテキスト識別子を暗黙的にしたいと思うことがあります。つまり、コンテキスト識別子を省略することでメッセージサイズが減少します（識別子の長さに応じて、大幅に減少する可能性があります）。これを行うアプリケーションでは、コンテキスト識別子が省略される状況と、これらの場合にコンテキスト識別子がどのように推論されるかを説明する必要があります（すべてのキーを網羅的に検索することは通常受け入れられないと考えられます）。これを行うための例として、コンテキストをトランザクション識別子に結び付ける方法があります。両方は元のメッセージで送信されますが、その後はトランザクション識別子だけが送信される必要があります。また、コンテキストをネットワークアドレスと関連付ける方法もあります。単一のネットワークアドレスから送信されるすべてのメッセージは特定のコンテキストに関連付けられると推定されます（この場合、アドレスは通常コンテキストの一部として配布されます）。

Note: The translation may have slight changes in formatting to fit the XML text structure.</li>
        <li pn="section-appendix.a-7.4">アプリケーションは、この保証を作成するために、キー識別子が一意であるとは依存できません（MUST）。アプリケーションがこれを実行する場合でも、異なるコンテキスト（つまり、異なるコンテキストプロバイダを使用した場合）でアプリケーションが実行されたり、システムがさまざまなアプリケーションのセキュリティーコンテキストを単一のストアに結合した場合に、一意性が侵害される可能性があります。</li>
        <li pn="section-appendix.a-7.5">アプリケーションは、アルゴリズム識別子を保護するという慣習を続けるべきです。これは、それを保護された属性フィールドに配置することで行われるものではないため、アプリケーションは、この値を含むアプリケーション固有の外部データ構造を定義する必要があります。この外部データフィールドは、コンテンツの暗号化、MAC、署名アルゴリズムに対してそれを如何に使用するかに使用できます。それは、キー値を導出するためにKDFを使用するアルゴリズムのSuppPrivInfoフィールドで使用することもできます。また、アプリケーションは、コンテキスト構造の一部である他の情報も保護したい場合があります。暗号計算で使用されるために保護されているキーや基本IVなどのフィールドは、外部データフィールドに含める必要はありません。</li>
      </ul>
      <t indent="0" pn="section-appendix.a-8">第2のケースは、複数の暗黙のアルゴリズム識別子が複数層のCOSEオブジェクトに指定されている場合です。アプリケーションが指定する暗号化コンテキストには、コンテンツ暗号化アルゴリズム、キーラップアルゴリズム、キー識別子、および共有秘密が含まれますので、これがどのように機能するかの例です。送信者は、コンテンツ層と受信者層の両方のアルゴリズム識別子を送信するのを省略し、キー識別子だけを残します。受信者はその後、キー識別子を使用して暗黙のアルゴリズム識別子を取得します。</t>
      <t indent="0" pn="section-appendix.a-9">以下の追加項目も考慮する必要があります:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.a-10">
        <li pn="section-appendix.a-10.1">このサポートを行いたいアプリケーションは、使用するキーとセカンダリレイヤーの構造およびアルゴリズムの両方を明確に特定できる構造を定義する必要があります。セカンダリレイヤーのキーは、受信者のレイヤーから通常どおり計算されます。</li>
      </ul>
      <t indent="0" pn="section-appendix.a-11">三番目のケースは、複数の暗黙のアルゴリズム識別子を持つが、おそらく関係のないレイヤーまたは異なるCOSEオブジェクトを対象としています。これは適用可能なさまざまなシナリオがあります。これらのシナリオの一部は次のとおりです：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.a-12">
        <li pn="section-appendix.a-12.1">2つのコンテキストがペアとして配布されます。それぞれのコンテキストはCOSE_Encryptメッセージと共に使用するためのものです。各コンテキストは異なる秘密鍵や初期化ベクトル（IV）を含み、場合によっては異なるアルゴリズムを用います。1つ目のコンテキストはパーティAからパーティBへのメッセージの送信に使用されます。2つ目のコンテキストはパーティBからパーティAへのメッセージの送信に使用されます。これにより、各パーティは異なる秘密鍵を使用してメッセージを送信するため、反射攻撃が発生する可能性はありません。自身に反射されたメッセージは復号化に失敗するためです。</li>
        <li pn="section-appendix.a-12.2">2つのコンテキストがペアとして配布されます。最初のコンテキストはメッセージの暗号化に使用され、2番目のコンテキストはメッセージに対して署名を行うために使用されます。目的は、2番目のコンテキストを最初のコンテキストとは独立して他のエンティティに配布することができるようにすることです。これにより、これらのエンティティはメッセージの内容を解読することなく、メッセージが個人から送信されたものであることを検証することができます。</li>
        <li pn="section-appendix.a-12.3">2つのコンテキストはペアとして分配されます。最初のコンテキストには、MACメッセージの処理に使用されるキーが含まれており、2番目のコンテキストには、暗号化メッセージの処理に使用される異なるキーが含まれています。これにより、異なるキーを持つ異なるタイプのメッセージの参加者へのキーの統一的な分配が可能となりますが、キーは調整された方法で使用することができます。</li>
      </ul>
      <t indent="0" pn="section-appendix.a-13">これらの場合には、以下の追加事項が考慮される必要があります：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.a-14">
        <li pn="section-appendix.a-14.1">アプリケーションは、複数のコンテキストが関連付けられたままであることを確保する必要があります。そのうちの1つのコンテキストが何らかの理由で無効化された場合、それに関連付けられたすべてのコンテキストも無効化されるべきです。</li>
      </ul>
    </section>
    <section anchor="three-layer" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-two-layers-of-recipient-inf">Two Layers of Recipient Information</name>
      <t indent="0" pn="section-appendix.b-1">現在定義されているすべての受信者アルゴリズムクラスは、COSE構造の2つのレイヤーのみを使用します。最初のレイヤー（COSE_Encrypt）はメッセージの内容であり、第二のレイヤー（COSE_Recipient）はコンテンツキーの暗号化です。ただし、RSA Key Encapsulation Mechanism（RSA-KEM）などの受信者アルゴリズムを使用する場合（詳細はRSA-KEMの付録Aを参照してください<xref target="RFC5990" format="default" sectionFormat="of" derivedContent="RFC5990"/>）、COSE_Recipient構造の2つのレイヤーが意味を持つことがあります。</t>
      <t indent="0" pn="section-appendix.b-2">これらのレイヤーは、以下の通りです：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-3">
        <li pn="section-appendix.b-3.1">
          <bcp14>レイヤー0：</bcp14>コンテンツ暗号化レイヤー。このレイヤーにはメッセージのペイロードが含まれています。</li>
        <li pn="section-appendix.b-3.2">レイヤー1：KEKによるCEKの暗号化。</li>
        <li pn="section-appendix.b-3.3">レイヤー2：RSAキーとキー導出関数を使用して長いランダムシークレットを暗号化し、そのシークレットをKEKに変換します。</li>
      </ul>
      <t indent="0" pn="section-appendix.b-4">これは三層メッセージの例です。読みやすくするため、バイナリーダンプではなく、拡張CBOR診断表記（<xref target="RFC8610" format="default" sectionFormat="of" derivedContent="RFC8610"/>で定義されています）を使用して表示されています。メッセージには以下の層があります：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-5">
        <li pn="section-appendix.b-5.1">レイヤー0: 128ビットのキーを使用してAES-GCMで暗号化されたコンテンツを持っています。</li>
        <li pn="section-appendix.b-5.2">レイヤー1：AES Key Wrapアルゴリズムを128ビットのキーで使用します。</li>
        <li pn="section-appendix.b-5.3">レイヤー2：ECDHエフェメラル-スタティック直接使用してレイヤー1キーを生成します。</li>
      </ul>
      <t indent="0" pn="section-appendix.b-6">実際には、この例はECDH-ES+A128KWアルゴリズムを使用した解体されたバージョンです。</t>
      <t indent="0" pn="section-appendix.b-7">バイナリーファイルのサイズは183バイトです。</t>
      <sourcecode type="cbor-diag" markers="false" pn="section-appendix.b-8">
96(
  [ / COSE_Encrypt /
    / protected h'a10101' / &lt;&lt; {
        / alg / 1:1 / AES-GCM 128 /
      } &gt;&gt;,
    / unprotected / {
      / iv / 5:h'02d1f7e6f26c43d4868d87ce'
    },
    / ciphertext / h'64f84d913ba60a76070a9a48f26e97e863e2852948658f0
811139868826e89218a75715b',
    / recipients / [
      [ / COSE_Recipient /
        / protected / h'',
        / unprotected / {
          / alg / 1:-3 / A128KW /
        },
        / ciphertext / h'dbd43c4e9d719c27c6275c67d628d493f090593db82
18f11',
        / recipients / [
          [ / COSE_Recipient /
            / protected h'a1013818' / &lt;&lt; {
                / alg / 1:-25 / ECDH-ES + HKDF-256 /
              } &gt;&gt; ,
            / unprotected / {
              / ephemeral / -1:{
                / kty / 1:2,
                / crv / -1:1,
                / x / -2:h'b2add44368ea6d641f9ca9af308b4079aeb519f11
e9b8a55a600b21233e86e68',
                / y / -3:false
              },
              / kid / 4:'meriadoc.brandybuck@buckland.example'
            },
            / ciphertext / h''
          ]
        ]
      ]
    ]
  ]
)
</sourcecode>
    </section>
    <section anchor="examples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-examples">Examples</name>
      <t indent="0" pn="section-appendix.c-1">この付録には、この文書で定義されたさまざまな機能とメッセージタイプを示す一連の例が含まれています。例を読みやすくするために、バイナリーのダンプではなく、拡張CBOR診断表記（<xref target="RFC8610" format="default" sectionFormat="of" derivedContent="RFC8610"/>で定義されている）を使用して示されます。</t>
      <t indent="0" pn="section-appendix.c-2">GitHubプロジェクトが<xref target="GitHub-Examples" format="default" sectionFormat="of" derivedContent="GitHub-Examples"/>で作成されました。このプロジェクトには、このドキュメントで提供されている例だけでなく、より完全なテスト例のセットも含まれています。各例は、例を作成するために使用される入力、例をデバッグするために使用できるいくつかの中間値、および16進ダンプとCBOR診断表記形式の両方で示される例の出力を含むJSONファイルに存在します。サイトの一部の例は、失敗テストケースとして設計されています。これらはJSONファイルで明確にマークされています。このドキュメントの例にエラーが見つかった場合、GitHub上の例は更新され、その旨の注記がJSONファイルに追加されます。</t>
      <t indent="0" pn="section-appendix.c-3">注意書きどおり、例はCBORの診断表記を使用しています。診断表記とバイナリーの変換を行うためのRubyベースのツールが存在します。このツールは次のコマンドラインでインストールすることができます：</t>
      <sourcecode type="shell" markers="false" pn="section-appendix.c-4">gem install cbor-diag</sourcecode>
      <t indent="0" pn="section-appendix.c-5">診断表記は、次のコマンドラインを使用してバイナリーファイルに変換することができます：</t>
      <sourcecode type="shell" markers="false" pn="section-appendix.c-6">diag2cbor.rb &lt; inputfile &gt; outputfile
</sourcecode>
      <t indent="0" pn="section-appendix.c-7">このドキュメントのXMLバージョンからは、XPath式を使用して例を抽出することができます。ソースコードはすべて属性type='cbor-diag'でタグ付けされています。（使用しているXPath評価ツールによっては、エンティティとして&gt;を処理する必要がある場合があります。）</t>
      <sourcecode type="xpath" markers="false" pn="section-appendix.c-8">//sourcecode[@type='cbor-diag']/text()</sourcecode>
      <section anchor="SignedExamples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.1">
        <name slugifiedName="name-examples-of-signed-messages">Examples of Signed Messages</name>
        <section anchor="Appendix_B_1_1" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.1.1">
          <name slugifiedName="name-single-signature">Single Signature</name>
          <t indent="0" pn="section-appendix.c.1.1-1">この例では、以下を使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.1.1-2">
            <li pn="section-appendix.c.1.1-2.1">署名アルゴリズム：ECDSA w/ SHA-256、Curve P-256</li>
          </ul>
          <t indent="0" pn="section-appendix.c.1.1-3">バイナリーファイルのサイズは103バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.1.1-4">
98(
  [
    / protected / h'',
    / unprotected / {},
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected h'a10126' / &lt;&lt; {
            / alg / 1:-7 / ECDSA 256 /
          } &gt;&gt;,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'e2aeafd40d69d19dfe6e52077c5d7ff4e408282cbefb
5d06cbf414af2e19d982ac45ac98b8544c908b4507de1e90b717c3d34816fe926a2b
98f53afd2fa0f30a'
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_1_2" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.1.2">
          <name slugifiedName="name-multiple-signers">Multiple Signers</name>
          <t indent="0" pn="section-appendix.c.1.2-1">この例では、以下を使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.1.2-2">
            <li pn="section-appendix.c.1.2-2.1">Signature Algorithm: ECDSA w/ SHA-256, Curve P-256

署名アルゴリズム: ECDSA w/ SHA-256、楕円曲線P-256</li>
            <li pn="section-appendix.c.1.2-2.2">シグネチャアルゴリズム：ECDSA w/ SHA-512、カーブ P-521</li>
          </ul>
          <t indent="0" pn="section-appendix.c.1.2-3">バイナリーファイルのサイズは277バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.1.2-4">
98(
  [
    / protected / h'',
    / unprotected / {},
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected h'a10126' / &lt;&lt; {
            / alg / 1:-7 / ECDSA 256 /
          } &gt;&gt;,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'e2aeafd40d69d19dfe6e52077c5d7ff4e408282cbefb
5d06cbf414af2e19d982ac45ac98b8544c908b4507de1e90b717c3d34816fe926a2b
98f53afd2fa0f30a'
      ],
      [
        / protected h'a1013823' / &lt;&lt; {
            / alg / 1:-36 / ECDSA 521 /
          } &gt;&gt; ,
        / unprotected / {
          / kid / 4:'bilbo.baggins@hobbiton.example'
        },
        / signature / h'00a2d28a7c2bdb1587877420f65adf7d0b9a06635dd1
de64bb62974c863f0b160dd2163734034e6ac003b01e8705524c5c4ca479a952f024
7ee8cb0b4fb7397ba08d009e0c8bf482270cc5771aa143966e5a469a09f613488030
c5b07ec6d722e3835adb5b2d8c44e95ffb13877dd2582866883535de3bb03d01753f
83ab87bb4f7a0297'
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_1_4" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.1.3">
          <name slugifiedName="name-signature-with-criticality">Signature with Criticality</name>
          <t indent="0" pn="section-appendix.c.1.3-1">この例では、以下のものを使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.1.3-2">
            <li pn="section-appendix.c.1.3-2.1">署名アルゴリズム：ECDSA w/ SHA-256、Curve P-256</li>
            <li pn="section-appendix.c.1.3-2.2">「予約済み」ヘッダーパラメーターには、重要度マーカーがあります。</li>
          </ul>
          <t indent="0" pn="section-appendix.c.1.3-3">バイナリーファイルのサイズは125バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.1.3-4">
98(
  [
    / protected h'a2687265736572766564f40281687265736572766564' /
    &lt;&lt; {
        "reserved":false,
        / crit / 2:[
          "reserved"
        ]
      } &gt;&gt;,
    / unprotected / {},
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected h'a10126' / &lt;&lt; {
            / alg / 1:-7 / ECDSA 256 /
          } &gt;&gt;,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'3fc54702aa56e1b2cb20284294c9106a63f91bac658d
69351210a031d8fc7c5ff3e4be39445b1a3e83e1510d1aca2f2e8a7c081c7645042b
18aba9d1fad1bd9c'
      ]
    ]
  ]
)
</sourcecode>
        </section>
      </section>
      <section anchor="Sign1_Examples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.2">
        <name slugifiedName="name-single-signer-examples">Single Signer Examples</name>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.2.1">
          <name slugifiedName="name-single-ecdsa-signature">Single ECDSA Signature</name>
          <t indent="0" pn="section-appendix.c.2.1-1">この例では、次のものを使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.2.1-2">
            <li pn="section-appendix.c.2.1-2.1">署名アルゴリズム：ECDSA（SHA-256）, カーブ P-256</li>
          </ul>
          <t indent="0" pn="section-appendix.c.2.1-3">バイナリーファイルのサイズは98バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.2.1-4">
18(
  [
    / protected h'a10126' / &lt;&lt; {
        / alg / 1:-7 / ECDSA 256 /
      } &gt;&gt;,
    / unprotected / {
      / kid / 4:'11'
    },
    / payload / 'This is the content.',
    / signature / h'8eb33e4ca31d1c465ab05aac34cc6b23d58fef5c083106c4
d25a91aef0b0117e2af9a291aa32e14ab834dc56ed2a223444547e01f11d3b0916e5
a4c345cacb36'
  ]
)
</sourcecode>
        </section>
      </section>
      <section anchor="EnvelopedExamples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.3">
        <name slugifiedName="name-examples-of-enveloped-messa">Examples of Enveloped Messages</name>
        <section anchor="Appendix_B_3_1" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.3.1">
          <name slugifiedName="name-direct-ecdh">Direct ECDH</name>
          <t indent="0" pn="section-appendix.c.3.1-1">この例では、以下のものを使用します:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.3.1-2">
            <li pn="section-appendix.c.3.1-2.1">CEK: AES-GCM 128ビットキーで</li>
            <li pn="section-appendix.c.3.1-2.2">受信者クラス：ECDH Ephemeral-Static、曲線P-256</li>
          </ul>
          <t indent="0" pn="section-appendix.c.3.1-3">バイナリーファイルのサイズは151バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.3.1-4">
96(
  [
    / protected h'a10101' / &lt;&lt; {
        / alg / 1:1 / AES-GCM 128 /
      } &gt;&gt;,
    / unprotected / {
      / iv / 5:h'c9cf4df2fe6c632bf7886413'
    },
    / ciphertext / h'7adbe2709ca818fb415f1e5df66f4e1a51053ba6d65a1a0
c52a357da7a644b8070a151b0',
    / recipients / [
      [
        / protected h'a1013818' / &lt;&lt; {
            / alg / 1:-25 / ECDH-ES + HKDF-256 /
          } &gt;&gt;,
        / unprotected / {
          / ephemeral / -1:{
            / kty / 1:2,
            / crv / -1:1,
            / x / -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbf
bf054e1c7b4d91d6280',
            / y / -3:true
          },
          / kid / 4:'meriadoc.brandybuck@buckland.example'
        },
        / ciphertext / h''
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_3_2" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.3.2">
          <name slugifiedName="name-direct-plus-key-derivation">Direct Plus Key Derivation</name>
          <t indent="0" pn="section-appendix.c.3.2-1">この例では、以下のものを使用します。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.3.2-2">
            <li pn="section-appendix.c.3.2-2.1">CEK: AES-CCMにより128ビットキーで、タグを64ビットに切り詰めます。</li>
            <li pn="section-appendix.c.3.2-2.2">
              <t indent="0" pn="section-appendix.c.3.2-2.2.1">受信者クラス: 以下の暗黙のフィールドを含む共有秘密に対してHKDFを使用し、コンテキストの一部とする。</t>
              <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.3.2-2.2.2">
                <li pn="section-appendix.c.3.2-2.2.2.1">salt: "aabbccddeeffgghh"</li>
                <li pn="section-appendix.c.3.2-2.2.2.2">PartyU identity: "lighting-client"</li>
                <li pn="section-appendix.c.3.2-2.2.2.3">PartyV identity: "lighting-server"</li>
                <li pn="section-appendix.c.3.2-2.2.2.4">Supplementary Public Other: "Encryption Example 02"</li>
              </ul>
            </li>
          </ul>
          <t indent="0" pn="section-appendix.c.3.2-3">バイナリーファイルのサイズは91バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.3.2-4">
96(
  [
    / protected h'a1010a' / &lt;&lt; {
        / alg / 1:10 / AES-CCM-16-64-128 /
      } &gt;&gt;,
    / unprotected / {
      / iv / 5:h'89f52f65a1c580933b5261a76c'
    },
    / ciphertext / h'753548a19b1307084ca7b2056924ed95f2e3b17006dfe93
1b687b847',
    / recipients / [
      [
        / protected h'a10129' / &lt;&lt; {
            / alg / 1:-10
          } &gt;&gt;,
        / unprotected / {
          / salt / -20:'aabbccddeeffgghh',
          / kid / 4:'our-secret'
        },
        / ciphertext / h''
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_3_4" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.3.3">
          <name slugifiedName="name-encrypted-content-with-exte">Encrypted Content with External Data</name>
          <t indent="0" pn="section-appendix.c.3.3-1">この例では、以下のものを使用します。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.3.3-2">
            <li pn="section-appendix.c.3.3-2.1">CEK: AES-GCM 128ビット鍵を使用</li>
            <li pn="section-appendix.c.3.3-2.2">受信者クラス：ECDH Static-Static、Curve P-256とAES Key Wrap</li>
            <li pn="section-appendix.c.3.3-2.3">外部から供給されたAAD: h'0011bbcc22dd44ee55ff660077'</li>
          </ul>
          <t indent="0" pn="section-appendix.c.3.3-3">バイナリーファイルのサイズは173バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.3.3-4">
96(
  [
    / protected h'a10101' / &lt;&lt; {
        / alg / 1:1 / AES-GCM 128 /
      } &gt;&gt; ,
    / unprotected / {
      / iv / 5:h'02d1f7e6f26c43d4868d87ce'
    },
    / ciphertext / h'64f84d913ba60a76070a9a48f26e97e863e28529d8f5335
e5f0165eee976b4a5f6c6f09d',
    / recipients / [
      [
        / protected / h'a101381f' / {
            \ alg \ 1:-32 \ ECDH-SS+A128KW \
          } / ,
        / unprotected / {
          / static kid / -3:'peregrin.took@tuckborough.example',
          / kid / 4:'meriadoc.brandybuck@buckland.example',
          / U nonce / -22:h'0101'
        },
        / ciphertext / h'41e0d76f579dbd0d936a662d54d8582037de2e366fd
e1c62'
      ]
    ]
  ]
)
</sourcecode>
        </section>
      </section>
      <section anchor="EncryptExamples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.4">
        <name slugifiedName="name-examples-of-encrypted-messa">Examples of Encrypted Messages</name>
        <section anchor="Appendix_B_4_1" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.4.1">
          <name slugifiedName="name-simple-encrypted-message">Simple Encrypted Message</name>
          <t indent="0" pn="section-appendix.c.4.1-1">この例では、以下のものを使用します:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.4.1-2">
            <li pn="section-appendix.c.4.1-2.1">CEK: AES-CCM の 128 ビットキーおよび 64 ビットのタグ</li>
          </ul>
          <t indent="0" pn="section-appendix.c.4.1-3">バイナリーファイルのサイズは52バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.4.1-4">
16(
  [
    / protected h'a1010a' / &lt;&lt; {
        / alg / 1:10 / AES-CCM-16-64-128 /
      } &gt;&gt; ,
    / unprotected / {
      / iv / 5:h'89f52f65a1c580933b5261a78c'
    },
    / ciphertext / h'5974e1b99a3a4cc09a659aa2e9e7fff161d38ce71cb45ce
460ffb569'
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_4_2" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.4.2">
          <name slugifiedName="name-encrypted-message-with-a-pa">Encrypted Message with a Partial IV</name>
          <t indent="0" pn="section-appendix.c.4.2-1">この例では、以下を使用します。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.4.2-2">
            <li pn="section-appendix.c.4.2-2.1">CEK: 128ビットキーおよび64ビットタグを使用したAES-CCM</li>
            <li pn="section-appendix.c.4.2-2.2">IVの接頭辞は89F52F65A1C580933B52です。</li>
          </ul>
          <t indent="0" pn="section-appendix.c.4.2-3">バイナリーファイルのサイズは41バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.4.2-4">
16(
  [
    / protected h'a1010a' / &lt;&lt; {
        / alg / 1:10 / AES-CCM-16-64-128 /
      } &gt;&gt; ,
    / unprotected / {
      / partial iv / 6:h'61a7'
    },
    / ciphertext / h'252a8911d465c125b6764739700f0141ed09192de139e05
3bd09abca'
  ]
)
</sourcecode>
        </section>
      </section>
      <section anchor="MacExamples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5">
        <name slugifiedName="name-examples-of-maced-messages">Examples of MACed Messages</name>
        <section anchor="Appendix_B_5_1" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5.1">
          <name slugifiedName="name-shared-secret-direct-mac">Shared Secret Direct MAC</name>
          <t indent="0" pn="section-appendix.c.5.1-1">この例では、次のものを使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.5.1-2">
            <li pn="section-appendix.c.5.1-2.1">MAC: AES-CMAC、256ビット鍵、64ビットに切り詰めます。</li>
            <li pn="section-appendix.c.5.1-2.2">受信者クラス：直接共有シークレット</li>
          </ul>
          <t indent="0" pn="section-appendix.c.5.1-3">バイナリーファイルのサイズは57バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.5.1-4">
97(
  [
    / protected h'a1010f' / &lt;&lt; {
        / alg / 1:15 / AES-CBC-MAC-256//64 /
      } &gt;&gt; ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'9e1226ba1f81b848',
    / recipients / [
      [
        / protected / h'',
        / unprotected / {
          / alg / 1:-6 / direct /,
          / kid / 4:'our-secret'
        },
        / ciphertext / h''
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_5_2" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5.2">
          <name slugifiedName="name-ecdh-direct-mac">ECDH Direct MAC</name>
          <t indent="0" pn="section-appendix.c.5.2-1">この例では、次のものを使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.5.2-2">
            <li pn="section-appendix.c.5.2-2.1">MAC: HMAC w/SHA-256, 256-bit key

MAC: HMAC w/SHA-256、256ビットの鍵</li>
            <li pn="section-appendix.c.5.2-2.2">受信者クラス：ECDH鍵合意、2つの静的鍵、コンテキスト構造におけるHKDF</li>
          </ul>
          <t indent="0" pn="section-appendix.c.5.2-3">バイナリーファイルのサイズは214バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.5.2-4">
97(
  [
    / protected h'a10105' / &lt;&lt; {
        / alg / 1:5 / HMAC 256//256 /
      } &gt;&gt; ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'81a03448acd3d305376eaa11fb3fe416a955be2cbe7ec96f012c99
4bc3f16a41',
    / recipients / [
      [
        / protected h'a101381a' / &lt;&lt; {
            / alg / 1:-27 / ECDH-SS + HKDF-256 /
          } &gt;&gt; ,
        / unprotected / {
          / static kid / -3:'peregrin.took@tuckborough.example',
          / kid / 4:'meriadoc.brandybuck@buckland.example',
          / U nonce / -22:h'4d8553e7e74f3c6a3a9dd3ef286a8195cbf8a23d
19558ccfec7d34b824f42d92bd06bd2c7f0271f0214e141fb779ae2856abf585a583
68b017e7f2a9e5ce4db5'
        },
        / ciphertext / h''
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_5_3" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5.3">
          <name slugifiedName="name-wrapped-mac">Wrapped MAC</name>
          <t indent="0" pn="section-appendix.c.5.3-1">この例では、以下を使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.5.3-2">
            <li pn="section-appendix.c.5.3-2.1">MAC: AES-MAC、128ビットキー、64ビットに切り詰められます</li>
            <li pn="section-appendix.c.5.3-2.2">受信者クラス：AES Key Wrap w/ プリ共有 256 ビットキー</li>
          </ul>
          <t indent="0" pn="section-appendix.c.5.3-3">バイナリーファイルのサイズは109バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.5.3-4">
97(
  [
    / protected h'a1010e' / &lt;&lt; {
        / alg / 1:14 / AES-CBC-MAC-128//64 /
      } &gt;&gt; ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'36f5afaf0bab5d43',
    / recipients / [
      [
        / protected / h'',
        / unprotected / {
          / alg / 1:-5 / A256KW /,
          / kid / 4:'018c0ae5-4d9b-471b-bfd6-eef314bc7037'
        },
        / ciphertext / h'711ab0dc2fc4585dce27effa6781c8093eba906f227
b6eb0'
      ]
    ]
  ]
)
</sourcecode>
        </section>
        <section anchor="Appendix_B_5_4" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.5.4">
          <name slugifiedName="name-multi-recipient-maced-messa">Multi-Recipient MACed Message</name>
          <t indent="0" pn="section-appendix.c.5.4-1">この例では、以下を使用します：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.5.4-2">
            <li pn="section-appendix.c.5.4-2.1">MAC: HMAC（キー長128ビット）を使用したSHA-256</li>
            <li pn="section-appendix.c.5.4-2.2">
              <t indent="0" pn="section-appendix.c.5.4-2.2.1">受信者クラス：2つの異なる方法を使用します。
              </t>
              <ol type="1" indent="adaptive" spacing="normal" start="1" pn="section-appendix.c.5.4-2.2.2">
                      <li pn="section-appendix.c.5.4-2.2.2.1" derivedCounter="1.">ECDHエフェメラル-スタティック、カーブP-521、AESキーラップ（128ビットキー）</li>
                <li pn="section-appendix.c.5.4-2.2.2.2" derivedCounter="2.">AESキーラップ（256ビットキー）</li>
              </ol>
            </li>
          </ul>
          <t indent="0" pn="section-appendix.c.5.4-3">バイナリーファイルのサイズは309バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.5.4-4">
97(
  [
    / protected h'a10105' / &lt;&lt; {
        / alg / 1:5 / HMAC 256//256 /
      } &gt;&gt; ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'bf48235e809b5c42e995f2b7d5fa13620e7ed834e337f6aa43df16
1e49e9323e',
    / recipients / [
      [
        / protected h'a101381c' / &lt;&lt; {
            / alg / 1:-29 / ECDH-ES+A128KW /
          } &gt;&gt; ,
        / unprotected / {
          / ephemeral / -1:{
            / kty / 1:2,
            / crv / -1:3,
            / x / -2:h'0043b12669acac3fd27898ffba0bcd2e6c366d53bc4db
71f909a759304acfb5e18cdc7ba0b13ff8c7636271a6924b1ac63c02688075b55ef2
d613574e7dc242f79c3',
            / y / -3:true
          },
          / kid / 4:'bilbo.baggins@hobbiton.example'
        },
        / ciphertext / h'339bc4f79984cdc6b3e6ce5f315a4c7d2b0ac466fce
a69e8c07dfbca5bb1f661bc5f8e0df9e3eff5'
      ],
      [
        / protected / h'',
        / unprotected / {
          / alg / 1:-5 / A256KW /,
          / kid / 4:'018c0ae5-4d9b-471b-bfd6-eef314bc7037'
        },
        / ciphertext / h'0b2c7cfce04e98276342d6476a7723c090dfdd15f9a
518e7736549e998370695e6d6a83b4ae507bb'
      ]
    ]
  ]
)
</sourcecode>
        </section>
      </section>
      <section anchor="Mac0Examples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.6">
        <name slugifiedName="name-examples-of-mac0-messages">Examples of MAC0 Messages</name>
        <section anchor="Appendix_B_6_1" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.6.1">
          <name slugifiedName="name-shared-secret-direct-mac-2">Shared-Secret Direct MAC</name>
          <t indent="0" pn="section-appendix.c.6.1-1">この例では次のものが使用されます：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.6.1-2">
            <li pn="section-appendix.c.6.1-2.1">MAC：AES-CMAC、256ビットのキー、64ビットに切り詰められます。</li>
            <li pn="section-appendix.c.6.1-2.2">受信者クラス：直接共有秘密</li>
          </ul>
          <t indent="0" pn="section-appendix.c.6.1-3">バイナリーファイルのサイズは37バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.6.1-4">
17(
  [
    / protected h'a1010f' / &lt;&lt; {
        / alg / 1:15 / AES-CBC-MAC-256//64 /
      } &gt;&gt; ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'726043745027214f'
  ]
)
</sourcecode>
          <t indent="0" pn="section-appendix.c.6.1-5">この例では、<xref target="Appendix_B_5_1" format="default" sectionFormat="of" derivedContent="Appendix C.5.1"/> と同じ入力を使用しています。</t>
        </section>
      </section>
      <section anchor="COSE_KEYS" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.7">
        <name slugifiedName="name-cose-keys">COSE Keys</name>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.7.1">
          <name slugifiedName="name-public-keys">Public Keys</name>
          <t indent="0" pn="section-appendix.c.7.1-1">これはCOSEキーセットの例です。この例には、以前のすべての例の公開キーが含まれています。</t>
          <t indent="0" pn="section-appendix.c.7.1-2">順番に言うと、以下のキーワードです:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.7.1-3">
            <li pn="section-appendix.c.7.1-3.1">「meriadoc.brandybuck@buckland.example」というkidを持つECキー</li>
            <li pn="section-appendix.c.7.1-3.2">"11"というkidを持つECキー</li>
            <li pn="section-appendix.c.7.1-3.3">こちらはXMLテキストですので、以下の英文を日本語に翻訳いたします：

「kidが「bilbo.baggins@hobbiton.example」であるECキー」</li>
            <li pn="section-appendix.c.7.1-3.4">キーIDが「peregrin.took@tuckborough.example」のECキー</li>
          </ul>
          <t indent="0" pn="section-appendix.c.7.1-4">バイナリーファイルのサイズは481バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.7.1-5">
[
  {
    -1:1,
    -2:h'65eda5a12577c2bae829437fe338701a10aaa375e1bb5b5de108de439c0
8551d',
    -3:h'1e52ed75701163f7f9e40ddf9f341b3dc9ba860af7e0ca7ca7e9eecd008
4d19c',
    1:2,
    2:'meriadoc.brandybuck@buckland.example'
  },
  {
    -1:1,
    -2:h'bac5b11cad8f99f9c72b05cf4b9e26d244dc189f745228255a219a86d6a
09eff',
    -3:h'20138bf82dc1b6d562be0fa54ab7804a3a64b6d72ccfed6b6fb6ed28bbf
c117e',
    1:2,
    2:'11'
  },
  {
    -1:3,
    -2:h'0072992cb3ac08ecf3e5c63dedec0d51a8c1f79ef2f82f94f3c737bf5de
7986671eac625fe8257bbd0394644caaa3aaf8f27a4585fbbcad0f2457620085e5c8
f42ad',
    -3:h'01dca6947bce88bc5790485ac97427342bc35f887d86d65a089377e247e
60baa55e4e8501e2ada5724ac51d6909008033ebc10ac999b9d7f5cc2519f3fe1ea1
d9475',
    1:2,
    2:'bilbo.baggins@hobbiton.example'
  },
  {
    -1:1,
    -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbfbf054e1c7b4d91
d6280',
    -3:h'f01400b089867804b8e9fc96c3932161f1934f4223069170d924b7e03bf
822bb',
    1:2,
    2:'peregrin.took@tuckborough.example'
  }
]
</sourcecode>
        </section>
        <section numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c.7.2">
          <name slugifiedName="name-private-keys">Private Keys</name>
          <t indent="0" pn="section-appendix.c.7.2-1">これはCOSEキーセットの例です。この例には、以前のすべての例の秘密鍵が含まれています。</t>
          <t indent="0" pn="section-appendix.c.7.2-2">キーは次のとおりです。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.c.7.2-3">
            <li pn="section-appendix.c.7.2-3.1">"meriadoc.brandybuck@buckland.example" という kid の EC キー</li>
            <li pn="section-appendix.c.7.2-3.2">「kid」が「11」のECキー</li>
            <li pn="section-appendix.c.7.2-3.3">「bilbo.baggins@hobbiton.example」というkidを持つECキー」</li>
            <li pn="section-appendix.c.7.2-3.4">「our-secret」というkidを持つ共有秘密鍵</li>
            <li pn="section-appendix.c.7.2-3.5">kidが「peregrin.took@tuckborough.example」のECキー</li>
            <li pn="section-appendix.c.7.2-3.6">キッドが「our-secret2」の共有秘密鍵</li>
            <li pn="section-appendix.c.7.2-3.7">A shared-secret key with a kid of "018c0ae5-4d9b-471b-bfd6-eef314bc7037"

"018c0ae5-4d9b-471b-bfd6-eef314bc7037" というkidを持つ共有秘密鍵</li>
          </ul>
          <t indent="0" pn="section-appendix.c.7.2-4">バイナリーファイルのサイズは816バイトです。</t>
          <sourcecode type="cbor-diag" markers="false" pn="section-appendix.c.7.2-5">
[
  {
    1:2,
    2:'meriadoc.brandybuck@buckland.example',
    -1:1,
    -2:h'65eda5a12577c2bae829437fe338701a10aaa375e1bb5b5de108de439c0
8551d',
    -3:h'1e52ed75701163f7f9e40ddf9f341b3dc9ba860af7e0ca7ca7e9eecd008
4d19c',
    -4:h'aff907c99f9ad3aae6c4cdf21122bce2bd68b5283e6907154ad911840fa
208cf'
  },
  {
    1:2,
    2:'11',
    -1:1,
    -2:h'bac5b11cad8f99f9c72b05cf4b9e26d244dc189f745228255a219a86d6a
09eff',
    -3:h'20138bf82dc1b6d562be0fa54ab7804a3a64b6d72ccfed6b6fb6ed28bbf
c117e',
    -4:h'57c92077664146e876760c9520d054aa93c3afb04e306705db609030850
7b4d3'
  },
  {
    1:2,
    2:'bilbo.baggins@hobbiton.example',
    -1:3,
    -2:h'0072992cb3ac08ecf3e5c63dedec0d51a8c1f79ef2f82f94f3c737bf5de
7986671eac625fe8257bbd0394644caaa3aaf8f27a4585fbbcad0f2457620085e5c8
f42ad',
    -3:h'01dca6947bce88bc5790485ac97427342bc35f887d86d65a089377e247e
60baa55e4e8501e2ada5724ac51d6909008033ebc10ac999b9d7f5cc2519f3fe1ea1
d9475',
    -4:h'00085138ddabf5ca975f5860f91a08e91d6d5f9a76ad4018766a476680b
55cd339e8ab6c72b5facdb2a2a50ac25bd086647dd3e2e6e99e84ca2c3609fdf177f
eb26d'
  },
  {
    1:4,
    2:'our-secret',
    -1:h'849b57219dae48de646d07dbb533566e976686457c1491be3a76dcea6c4
27188'
  },
  {
    1:2,
    -1:1,
    2:'peregrin.took@tuckborough.example',
    -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbfbf054e1c7b4d91
d6280',
    -3:h'f01400b089867804b8e9fc96c3932161f1934f4223069170d924b7e03bf
822bb',
    -4:h'02d1f7e6f26c43d4868d87ceb2353161740aacf1f7163647984b522a848
df1c3'
  },
  {
    1:4,
    2:'our-secret2',
    -1:h'849b5786457c1491be3a76dcea6c4271'
  },
  {
    1:4,
    2:'018c0ae5-4d9b-471b-bfd6-eef314bc7037',
    -1:h'849b57219dae48de646d07dbb533566e976686457c1491be3a76dcea6c4
27188'
  }
]
</sourcecode>
        </section>
      </section>
    </section>
    <section numbered="false" removeInRFC="false" toc="include" pn="section-appendix.d">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.d-1">このドキュメントは、IETFのCOSEワーキンググループの成果物です。</t>
      <t indent="0" pn="section-appendix.d-2">最初にこのプロジェクトを始めさせたのは、次の個人です：<contact fullname="Richard Barnes"/>、<contact fullname="Matt Miller"/>、および<contact fullname="Martin Thomson"/>。</t>
      <t indent="0" pn="section-appendix.d-3">仕様の初期草案のバージョンは、一部はJOSEおよびS/MIME Working Groupsの成果に基づいていました。</t>
      <t indent="0" pn="section-appendix.d-4">次の個人が文書の最終形式への入力を提供しました： <contact fullname="Carsten Bormann"/>、 <contact fullname="John Bradley"/>、 <contact fullname="Brian Campbell"/>、 <contact fullname="Michael B. Jones"/>、 <contact fullname="Ilari Liusvaara"/>、 <contact fullname="Francesca Palombini"/>、 <contact fullname="Ludwig Seitz"/>、および<contact fullname="Göran Selander"/>。</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.e">
      <name slugifiedName="name-authors-address">Author's Address</name>
      <author initials="J." surname="Schaad" fullname="Jim Schaad">
        <organization showOnFrontPage="true">August Cellars</organization>
        <address>

      </address>
      </author>
    </section>
  </back>
</rfc>
