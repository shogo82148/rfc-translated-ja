<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" docName="draft-ietf-cose-msg-24" indexInclude="true" number="8152" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-cose-msg-24" rel="prev"/>
<link href="https://dx.doi.org/10.17487/rfc8152" rel="alternate"/>
  <front>
    <title>CBORオブジェクト署名および暗号化（COSE）</title>
    <seriesInfo name="RFC" value="8152" stream="IETF"/>
    <date year="2017" month="July"/>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">Concise Binary Object Representation（CBOR）は、コードサイズやメッセージサイズが小さくなるように設計されたデータ形式です。このデータ形式に基本的なセキュリティーサービスを定義する必要があります。この文書では、CBORオブジェクト署名および暗号化（COSE）プロトコルを定義します。この仕様書では、CBORをシリアライズに使用して署名、メッセージ認証コード、および暗号化を作成および処理する方法について説明します。さらに、この仕様書では、CBORを使用して暗号鍵を表現する方法についても説明します。</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">このメモのステータス</name>
        <t indent="0" pn="section-boilerplate.1.1">これはインターネット標準トラックの文書です。</t>
        <t indent="0" pn="section-boilerplate.1.2">この文書は、インターネットエンジニアリングタスクフォース（IETF）の成果です。IETFコミュニティの合意を代表しています。公開レビューを受け、インターネットエンジニアリングステアリンググループ（IESG）によって公開が承認されました。インターネット標準に関する詳細な情報は、RFC 7841のセクション2で入手できます。</t>
        <t indent="0" pn="section-boilerplate.1.3">このドキュメントの現在のステータス、誤り情報、およびフィードバックの提供方法に関する情報は、http://www.rfc-editor.org/info/rfc8152で入手できる場合があります。</t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">著作権表示</name>
        <t indent="0" pn="section-boilerplate.2-1">著作権（c）2017 IETF Trustおよびドキュメントの著者として識別された個人。全著作権所有。</t>
        <t indent="0" pn="section-boilerplate.2-2">このドキュメントは、このドキュメントの公開日に有効なBCP 78およびIETF文書に関連するIETFトラストの法的規定（http://trustee.ietf.org/license-info）の対象です。このドキュメントに関連するあなたの権利と制限については、これらの文書を注意深く確認してください。このドキュメントから抽出されたコードコンポーネントは、Trust Legal Provisionsのセクション4.eで説明されているように、Simplified BSD Licenseのテキストを含める必要があり、Simplified BSD Licenseで説明されているように保証なしで提供されます。</t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">目次</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">導入</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
            <li pn="section-toc.1-1.1.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-design-changes-from-jose">JOSEからのデザイン変更</xref></t>
            </li>
            <li pn="section-toc.1-1.1.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1"><xref derivedContent="1.2" format="counter" sectionFormat="of" target="section-1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-terminology">要件用語</xref></t>
            </li>
            <li pn="section-toc.1-1.1.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.3.1"><xref derivedContent="1.3" format="counter" sectionFormat="of" target="section-1.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-grammar">CBORの文法</xref></t>
            </li>
            <li pn="section-toc.1-1.1.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.4.1"><xref derivedContent="1.4" format="counter" sectionFormat="of" target="section-1.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-related-terminology">CBOR関連用語</xref></t>
            </li>
            <li pn="section-toc.1-1.1.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.5.1"><xref derivedContent="1.5" format="counter" sectionFormat="of" target="section-1.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-document-terminology">ドキュメント用語</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-basic-cose-structure">基本的なCOSE構造</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-parameters">ヘッダーパラメーター</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
            <li pn="section-toc.1-1.3.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-common-cose-headers-parameters">Common COSE Headers Parameters</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-objects">オブジェクトの署名</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
            <li pn="section-toc.1-1.4.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-with-one-or-more-signers">1つ以上の署名者で署名します。</xref></t>
            </li>
            <li pn="section-toc.1-1.4.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-with-one-signer">１つの署名者での署名</xref></t>
            </li>
            <li pn="section-toc.1-1.4.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-externally-supplied-data">外部から提供されたデータ</xref></t>
            </li>
            <li pn="section-toc.1-1.4.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-and-verification-process">署名および検証プロセス</xref></t>
            </li>
            <li pn="section-toc.1-1.4.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.4.5.1"><xref derivedContent="4.5" format="counter" sectionFormat="of" target="section-4.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-computing-counter-signatures">コンピューティングカウンターサインはします</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-encryption-objects">暗号化オブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
            <li pn="section-toc.1-1.5.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-enveloped-cose-structure">暗号化されたCOSE構造</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.1.2">
              <li pn="section-toc.1-1.5.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.1.1.1"><xref derivedContent="5.1.1" format="counter" sectionFormat="of" target="section-5.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-content-key-distribution-methods">コンテンツのキー分配方法</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.5.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-recipient-encrypted">単一受信者暗号化</xref></t>
            </li>
            <li pn="section-toc.1-1.5.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-how-to-encrypt-and-decrypt-for-aead-algorithms">AEADアルゴリズムの暗号化と復号化の方法</xref></t>
            </li>
            <li pn="section-toc.1-1.5.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.5.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-how-to-encrypt-and-decrypt-for-ae-algorithms">AEアルゴリズムの暗号化と復号化の方法</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-mac-objects">MACオブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
            <li pn="section-toc.1-1.6.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-maced-message-with-recipients">MACed Message with Recipients</xref></t>
            </li>
            <li pn="section-toc.1-1.6.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-maced-messages-with-implicit-key">MAC付きのメッセージ、暗黙のキー</xref></t>
            </li>
            <li pn="section-toc.1-1.6.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.6.3.1"><xref derivedContent="6.3" format="counter" sectionFormat="of" target="section-6.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-how-to-compute-and-verify-a-mac">MACを計算し、検証する方法</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-objects">キーオブジェクト</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
            <li pn="section-toc.1-1.7.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.7.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-common-parameters">COSE鍵共通パラメーター</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signature-algorithms">署名アルゴリズム</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
            <li pn="section-toc.1-1.8.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ecdsa">ECDSA</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.1.2">
              <li pn="section-toc.1-1.8.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.1.1.1"><xref derivedContent="8.1.1" format="counter" sectionFormat="of" target="section-8.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.8.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-edwards-curve-digital-signature-algorithms-(eddsas)">Edwards-Curve Digital Signature Algorithms (EdDSAs)</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.2.1" format="counter" sectionFormat="of" target="section-8.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-message-authentication-code-(mac)-algorithms">Message Authentication Code (MAC) Algorithms</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2">
            <li pn="section-toc.1-1.9.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.9.1.1"><xref derivedContent="9.1" format="counter" sectionFormat="of" target="section-9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hash-based-message-authentication-codes-(hmacs)">Hash-Based Message Authentication Codes (HMACs)</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.1.2">
              <li pn="section-toc.1-1.9.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.9.1.1.1"><xref derivedContent="9.1.1" format="counter" sectionFormat="of" target="section-9.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.9.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.9.2.1"><xref derivedContent="9.2" format="counter" sectionFormat="of" target="section-9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-aes-message-authentication-code-(aes-cbc-mac)">AES Message Authentication Code (AES-CBC-MAC)</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2.2">
              <li pn="section-toc.1-1.9.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.9.2.1.1"><xref derivedContent="9.2.1" format="counter" sectionFormat="of" target="section-9.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-content-encryption-algorithms">コンテンツの暗号化アルゴリズム</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.2">
            <li pn="section-toc.1-1.10.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.1.1"><xref derivedContent="10.1" format="counter" sectionFormat="of" target="section-10.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-aes-gcm">AES GCM</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.1.2">
              <li pn="section-toc.1-1.10.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.1.1.1"><xref derivedContent="10.1.1" format="counter" sectionFormat="of" target="section-10.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.10.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.2.1"><xref derivedContent="10.2" format="counter" sectionFormat="of" target="section-10.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-aes-ccm">AES CCM</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.2.2">
              <li pn="section-toc.1-1.10.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.2.1.1"><xref derivedContent="10.2.1" format="counter" sectionFormat="of" target="section-10.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.10.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.3.1"><xref derivedContent="10.3" format="counter" sectionFormat="of" target="section-10.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-chacha20-and-poly1305">ChaCha20とPoly1305</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.3.2">
              <li pn="section-toc.1-1.10.3.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.10.3.1.1"><xref derivedContent="10.3.1" format="counter" sectionFormat="of" target="section-10.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-derivation-functions-(kdfs)">Key Derivation Functions (KDFs)</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
            <li pn="section-toc.1-1.11.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.11.1.1"><xref derivedContent="11.1" format="counter" sectionFormat="of" target="section-11.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hmac-based-extract-and-expand-key-derivation-function-(hkdf)">HMAC-Based Extract-and-Expand Key Derivation Function (HKDF)</xref></t>
            </li>
            <li pn="section-toc.1-1.11.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.11.2.1"><xref derivedContent="11.2" format="counter" sectionFormat="of" target="section-11.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-context-information-structure">コンテキスト情報構造</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-content-key-distribution-methods">コンテンツのキー分配方法</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.2">
            <li pn="section-toc.1-1.12.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.1.1"><xref derivedContent="12.1" format="counter" sectionFormat="of" target="section-12.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-encryption">直接暗号化</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.1.2">
              <li pn="section-toc.1-1.12.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.1.1.1"><xref derivedContent="12.1.1" format="counter" sectionFormat="of" target="section-12.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-key">直接キー</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.1.1.2">
                <li pn="section-toc.1-1.12.1.1.1">
                  <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.1.1.1.1"><xref derivedContent="12.1.1.1" format="counter" sectionFormat="of" target="section-12.1.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
                </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.12.1.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.1.2.1"><xref derivedContent="12.1.2" format="counter" sectionFormat="of" target="section-12.1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-key-with-kdf">KDFを使用した直接鍵</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.1.2.2">
                <li pn="section-toc.1-1.12.1.2.1">
                  <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.1.2.1.1"><xref derivedContent="12.1.2.1" format="counter" sectionFormat="of" target="section-12.1.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
                </li>
                </ul>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.12.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.2.1"><xref derivedContent="12.2" format="counter" sectionFormat="of" target="section-12.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-wrap">キーラップ</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.2.2">
              <li pn="section-toc.1-1.12.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.2.1.1"><xref derivedContent="12.2.1" format="counter" sectionFormat="of" target="section-12.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-aes-key-wrap">AESキーラップ</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.2.1.2">
                <li pn="section-toc.1-1.12.2.1.1">
                  <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.2.1.1.1"><xref derivedContent="12.2.1.1" format="counter" sectionFormat="of" target="section-12.2.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations-for-aes-kw">AES-KWに対するセキュリティーに関する考慮事項</xref></t>
                </li>
                </ul>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.12.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.3.1"><xref derivedContent="12.3" format="counter" sectionFormat="of" target="section-12.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-transport">主キー伝送</xref></t>
            </li>
            <li pn="section-toc.1-1.12.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.4.1"><xref derivedContent="12.4" format="counter" sectionFormat="of" target="section-12.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-key-agreement">直接鍵確立</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.4.2">
              <li pn="section-toc.1-1.12.4.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.4.1.1"><xref derivedContent="12.4.1" format="counter" sectionFormat="of" target="section-12.4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ecdh">ECDH</xref></t>
              </li>
              <li pn="section-toc.1-1.12.4.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.4.2.1"><xref derivedContent="12.4.2" format="counter" sectionFormat="of" target="section-12.4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.12.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.5.1"><xref derivedContent="12.5" format="counter" sectionFormat="of" target="section-12.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-agreement-with-key-wrap">キーラップを伴うキーアグリーメント</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.5.2">
              <li pn="section-toc.1-1.12.5.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.12.5.1.1"><xref derivedContent="12.5.1" format="counter" sectionFormat="of" target="section-12.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ecdh">ECDH</xref></t>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.13.1"><xref derivedContent="13" format="counter" sectionFormat="of" target="section-13"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-object-parameters">キーオブジェクトパラメーター</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
            <li pn="section-toc.1-1.13.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.13.1.1"><xref derivedContent="13.1" format="counter" sectionFormat="of" target="section-13.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-elliptic-curve-keys">楕円曲線鍵</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.1.2">
              <li pn="section-toc.1-1.13.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.13.1.1.1"><xref derivedContent="13.1.1" format="counter" sectionFormat="of" target="section-13.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-double-coordinate-curves">二重座標曲線</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.13.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.13.2.1"><xref derivedContent="13.2" format="counter" sectionFormat="of" target="section-13.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-octet-key-pair">オクテットキーペア</xref></t>
            </li>
            <li pn="section-toc.1-1.13.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.13.3.1"><xref derivedContent="13.3" format="counter" sectionFormat="of" target="section-13.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-symmetric-keys">対称鍵</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.14.1"><xref derivedContent="14" format="counter" sectionFormat="of" target="section-14"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-encoder-restrictions">CBOR エンコーダの制約</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.15.1"><xref derivedContent="15" format="counter" sectionFormat="of" target="section-15"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-application-profiling-considerations">アプリケーションプロファイリングに関する考慮事項</xref></t>
          </li>
          <li pn="section-toc.1-1.16">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.1"><xref derivedContent="16" format="counter" sectionFormat="of" target="section-16"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANAの考慮事項</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.2">
            <li pn="section-toc.1-1.16.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.1.1"><xref derivedContent="16.1" format="counter" sectionFormat="of" target="section-16.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cbor-tag-assignment">CBOR タグの割り当て</xref></t>
            </li>
            <li pn="section-toc.1-1.16.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.2.1"><xref derivedContent="16.2" format="counter" sectionFormat="of" target="section-16.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-header-parameters-registry">COSEヘッダーパラメーターのレジストリ</xref></t>
            </li>
            <li pn="section-toc.1-1.16.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.3.1"><xref derivedContent="16.3" format="counter" sectionFormat="of" target="section-16.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-header-algorithm-parameters-registry">COSEヘッダーアルゴリズムパラメーター登録</xref></t>
            </li>
            <li pn="section-toc.1-1.16.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.4.1"><xref derivedContent="16.4" format="counter" sectionFormat="of" target="section-16.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-algorithms-registry">COSEアルゴリズムレジストリ</xref></t>
            </li>
            <li pn="section-toc.1-1.16.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.5.1"><xref derivedContent="16.5" format="counter" sectionFormat="of" target="section-16.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-common-parameters-registry">COSEキーパラメーター共通レジストリ</xref></t>
            </li>
            <li pn="section-toc.1-1.16.6">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.6.1"><xref derivedContent="16.6" format="counter" sectionFormat="of" target="section-16.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-type-parameters-registry">COSEキータイプパラメーターレジストリ</xref></t>
            </li>
            <li pn="section-toc.1-1.16.7">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.7.1"><xref derivedContent="16.7" format="counter" sectionFormat="of" target="section-16.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-types-registry">COSEキータイプの登録</xref></t>
            </li>
            <li pn="section-toc.1-1.16.8">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.8.1"><xref derivedContent="16.8" format="counter" sectionFormat="of" target="section-16.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-elliptic-curves-registry">COSE楕円曲線レジストリ</xref></t>
            </li>
            <li pn="section-toc.1-1.16.9">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.9.1"><xref derivedContent="16.9" format="counter" sectionFormat="of" target="section-16.9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-media-type-registrations">メディアタイプの登録</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.16.9.2">
              <li pn="section-toc.1-1.16.9.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.9.1.1"><xref derivedContent="16.9.1" format="counter" sectionFormat="of" target="section-16.9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-security-message">COSEセキュリティーメッセージ</xref></t>
              </li>
              <li pn="section-toc.1-1.16.9.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.9.2.1"><xref derivedContent="16.9.2" format="counter" sectionFormat="of" target="section-16.9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-key-media-type">COSEキーのメディアタイプ</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.16.10">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.10.1"><xref derivedContent="16.10" format="counter" sectionFormat="of" target="section-16.10"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-coap-content-formats-registry">CoAP コンテンツ形式レジストリ</xref></t>
            </li>
            <li pn="section-toc.1-1.16.11">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.16.11.1"><xref derivedContent="16.11" format="counter" sectionFormat="of" target="section-16.11"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-expert-review-instructions">専門家によるレビューの手順</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.17">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.17.1"><xref derivedContent="17" format="counter" sectionFormat="of" target="section-17"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">セキュリティーに関する考慮事項</xref></t>
          </li>
          <li pn="section-toc.1-1.18">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.18.1"><xref derivedContent="18" format="counter" sectionFormat="of" target="section-18"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.18.2">
            <li pn="section-toc.1-1.18.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.18.1.1"><xref derivedContent="18.1" format="counter" sectionFormat="of" target="section-18.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
            </li>
            <li pn="section-toc.1-1.18.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.18.2.1"><xref derivedContent="18.2" format="counter" sectionFormat="of" target="section-18.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.A">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.A.1"><xref derivedContent="A" format="counter" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-guidelines-for-external-data-authentication-of-algorithms">アルゴリズムの外部データ認証のためのガイドライン</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.A.2">
            <li pn="section-toc.1-1.A.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.A.1.1"><xref derivedContent="A.1" format="counter" sectionFormat="of" target="section-a.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-algorithm-identification">アルゴリズムの識別</xref></t>
            </li>
            <li pn="section-toc.1-1.A.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.A.2.1"><xref derivedContent="A.2" format="counter" sectionFormat="of" target="section-a.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-counter-signature-without-headers">ヘッダーなしのカウンタ署名</xref></t>
            </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.B">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.B.1"><xref derivedContent="B" format="counter" sectionFormat="of" target="section-appendix.b"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-two-layers-of-recipient-information">受信者情報の二つのレイヤー</xref></t>
          </li>
          <li pn="section-toc.1-1.C">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.1"><xref derivedContent="C" format="counter" sectionFormat="of" target="section-appendix.c"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples">例えば</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.2">
            <li pn="section-toc.1-1.C.1">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.1.1"><xref derivedContent="C.1" format="counter" sectionFormat="of" target="section-c.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-signed-messages">Examples of Signed Messages</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.1.2">
              <li pn="section-toc.1-1.C.1.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.1.1.1"><xref derivedContent="C.1.1" format="counter" sectionFormat="of" target="section-c.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-signature">Single Signature</xref></t>
              </li>
              <li pn="section-toc.1-1.C.1.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.1.2.1"><xref derivedContent="C.1.2" format="counter" sectionFormat="of" target="section-c.1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multiple-signers">Multiple Signers</xref></t>
              </li>
              <li pn="section-toc.1-1.C.1.3">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.1.3.1"><xref derivedContent="C.1.3" format="counter" sectionFormat="of" target="section-c.1.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-counter-signature">Counter Signature</xref></t>
              </li>
              <li pn="section-toc.1-1.C.1.4">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.1.4.1"><xref derivedContent="C.1.4" format="counter" sectionFormat="of" target="section-c.1.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signature-with-criticality">Signature with Criticality</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.C.2">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.2.1"><xref derivedContent="C.2" format="counter" sectionFormat="of" target="section-c.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-signer-examples">Single Signer Examples</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.2.2">
              <li pn="section-toc.1-1.C.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.2.1.1"><xref derivedContent="C.2.1" format="counter" sectionFormat="of" target="section-c.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-ecdsa-signature">Single ECDSA Signature</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.C.3">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.3.1"><xref derivedContent="C.3" format="counter" sectionFormat="of" target="section-c.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-enveloped-messages">Examples of Enveloped Messages</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.3.2">
              <li pn="section-toc.1-1.C.3.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.3.1.1"><xref derivedContent="C.3.1" format="counter" sectionFormat="of" target="section-c.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-ecdh">Direct ECDH</xref></t>
              </li>
              <li pn="section-toc.1-1.C.3.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.3.2.1"><xref derivedContent="C.3.2" format="counter" sectionFormat="of" target="section-c.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-plus-key-derivation">Direct Plus Key Derivation</xref></t>
              </li>
              <li pn="section-toc.1-1.C.3.3">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.3.3.1"><xref derivedContent="C.3.3" format="counter" sectionFormat="of" target="section-c.3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-counter-signature-on-encrypted-content">Counter Signature on Encrypted Content</xref></t>
              </li>
              <li pn="section-toc.1-1.C.3.4">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.3.4.1"><xref derivedContent="C.3.4" format="counter" sectionFormat="of" target="section-c.3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-encrypted-content-with-external-data">Encrypted Content with External Data</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.C.4">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.4.1"><xref derivedContent="C.4" format="counter" sectionFormat="of" target="section-c.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-encrypted-messages">Examples of Encrypted Messages</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.4.2">
              <li pn="section-toc.1-1.C.4.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.4.1.1"><xref derivedContent="C.4.1" format="counter" sectionFormat="of" target="section-c.4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-simple-encrypted-message">Simple Encrypted Message</xref></t>
              </li>
              <li pn="section-toc.1-1.C.4.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.4.2.1"><xref derivedContent="C.4.2" format="counter" sectionFormat="of" target="section-c.4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-encrypted-message-with-a-partial-iv">Encrypted Message with a Partial IV</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.C.5">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.5.1"><xref derivedContent="C.5" format="counter" sectionFormat="of" target="section-c.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-maced-messages">Examples of MACed Messages</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.5.2">
              <li pn="section-toc.1-1.C.5.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.5.1.1"><xref derivedContent="C.5.1" format="counter" sectionFormat="of" target="section-c.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-shared-secret-direct-mac">Shared Secret Direct MAC</xref></t>
              </li>
              <li pn="section-toc.1-1.C.5.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.5.2.1"><xref derivedContent="C.5.2" format="counter" sectionFormat="of" target="section-c.5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ecdh-direct-mac">ECDH Direct MAC</xref></t>
              </li>
              <li pn="section-toc.1-1.C.5.3">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.5.3.1"><xref derivedContent="C.5.3" format="counter" sectionFormat="of" target="section-c.5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-wrapped-mac">Wrapped MAC</xref></t>
              </li>
              <li pn="section-toc.1-1.C.5.4">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.5.4.1"><xref derivedContent="C.5.4" format="counter" sectionFormat="of" target="section-c.5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multi-recipient-maced-message">Multi-Recipient MACed Message</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.C.6">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.6.1"><xref derivedContent="C.6" format="counter" sectionFormat="of" target="section-c.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-mac0-messages">Examples of MAC0 Messages</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.6.2">
              <li pn="section-toc.1-1.C.6.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.6.1.1"><xref derivedContent="C.6.1" format="counter" sectionFormat="of" target="section-c.6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-shared-secret-direct-mac">Shared Secret Direct MAC</xref></t>
              </li>
              </ul>
            </li>
            <li pn="section-toc.1-1.C.7">
              <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.7.1"><xref derivedContent="C.7" format="counter" sectionFormat="of" target="section-c.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-cose-keys">COSE Keys</xref></t>
              <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.C.7.2">
              <li pn="section-toc.1-1.C.7.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.7.1.1"><xref derivedContent="C.7.1" format="counter" sectionFormat="of" target="section-c.7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-public-keys">Public Keys</xref></t>
              </li>
              <li pn="section-toc.1-1.C.7.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.C.7.2.1"><xref derivedContent="C.7.2" format="counter" sectionFormat="of" target="section-c.7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-private-keys">Private Keys</xref></t>
              </li>
              </ul>
            </li>
            </ul>
          </li>
      </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">導入</name>
      <t indent="0" pn="section-1-1">IoT（Internet of Things）を構成する小型の制約されたデバイスに対する注目が増しています。このプロセスから生まれた標準の一つが、「Concise Binary Object Representation（CBOR）」です<xref target="RFC7049" format="default" sectionFormat="of" derivedContent="RFC7049"/>。CBORは、バイナリデータを含むことを許容するなど、JavaScript Object Notation（JSON）のデータモデルを拡張しました<xref target="RFC7159" format="default" sectionFormat="of" derivedContent="RFC7159"/>。CBORは、データ構造のエンコーディングとして、多くのIETFワーキンググループによって採用されています。CBORは、メッセージの輸送や実装サイズの面で小さく、スキーマフリーのデコーダーであるように特に設計されています。IoT向けのメッセージセキュリティーサービスの提供が必要であり、メッセージのエンコーディング形式としてCBORを使用することは合理的です。</t>
      <t indent="0" pn="section-1-2">JOSE ワーキンググループは、JSON を使用した暗号化、署名、およびメッセージ認証コード（MAC）操作の処理方法、および JSON を使用した鍵のエンコード方法を指定した一連のドキュメントを作成しました。このドキュメントでは、同じことを CBOR エンコーディング形式に対して行う CBOR オブジェクト署名および暗号化（COSE）規格を定義しています。元の JSON オブジェクト署名および暗号化（JOSE）ドキュメントの特性を保つための努力が行われる一方で、2つの考慮事項が考慮されています:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1-3">
        <li pn="section-1-3.1">CBORは、JSONにはない機能を持ち、使用するのに適しています。その一例として、CBORはバイナリを最初にBase64エンコードされた文字列に変換することなく、直接エンコードする方法を持っています。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1-4">
        <li pn="section-1-4.1">COSEはJOSE仕様の直接的なコピーではありません。COSEを作成する過程で、JOSEについての決定事項は再評価されました。多くの場合、基準が常に同じではなかったため、異なる結果が決定されました。</li>
      </ul>
      <section anchor="design-changes-from-jose" numbered="true" removeInRFC="false" toc="include" pn="section-1.1">
        <name slugifiedName="name-design-changes-from-jose">JOSEからのデザイン変更</name>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-1">
          <li pn="section-1.1-1.1">暗号化された、署名された、およびMACを付与されたメッセージを簡単に識別し、一貫した表示を提供するために、単一のトップメッセージ構造を定義します。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-2">
          <li pn="section-1.1-2.1">署名付きメッセージは、内容に関連する保護されたパラメーターとシグネチャに関連するパラメーターを区別します。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-3">
          <li pn="section-1.1-3.1">
            <bcp14>MACed messages are separated from signed messages.</bcp14>

MAC付きのメッセージは署名されたメッセージから分離されています。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-4">
          <li pn="section-1.1-4.1">MAC認証されたメッセージは、MAC認証キーを取得するために、封入されたメッセージと同じ受信者アルゴリズムのセットを使用する能力を持っています。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-5">
          <li pn="section-1.1-5.1">バイナリデータには、base64urlエンコーディングではなく、バイナリエンコーディングを使用してください。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-6">
          <li pn="section-1.1-6.1">暗号化アルゴリズムの認証タグを暗号文と組み合わせます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-1.1-7">
          <li pn="section-1.1-7.1">暗号アルゴリズムのセットは、一部の方向で拡張され、他の方向で削減されました。</li>
        </ul>
      </section>
      <section anchor="requirements-terminology" numbered="true" removeInRFC="false" toc="include" pn="section-1.2">
        <name slugifiedName="name-requirements-terminology">要件用語</name>
        <t indent="0" pn="section-1.2-1">このドキュメントのキーワード "<bcp14>しなければなりません（MUST）</bcp14>"、"<bcp14>してはなりません（MUST NOT）</bcp14>"、"<bcp14>要求されています（REQUIRED）</bcp14>"、"<bcp14>することになります（SHALL）</bcp14>"、"<bcp14>することはありません（SHALL NOT）</bcp14>"、"<bcp14>すべきです（SHOULD）</bcp14>"、"<bcp14>すべきではありません（SHOULD NOT）</bcp14>"、"<bcp14>推奨されます（RECOMMENDED）</bcp14>"、"<bcp14>推奨されません（NOT RECOMMENDED）</bcp14>"、"<bcp14>してもよいです（MAY）</bcp14>"、および "<bcp14>選択できます（OPTIONAL）</bcp14>" は、全て大文字で表示される場合に限り、BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/>で説明されているように解釈されます。</t>
        <t indent="0" pn="section-1.2-2">小文字で表示される場合、この解釈は適用されません。</t>
      </section>
      <section anchor="cbor-grammar" numbered="true" removeInRFC="false" toc="include" pn="section-1.3">
        <name slugifiedName="name-cbor-grammar">CBORの文法</name>
        <t indent="0" pn="section-1.3-1">現在、仕様で使用するための標準的なCBOR文法は存在しません。そのため、CBOR構造は文章で説明されています。</t>
        <t indent="0" pn="section-1.3-2">ドキュメントは、まず文法を作成し、それに続いてそれに対応する散文を開発することで作成されました。これによって、散文は、CBORデータ定義言語（CDDL）<xref target="CDDL" format="default" sectionFormat="of" derivedContent="CDDL"/>で定義されたプリミティブ型の文字列を使用して書かれました。この仕様では、以下のプリミティブ型が使用されます：</t>
        <t indent="0" pn="section-1.3-3"><artwork name="" type="" align="left" alt="">
   任意 -- すべてのCBOR値をここに配置することを許可する一般的な値。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-4"><artwork name="" type="" align="left" alt="">
   bool -- a boolean value (<bcp14>MUST</bcp14>: major type 7, value 21; <bcp14>MUST</bcp14> <bcp14>NOT</bcp14>:
   major type 7, value 20).
</artwork>
          <artwork name="" type="" align="left" alt="">
   bool -- 論理値（<bcp14>しなければなりません (MUST)</bcp14>：メジャータイプ7、値21；<bcp14>してはなりません (MUST NOT)</bcp14>：
   メジャータイプ7、値20）。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-5"><artwork name="" type="" align="left" alt="">
   bstr -- バイト文字列（メジャータイプ2）。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-6"><artwork name="" type="" align="left" alt="">
   intは、符号なし整数または負の整数です。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-7"><artwork name="" type="" align="left" alt="">
   nil -- null値（主要型7、値22）。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-8"><artwork name="" type="" align="left" alt="">
   nint -- 負の整数（メジャータイプ1）。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-9"><artwork name="" type="" align="left" alt="">
   <xi:bcp14>「tstr」とは、UTF-8形式のテキスト文字列 (メジャータイプ3) です。</xi:bcp14>
          </artwork>
        </t>
        <t indent="0" pn="section-1.3-10"><artwork name="" type="" align="left" alt="">
   uint -- 符号なし整数（メジャータイプ0）。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-11">このドキュメントでは、CDDLからの2つの構文が省略形として表示されます。これらは次のようなものです：</t>
        <t indent="0" pn="section-1.3-12"><artwork name="" type="" align="left" alt="">
   FOO / BAR -- ここには、FOOまたはBARのいずれかが現れることを示します。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-13"><artwork name="" type="" align="left" alt="">
   [+ FOO] -- 配列内にタイプFOOが1回以上出現することを示します。
</artwork>
        </t>
        <t indent="0" pn="section-1.3-14">プローズ説明に加えて、CBORのグラマーのバージョンがCDDLで示されています。CDDLはRFCで公開されていないため、このグラマーがCDDLの最終バージョンで動作しない可能性があります。CDDLグラマーは情報提供ですが、プローズ説明が規範です。</t>
        <t indent="0" pn="section-1.3-15">このドキュメントのXMLバージョンから収集されたCDDLは、以下のXPath式を使用して抽出することができます。（使用しているXPath評価器によっては、"&gt;"をエンティティとして扱う必要がある場合があります。）</t>
        <t indent="0" pn="section-1.3-16">//artwork[@type='CDDL']/text() 

//artwork[@type='CDDL']/text()</t>
        <t indent="0" pn="section-1.3-17">CDDLは、最初の非終端記号がファイルの最初の記号であることを期待しています。そのため、最初のCDDLのフラグメントをここに示します。</t>
        <t indent="0" pn="section-1.3-18">start = COSE_Messages / COSE_Key / COSE_KeySet / Internal_Types

start = COSEメッセージ / COSEキー / COSEキーセット / 内部タイプ</t>
        <t indent="0" pn="section-1.3-19">; これは、ツールを静かにするために定義されています：Internal_Types = Sig_structure / Enc_structure / MAC_structure / COSE_KDF_Context</t>
        <t indent="0" pn="section-1.3-20">非終端記号「Internal_Types」は、このドキュメントの作成中に使用される自動検証ツールの処理のために定義されています。それは、セキュリティー計算に使用されるが、輸送には出力されない非終端記号を参照しています。</t>
      </section>
      <section anchor="cbor-related-terminology" numbered="true" removeInRFC="false" toc="include" pn="section-1.4">
        <name slugifiedName="name-cbor-related-terminology">CBOR関連用語</name>
        <t indent="0" pn="section-1.4-1">JSONでは、マップはオブジェクトと呼ばれ、マップキーには文字列のみがあります。COSEでは、マップキーとして文字列、負の整数、および非負の整数を使用します。整数はエンコードの効率化と簡単な比較のために使用されます。文字列の含まれることで、追加の範囲の短いエンコード値も使用できます。単語「キー」は、主に別の意味である暗号鍵として使用されるため、マップキーのこの使用法には「ラベル」という用語を使用します。</t>
        <t indent="0" pn="section-1.4-2">COSEマップ内に文字列または整数でないラベルが存在する場合、それはエラーです。アプリケーションは処理を失敗させるか、または不正なラベルを持つメッセージを処理することができますが、ただし、<bcp14>不正なラベルを持つメッセージを作成してはなりません（MUST NOT）</bcp14>。</t>
        <t indent="0" pn="section-1.4-3">CDDLの文法断片には、前の段落のように非終端記号「label」と「values」が定義されており、それは任意の値の使用を許可します。</t>
        <t indent="0" pn="section-1.4-4">label = int / tstr values = any

ラベル = 整数 / 文字列値 = 任意</t>
      </section>
      <section anchor="document-terminology" numbered="true" removeInRFC="false" toc="include" pn="section-1.5">
        <name slugifiedName="name-document-terminology">ドキュメント用語</name>
        <t indent="0" pn="section-1.5-1">このドキュメントでは、以下の用語を使用します：</t>
        <t indent="0" pn="section-1.5-2">バイトはオクテットの同義語です。</t>
        <t indent="0" pn="section-1.5-3">制約付きアプリケーションプロトコル（CoAP）は、制約のあるシステムで使用するための特殊なウェブ転送プロトコルです。それは、<xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/> で定義されています。</t>
        <t indent="0" pn="section-1.5-4">認証付き暗号化（AE）<xref target="RFC5116" format="default" sectionFormat="of" derivedContent="RFC5116"/>アルゴリズムは、暗号化サービスと共に内容アルゴリズムの認証チェックを提供する暗号化アルゴリズムです。</t>
        <t indent="0" pn="section-1.5-5">認証付き暗号化（AEAD）<xref target="RFC5116" format="default" sectionFormat="of" derivedContent="RFC5116"/>アルゴリズムは、AEアルゴリズムと同じ内容認証サービスを提供しますが、さらに非暗号化データの認証も提供します。</t>
      </section>
    </section>
    <section anchor="basic-cose-structure" numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-basic-cose-structure">基本的なCOSE構造</name>
      <t indent="0" pn="section-2-1">COSEオブジェクトの構造は、異なる種類のセキュリティーメッセージを解析および処理する際に共通のコードが大量に存在できるように設計されています。すべてのメッセージ構造は、CBOR配列型をベースに構築されます。配列の最初の3つの要素には常に同じ情報が含まれています。</t>
      <t indent="0" pn="section-2-2">1. bstrに包まれた保護されたヘッダーパラメーターのセット。</t>
      <t indent="0" pn="section-2-3">2. マップとしての保護されていないヘッダーパラメーターのセット。</t>
      <t indent="0" pn="section-2-4">3. メッセージの内容。内容は、適切な場合には平文または暗号文です。内容は切り離されることもありますが、その場所は依然として使用されます。内容が存在する場合は、bstrで包まれ、切り離されている場合はnil値です。</t>
      <t indent="0" pn="section-2-5">このポイント以降の要素は、具体的なメッセージタイプに依存します。</t>
      <t indent="0" pn="section-2-6">COSEメッセージでは、さまざまな暗号概念の異なるタイプを分離するためにレイヤーの概念を使用して構築されます。これがどのように機能するかの例として、COSE_Encryptメッセージ（セクション5.1）を考えてみましょう。このメッセージタイプは2つのレイヤーに分割されます：コンテンツレイヤーと受信者レイヤーです。コンテンツレイヤーでは、平文が暗号化され、暗号化されたメッセージに関する情報が配置されます。受信者レイヤーでは、コンテンツ暗号化キー（CEK）が暗号化され、各受信者に対して暗号化方法に関する情報が配置されます。CEKが事前共有されている場合には、暗号化メッセージCOSE_Encrypt0（セクション5.2）の単一レイヤーバージョンが提供されます。</t>
      <t indent="0" pn="section-2-7">以下の方法で、提示されたメッセージのタイプを識別します：</t>
      <t indent="0" pn="section-2-8">1. 特定のメッセージタイプはコンテキストから判明します。これは、含まれる構造内のマーカーまたはアプリケーションプロトコルで指定された制約によって定義される場合があります。</t>
      <t indent="0" pn="section-2-9">2. メッセージのタイプはCBORタグによって識別されます。CBORタグを持つメッセージは、この仕様ではタグ付きメッセージとして知られており、CBORタグを持たないメッセージは非タグ付きメッセージとして知られています。この文書では、各メッセージ構造に対してCBORタグが定義されています。これらのタグは表1に見つけることができます。</t>
      <t indent="0" pn="section-2-10">3. COSEオブジェクトが'media type'として'application/cose'で送信される場合、埋め込まれたオブジェクトを識別するために、<bcp14>選択できます（OPTIONAL）</bcp14>のオプションパラメーター 'cose-type' を使用できます。このパラメーターは、構造体のタグバージョンが使用される場合は<bcp14>選択できます（OPTIONAL）</bcp14>です。また、構造体のタグバージョンが使用されない場合は、このパラメーターは<bcp14>必要です（REQUIRED）</bcp14>です。各構造体に対してパラメーターと一緒に使用する値は、表1に記載されています。</t>
      <t indent="0" pn="section-2-11">4. COSEオブジェクトがCoAPペイロードとして運ばれる場合、CoAPコンテンツフォーマットオプションを使用してメッセージのコンテンツを識別することができます。CoAPコンテンツフォーマットの値は表26にあります。メッセージ構造のためのCBORタグは必要ありません。各セキュリティーメッセージは一意に識別されます。</t>
      <t indent="0" pn="section-2-12"><table align="center">
          <thead>
            <tr>
              <tr>
                <td align="left"> CBORタグ</td>
                <td align="left">cose-type</td>
                <td align="left">データ項目</td>
                <td align="left">意味                     </td>
              </tr>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left"> 98</td>
              <td align="left">cose-sign</td>
              <td align="left">COSE_Sign</td>
              <td align="left">COSE署名データオブジェクト   </td>
            </tr>
            <tr>
              <td align="left"> 18 </td>
              <td align="left">cose-sign1 </td>
              <td align="left">COSE_Sign1 </td>
              <td align="left">COSE単一署名者データオブジェクト                    </td>
            </tr>
            <tr>
              <td align="left"> 96 </td>
              <td align="left">cose-encrypt </td>
              <td align="left">COSE_Encrypt </td>
              <td align="left">COSE暗号化データオブジェクト                    </td>
            </tr>
            <tr>
              <td align="left"> 16 </td>
              <td align="left">cose-encrypt0 </td>
              <td align="left">COSE_Encrypt0 </td>
              <td align="left">COSE単一受信者暗号化データオブジェクト     </td>
            </tr>
            <tr>
              <td align="left"> 97</td>
              <td align="left">cose-mac</td>
              <td align="left">COSE_Mac</td>
              <td align="left">COSE MACデータオブジェクト    </td>
            </tr>
            <tr>
              <td align="left"> 17 </td>
              <td align="left">cose-mac0 </td>
              <td align="left">COSE_Mac0 </td>
              <td align="left">COSE受信者なしMACオブジェクト                    </td>
            </tr>
          </tbody>
        </table>
      </t>
      <t indent="0" pn="section-2-13"><artwork name="" type="" align="left" alt="">
                テーブル1: COSEメッセージ識別
</artwork>
      </t>
      <t indent="0" pn="section-2-14">以下のCDDLフラグメントは、このドキュメントで定義されているすべてのトップメッセージを識別します。タグ付きバージョンとタグなしバージョンのメッセージに対して、別々の非終端記号が定義されています。</t>
      <t indent="0" pn="section-2-15">COSE_Messages = COSE_Untagged_Message / COSE_Tagged_Message

COSE_Messages = COSE_Untagged_Message / COSE_Tagged_Message</t>
      <t indent="0" pn="section-2-16">COSE_Untagged_Message = COSE_Sign / COSE_Sign1 / COSE_Encrypt / COSE_Encrypt0 / COSE_Mac / COSE_Mac0

COSE_Untagged_Message = COSE_Sign / COSE_Sign1 / COSE_Encrypt / COSE_Encrypt0 / COSE_Mac / COSE_Mac0

「COSE_Untagged_Message」は、「COSE_Sign」または「COSE_Sign1」または「COSE_Encrypt」または「COSE_Encrypt0」または「COSE_Mac」または「COSE_Mac0」である。</t>
      <t indent="0" pn="section-2-17">COSE_Tagged_Message = COSE_Sign_Tagged / COSE_Sign1_Tagged / COSE_Encrypt_Tagged / COSE_Encrypt0_Tagged / COSE_Mac_Tagged / COSE_Mac0_Tagged

COSE_Tagged_Message = COSE_Sign_Tagged / COSE_Sign1_Tagged / COSE_Encrypt_Tagged / COSE_Encrypt0_Tagged / COSE_Mac_Tagged / COSE_Mac0_Tagged 

【訳】COSE_Tagged_Message = COSE_Sign_Tagged / COSE_Sign1_Tagged / COSE_Encrypt_Tagged / COSE_Encrypt0_Tagged / COSE_Mac_Tagged / COSE_Mac0_Tagged</t>
    </section>
    <section anchor="header-parameters" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-header-parameters">ヘッダーパラメーター</name>
      <t indent="0" pn="section-3-1">COSEの構造は、ペイロード自体の一部ではない情報を保持するために使用される2つのバケットを持つように設計されています。これらのバケットはコンテンツ、アルゴリズム、キー、またはレイヤーの処理に関する評価ヒントに関する情報を保持するために使用されます。これらの2つのバケットは、キーを除くすべての構造で使用できます。これらのバケットは存在するものの、すべてのインスタンスで利用可能なわけではありません。たとえば、保護されたバケットは受信者の構造の一部として定義されていますが、受信者の構造に使用される一部のアルゴリズムは認証データを提供しません。この場合、保護されたバケットは空のままです。</t>
      <t indent="0" pn="section-3-2">両方のバケツはCBORマップとして実装されています。マップのキーは「ラベル」（セクション1.4）です。値の部分は、ラベルの定義に依存します。両方のマップは、同じセットのラベル/値のペアを使用します。ラベルの整数値と文字列値は、標準範囲、プライベート範囲、および選択したアルゴリズムに依存する範囲に分割されています。定義済みのラベルは、「COSEヘッダーパラメーター」IANAレジストリ（セクション16.2）で見つけることができます。</t>
      <t indent="0" pn="section-3-3">各レイヤーには2つのバケットが用意されています。</t>
      <t indent="0" pn="section-3-4">protected: 現在のレイヤーに関する暗号化されるべきパラメーターが含まれています。 このバケットは、暗号化の計算に含まれない場合は<bcp14>しなければなりません（MUST）</bcp14>空である必要があります。 このバケットは、メッセージとしてバイナリオブジェクトとしてエンコードされます。 この値は、保護されたマップをCBORエンコードし、それをbstrオブジェクトでラップすることで得られます。 送信者は、ゼロ長のマップをゼロ長の文字列としてエンコードする<bcp14>すべきです（SHOULD）</bcp14>（h'a0'としてエンコードされるゼロ長のマップではなく）。 ゼロ長のバイナリエンコーディングは、短く、暗号化計算のシリアライゼーション構造に使用されるバージョンでもあるため、好まれます。 マップをエンコードした後、値はバイナリオブジェクトでラップされます。 受信者は、ゼロ長のバイナリ値とバイナリ値でエンコードされたゼロ長のマップ、両方を受け入れる<bcp14>しなければなりません（MUST）</bcp14>。 ラップにより、保護されたマップのエンコードを輸送することが、それが輸送中に変更される可能性が低くなるよりも大きな確率で可能になります（正しく動作しない中間ノードはデコードして再エンコードするかもしれませんが、デコードされたバイト文字列と再エンコードされたバイト文字列が同じでない限り、検証に失敗します）。 これにより、すべての当事者が共通の正準エンコーディングを行える必要があるという問題が回避されます。</t>
      <t indent="0" pn="section-3-5">未保護：暗号的に保護されていない現在のレイヤーに関するパラメーターが含まれています。</t>
      <t indent="0" pn="section-3-6">現在のレイヤーに関連するパラメーターのみがそのレイヤーに配置されるべきです。これの例として、「コンテンツタイプ」というパラメーターは、メッセージに含まれるメッセージの内容を説明します。そのため、このパラメーターはコンテンツレイヤーのみに配置され、受信者または署名のレイヤーには配置されません。原則として、他のレイヤーを参照せずに、任意のレイヤーを処理することができるべきです。COSE_Sign構造体を除いて、レイヤー間で交換する必要があるデータは暗号鍵のみです。</t>
      <t indent="0" pn="section-3-7">この文書で定義されているすべてのセキュリティーオブジェクトには、バケットが存在します。順番に並んでいるフィールドは、「保護された」バケット（CBORの「bstr」型）と「保護されていない」バケット（CBORの「map」型）です。両方のバケットの存在が必要です。バケットに含まれるパラメーターは、IANAの「COSEヘッダーパラメーター」レジストリ（セクション16.2）から取得されます。一部の一般的なパラメーターは次のセクションで定義されていますが、この文書全体で多くのパラメーターが定義されています。</t>
      <t indent="0" pn="section-3-8">各マップ内のラベルは<bcp14> しなければなりません（MUST）</bcp14>、一意でなければなりません。メッセージの処理中に、ラベルが複数回現れた場合、メッセージは<bcp14> 不正な形式であるため、受け入れられない 必要があります（MUST）</bcp14>。アプリケーションは、保護されたヘッダーと保護されていないヘッダーの両方に同じラベルが出現しないことを<bcp14> すべきです（SHOULD）</bcp14> 
確認する 必要があります。メッセージが不正な形式として拒否されない場合、属性は<bcp14> 保護されたバケットから取得される 必要があります（MUST）</bcp14>、それらは保護されていないバケットから取得される前に。</t>
      <t indent="0" pn="section-3-9">次のCDDLフラグメントは、ヘッダーバケット2つを表します。CDDLで定義された「Headers」というグループは、属性が配置される2つのバケットを表します。このグループは、すべての場所でこれら2つのフィールドを一貫して提供するために使用されます。共通ヘッダーマップを表すタイプも定義されています。</t>
      <t indent="0" pn="section-3-10">Headers = ( protected : 空またはシリアライズされたマップ, unprotected : ヘッダーマップ )</t>
      <t indent="0" pn="section-3-11">header_map = { ジェネリック_ヘッダー, * ラベル =&gt; 値 }</t>
      <t indent="0" pn="section-3-12">empty_or_serialized_map = bstr .cbor ヘッダーマップ / bstr .size 0</t>
      <section anchor="common-cose-headers-parameters" numbered="true" removeInRFC="false" toc="include" pn="section-3.1">
        <name slugifiedName="name-common-cose-headers-parameters">Common COSE Headers Parameters</name>
        <t indent="0" pn="section-3.1-1">このセクションでは、一連の共通ヘッダーパラメーターが定義されます。これらのパラメーターの概要は、表2に記載されています。labelの値とその値のタイプを特定するために、この表を参照する必要があります。</t>
        <t indent="0" pn="section-3.1-2">このセクションで定義されているヘッダーパラメーターのセットは以下の通りです：</t>
        <t indent="0" pn="section-3.1-3">alg: このパラメーターは、セキュリティー処理に使用されるアルゴリズムを示すために使用されます。このパラメーターは、その能力が存在する場合には認証される<bcp14>しなければなりません（MUST）</bcp14>。このサポートは、AEADアルゴリズムまたは構造（COSE_Sign、COSE_Sign0、COSE_Mac、およびCOSE_Mac0）によって提供されます。この認証は、保護されたヘッダーバケットにヘッダーを配置するか、外部から供給されたデータの一部として行うことができます。値は「COSE Algorithms」レジストリから取得されます（セクション16.4を参照）。</t>
        <t indent="0" pn="section-3.1-4">クリティカル：このパラメーターは、メッセージを処理しているアプリケーションが理解する必要がある保護ヘッダーラベルを示すために使用されます。このドキュメントで定義されたパラメーターは、すべての実装によって理解される必要があるため、含める必要はありません。存在する場合、このパラメーターは保護ヘッダーバケットに配置される<bcp14>しなければなりません（MUST）</bcp14>。配列には少なくとも1つの値が含まれている<bcp14>しなければなりません（MUST）</bcp14>。すべてのラベルを 'crit' パラメーターに含める必要はありません。配列に配置されるヘッダーラベルを決定するためのルールは次のとおりです：</t>
        <t indent="0" pn="section-3.1-5"><artwork name="" type="" align="left" alt="">
   *  0から8の範囲の整数ラベルは省略<strong><bcp14>すべきです（SHOULD）</bcp14></strong>。
</artwork>
        </t>
        <t indent="0" pn="section-3.1-6"><artwork name="" type="" align="left" alt="">
   *  算術依存性により、範囲が-1から-128の整数ラベルは省略することができます。アプリケーションがアルゴリズムを正しく処理できる場合、そのアルゴリズムに関連するすべての共通パラメーターを正しく処理できると仮定できます。範囲が-129から-65536の整数ラベルは、一般的にサポートされていない可能性があるより少なく一般的なパラメーターであるため、含めるべきです（SHOULD）。
</artwork>
        </t>
        <t indent="0" pn="section-3.1-7"><artwork name="" type="" align="left" alt="">
   * アプリケーションに必要なパラメーターのラベルは省略しても構いません。ラベルを省略できる場合、アプリケーションにはその旨の記述があるべきです。
</artwork>
        </t>
        <t indent="0" pn="section-3.1-8"><artwork name="" type="" align="left" alt="">
   'crit'によって示されるヘッダーパラメーターの値は、セキュリティーライブラリのコードまたはセキュリティーライブラリを使用するアプリケーションのいずれかで処理することができます。唯一の要件は、パラメーターが処理されることです。 'crit'の値リストに、パラメーターが保護されたバケットに含まれていない値が含まれている場合、これはメッセージの処理における致命的なエラーです。
</artwork>
        </t>
        <t indent="0" pn="section-3.1-9">content type:  This parameter is used to indicate the content type of
   the data in the payload or ciphertext fields.  Integers are from
   the "CoAP Content-Formats" IANA registry table <xref target="COAP.Formats" format="default" sectionFormat="of" derivedContent="COAP.Formats"/>.
   Text values following the syntax of "&lt;type-name&gt;/&lt;subtype-name&gt;"
   where &lt;type-name&gt; and &lt;subtype-name&gt; are defined in <xref target="RFC6838" section="4.2" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc6838#section-4.2" derivedContent="RFC6838"/>.  Leading and trailing whitespace is also omitted.
   Textual content values along with parameters and subparameters can
   be located using the IANA "Media Types" registry.  Applications
   <bcp14>SHOULD</bcp14> provide this parameter if the content structure is
   potentially ambiguous.</t>
        <t indent="0" pn="section-3.1-10">kid: このパラメーターは、必要な暗号鍵を見つけるための入力データの一部を識別します。このパラメーターの値は、COSE_Key構造体の 'kid' メンバーと一致させることができます。他のキー配布方法では、一致させるための同等のフィールドを定義することができます。アプリケーションは 'kid' の値が一意であるとは想定しては<bcp14>してはなりません（MUST NOT）</bcp14>。同じ 'kid' 値を持つ複数の鍵が存在する可能性があるため、この 'kid' に関連付けられたすべての鍵を確認する必要があるかもしれません。'kid' の内部構造は定義されておらず、アプリケーションはそれに頼ることはできません。鍵識別子の値は、どの鍵を使用するかのヒントです。これはセキュリティー的に重要なフィールドではありません。そのため、これは保護されていないヘッダーバケットに配置することができます。</t>
        <t indent="0" pn="section-3.1-11">IV: このパラメーターは、初期化ベクトル (IV) の値を保持します。対称暗号化アルゴリズムにおいては、これはノンスと呼ばれる場合もあります。IVは、IVの修正によって復号化結果が乱れたテキストとして容易に検出できるため、保護されていないヘッダーに配置されることがあります。</t>
        <t indent="0" pn="section-3.1-12">部分IV：このパラメーターは、IV値の一部を保持します。COSE_Encrypt0構造を使用する場合、IVの一部はキーに関連付けられたコンテキストの一部として使用することができます。このフィールドは、各メッセージごとにIVが変更されることを引き起こす値を運ぶために使用されます。IVは、IVを変更することによって、復号化が文字化けとして容易に検出可能な平文を生じさせるため、保護されていないヘッダーに配置することができません。'Initialization Vector'および'Partial Initialization Vector'パラメーターは、同じセキュリティーレイヤー内に<bcp14>してはなりません（MUST NOT）</bcp14>。</t>
        <t indent="0" pn="section-3.1-13"><artwork name="" type="" align="left" alt="">
   メッセージ IV は次の手順で生成されます：
</artwork>
        </t>
        <t indent="0" pn="section-3.1-14"><artwork name="" type="" align="left" alt="">
   1.  IVの長さにゼロを左詰めして、パーシャルIVを満たします。
</artwork>
        </t>
        <t indent="0" pn="section-3.1-15"><artwork name="" type="" align="left" alt="">
   2.  パディングされた部分 IV をコンテキスト IV と排他的論理和(XOR)を取る。
</artwork>
        </t>
        <t indent="0" pn="section-3.1-16">カウンターシグネチャ：このパラメーターには1つ以上のカウンターシグネチャ値が格納されます。カウンターシグネチャは、第二の当事者がデータに署名する方法を提供します。カウンターシグネチャパラメーターは、次のいずれかの構造体に非保護属性として出現することができます：COSE_Sign1、COSE_Signature、COSE_Encrypt、COSE_recipient、COSE_Encrypt0、COSE_Mac、およびCOSE_Mac0。これらの構造体はすべて同じ開始要素を持っているため、カウンターシグネチャの一貫した計算が行われます。カウンターシグネチャの計算方法の詳細については、セクション4.5を参照してください。</t>
        <t indent="0" pn="section-3.1-17"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前 </td>
                  <td align="left">ラベル </td>
                  <td align="left">値のタイプ </td>
                  <td align="left">値の登録</td>
                  <td align="left">説明    </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> alg  </td>
                <td align="left">1  </td>
                <td align="left">int / tstr  </td>
                <td align="left">COSE アルゴリズムの登録</td>
                <td align="left">使用する暗号技術アルゴリズム </td>
              </tr>
              <tr>
                <td align="left"> crit  </td>
                <td align="left">2  </td>
                <td align="left">[+ label]  </td>
                <td align="left">COSE ヘッダーパラメーターの登録</td>
                <td align="left">理解される必要がある重要なヘッダー </td>
              </tr>
              <tr>
                <td align="left"> content</td>
                <td align="left">3</td>
                <td align="left">tstr / uint</td>
                <td align="left">CoAP</td>
                <td align="left">コンテンツの種類   </td>
              </tr>
              <tr>
                <td align="left"> type   </td>
                <td align="left">   </td>
                <td align="left">   </td>
                <td align="left">メディアタイプの登録</td>
                <td align="left">ペイロードの形式 </td>
              </tr>
              <tr>
                <td align="left"> kid</td>
                <td align="left">4</td>
                <td align="left">bstr</td>
                <td align="left"/>
                <td align="left">鍵の識別子 </td>
              </tr>
              <tr>
                <td align="left"> IV  </td>
                <td align="left">5  </td>
                <td align="left">bstr  </td>
                <td align="left">  </td>
                <td align="left">完全な初期化ベクトル         </td>
              </tr>
              <tr>
                <td align="left"> Partial</td>
                <td align="left">6</td>
                <td align="left">bstr</td>
                <td align="left"/>
                <td align="left">部分的な        </td>
              </tr>
              <tr>
                <td align="left"> IV </td>
                <td align="left"> </td>
                <td align="left"> </td>
                <td align="left"> </td>
                <td align="left">初期化ベクトル         </td>
              </tr>
              <tr>
                <td align="left"> counter</td>
                <td align="left">7</td>
                <td align="left">COSE_Signature</td>
                <td align="left"/>
                <td align="left">CBORでエンコードされた   </td>
              </tr>
              <tr>
                <td align="left"> signature  </td>
                <td align="left">  </td>
                <td align="left">/ [+ COSE_Signature ]</td>
                <td align="left"> </td>
                <td align="left">署名      構造体      </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-3.1-18"><artwork name="" type="" align="left" alt="">
                  テーブル2：一般的なヘッダーパラメーター
</artwork>
        </t>
        <t indent="0" pn="section-3.1-19">このセクションで定義されているヘッダーセットを表すためのCDDLフラグメントは以下の通りです。各ヘッダーはオプションとしてタグ付けされています。なぜなら、すべてのマップに必要ではないからです。特定のマップで必要なヘッダーについては、上記で説明されています。</t>
        <t indent="0" pn="section-3.1-20">Generic_Headers = ( ? 1 =&gt; int / tstr, ; アルゴリズム識別子
? 2 =&gt; [+label], ; クリティカリティ
? 3 =&gt; tstr / int, ; コンテンツタイプ
? 4 =&gt; bstr, ; キー識別子
? 5 =&gt; bstr, ; IV
? 6 =&gt; bstr, ; 部分 IV
? 7 =&gt; COSE_Signature / [+COSE_Signature] ; カウンターシグネチャ )</t>
      </section>
    </section>
    <section anchor="signing-objects" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-signing-objects">オブジェクトの署名</name>
      <t indent="0" pn="section-4-1">COSEは、2つの異なる署名構造をサポートしています。COSE_Signは、同じコンテンツに1つ以上の署名を適用することができます。COSE_Sign1は、1人の署名者に制限されています。これらの構造は互換性がなく、署名計算にはどの構造が使用されているかを識別するパラメーターが含まれているため、変換された構造は署名の検証に失敗します。</t>
      <section anchor="signing-with-one-or-more-signers" numbered="true" removeInRFC="false" toc="include" pn="section-4.1">
        <name slugifiedName="name-signing-with-one-or-more-signers">1つ以上の署名者で署名します。</name>
        <t indent="0" pn="section-4.1-1">COSE_Sign構造体には、メッセージペイロードに1つ以上の署名を適用することができます。コンテンツに関連するパラメーターと署名に関連するパラメーターは、署名自体とともに運ばれます。これらのパラメーターは、署名によって認証される場合もあれば、単に存在する場合もあります。コンテンツに関するパラメーターの例としては、コンテンツタイプがあります。署名に関するパラメーターの例としては、署名の作成に使用されるアルゴリズムとキー、カウンターサインがあります。</t>
        <t indent="0" pn="section-4.1-2">RFC 5652は次のように示しています：</t>
        <t indent="0" pn="section-4.1-3"><artwork name="" type="" align="left" alt="">
   複数の署名が存在する場合、特定の署名者に関連付けられた1つの署名の正常な検証は通常、その署名者による成功した署名とみなされます。ただし、他のルールが必要なアプリケーション環境もあります。1つの有効な署名ではなく、各署名者に対して異なるルールを採用するアプリケーションは、それらのルールを明示する必要があります。また、署名者識別子の単純な一致だけでは、署名が同じ署名者によって生成されたかどうかを判断するのに十分ではない場合、アプリケーション仕様は、どの署名が同じ署名者によって生成されたかを判断する方法について記述する必要があります。受信者の異なるコミュニティをサポートすることが、複数の署名を含める署名者が選択する主な理由です。
</artwork>
        </t>
        <t indent="0" pn="section-4.1-4">たとえば、COSE_Sign構造体には、Edwards-curve Digital Signature Algorithm（EdDSA）で生成された署名と、Elliptic Curve Digital Signature Algorithm（ECDSA）で生成された署名が含まれているかもしれません。これにより、受信者は、どちらかのアルゴリズムに関連する署名を検証することができます。複数の署名評価に関する詳細な情報については、<xref target="RFC5752" format="default" sectionFormat="of" derivedContent="RFC5752"/>を参照してください。</t>
        <t indent="0" pn="section-4.1-5">署名構造は、使用される文脈に応じて、タグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Sign構造は、CBORタグ98によって識別されます。これを表すCDDLフラグメントは次のとおりです。</t>
        <t indent="0" pn="section-4.1-6">COSE_Sign_Tagged = #6.98(COSE_Sign)
COSE_Sign_Tagged = #6.98(COSE_Sign)</t>
        <t indent="0" pn="section-4.1-7">COSE署名メッセージは2つの部分で定義されています。本文と本文に関する情報を持つCBORオブジェクトはCOSE_Sign構造と呼ばれます。署名と署名に関する情報を持つCBORオブジェクトはCOSE_Signature構造と呼ばれます。COSE署名メッセージの例は付録C.1にあります。</t>
        <t indent="0" pn="section-4.1-8">COSE_Sign構造体はCBOR配列です。配列のフィールドは次の順序であります：</t>
        <t indent="0" pn="section-4.1-9"><bcp14>保護されました</bcp14>: これはセクション3で説明されているものです。</t>
        <t indent="0" pn="section-4.1-10">非保護：これはセクション3に記載されているとおりです。</t>
        <t indent="0" pn="section-4.1-11">payload: このフィールドには署名されるシリアライズされたコンテンツが含まれます。メッセージにペイロードが存在しない場合、アプリケーションは別途ペイロードを提供する必要があります。ペイロードは、変更されることなく輸送されるように、bstrで包まれます。ペイロードが別途輸送される場合（「切り離されたコンテンツ」と呼ばれます）、この位置にはnilのCBORオブジェクトが置かれ、アプリケーションは変更なく輸送されることを保証する責任があります。</t>
        <t indent="0" pn="section-4.1-12"><artwork name="" type="" align="left" alt="">
   <bcp14>注意：</bcp14>メッセージリカバリアルゴリズムを使用した場合（セクション8）、回復できる最大バイト数はペイロードの長さです。ペイロードのサイズは回復されるバイト数で減少します。ペイロードのすべてのバイトが消費される場合、ペイロードは不在ではなく、ゼロ長のバイナリ文字列としてエンコードされます。
</artwork>
        </t>
        <t indent="0" pn="section-4.1-13">署名：このフィールドは署名の配列です。各署名はCOSE_Signature構造体として表されます。</t>
        <t indent="0" pn="section-4.1-14">上記のテキストに対応するCOSE_SignのCDDLフラグメントは次の通りです。</t>
        <t indent="0" pn="section-4.1-15">COSE_Sign = [ ヘッダー, ペイロード : bstr / nil, 署名 : [+ COSE_Signature] ]</t>
        <t indent="0" pn="section-4.1-16"><bcp14>MUST</bcp14> contain a positive integer, <bcp14>MUST</bcp14> contain a byte string or a map, <bcp14>MUST</bcp14> contain a byte string, and <bcp14>MAY</bcp14> contain additional elements.</t>
        <t indent="0" pn="section-4.1-17">保護されました：これはセクション3で説明されているとおりです。</t>
        <t indent="0" pn="section-4.1-18">未保護：これはセクション3で説明されているようになります。</t>
        <t indent="0" pn="section-4.1-19">signature：このフィールドには計算された署名値が含まれます。フィールドのタイプはバイナリ文字列（bstr）です。署名値が8ビットの倍数でない場合、アルゴリズムは<bcp14>しなければなりません（MUST）</bcp14>、パディングを指定する必要があります。</t>
        <t indent="0" pn="section-4.1-20">上記のテキストの COSE_Signature に対する CDDL フラグメントは次のようになります。</t>
        <t indent="0" pn="section-4.1-21">COSE_Signature = [ ヘッダー, シグネチャ : bstr ]</t>
      </section>
      <section anchor="signing-with-one-signer" numbered="true" removeInRFC="false" toc="include" pn="section-4.2">
        <name slugifiedName="name-signing-with-one-signer">１つの署名者での署名</name>
        <t indent="0" pn="section-4.2-1">COSE_Sign1署名構造は、メッセージに1つの署名のみが配置される場合に使用されます。コンテンツと署名に関連するパラメーターは、COSE_Signとは異なり、同じ一組のバケットに配置されます。</t>
        <t indent="0" pn="section-4.2-2">構造は、使用されるコンテキストに応じてタグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Sign1構造は、CBORタグ18によって識別されます。これを表すCDDLフラグメントは次のようになります：</t>
        <t indent="0" pn="section-4.2-3">COSE_Sign1_Tagged = #6.18(COSE_Sign1)
「COSE_Sign1_Tagged」は、#6.18（COSE_Sign1）です。</t>
        <t indent="0" pn="section-4.2-4">本文、署名、本文と署名に関する情報を運ぶCBORオブジェクトは「COSE_Sign1」構造体と呼ばれます。COSE_Sign1メッセージの例は、付録C.2にあります。</t>
        <t indent="0" pn="section-4.2-5">COSE_Sign1構造体はCBOR配列です。配列の順番にフィールドがあります：</t>
        <t indent="0" pn="section-4.2-6">protected: これはセクション3で説明されている通りです。</t>
        <t indent="0" pn="section-4.2-7"><bcp14>未保護</bcp14>：これはセクション3で説明されているものです。</t>
        <t indent="0" pn="section-4.2-8">ペイロード：これはセクション4.1で説明されているようにです。</t>
        <t indent="0" pn="section-4.2-9"><bcp14>signature: このフィールドには、計算された署名値が含まれています。フィールドのタイプは bstr です。</bcp14></t>
        <t indent="0" pn="section-4.2-10">上記のテキストを表すCOSE_Sign1のCDDLフラグメントは次のとおりです。</t>
        <t indent="0" pn="section-4.2-11">COSE_Sign1 = [ Headers, payload : bstr / nil, signature : bstr ]
COSE_Sign1 = [ ヘッダー, ペイロード : bstr / nil, 署名 : bstr ]</t>
      </section>
      <section anchor="externally-supplied-data" numbered="true" removeInRFC="false" toc="include" pn="section-4.3">
        <name slugifiedName="name-externally-supplied-data">外部から提供されたデータ</name>
        <t indent="0" pn="section-4.3-1">COSEドキュメントで提供される機能の1つは、アプリケーションがCOSEオブジェクトの一部として運ばれないが、認証される追加データを提供する能力です。これをサポートする主な理由は、CoAPメッセージ構造<xref target="RFC7252" format="default" sectionFormat="of" derivedContent="RFC7252"/>を見ることで明確になります。この構造では、ペイロードの前にオプションを運ぶための仕組みが存在します。この場所に配置できるデータの例としては、CoAPコードやCoAPオプションがあります。データがヘッダーセクションにある場合、プロキシが操作を行う際に使用するために利用可能です。例えば、Acceptオプションはプロキシがキャッシュ内に適切な値があるかどうかを判断するために使用できます。しかし、送信者はその値を認証タグに含めることでプロキシが受け入れる値のセットを変更することを防ぐこともできます。ただし、これらの値を保護して、送信中に変更された場合に検出できるようにすることも望まれる場合があります。</t>
        <t indent="0" pn="section-4.3-2">この文書は、外部から供給された認証データのバイト配列を使用するプロセスについて説明していますが、バイト配列の構築方法はアプリケーションの機能です。この機能を使用するアプリケーションは、外部から供給された認証データの構築方法を定義する必要があります。このような構築方法は、以下の問題を考慮する必要があります：<bcp14>しなければなりません（MUST）</bcp14>。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-4.3-3">
          <li pn="section-4.3-3.1">複数の項目が含まれている場合、異なる入力がある場合に同じバイト文字列が生成されないように、アプリケーションは確認する必要があります。これは、文字列 'AB' と 'CDE' を追加するか、文字列 'ABC' と 'DE' を追加することによって発生する可能性があります。通常、これはフィールドを固定幅にするか、フィールドの長さを出力の一部として符号化することによって対処されます。CoAP [RFC7252] のオプションを例に挙げると、これらのフィールドはTLV構造を使用しているため、問題なく連結することができます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-4.3-4">
          <li pn="section-4.3-4.1">複数のアイテムを含む場合、アイテムの順序を定義する必要があります。CoAPのオプションを例に挙げると、アプリケーションはフィールドをオプション番号で順序付ける必要があると述べることができます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-4.3-5">
          <li pn="section-4.3-5.1">アプリケーションは、バイトストリームが両側で同じになることを確認する必要があります。CoAPのオプションを使用すると、同じ相対番号が保持される場合に問題が発生する可能性があります。中間ノードはオプションを挿入または削除することができ、相対番号の方法を変更することがあります。アプリケーションは、相対番号が外部データに存在するオプションにのみ相対的であるため、相対番号が再エンコードされる必要があることを指定する必要があります。</li>
        </ul>
      </section>
      <section anchor="signing-and-verification-process" numbered="true" removeInRFC="false" toc="include" pn="section-4.4">
        <name slugifiedName="name-signing-and-verification-process">署名および検証プロセス</name>
        <t indent="0" pn="section-4.4-1">署名を作成するためには、明確に定義されたバイトストリームが必要です。Sig_structureは正規形を作成するために使用されます。この署名と検証プロセスでは、本文情報（COSE_SignまたはCOSE_Sign1）、署名者情報（COSE_Signature）、およびアプリケーションデータ（外部ソース）が必要です。Sig_structureはCBOR配列です。Sig_structureのフィールドは順に次の通りです：</t>
        <t indent="0" pn="section-4.4-2">1. 署名の文脈を識別するテキスト文字列。文脈文字列は次のとおりです：</t>
        <t indent="0" pn="section-4.4-3"><artwork name="" type="" align="left" alt="">
       COSE_Signature構造体を使用した署名のための「署名（Signature）」。
</artwork>
        </t>
        <t indent="0" pn="section-4.4-4"><artwork name="" type="" align="left" alt="">
       COSE_Sign1構造を使用する署名の「Signature1」。
</artwork>
        </t>
        <t indent="0" pn="section-4.4-5"><artwork name="" type="" align="left" alt="">
       "CounterSignature"は、カウンタ署名属性として使用される署名です。
</artwork>
        </t>
        <t indent="0" pn="section-4.4-6">2. ボディ構造でエンコードされた保護された属性は、bstrタイプで表されます。保護された属性が存在しない場合は、長さゼロのbstrが使用されます。</t>
        <t indent="0" pn="section-4.4-7">3. プロテクトされた属性は、bstr型でエンコードされた署名者構造から取得されます。もしプロテクトされた属性が存在しない場合は、長さゼロのbstrが使用されます。このフィールドは、COSE_Sign1署名構造には含まれません。</t>
        <t indent="0" pn="section-4.4-8">4. アプリケーションからエンコードされた保護属性が、bstr型で与えられます。このフィールドが提供されない場合、長さゼロのバイナリ文字列がデフォルトとなります。（このフィールドを構築するためのアプリケーション上のガイダンスについては、セクション4.3を参照してください。）</t>
        <t indent="0" pn="section-4.4-9">5. ペイロードは bstr タイプでエンコードされ、署名する必要があります。ペイロードは、輸送方法に関係なく、ここに配置されます。</t>
        <t indent="0" pn="section-4.4-10">上記のテキストを記述するCDDLフラグメントは次のとおりです：</t>
        <t indent="0" pn="section-4.4-11">Sig_structure = [ context : "シグネチャ" / "シグネチャ1" / "カウンターシグネチャ", body_protected : empty_or_serialized_map, ? sign_protected : empty_or_serialized_map, external_aad : bstr, payload : bstr ]</t>
        <t indent="0" pn="section-4.4-12">署名の計算方法:</t>
        <t indent="0" pn="section-4.4-13">1. 適切なフィールドでSig_structureを作成し、情報を入れます。</t>
        <t indent="0" pn="section-4.4-14">2. セクション14で説明されているエンコーディングを使用して、Sig_structureをバイト文字列にエンコードすることにより、値ToBeSignedを作成します。</t>
        <t indent="0" pn="section-4.4-15">3. K (署名するためのキー)、alg(署名に使用するアルゴリズム)、ToBeSigned (署名する値)を渡して署名作成アルゴリズムを呼び出します。</t>
        <t indent="0" pn="section-4.4-16">4. 結果の署名値を配列の 'signature' フィールドに配置します。</t>
        <t indent="0" pn="section-4.4-17">署名を検証する手順は次のとおりです：</t>
        <t indent="0" pn="section-4.4-18">1. Sig_structureオブジェクトを作成し、適切なフィールドで埋めます。</t>
        <t indent="0" pn="section-4.4-19">２．セクション14で述べられているエンコード方法を使用して、Sig_structureをバイト文字列にエンコードして値ToBeSignedを作成します。</t>
        <t indent="0" pn="section-4.4-20">3. K (検証に使用するキー)、alg (署名に使用されたアルゴリズム)、ToBeSigned (署名する値)、および sig (検証する署名) を渡して署名の検証アルゴリズムを呼び出します。</t>
        <t indent="0" pn="section-4.4-21">署名の検証を行うだけでなく、アプリケーションはキーが正しく署名される識別子とペアになっていること、および署名される識別子がアクションを実行する前に承認されていることを確認するための適切なチェックも実行する場合があります。</t>
      </section>
      <section anchor="computing-counter-signatures" numbered="true" removeInRFC="false" toc="include" pn="section-4.5">
        <name slugifiedName="name-computing-counter-signatures">コンピューティングカウンターサインはします</name>
        <t indent="0" pn="section-4.5-1">カウンタ署名は、異なるサイン作成者によって生成された別の署名と特定のコンテンツを関連付ける方法を提供します。通常、これは、ある時点で署名が存在したことを証明するために、署名上の署名を提供するために使用されます（タイムスタンプなど）。この文書では、カウンタ署名をさらに多くの環境で存在させることを許可しています。例えば、COSE_Encryptオブジェクトの保護されていない属性にカウンタ署名を配置することが可能です。これにより、中間者が暗号化されたバイトストリームが変更されていないことを検証することができるが、解読することはできない、または特定の時点で暗号化されたバイトストリームが存在したこと、または経由したことを示すことができます（プロキシ署名）。</t>
        <t indent="0" pn="section-4.5-2">署名に対するカウンタ署名の例は、付録C.1.3に記載されています。暗号化オブジェクトにおけるカウンタ署名の例は、付録C.3.3に記載されています。</t>
        <t indent="0" pn="section-4.5-3">異なるアイテムのカウンタ署名の作成と検証は、オブジェクトが同じ構造を持っていることに依存します。要素は、保護された属性のセット、保護されていない属性のセット、および本体の順になります。これは、Sig_structureが署名の処理のためのバイトストリームを一様な方法で取得するために使用できることを意味します。カウンタ署名がCOSE_Encrypt構造上で計算される場合、body_protectedおよびpayloadアイテムはCOSE_Sign構造からのものと同じ方法でSig_structureにマッピングできます。</t>
        <t indent="0" pn="section-4.5-4">コンターサインには、追加情報を持つ署名アルゴリズム（セクション8を参照）のみ使用できることに注意する必要があります。これは、本文がコンターサインを評価せずに処理できるようにする必要があり、メッセージ回復を伴う署名スキームでは不可能です。</t>
      </section>
    </section>
    <section anchor="encryption-objects" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-encryption-objects">暗号化オブジェクト</name>
      <t indent="0" pn="section-5-1">COSEは2つの異なる暗号化構造をサポートしています。COSE_Encrypt0は、暗黙的に分かっている使用するキーのために受信者の構造が必要ない場合に使用されます。COSE_Encryptは、その他の場合に使用されます。これには、複数の受信者がある場合や直接以外の受信者アルゴリズムが使用される場合などが含まれます。</t>
      <section anchor="enveloped-cose-structure" numbered="true" removeInRFC="false" toc="include" pn="section-5.1">
        <name slugifiedName="name-enveloped-cose-structure">暗号化されたCOSE構造</name>
        <t indent="0" pn="section-5.1-1">The enveloped structure allows for one or more recipients of a message. There are provisions for parameters about the content and parameters about the recipient information to be carried in the message. The protected parameters associated with the content are authenticated by the content encryption algorithm. The protected parameters associated with the recipient are authenticated by the recipient algorithm (when the algorithm supports it). Examples of parameters about the content are the type of the content and the content encryption algorithm. Examples of parameters about the recipient are the recipient's key identifier and the recipient's encryption algorithm.

この封筒構造では、メッセージの一人以上の受信者が可能です。メッセージには、コンテンツに関するパラメーターと受信者情報に関するパラメーターが含まれるように規定されています。コンテンツに関連する保護パラメーターは、コンテンツ暗号化アルゴリズムによって認証されます。受信者に関連する保護パラメーターは、受信者アルゴリズムによって認証されます（アルゴリズムがサポートしている場合）。コンテンツに関するパラメーターの例は、コンテンツの種類とコンテンツ暗号化アルゴリズムです。受信者に関するパラメーターの例は、受信者の鍵識別子と受信者の暗号化アルゴリズムです。</t>
        <t indent="0" pn="section-5.1-2">The same techniques and structures are used for encrypting both the
plaintext and the keys.  This is different from the approach used by
both "Cryptographic Message Syntax (CMS)" <xref target="RFC5652" format="default" sectionFormat="of" derivedContent="RFC5652"/> and "JSON Web
Encryption (JWE)" <xref target="RFC7516" format="default" sectionFormat="of" derivedContent="RFC7516"/> where different structures are used for
the content layer and for the recipient layer.  Two structures are
defined: COSE_Encrypt to hold the encrypted content and
COSE_recipient to hold the encrypted keys for recipients.  Examples
of encrypted messages can be found in Appendix C.3.</t>
        <t indent="0" pn="section-5.1-3">COSE_Encrypt構造体は、使用される文脈に応じて、タグ付きまたはタグなしでエンコードされることがあります。タグ付きのCOSE_Encrypt構造体は、CBORタグ96によって識別されます。これを表すCDDLフラグメントは以下の通りです：</t>
        <t indent="0" pn="section-5.1-4">COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)

COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)</t>
        <t indent="0" pn="section-5.1-5">COSE_Encrypt 構造体は CBOR 配列です。配列の順序でフィールドが配置されます。</t>
        <t indent="0" pn="section-5.1-6">protected: これはセクション3で説明されているとおりです。</t>
        <t indent="0" pn="section-5.1-7">非保護: これはセクション3で説明されているとおりです。</t>
        <t indent="0" pn="section-5.1-8">暗号文：このフィールドには、bstrとしてエンコードされた暗号文が含まれています。もし暗号文が暗号化プロセスに関する制御情報と独立して転送される場合（すなわち、切り離されたコンテンツの場合）、このフィールドはnil値としてエンコードされます。</t>
        <t indent="0" pn="section-5.1-9">受信者: このフィールドには、受信者情報構造の配列が含まれています。受信者情報構造のタイプは、COSE_recipientです。</t>
        <t indent="0" pn="section-5.1-10">上記のテキストに対応するCDDLのフラグメントは以下の通りです：</t>
        <t indent="0" pn="section-5.1-11">COSE_Encrypt = [ ヘッダー、暗号文 : bstr / nil、受信者 : [+COSE_recipient] ]</t>
        <t indent="0" pn="section-5.1-12">COSE_recipient構造体はCBOR配列です。配列のフィールドは以下の順序であります：</t>
        <t indent="0" pn="section-5.1-13"><bcp14>保護されています（protected）</bcp14>。これはセクション3で説明されています。</t>
        <t indent="0" pn="section-5.1-14">保護されていない：これはセクション3で説明されているように、です。</t>
        <t indent="0" pn="section-5.1-15">暗号文：このフィールドには、bstrとしてエンコードされた暗号化されたキーが含まれています。すべてのエンコードされたキーは対称キーです。キーのバイナリ値が内容です。暗号化されたキーがない場合、このフィールドはnil値としてエンコードされます。</t>
        <t indent="0" pn="section-5.1-16">受信者：このフィールドには、受信者情報の構造体の配列が含まれています。受信者情報の構造体の型はCOSE_recipientです（この一例は付録Bにあります）。受信者情報の構造体が存在しない場合、この要素は存在しません。</t>
        <t indent="0" pn="section-5.1-17">上記のテキストに対応するCOSE_recipientのCDDLフラグメントは次の通りです：</t>
        <t indent="0" pn="section-5.1-18">COSE_recipient = [ Headers, ciphertext : bstr / nil, ? recipients : [+COSE_recipient] ]

COSE_recipient = [ ヘッダー, 暗号文 : バイト文字列 / 無し, ? 受信者 : [+COSE_recipient] ]</t>
        <section anchor="content-key-distribution-methods" numbered="true" removeInRFC="false" toc="include" pn="section-5.1.1">
          <name slugifiedName="name-content-key-distribution-methods">コンテンツキー配布方法</name>
          <t indent="0" pn="section-5.1.1-1">暗号化されたメッセージは、1人以上の受信者のために暗号化された内容と暗号化されたCEKで構成されます。CEKは、その受信者に固有のキーを使用して各受信者ごとに暗号化されます。この暗号化の詳細は、受信者のアルゴリズムがどのクラスに属するかによって異なります。各クラスの詳細については、セクション12に記載されています。5つの内容鍵配布方法の簡単な概要は次のとおりです：</t>
          <t indent="0" pn="section-5.1.1-2">直接: CEKは、以前に配布された対称鍵と同じであるか、以前に配布された秘密から派生しています。メッセージにはCEKは輸送されません。</t>
          <t indent="0" pn="section-5.1.1-3">対称鍵暗号鍵（KEK）：CEKは、以前に配布された対称型KEKを使用して暗号化されます。また、キーラップとも呼ばれています。</t>
          <t indent="0" pn="section-5.1.1-4">鍵の合意: 受信者の公開鍵と送信者の秘密鍵を使用して、一対の秘密鍵を生成し、鍵導出関数（KDF）を適用して鍵を導出し、その後、CEKは導出された鍵自体または導出された鍵で暗号化されます。</t>
          <t indent="0" pn="section-5.1.1-5">キーの輸送: CEK は受信者の公開鍵で暗号化されます。このドキュメントではキー輸送アルゴリズムは定義されていません。</t>
          <t indent="0" pn="section-5.1.1-6">パスワード：CEKは、パスワードから派生したKEKで暗号化されます。このドキュメントではパスワードアルゴリズムは定義されていません。</t>
        </section>
      </section>
      <section anchor="single-recipient-encrypted" numbered="true" removeInRFC="false" toc="include" pn="section-5.2">
        <name slugifiedName="name-single-recipient-encrypted">単一受信者暗号化</name>
        <t indent="0" pn="section-5.2-1">COSE_Encrypt0の暗号化された構造は、メッセージの受信者を特定する能力を持っていません。この構造は、オブジェクトの受信者がメッセージを復号化するために使用するキーの識別を既に知っていることを前提としています。もし受信者にキーを特定する必要がある場合は、被包含構造を使用するべきです。</t>
        <t indent="0" pn="section-5.2-2">暗号化されたメッセージの例は、付録C.3にあります。</t>
        <t indent="0" pn="section-5.2-3">COSE_Encrypt0構造体は、使用される文脈に応じて、タグ付きまたはタグなしでエンコードできます。タグ付きのCOSE_Encrypt0構造体は、CBORタグ16で識別されます。これを表すCDDLフラグメントは次の通りです：</t>
        <t indent="0" pn="section-5.2-4">COSE_Encrypt0_Tagged = #6.16(COSE_Encrypt0)</t>
        <t indent="0" pn="section-5.2-5">COSE_Encrypt0構造体は、CBOR配列です。配列のフィールドは以下の順になります：</t>
        <t indent="0" pn="section-5.2-6">保護されました: これはセクション3で説明されているとおりです。</t>
        <t indent="0" pn="section-5.2-7">未保護：これはセクション3で説明されているようになります。</t>
        <t indent="0" pn="section-5.2-8">暗号文：これはセクション5.1で説明されているものです。</t>
        <t indent="0" pn="section-5.2-9">上記のテキストに対応するCOSE_Encrypt0のCDDLフラグメントは次のとおりです：</t>
        <t indent="0" pn="section-5.2-10">COSE_Encrypt0 = [ Headers, ciphertext : bstr / nil, ]

COSE_Encrypt0 = [Headers、ciphertext : bstr / nil]</t>
      </section>
      <section anchor="how-to-encrypt-and-decrypt-for-aead-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-5.3">
        <name slugifiedName="name-how-to-encrypt-and-decrypt-for-aead-algorithms">AEADアルゴリズムの暗号化と復号化の方法</name>
        <t indent="0" pn="section-5.3-1">AEADアルゴリズムの暗号化アルゴリズムは非常にシンプルです。最初のステップは、認証済みデータ構造のための一貫したバイトストリームを作成することです。この目的のために、Enc_structureを使用します。Enc_structureはCBOR配列です。Enc_structureのフィールドは以下の順序であります：</t>
        <t indent="0" pn="section-5.3-2">1. 認証されたデータ構造の文脈を識別するテキスト文字列です。文脈文字列は次の通りです:</t>
        <t indent="0" pn="section-5.3-3"><artwork name="" type="" align="left" alt="">
       COSE_Encrypt0データ構造のコンテンツ暗号化に使用する「Encrypt0」。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-4"><artwork name="" type="" align="left" alt="">
       COSE_Encrypt データ構造の第1レイヤー（つまり、コンテンツの暗号化）のために「Encrypt」を使用します。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-5"><artwork name="" type="" align="left" alt="">
       "Enc_Recipient"は、COSE_Encryptデータ構造に配置される受信者エンコーディングです。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-6"><artwork name="" type="" align="left" alt="">
       MACつきメッセージ構造に配置するための受信者エンコーディング「Mac_Recipient」。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-7"><artwork name="" type="" align="left" alt="">
  「<bcp14>Rec_Recipient</bcp14>」は、受信者構造に配置される受信者エンコーディングを表します。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-8">2.  The protected attributes from the body structure encoded in a
    bstr type.  If there are no protected attributes, a bstr of
    length zero is used.</t>
        <t indent="0" pn="section-5.3-9">3. アプリケーションからエンコードされた保護された属性は、bstr タイプで提供されます。このフィールドが提供されていない場合、長さゼロの bstr がデフォルトで使用されます（このフィールドの構築に関するアプリケーションのガイダンスについては、セクション4.3を参照してください）。</t>
        <t indent="0" pn="section-5.3-10">上記のテキストを記述するCDDLの断片は以下の通りです：</t>
        <t indent="0" pn="section-5.3-11">Enc_structure = [ context : 「暗号化」/「Encrypt0」/「受信者の暗号化」/「受信者のMAC」/「受信者の記録」, protected : empty_or_serialized_map, external_aad : bstr ]</t>
        <t indent="0" pn="section-5.3-12">メッセージを暗号化する方法：</t>
        <t indent="0" pn="section-5.3-13">1. 適切なフィールドで Enc_structure を作成し、それに値を入れます。</t>
        <t indent="0" pn="section-5.3-14">2. Enc_structureをバイトストリーム（追加認証データ（AAD））にエンコードします。エンコード方法は、セクション14で説明されています。</t>
        <t indent="0" pn="section-5.3-15">3. 暗号化キー（K）を決定します。このステップは、使用されている受信者アルゴリズムのクラスに依存します。以下に該当する場合:</t>
        <t indent="0" pn="section-5.3-16"><artwork name="" type="" align="left" alt="">
    受信者なし：使用される鍵は、アルゴリズムと現在の層の鍵によって決定されます。例として、鍵伝送鍵（セクション12.3）、鍵包装鍵（セクション12.2.1）、または事前共有の秘密鍵があります。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-17"><artwork name="" type="" align="left" alt="">
    直接暗号化および直接鍵合意：鍵は、受信者の構造内の鍵とアルゴリズムによって決定されます。使用する暗号化アルゴリズムと鍵のサイズは、受信者用のKDFの入力です。（直接の場合、KDFは同一演算と考えることができます。）これらのアルゴリズムの例は、セクション12.1.2と12.4.1にあります。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-18"><artwork name="" type="" align="left" alt="">
    その他: キーはランダムにまたは擬似乱数的に生成されます。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-19">4. K（暗号化キー）、P（平文）、およびAADで暗号化アルゴリズムを呼び出します。返された暗号文を構造体の「ciphertext」フィールドに配置します。</t>
        <t indent="0" pn="section-5.3-20">5. メッセージの受信者に対して、K（暗号化キー）を平文として、その受信者のために再帰的に暗号化アルゴリズムを実行します。</t>
        <t indent="0" pn="section-5.3-21">メッセージを復号化する方法:</t>
        <t indent="0" pn="section-5.3-22">1. 適切なフィールドで Enc_structure を作成し、それを埋める。</t>
        <t indent="0" pn="section-5.3-23">2. Enc_structure をバイトストリーム (AAD) にエンコードします。エンコードの詳細については、セクション14を参照してください。</t>
        <t indent="0" pn="section-5.3-24">3. 変換キーを決定します。このステップは、使用されている受信者のアルゴリズムのクラスに依存します。次の場合には：</t>
        <t indent="0" pn="section-5.3-25"><artwork name="" type="" align="left" alt="">
    <bcp14>宛先なし：</bcp14>使用される鍵は、アルゴリズムと現在のレイヤーでの鍵によって決定されます。例としては、鍵輸送鍵（セクション12.3）、鍵包装鍵（セクション12.2.1）または事前共有の秘密鍵があります。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-26"><artwork name="" type="" align="left" alt="">
    直接暗号化および直接鍵合意：鍵は受信者構造内の鍵とアルゴリズムによって決定されます。使用する暗号化アルゴリズムと鍵のサイズは、受信者向けに使用されるKDFへの入力です。（直接の場合、KDFは同一演算と考えることができます。）これらのアルゴリズムの例については、セクション12.1.2および12.4.1に記載があります。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-27"><artwork name="" type="" align="left" alt="">
  その他: 鍵は、受信者の一つの構造を解読・復号化することによって決定されます。
</artwork>
        </t>
        <t indent="0" pn="section-5.3-28">4. K (使用する復号鍵)、C (暗号文)、およびAADで復号化アルゴリズムを呼び出します。</t>
      </section>
      <section anchor="how-to-encrypt-and-decrypt-for-ae-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-5.4">
        <name slugifiedName="name-how-to-encrypt-and-decrypt-for-ae-algorithms">AEアルゴリズムの暗号化と復号化の方法</name>
        <t indent="0" pn="section-5.4-1">メッセージを暗号化する方法:</t>
        <t indent="0" pn="section-5.4-2">1. 「'protected' フィールドが空であることを確認します。」</t>
        <t indent="0" pn="section-5.4-3">2. この操作に対して外部からの追加認証データが提供されていないことを確認します。</t>
        <t indent="0" pn="section-5.4-4">3. 暗号化キーを決定します。この手順は、使用されている受信者アルゴリズムのクラスに依存します。次の場合に使用します：</t>
        <t indent="0" pn="section-5.4-5"><artwork name="" type="" align="left" alt="">
    受信者なし：使用される鍵は、アルゴリズムと現在の階層での鍵によって決定されます。例としては、鍵輸送鍵（セクション12.3）、鍵包装鍵（セクション12.2.1）、または事前共有の秘密鍵があります。
</artwork>
        </t>
        <t indent="0" pn="section-5.4-6"><artwork name="" type="" align="left" alt="">
    <bcp14>しなければなりません</bcp14>、<bcp14>しなければなりません</bcp14>、<bcp14>要求されています</bcp14>、<bcp14>することになります</bcp14>、<bcp14>することはありません</bcp14>、<bcp14>すべきです</bcp14>、<bcp14>すべきではありません</bcp14>、<bcp14>推奨されます</bcp14>、<bcp14>推奨されません</bcp14>、<bcp14>してもよいです</bcp14>、そして<bcp14>選択できます</bcp14>：受取人の構造にあるキーとアルゴリズムによってキーが決定されます。使用される暗号化アルゴリズムとキーサイズは、受取人用のKDFの入力です。（ダイレクトの場合、KDFは同一操作と考えることができます。）これらのアルゴリズムの例は、セクション12.1.2および12.4.1にあります。
</artwork>
        </t>
        <t indent="0" pn="section-5.4-7"><artwork name="" type="" align="left" alt="">
    その他: 鍵はランダムに生成されます。
</artwork>
        </t>
        <t indent="0" pn="section-5.4-8">4. K（使用する暗号化キー）およびP（平文）と共に、暗号化アルゴリズムを呼び出します。返された暗号文を、構造体の「ciphertext」フィールドに配置します。</t>
        <t indent="0" pn="section-5.4-9">5. メッセージの受信者に対して、暗号化アルゴリズムを再帰的に実行し、平文として暗号化鍵である K を使用します。</t>
        <t indent="0" pn="section-5.4-10">メッセージを復号化する方法：</t>
        <t indent="0" pn="section-5.4-11">1. 'protected' フィールドが空であることを確認します。</t>
        <t indent="0" pn="section-5.4-12">2. この操作に対して外部から追加の認証データが提供されていないことを確認してください。</t>
        <t indent="0" pn="section-5.4-13">3. 復号キーを決定します。このステップは、使用されている受信者アルゴリズムのクラスに依存します。次の場合には:</t>
        <t indent="0" pn="section-5.4-14"><artwork name="" type="" align="left" alt="">
    受信者なし： 使用されるキーは、現在のレイヤーのアルゴリズムとキーによって決定されます。例えば、鍵輸送鍵（セクション12.3）、鍵ラップ鍵（セクション12.2.1）、または事前共有の秘密です。
</artwork>
        </t>
        <t indent="0" pn="section-5.4-15"><artwork name="" type="" align="left" alt="">
    <bcp14>RFCでは、直接暗号化および直接鍵合意があります。鍵は受信者構造内の鍵とアルゴリズムによって決定されます。使用される暗号化アルゴリズムと鍵のサイズは、受信者向けに使用されるKDFの入力となります（直接の場合、KDFは同一操作と考えることができます）。これらのアルゴリズムの例は、12.1.2節および12.4.1節に示されています。</bcp14>
          </artwork>
        </t>
        <t indent="0" pn="section-5.4-16"><artwork name="" type="" align="left" alt="">
    その他: キーは、受信者の構造体の1つを復号化して解読することによって決定されます。
</artwork>
        </t>
        <t indent="0" pn="section-5.4-17">4. K（使用する復号鍵）とC（暗号文）で復号化アルゴリズムを呼び出します。</t>
      </section>
    </section>
    <section anchor="mac-objects" numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-mac-objects">MACオブジェクト</name>
      <t indent="0" pn="section-6-1">COSEは2つの異なるMAC構造をサポートしています。COSE_MAC0は、暗黙的にわかっている鍵を使用するため、受信者の構造が必要ない場合に使用されます。COSE_MACは他のすべての場合に使用されます。これには複数の受信者が必要な場合、鍵が不明な場合、および直接ではない受信者のアルゴリズムなどが含まれます。</t>
      <t indent="0" pn="section-6-2">このセクションでは、COSEでMAC認証を行う際に使用される構造と方法について説明します。このドキュメントでは、暗号化に許可されている受信者アルゴリズムのすべてのクラスの使用が許可されています。</t>
      <t indent="0" pn="section-6-3">MAC操作を使用する場合、2つのモードで使用できます。最初のモードは、MACが計算されてからコンテンツが変更されていないことを確認するためのチェックです。この目的のためには、受信アルゴリズムのどのクラスでも使用できます。2番目のモードは、MACが計算されてからコンテンツが変更されていないことをチェックし、受信アルゴリズムを使用して誰が送信したのかを確認するために使用することです。この機能をサポートする受信アルゴリズムのクラスは、プリシェアドシークレットを使用するものや、静的静的（SS）鍵合意（キーラップの手順を省略）を行うものです。どちらの場合でも、メッセージのMACを作成して送信したエンティティを検証できます。（送信者の情報は、関与するパーティが2つしかいない前提で、メッセージを自分自身に送信しなかった場合に基づいています。）MACメッセージの構造のどちらでも、メッセージを作成および送信したエンティティの起源のプロパティを取得できます。</t>
      <section anchor="maced-message-with-recipients" numbered="true" removeInRFC="false" toc="include" pn="section-6.1">
        <name slugifiedName="name-maced-message-with-recipients">MACed Message with Recipients</name>
        <t indent="0" pn="section-6.1-1">多重受信者MACメッセージは、2つの構造を使用します。ボディを保持するためにこのセクションで定義されたCOSE_Mac構造体と、MAC計算に使用される鍵を保持するためのCOSE_recipient構造体（セクション5.1）です。MAC付きメッセージの例は、付録C.5にあります。</t>
        <t indent="0" pn="section-6.1-2">MAC構造は、使用されるコンテキストに応じてタグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Mac構造は、CBORタグ97で識別されます。これを表すCDDLフラグメントは次のとおりです：</t>
        <t indent="0" pn="section-6.1-3">COSE_Mac_Tagged = #6.97(COSE_Mac)</t>
        <t indent="0" pn="section-6.1-4">COSE_Mac構造体はCBOR配列です。配列のフィールドは順番に以下のとおりです：</t>
        <t indent="0" pn="section-6.1-5">保護されています: これはセクション3で説明されている通りです。</t>
        <t indent="0" pn="section-6.1-6">未保護: これはセクション3で説明されているようにです。</t>
        <t indent="0" pn="section-6.1-7">ペイロード：このフィールドには、MAC化されるシリアライズされたコンテンツが含まれます。メッセージにペイロードが存在しない場合、アプリケーションは別途ペイロードを提供することが必要です。ペイロードは変更なしに輸送されるようにするために、bstrでラップされます。ペイロードが別々に輸送される場合（つまり、切り離されたコンテンツ）、この場所にはnilのCBOR値が配置され、アプリケーションは変更なしに輸送されることを保証する責任があります。</t>
        <t indent="0" pn="section-6.1-8">タグ：このフィールドにはMAC値が含まれています。</t>
        <t indent="0" pn="section-6.1-9">受信者: これはセクション5.1で説明されているようにします。</t>
        <t indent="0" pn="section-6.1-10">上記のテキストを表すCOSE_MacのためのCDDLフラグメントは次のとおりです。</t>
        <t indent="0" pn="section-6.1-11">COSE_Mac = [ Headers, payload : bstr / nil, tag : bstr, recipients :[+COSE_recipient] ]

COSE_Mac = [ ヘッダー, ペイロード : バイナリストリング / 無し, タグ : バイナリストリング, 受信者 :[+COSE_recipient] ]</t>
      </section>
      <section anchor="maced-messages-with-implicit-key" numbered="true" removeInRFC="false" toc="include" pn="section-6.2">
        <name slugifiedName="name-maced-messages-with-implicit-key">MAC付きのメッセージ、暗黙のキー</name>
        <t indent="0" pn="section-6.2-1">このセクションでは、受信者が暗黙にわかっている場合にMAC認証を行う際に使用される構造と方法を説明します。</t>
        <t indent="0" pn="section-6.2-2">MACされたメッセージは、このセクションで定義されているCOSE_Mac0構造体を使用して本文を運びます。暗黙のキーを持つMACされたメッセージの例は、付録C.6にあります。</t>
        <t indent="0" pn="section-6.2-3">MAC構造体は、使用される文脈に応じて、タグ付きまたはタグなしでエンコードすることができます。タグ付きのCOSE_Mac0構造体は、CBORタグ17で識別されます。これを表すCDDLフラグメントは次のとおりです：</t>
        <t indent="0" pn="section-6.2-4">COSE_Mac0_Tagged = #6.17(COSE_Mac0)</t>
        <t indent="0" pn="section-6.2-5">COSE_Mac0構造体はCBOR配列です。配列のフィールドは順番に次の通りです：</t>
        <t indent="0" pn="section-6.2-6">保護されています：これはセクション3で説明されているものです。</t>
        <t indent="0" pn="section-6.2-7">未保護：これはセクション3で説明されているものです。</t>
        <t indent="0" pn="section-6.2-8">payload: これはセクション6.1に記載されているとおりです。</t>
        <t indent="0" pn="section-6.2-9">タグ：このフィールドにはMAC値が含まれています。</t>
        <t indent="0" pn="section-6.2-10">上記のテキストに対応するCDDLフラグメントは以下の通りです：</t>
        <t indent="0" pn="section-6.2-11">COSE_Mac0 = [ Headers, payload : bstr / nil, tag : bstr, ]

COSE_Mac0 = [ ヘッダー, ペイロード : bstr / nil, タグ : bstr, ]</t>
      </section>
      <section anchor="how-to-compute-and-verify-a-mac" numbered="true" removeInRFC="false" toc="include" pn="section-6.3">
        <name slugifiedName="name-how-to-compute-and-verify-a-mac">MACを計算し、検証する方法</name>
        <t indent="0" pn="section-6.3-1">認証するデータの一貫したエンコードを得るために、MAC_structureは正準形を持つように使用されます。MAC_structureはCBOR配列です。MAC_structureのフィールドは以下の順序であります。</t>
        <t indent="0" pn="section-6.3-2">1. エンコードされている構造を識別するテキスト文字列です。COSE_Mac 構造体の場合、この文字列は「MAC」です。COSE_Mac0 構造体の場合、この文字列は「MAC0」です。</t>
        <t indent="0" pn="section-6.3-3">2. COSE_MAC構造から保護された属性です。保護された属性がない場合は、長さゼロのbstrが使用されます。</t>
        <t indent="0" pn="section-6.3-4">3. アプリケーションから保護された属性を、bstr タイプとしてエンコードします。このフィールドが指定されていない場合、長さがゼロのバイナリ文字列にデフォルトで設定されます（このフィールドの構築に関するアプリケーションのガイダンスについては、セクション4.3を参照してください）。</t>
        <t indent="0" pn="section-6.3-5">4. ここに運搬方法に関係なく配置される、bstr型でエンコードされたMACを持つペイロード。</t>
        <t indent="0" pn="section-6.3-6">上記のテキストに対応するCDDLフラグメントは次のとおりです：</t>
        <t indent="0" pn="section-6.3-7">MAC_structure = [ context : 「MAC」または「MAC0」, protected : 空またはシリアライズされたマップ, external_aad : バイナリ文字列, payload : バイナリ文字列 ]</t>
        <t indent="0" pn="section-6.3-8">MACを計算する手順は次のとおりです：</t>
        <t indent="0" pn="section-6.3-9">1. 適切なフィールドでMAC_structureを作成し、それを埋める。</t>
        <t indent="0" pn="section-6.3-10">2. 値ToBeMacedを作成します。MAC_structureをバイトストリームにエンコードし、セクション14で説明されているエンコーディングを使用します。</t>
        <t indent="0" pn="section-6.3-11">3. K（使用するキー）、alg（MACを作成するアルゴリズム）、および ToBeMaced（MACを計算する値）を渡してMAC作成アルゴリズムを呼び出します。</t>
        <t indent="0" pn="section-6.3-12">4. 生成されたMACをCOSE_MacまたはCOSE_Mac0構造体の'tag'フィールドに配置します。</t>
        <t indent="0" pn="section-6.3-13">5. メッセージの各受信者のためにMACキーを暗号化して符号化します。</t>
        <t indent="0" pn="section-6.3-14">MACを検証する手順は以下の通りです：</t>
        <t indent="0" pn="section-6.3-15">1. MAC_structureオブジェクトを作成し、適切なフィールドで埋める。</t>
        <t indent="0" pn="section-6.3-16">2. 値ToBeMacedを作成します。MAC_structureをバイトストリームにエンコードし、Section 14で説明されているエンコードを使用します。</t>
        <t indent="0" pn="section-6.3-17">3. メッセー ジの受信者のうちの一人から暗号鍵を取得します。</t>
        <t indent="0" pn="section-6.3-18">4. K（使用するキー）、alg（MACを生成するアルゴリズム）、ToBeMaced（MACを計算する値）を渡してMAC作成アルゴリズムを呼び出します。</t>
        <t indent="0" pn="section-6.3-19">5. COSE_MacまたはCOSE_Mac0構造体の'tag'フィールドとMAC値を比較します。</t>
      </section>
    </section>
    <section anchor="key-objects" numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-key-objects">キーオブジェクト</name>
      <t indent="0" pn="section-7-1">COSEキーコンテナは、CBORマップオブジェクト上に構築されます。COSEキーに現れることができる共通パラメーターのセットは、IANAの「COSEキーコモンパラメーター」レジストリ（セクション16.5）で見つけることができます。特定のキータイプに対して定義された追加のパラメーターは、IANAの「COSEキータイプパラメーター」レジストリ（セクション16.6）で見つけることができます。</t>
      <t indent="0" pn="section-7-2">COSEキーセットは、基礎となる型としてCBOR配列オブジェクトを使用します。配列要素の値はCOSEキーです。COSEキーセットは、配列内に少なくとも1つの要素を<bcp14>しなければなりません（MUST）</bcp14>。COSEキーセットの例は、付録C.7に示されています。</t>
      <t indent="0" pn="section-7-3">各要素は、COSE Key Set内の<bcp14>しなければなりません（MUST）</bcp14>個別に処理されます。COSE Key Set内の要素の1つが不正形式であるか、アプリケーションが理解できないキーを使用している場合、そのキーは無視され、他のキーは通常通りに処理されます。</t>
      <t indent="0" pn="section-7-4">要素「kty」は、COSE_Key マップ内の必須要素です。</t>
      <t indent="0" pn="section-7-5"><bcp14>MUST</bcp14> 辞書記法で、COSE_Key および COSE_KeySet を記述します。</t>
      <t indent="0" pn="section-7-6">COSE_Key = { 1 =&gt; tstr / int, ; kty ? 2 =&gt; bstr, ; kid ? 3 =&gt; tstr / int, ; alg ? 4 =&gt; [+ (tstr / int)], ; key_ops ? 5 =&gt; bstr, ; Base IV * label =&gt; values }

COSE_Key = { 1 =&gt; tstr / int, ；kty ? 2 =&gt; bstr, ；kid ? 3 =&gt; tstr / int, ；alg ? 4 =&gt; [+ (tstr / int)], ；key_ops ? 5 =&gt; bstr, ；Base IV * label =&gt; values }</t>
      <t indent="0" pn="section-7-7">COSE_KeySet = [＋COSE_Key]</t>
      <section anchor="cose-key-common-parameters" numbered="true" removeInRFC="false" toc="include" pn="section-7.1">
        <name slugifiedName="name-cose-key-common-parameters">COSE鍵共通パラメーター</name>
        <t indent="0" pn="section-7.1-1">このドキュメントは、COSEキーオブジェクトの共通パラメーターセットを定義しています。テーブル3は、このセクションで定義されているパラメーターの概要を提供しています。また、特定のキータイプに対して定義されたパラメーターもあります。キータイプ固有のパラメーターは、セクション13に記載されています。</t>
        <t indent="0" pn="section-7.1-2"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前 </td>
                  <td align="left">ラベル </td>
                  <td align="left">CBORのタイプ </td>
                  <td align="left">値の登録 </td>
                  <td align="left">説明</td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> kty </td>
                <td align="left">1</td>
                <td align="left">tstr / int</td>
                <td align="left">COSEキー共通パラメーター</td>
                <td align="left">キーのタイプの識別</td>
              </tr>
              <tr>
                <td align="left"> kid </td>
                <td align="left">2</td>
                <td align="left">bstr</td>
                <td align="left"/>
                <td align="left">キーの識別値 - メッセージ中のkidに一致する値</td>
              </tr>
              <tr>
                <td align="left"> alg </td>
                <td align="left">3</td>
                <td align="left">tstr / int</td>
                <td align="left">COSEアルゴリズム</td>
                <td align="left">このアルゴリズムに対するキーの使用制限</td>
              </tr>
              <tr>
                <td align="left"> key_ops </td>
                <td align="left">4</td>
                <td align="left">[+ (tstr/int)]</td>
                <td align="left"/>
                <td align="left">許可される操作の制限セット</td>
              </tr>
              <tr>
                <td align="left"> Base IV </td>
                <td align="left">5</td>
                <td align="left">bstr</td>
                <td align="left"/>
                <td align="left">Partial IVsとXORされるBase IV</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-7.1-3"><artwork name="" type="" align="left" alt="">
                       テーブル3: キーマップのラベル
</artwork>
        </t>
        <t indent="0" pn="section-7.1-4">kty：このパラメーターは、この構造体のキーファミリを識別し、したがって、見つかるべきキータイプ固有のパラメーターセットを特定するために使用されます。このドキュメントで定義されている値のセットは、表21にあります。このパラメーターは<bcp14>しなければなりません（MUST）</bcp14>キーオブジェクトに含まれている必要があります。実装は、処理中のアルゴリズムに適切なキータイプであることを確認する<bcp14>しなければなりません（MUST）</bcp14>。キータイプは信頼の決定プロセスの一部として含まれる<bcp14>しなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-7.1-5">alg：このパラメーターは、鍵と一緒に使用されるアルゴリズムを制限するために使用されます。もし鍵構造にこのパラメーターが存在する場合、アプリケーションはこのアルゴリズムが鍵が使用されるアルゴリズムと一致していることを確認<bcp14>しなければなりません（MUST）</bcp14>。もしアルゴリズムが一致しない場合、この鍵オブジェクトは暗号操作を実行するために<bcp14>してはなりません（MUST NOT）</bcp14>。同じ鍵は異なるアルゴリズムが指定されている別の鍵構造に存在するかもしれませんが、これはセキュリティーの観点からは望ましくない行為とされます。</t>
        <t indent="0" pn="section-7.1-6">kid: このパラメーターは、キーに識別子を与えるために使用されます。識別子は構造化されておらず、ユーザーが提供した文字列からキーの公開部分で計算された値まで、何でも良いです。このフィールドは、確認する必要のあるキーのセットを絞り込むために、メッセージの中の 'kid' パラメーターと一致させるために意図されています。</t>
        <t indent="0" pn="section-7.1-7">key_ops（キーオプス）：このパラメーターは、キーに使用する操作の集合を制限するために定義されています。フィールドの値は、テーブル4の値の配列です。アルゴリズムは、出現を許可されるキーの操作の値を定義し、特定の操作には必要です。値のセットは、<xref target="RFC7517" format="default" sectionFormat="of" derivedContent="RFC7517"/>および<xref target="W3C.WebCrypto" format="default" sectionFormat="of" derivedContent="W3C.WebCrypto"/>と一致します。</t>
        <t indent="0" pn="section-7.1-8">Base IV: このパラメーターは、IVのベース部分を運ぶために定義されています。これは、セクション3.1で定義されたPartial IVヘッダーパラメーターと共に使用するように設計されています。このフィールドは、Partial IVとキーを関連付け、メッセージごとにPartial IVで修正されるキーを提供します。</t>
        <t indent="0" pn="section-7.1-9"><artwork name="" type="" align="left" alt="">
    Base IVをアプリケーションで使用する際には、非常に細心の注意が必要です。同じIVが2回使用されると、多くの暗号化アルゴリズムの安全性が低下します。
</artwork>
        </t>
        <t indent="0" pn="section-7.1-10"><artwork name="" type="" align="left" alt="">
   異なる送信者ごとに派生キーが生成される場合、ゼロを始めとする部分初期化ベクトル（IV）を使用する場合は、同じ基準IVを使用することで、IVが単一のキーに対して2回使用されないようにできる可能性が高いです。 異なる送信者ごとに異なるキーが生成される場合は、同じ基準IVから始めることで、この条件を満たす可能性が高いです。 同じキーが複数の送信者で使用される場合は、アプリケーションは送信者間でIV空間を分割する手段を提供する必要があります。 これは、異なる基点を提供するか、異なる部分IVで開始し、再鍵化する前に送信するメッセージの数を制限することによって行うことができます。
</artwork>
        </t>
        <t indent="0" pn="section-7.1-11"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">値</td>
                  <td align="left">説明                                     </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> サイン </td>
                <td align="left">1 </td>
                <td align="left">キーは署名の作成に使用されます。プライベートキーフィールドが必要です。                             </td>
              </tr>
              <tr>
                <td align="left"> 検証</td>
                <td align="left">2</td>
                <td align="left">キーは署名の検証に使用されます。 </td>
              </tr>
              <tr>
                <td align="left"> 暗号化</td>
                <td align="left">3</td>
                <td align="left">キーは鍵転送の暗号化に使用されます。   </td>
              </tr>
              <tr>
                <td align="left"> 復号化 </td>
                <td align="left">4 </td>
                <td align="left">キーは鍵転送の復号化に使用されます。プライベートキーフィールドが必要です。                    </td>
              </tr>
              <tr>
                <td align="left"> 包含</td>
                <td align="left">5</td>
                <td align="left">キーは鍵包装の暗号化に使用されます。        </td>
              </tr>
              <tr>
                <td align="left"> キー</td>
              </tr>
              <tr>
                <td align="left"> 非包含</td>
                <td align="left">6</td>
                <td align="left">キーは鍵包装の復号化に使用されます。        </td>
              </tr>
              <tr>
                <td align="left"> キー</td>
                <td align="left"/>
                <td align="left">プライベートキーフィールドが必要です。                    </td>
              </tr>
              <tr>
                <td align="left"> 生成</td>
                <td align="left">7</td>
                <td align="left">キーは派生キーの生成に使用されます。  </td>
              </tr>
              <tr>
                <td align="left"> キー</td>
                <td align="left"/>
                <td align="left">プライベートキーフィールドが必要です。                             </td>
              </tr>
              <tr>
                <td align="left"> 生成</td>
                <td align="left">8</td>
                <td align="left">キーはキーとして使用しないビットの派生に使用されます。  プライベートキーフィールドが必要です。   </td>
              </tr>
              <tr>
                <td align="left"> MAC</td>
                <td align="left">9</td>
                <td align="left">キーはMACの作成に使用されます。              </td>
              </tr>
              <tr>
                <td align="left"> 作成</td>
              </tr>
              <tr>
                <td align="left"> MAC</td>
                <td align="left">10</td>
                <td align="left">キーはMACの検証に使用されます。            </td>
              </tr>
              <tr>
                <td align="left"> 検証</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-7.1-12"><artwork name="" type="" align="left" alt="">
                   Table 4: キー操作の値
</artwork>
        </t>
      </section>
    </section>
    <section anchor="signature-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-8">
      <name slugifiedName="name-signature-algorithms">署名アルゴリズム</name>
      <t indent="0" pn="section-8-1"><bcp14>署名アルゴリズムには2つのスキームがあります。1つ目は追加データ付き署名です。このスキームでは、メッセージの内容が処理され、署名が生成されます。この署名は追加データと呼ばれます。ECDSAやRSA確率的署名方式（RSASSA-PSS）などのアルゴリズムで使用されるスキームです。（実際、RSASSA-PSSのSSAは追加データ付き署名方式を表しています。）</bcp14></t>
      <t indent="0" pn="section-8-2">このスキームの署名関数は次のとおりです：</t>
      <t indent="0" pn="section-8-3"><artwork name="" type="" align="left" alt="">
   シグネチャ = メッセージコンテンツをキーで署名する
</artwork>
      </t>
      <t indent="0" pn="section-8-4"><artwork name="" type="" align="left" alt="">
   valid = メッセージ内容、鍵、署名の検証
</artwork>
      </t>
      <t indent="0" pn="section-8-5">第2のスキームは、メッセージリカバリと署名です（このアルゴリズムの例は、<xref target="PVSig" format="default" sectionFormat="of" derivedContent="PVSig"/>）。このスキームでは、メッセージの内容が処理されますが、一部は署名に含まれます。メッセージの内容を署名に移動することで、より小さな署名が可能になります。署名のサイズは依然として大きい可能性がありますが、メッセージの内容は縮小されます。これには、これらのアルゴリズムを実装するシステムとそれらを使用するアプリケーションに対する影響があります。まず、メッセージの内容は署名が検証されるまで完全に利用できません。その時点までは、署名の内部に含まれるメッセージの一部は回復できません。次に、署名の強度のセキュリティー分析は、メッセージの内容の構造に非常に基づいています。予測可能性の高いメッセージでは、署名プロセスの一環として追加のランダム性が必要です。最悪の場合、付録付きの署名と同じになります。最後に、複数の署名がメッセージに適用される場合、すべての署名アルゴリズムが同じ数のバイトのメッセージ内容を消費する必要があります。つまり、異なるスキームを単一のメッセージに混在させることはサポートされておらず、リカバリ署名スキームが使用される場合、すべての署名に同じ量のコンテンツを消費する必要があります。</t>
      <t indent="0" pn="section-8-6">このスキームの署名機能は以下のとおりです：</t>
      <t indent="0" pn="section-8-7">署名、送信されたメッセージ = メッセージの内容を署名する（Sign）、キーを使用します。</t>
      <t indent="0" pn="section-8-8">有効な場合、メッセージの内容は「メッセージの送信、鍵、署名の検証」によって検証されます。</t>
      <t indent="0" pn="section-8-9"><bcp14>署名アルゴリズムは、COSE_SignatureおよびCOSE_Sign1構造と共に使用されます。現時点では、COSEとの使用のために付録を持つ署名のみが定義されています。しかし、効果的なサイズ削減が可能であるという理由から、メッセージリカバリアルゴリズムを使用した署名の利用に関心が強く示されています。実装では、将来の統合のためにこれを考慮する必要があります。</bcp14></t>
      <section anchor="ecdsa" numbered="true" removeInRFC="false" toc="include" pn="section-8.1">
        <name slugifiedName="name-ecdsa">ECDSA</name>
        <t indent="0" pn="section-8.1-1">ECDSAはECCを使用した署名アルゴリズムを定義しています。実装は<bcp14>すべきです（SHOULD）</bcp14>決定論的ECDSAのバージョンを使用することをお勧めします。このバージョンは<xref target="RFC6979" format="default" sectionFormat="of" derivedContent="RFC6979"/>で定義されています。決定論的署名アルゴリズムの使用により、システムはランダム数生成器に依存せずに、同じ値の 'k'（メッセージ毎のランダム値）を生成することを回避できます。値 'k' の偏りがある生成は攻撃され、この値の衝突は鍵の漏洩につながります。さらに、決定論的ECDSAは署名アルゴリズムの決定論的なテストを行うことも可能にします。決定論的ECDSAの使用は、プライベートキーを作成する際の良好なランダム数生成の必要性を減じるものではありません。</t>
        <t indent="0" pn="section-8.1-2">ECDSA署名アルゴリズムはハッシュ関数（h）でパラメーター化されます。ハッシュ関数の出力の長さが鍵のグループよりも大きい場合、ハッシュ出力の左端のバイトが使用されます。</t>
        <t indent="0" pn="section-8.1-3">このドキュメントで定義されたアルゴリズムは、表5に記載されています。</t>
        <t indent="0" pn="section-8.1-4"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">値</td>
                  <td align="left">ハッシュ</td>
                  <td align="left">説明         </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> ES256</td>
                <td align="left">-7</td>
                <td align="left">SHA-256</td>
                <td align="left">ECDSA w/ SHA-256 </td>
              </tr>
              <tr>
                <td align="left"> ES384</td>
                <td align="left">-35</td>
                <td align="left">SHA-384</td>
                <td align="left">ECDSA w/ SHA-384 </td>
              </tr>
              <tr>
                <td align="left"> ES512</td>
                <td align="left">-36</td>
                <td align="left">SHA-512</td>
                <td align="left">ECDSA w/ SHA-512 </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-8.1-5"><artwork name="" type="" align="left" alt="">
                   テーブル5：ECDSAアルゴリズムの値
</artwork>
        </t>
        <t indent="0" pn="section-8.1-6">このドキュメントは、ECDSAが曲線P-256、P-384、およびP-521だけで動作するように定義しています。このドキュメントでは、曲線を 'EC2'（2座標楕円曲線）キータイプを使用してエンコードすることが要求されています。実装は、署名の作成と検証時にキータイプと曲線が正しいことを確認する必要があります。他のドキュメントでは、将来的に他の曲線や点との連携を定義することができます。</t>
        <t indent="0" pn="section-8.1-7">相互運用性を促進するために、SHA-256はカーブP-256とのみ使用されることが提案されており、SHA-384はカーブP-384とのみ使用され、SHA-512はカーブP-521と使用されることが推奨されています。これは、<xref target="RFC5480" section="4" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc5480#section-4" derivedContent="RFC5480"/>での推奨事項と一致しています。</t>
        <t indent="0" pn="section-8.1-8">署名アルゴリズムは、整数のペア（R、S）を生成します。これらの整数の長さは、署名プロセスに使用される鍵の長さと同じです。署名は、整数を鍵の長さと同じ長さのバイト列に変換してエンコードされます。長さは最も近いバイトに切り上げられ、正しい長さに到達するためにゼロビットで左パディングされます。その後、2つの整数は連結され、結果の署名が形成されます。</t>
        <t indent="0" pn="section-8.1-9"><xref target="RFC8017" format="default" sectionFormat="of" derivedContent="RFC8017"/>で定義された関数を使用して、署名は以下のようになります：署名 = I2OSP(R, n) | I2OSP(S, n)、ただし n = key_length / 8 の上限付き整数部分</t>
        <t indent="0" pn="section-8.1-10">このアルゴリズムでCOSEキーを使用する場合、次のチェックが行われます：<bcp14>します（MUST）</bcp14>。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1-11">
          <li pn="section-8.1-11.1">「'kty'フィールドは存在しなければなりません（MUST）、かつ『EC2』でなければなりません（MUST）」</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1-12">
          <li pn="section-8.1-12.1">もし「'alg'」フィールドが存在する場合、それは使用されているECDSA署名アルゴリズムと一致しなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1-13">
          <li pn="section-8.1-13.1">もし 'key_ops' フィールドが存在する場合、ECDSA 署名を作成する際には、'key_ops' フィールドに 'sign' を含める必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1-14">
          <li pn="section-8.1-14.1">もし 'key_ops' フィールドが存在する場合、ECDSA 署名の検証時に 'verify' を含める必要があります。</li>
        </ul>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8.1.1">
          <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
          <t indent="0" pn="section-8.1.1-1">署名のセキュリティー強度は、キーのビット長に関連付けられたセキュリティー強度とハッシュ関数のセキュリティー強度の最小値によって超えられない。</t>
          <t indent="0" pn="section-8.1.1-2">注意：このテクニックの使用は、良好な乱数生成が存在する場合でも良い考えです。これにより、2つの署名操作で同じ値の「k」を持つ可能性が低くなり、再現可能な署名値を使用することができるため、テストに役立ちます。</t>
          <t indent="0" pn="section-8.1.1-3">ECDSA署名アルゴリズムに対して理論的に実行可能な2つの代替攻撃が存在します。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1.1-4">
            <li pn="section-8.1.1-4.1">署名の検証に使用される曲線を変更する場合：署名の検証に使用される曲線を変更すると、異なる曲線で計算された同じ署名を持つ2つのメッセージが存在する可能性があります。新しい曲線に対する唯一の要件は、その位数が古い曲線と同じであり、クライアントに受け入れられることです。例えば、曲線secp256r1（またはP-256とも呼ばれます）からsecp256k1へ変更することが考えられます（どちらも256ビットの曲線です）。現時点では、この攻撃のバージョンに対処する方法は制限されること以外にありません。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.1.1-5">
            <li pn="section-8.1.1-5.1">
              <bcp14>MUST</bcp14> include a signature algorithm identifier in the protected header in order to mitigate the attack mentioned above. The signature algorithm identifier can be used to change the hash function used for validating the signature. If there are two different hash functions of the same length or if truncation of a hash function is possible, collisions between the hash functions instead of within a single hash function could occur. Therefore, it is <bcp14>RECOMMENDED</bcp14> to use a signature algorithm identifier to address this issue and ensure the integrity of the signature.</li>
          </ul>
        </section>
      </section>
      <section anchor="edwards-curve-digital-signature-algorithms-(eddsas)" numbered="true" removeInRFC="false" toc="include" pn="section-8.2">
        <name slugifiedName="name-edwards-curve-digital-signature-algorithms-(eddsas)">エドワーズ曲線デジタル署名アルゴリズム（EdDSA）</name>
        <t indent="0" pn="section-8.2-1"><xref target="RFC8032" format="default" sectionFormat="of" derivedContent="RFC8032"/>は、楕円曲線署名方式であるEdwards-curve Digital Signature Algorithm (EdDSA)について説明しています。この文書では、署名アルゴリズムはedwards25519とedwards448の曲線のパラメーターを使用してインスタンス化されます。さらに、EdDSAアルゴリズムの2つのバリアント（Pure EdDSAおよびHashEdDSA）についても説明しています。Pure EdDSAでは、署名前にコンテンツにハッシュ関数を適用しない場合、HashEdDSAでは署名前にコンテンツにハッシュ関数を適用し、そのハッシュ関数の結果を署名します。EdDSAでは、署名アルゴリズム内で署名対象となるコンテンツ（メッセージまたはプリハッシュ値）が2回処理されます。COSEとの使用においては、純粋なEdDSAバージョンのみが使用されます。これは、非常に大きなコンテンツが必要とされることは予想されておらず、メッセージ構造の配置に基づいて、署名を作成または検証するためにメモリにメッセージ全体を保持する必要があるためです。つまり、ハッシュのブロック更新を行い、その後メッセージをメモリから削除する必要性はないようです。アプリケーションは、メッセージの内容をハッシュ値として定義し、COSEオブジェクト（ハッシュ値と共に）とコンテンツを別々に転送することで同じ機能を提供することができます。</t>
        <t indent="0" pn="section-8.2-2">このドキュメントで定義されたアルゴリズムは、表6に記載されています。複数の曲線で使用できる、単一の署名アルゴリズムが定義されています。</t>
        <t indent="0" pn="section-8.2-3"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">値</td>
                  <td align="left">説明 </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> EdDSA</td>
                <td align="left">-8</td>
                <td align="left">EdDSA       </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-8.2-4"><artwork name="" type="" align="left" alt="">
                   テーブル6：EdDSAアルゴリズムの値
</artwork>
        </t>
        <t indent="0" pn="section-8.2-5"><xref target="RFC8032" format="default" sectionFormat="of" derivedContent="RFC8032"/>は、署名値のエンコード方法について説明しています。</t>
        <t indent="0" pn="section-8.2-6">このアルゴリズムでCOSEキーを使用する場合、以下のチェックが行われます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.2-7">
          <li pn="section-8.2-7.1">
            <bcp14>'kty'フィールドは存在しなければならず、'OKP'（オクテットキーペア）でなければなりません。</bcp14></li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.2-8">
          <li pn="section-8.2-8.1">
            <bcp14>「crv」フィールドは存在しなければならず、この署名アルゴリズムに定義された曲線である必要があります。</bcp14></li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.2-9">
          <li pn="section-8.2-9.1">もし'alg'フィールドが存在する場合、それは'EdDSA'と一致しなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.2-10">
          <li pn="section-8.2-10.1">
            <bcp14>key_ops</bcp14>フィールドが存在する場合、EdDSA署名を作成する際に<bcp14>sign</bcp14>を含まなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8.2-11">
          <li pn="section-8.2-11.1">もし 'key_ops' フィールドが存在する場合、EdDSA 署名を検証する際に 'verify' を含む必要があります。</li>
        </ul>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8.2.1">
          <name slugifiedName="name-security-considerations">セキュリティーの考慮事項</name>
          <t indent="0" pn="section-8.2.1-1">公開値の計算方法は、EdDSAと楕円曲線Diffie-Hellman（ECDH）で異なります。そのため、これらのアルゴリズムを互いに使用するべきではありません。</t>
          <t indent="0" pn="section-8.2.1-2">バッチ署名の検証が行われる場合、十分にシード化された暗号論的乱数発生器が<bcp14>要求されています（REQUIRED）</bcp14>。署名と非バッチ署名の検証は決定論的な操作であり、どのような種類の乱数も必要ありません。</t>
        </section>
      </section>
    </section>
    <section anchor="message-authentication-code-(mac)-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-9">
      <name slugifiedName="name-message-authentication-code-(mac)-algorithms">メッセージ認証コード（MAC）アルゴリズム</name>
      <t indent="0" pn="section-9-1">メッセージ認証コード（MAC）はデータの認証と整合性保護を提供します。MACはデータの発信元をほとんどまたは全く提供しません。たとえば、MACは送信者のアイデンティティを第三者に証明するために使用されることがあります。</t>
      <t indent="0" pn="section-9-2">MACsは署名付きアルゴリズムと同じスキームを使用します。メッセージの内容が処理され、認証コードが生成されます。認証コードは頻繁にタグと呼ばれます。</t>
      <t indent="0" pn="section-9-3">MAC関数は次のとおりです：</t>
      <t indent="0" pn="section-9-4">tag = MAC_Create（メッセージコンテンツ、キー）</t>
      <t indent="0" pn="section-9-5">valid = MAC_Verify（メッセージの内容、キー、タグ）</t>
      <t indent="0" pn="section-9-6">MACアルゴリズムは、ブロック暗号アルゴリズム（つまり、AES-MAC）またはハッシュアルゴリズム（つまり、ハッシュベースのメッセージ認証コード（HMAC））に基づいています。このドキュメントでは、これらの構築方法を使用したMACアルゴリズムを定義しています。</t>
      <t indent="0" pn="section-9-7">MACアルゴリズムは、COSE_MacおよびCOSE_Mac0の構造に使用されます。</t>
      <section anchor="hash-based-message-authentication-codes-(hmacs)" numbered="true" removeInRFC="false" toc="include" pn="section-9.1">
        <name slugifiedName="name-hash-based-message-authentication-codes-(hmacs)">メッセージ認証コード（HMAC）</name>
        <t indent="0" pn="section-9.1-1">HMAC <xref target="RFC2104" format="default" sectionFormat="of" derivedContent="RFC2104"/> <xref target="RFC4231" format="default" sectionFormat="of" derivedContent="RFC4231"/>は、長さ拡張攻撃に対処するために設計されています。このアルゴリズムはまた、新しいハッシュアルゴリズムをハッシュ関数を変更することなしに直接組み込むことを可能にするために設計されています。HMACの設計プロセスは、MD5などのハッシュアルゴリズムのセキュリティーが時間とともに低下している一方で、HMACとMD5を組み合わせたセキュリティーがまだ妥協されていないことが示されています<xref target="RFC6151" format="default" sectionFormat="of" derivedContent="RFC6151"/>。</t>
        <t indent="0" pn="section-9.1-2">HMACアルゴリズムは、内部および外部のパディング、ハッシュ関数（h）、および認証タグ値の長さによってパラメーター化されます。この仕様では、内部および外部のパディングは、<xref target="RFC2104" format="default" sectionFormat="of" derivedContent="RFC2104"/>で設定された値で固定されています。認証タグの長さは、偽造を生成する難度に対応します。制約のある環境での使用のために、切り詰められた一連のHMACアルゴリズムを定義します。</t>
        <t indent="0" pn="section-9.1-3">現在、切り捨てに関する既知の問題はありません。ただし、メッセージタグのセキュリティー強度はそれに応じて弱体化します。切り捨てる場合、左端のタグの長さビットが保持され、送信されます。</t>
        <t indent="0" pn="section-9.1-4">このドキュメントで定義されているアルゴリズムは、テーブル7にあります。</t>
        <t indent="0" pn="section-9.1-5"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前 </td>
                  <td align="left">値   </td>
                  <td align="left">ハッシュ </td>
                  <td align="left">タグ長</td>
                  <td align="left">説明                     </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> HMAC</td>
                <td align="left">4</td>
                <td align="left">SHA-256</td>
                <td align="left">64</td>
                <td align="left">HMAC w/ SHA-256          </td>
              </tr>
              <tr>
                <td align="left"> 256/64</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left"/>
                <td align="left">64ビットに切り詰める      </td>
              </tr>
              <tr>
                <td align="left"> HMAC</td>
                <td align="left">5</td>
                <td align="left">SHA-256</td>
                <td align="left">256</td>
                <td align="left">HMAC w/ SHA-256          </td>
              </tr>
              <tr>
                <td align="left"> 256/256</td>
              </tr>
              <tr>
                <td align="left"> HMAC</td>
                <td align="left">6</td>
                <td align="left">SHA-384</td>
                <td align="left">384</td>
                <td align="left">HMAC w/ SHA-384          </td>
              </tr>
              <tr>
                <td align="left"> 384/384</td>
              </tr>
              <tr>
                <td align="left"> HMAC</td>
                <td align="left">7</td>
                <td align="left">SHA-512</td>
                <td align="left">512</td>
                <td align="left">HMAC w/ SHA-512          </td>
              </tr>
              <tr>
                <td align="left"> 512/512</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-9.1-6"><artwork name="" type="" align="left" alt="">
                   テーブル 7: HMAC アルゴリズム値
</artwork>
        </t>
        <t indent="0" pn="section-9.1-7">一部の受信者アルゴリズムは鍵を保持し、他のものは秘密データから鍵を導出します。鍵を保持するアルゴリズム（AES Key Wrapなど）においては、HMAC鍵のサイズは底層のハッシュ関数と<bcp14>同じサイズであるべきです（SHOULD）</bcp14>。鍵を導出するアルゴリズム（ECDHなど）においては、導出された鍵のサイズは底層のハッシュ関数と<bcp14>同じサイズでなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-9.1-8">このアルゴリズムにCOSEキーを使用する場合、以下のチェックが行われます：<bcp14>しなければなりません（MUST）</bcp14></t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.1-9">
          <li pn="section-9.1-9.1">'kty'フィールドは<bcp14>しなければなりません（MUST）</bcp14>存在し、'Symmetric'で<bcp14>なければなりません（MUST）</bcp14>。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.1-10">
          <li pn="section-9.1-10.1">もし「alg」フィールドが存在する場合、それは使用中のHMACアルゴリズムと一致しなければなりません（MUST match）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.1-11">
          <li pn="section-9.1-11.1">
            <bcp14>key_ops</bcp14>フィールドが存在する場合、HMAC認証タグを作成する際に、<bcp14>key_ops</bcp14>フィールドには必ず「MAC create」を含める必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.1-12">
          <li pn="section-9.1-12.1">もし「key_ops」のフィールドが存在する場合、HMAC認証タグを検証する際に、「MACの検証」を含めなければなりません。</li>
        </ul>
        <t indent="0" pn="section-9.1-13">実装は、MAC値を作成および検証する場合、関係するエンティティに対してキーのタイプ、キーの長さ、およびアルゴリズムが正しいか適切であることを<bcp14>確認しなければなりません（MUST）</bcp14>。</t>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-9.1.1">
          <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
          <t indent="0" pn="section-9.1.1-1">HMACは、弱体化されたハッシュアルゴリズムと使用しても攻撃に対して耐性を示すことが証明されています。現在、最もよく知られている攻撃方法は、鍵を総当たりで解読することです。これは、鍵のサイズがHMACの操作のセキュリティーに直接関連していることを意味します。</t>
        </section>
      </section>
      <section anchor="aes-message-authentication-code-(aes-cbc-mac)" numbered="true" removeInRFC="false" toc="include" pn="section-9.2">
        <name slugifiedName="name-aes-message-authentication-code-(aes-cbc-mac)">AESメッセージ認証コード（AES-CBC-MAC）</name>
        <t indent="0" pn="section-9.2-1">AES-CBC-MACは、<xref target="MAC" format="default" sectionFormat="of" derivedContent="MAC"/>で定義されています。（AES Cipher-Based Message Authentication Code（AES-CMAC）<xref target="RFC4493" format="default" sectionFormat="of" derivedContent="RFC4493"/>とは異なるアルゴリズムであることに注意してください。）</t>
        <t indent="0" pn="section-9.2-2">AES-CBC-MACは、キーの長さ、認証タグの長さ、および使用されるIVによってパラメーター化されます。これらのすべてのアルゴリズムにおいて、IVはすべてゼロで固定されています。私たちは、さまざまなキーの長さとタグの長さに対して、アルゴリズムの配列を提供しています。このドキュメントで定義されているアルゴリズムは、表8にあります。</t>
        <t indent="0" pn="section-9.2-3"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left">名前</td>
                  <td align="left">値</td>
                  <td align="left">キー長</td>
                  <td align="left">タグ長</td>
                  <td align="left">説明</td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">AES-MAC</td>
                <td align="left">14</td>
                <td align="left">128</td>
                <td align="left">64</td>
                <td align="left">AES-MAC 128ビットのキー</td>
              </tr>
              <tr>
                <td align="left">128/64</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left"/>
                <td align="left">64ビットのタグ</td>
              </tr>
              <tr>
                <td align="left">AES-MAC</td>
                <td align="left">15</td>
                <td align="left">256</td>
                <td align="left">64</td>
                <td align="left">AES-MAC 256ビットのキー</td>
              </tr>
              <tr>
                <td align="left">256/64</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left"/>
                <td align="left">64ビットのタグ</td>
              </tr>
              <tr>
                <td align="left">AES-MAC</td>
                <td align="left">25</td>
                <td align="left">128</td>
                <td align="left">128</td>
                <td align="left">AES-MAC 128ビットのキー</td>
              </tr>
              <tr>
                <td align="left">128/128</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left"/>
                <td align="left">128ビットのタグ</td>
              </tr>
              <tr>
                <td align="left">AES-MAC</td>
                <td align="left">26</td>
                <td align="left">256</td>
                <td align="left">128</td>
                <td align="left">AES-MAC 256ビットのキー</td>
              </tr>
              <tr>
                <td align="left">256/128</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left"/>
                <td align="left">128ビットのタグ</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-9.2-4"><artwork name="" type="" align="left" alt="">
                  <bcp14>表8: AES-MAC アルゴリズム値</bcp14>
          </artwork>
        </t>
        <t indent="0" pn="section-9.2-5">キーは、キー構造または受信者構造から取得することができます。MAC値を作成および検証する実装は、キーのタイプ、キーの長さ、アルゴリズムが正しいかつ関連するエンティティに適切であることを<bcp14>必ずしも確認しなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-9.2-6">このアルゴリズムでCOSEキーを使用する場合、次のチェックが行われます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2-7">
          <li pn="section-9.2-7.1">「kty」フィールドは存在しなければならず、その値は「Symmetric」でなければなりません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2-8">
          <li pn="section-9.2-8.1">
            <bcp14>alg</bcp14>フィールドが存在する場合、それは使用されているAES-MACアルゴリズムと一致しなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2-9">
          <li pn="section-9.2-9.1">もし「key_ops」フィールドが存在するなら、AES-MAC認証タグを作成する際には「MAC作成」を含めなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2-10">
          <li pn="section-9.2-10.1">
            <bcp14>もし 'key_ops' フィールドが存在する場合、AES-MAC 認証タグを検証する際に、'MAC verify' を含めなければなりません（MUST）。</bcp14></li>
        </ul>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-9.2.1">
          <name slugifiedName="name-security-considerations">セキュリティーの考慮事項</name>
          <t indent="0" pn="section-9.2.1-1">Cipher Block Chaining Message Authentication Code（CBC-MAC）に対しては、考慮すべき攻撃手法が存在します。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2.1-2">
            <li pn="section-9.2.1-2.1">固定かつ既知の長さのメッセージに対しては、単一の鍵のみを使用する必要があります。「もしそのような場合でない場合、攻撃者は、2つのメッセージとタグのペアを使用して有効なタグを持つメッセージを生成することができます。これは、異なる長さのメッセージに対して異なる鍵を使用することで解決することができます。現在の構造は、特定の長さを含む符号化構造を構築して署名することで、この問題を軽減しています。（CMACもこの問題に対処しています。）」</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2.1-3">
            <li pn="section-9.2.1-3.1">
              <bcp14>`Cipher Block Chaining (CBC)`モードでは、暗号化と認証の両方に同じキーが使用される場合、攻撃者は有効な認証コードを持つメッセージを生成することができます。</bcp14></li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-9.2.1-4">
            <li pn="section-9.2.1-4.1">もしIVが変更可能である場合、メッセージは偽造される可能性があります。これはすべてのIVをゼロに固定することで解決されます。</li>
          </ul>
        </section>
      </section>
    </section>
    <section anchor="content-encryption-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-10">
      <name slugifiedName="name-content-encryption-algorithms">コンテンツの暗号化アルゴリズム</name>
      <t indent="0" pn="section-10-1">コンテンツ暗号化アルゴリズムは、対称鍵を使用して潜在的に大きなデータブロックのデータ機密性を提供します。暗号化されたデータの整合性を保証しますが、送信者の身元を第三者に証明するためには提供されないか非常に制限されます。（たとえば、使用されたものを第三者に証明することはできません。）データの発生元を提供する能力は、CEKの取得方法に関連しています。</t>
      <t indent="0" pn="section-10-2">COSEは、コンテンツと追加データの両方の認証をサポートする暗号化アルゴリズムの集合を制限します。暗号化プロセスは、ある種の認証値を生成しますが、その値は明示的またはアルゴリズムの定義に応じて暗黙的である場合があります。簡単のため、認証コードは通常、暗号文のストリームに追加されると定義されます。暗号化機能は次のとおりです：</t>
      <t indent="0" pn="section-10-3">ciphertext = メッセージ内容を暗号化する(キー、追加データ)</t>
      <t indent="0" pn="section-10-4">有効な場合、メッセージコンテンツ=鍵、追加データで複合化（暗号文テキスト）が行われます。ほとんどのAEADアルゴリズムは、複合化が有効である場合にのみメッセージコンテンツを返すように論理的に定義されています。すべてではないが、多くの場合</t>
      <t indent="0" pn="section-10-5">実装はこの規約に従います。メッセージの内容は復号が検証されない場合には使用してはなりません。</t>
      <t indent="0" pn="section-10-6">これらのアルゴリズムは、COSE_EncryptとCOSE_Encrypt0で使用されます。</t>
      <section anchor="aes-gcm" numbered="true" removeInRFC="false" toc="include" pn="section-10.1">
        <name slugifiedName="name-aes-gcm">AES GCM</name>
        <t indent="0" pn="section-10.1-1">Galois/Counter Mode（GCM）モードは、<xref target="AES-GCM" format="default" sectionFormat="of" derivedContent="AES-GCM"/>で定義された一般的な認証付き暗号化ブロック暗号モードです。GCMモードは、AESブロック暗号アルゴリズムと組み合わせてAEAD暗号を定義します。</t>
        <t indent="0" pn="section-10.1-2">GCMモードは認証タグのサイズとノンスのサイズによってパラメーター化されます。このドキュメントでは、ノンスのサイズを96ビットに固定します。認証タグのサイズは、一部の値に制限されます。ただし、本ドキュメントでは認証タグのサイズが128ビットに固定されます。</t>
        <t indent="0" pn="section-10.1-3">このドキュメントで定義されているアルゴリズムのセットは、表9にあります。</t>
        <t indent="0" pn="section-10.1-4"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">値</td>
                  <td align="left">説明                              </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> A128GCM</td>
                <td align="left">1</td>
                <td align="left">AES-GCMモード（128ビットキー、128ビットタグ） </td>
              </tr>
              <tr>
                <td align="left"> A192GCM</td>
                <td align="left">2</td>
                <td align="left">AES-GCMモード（192ビットキー、128ビットタグ） </td>
              </tr>
              <tr>
                <td align="left"> A256GCM</td>
                <td align="left">3</td>
                <td align="left">AES-GCMモード（256ビットキー、128ビットタグ） </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-10.1-5"><artwork name="" type="" align="left" alt="">
                Table 9: AES-GCMのためのアルゴリズム値
</artwork>
        </t>
        <t indent="0" pn="section-10.1-6">鍵は、鍵の構造または受信者の構造から取得できます。暗号化および復号化を行う実装は、鍵のタイプ、鍵の長さ、およびアルゴリズムが関係するエンティティに対して正しいか適切かを確認しなければなりません（MUST）。</t>
        <t indent="0" pn="section-10.1-7">When using a COSE key for this algorithm, the following checks are
made:</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.1-8">
          <li pn="section-10.1-8.1">「'kty'フィールドは<bcp14>しなければなりません（MUST）</bcp14>、そして「Symmetric」である<bcp14>しなければなりません（MUST）</bcp14>。」</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.1-9">
          <li pn="section-10.1-9.1">もし「alg」フィールドが存在する場合、使用されているAES-GCMアルゴリズムと一致しなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.1-10">
          <li pn="section-10.1-10.1">もし 'key_ops' フィールドが存在する場合、暗号化する際に 'encrypt' または 'wrap key' を含めるべきです（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.1-11">
          <li pn="section-10.1-11.1">
            <bcp14>もし'key_ops'フィールドが存在する場合、復号化する際には'decrypt'または'unwrap key'を含まなければなりません。</bcp14></li>
        </ul>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-10.1.1">
          <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
          <t indent="0" pn="section-10.1.1-1">AES-GCM を使用する場合、以下の制約が適用されます: 「<bcp14>しなければなりません（MUST）</bcp14>」</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.1.1-2">
            <li pn="section-10.1.1-2.1"> The key and nonce pair MUST be unique for every message encrypted.</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.1.1-3">
            <li pn="section-10.1.1-3.1">単一のキーで暗号化されるデータの合計量は、2^39 - 256 ビットを超えてはなりません（<bcp14>MUST NOT</bcp14>）。これが超えられる可能性がある環境では、明示的なチェックが必要です（<bcp14>REQUIRED</bcp14>）。

</li>
          </ul>
          <t indent="0" pn="section-10.1.1-4">次のように考慮すべきである：タグの値を小さくすることをサポートすることは検討されました。制約のあるコミュニティでは、64ビットの範囲のタグサイズが望まれます。これにより、最大メッセージサイズ（一般的には問題ではありませんが）とキーの使用回数が大幅に変化します。制約のある環境では、Counter with CBC-MAC（CCM）が通常のモードであるため、制限付きモードはサポートされていません。</t>
        </section>
      </section>
      <section anchor="aes-ccm" numbered="true" removeInRFC="false" toc="include" pn="section-10.2">
        <name slugifiedName="name-aes-ccm">AES CCM</name>
        <t indent="0" pn="section-10.2-1">CCMは、<xref target="RFC3610" format="default" sectionFormat="of" derivedContent="RFC3610"/>で定義された一般的な認証暗号化ブロック暗号モードです。CCMモードはAESブロック暗号アルゴリズムと組み合わされ、制約されたデバイスでよく使用されるコンテンツ暗号化アルゴリズムを定義します。</t>
        <t indent="0" pn="section-10.2-2">CCMモードには2つのパラメーターの選択があります。最初の選択肢は、認証フィールドのサイズであるMです。Mの値の選択は、メッセージの成長（タグからの成長）と、攻撃者がメッセージを検知されずに変更できる確率とのトレードオフを含みます。2番目の選択肢は、長さフィールドのサイズであるLです。この値は、最大メッセージサイズとNonceのサイズとの間でトレードオフを必要とします。</t>
        <t indent="0" pn="section-10.2-3">CCMの仕様では、LおよびMがバイト数ではなくビット数のカウントとして指定されるという点が残念です。これにより、AES-CCM-8がCCMモードの認証のサイズが8ビットではなく64ビットであるバージョンを指すことが頻繁にあるため、誤解が生じる可能性があります。これらの値は従来、バイト数ではなくビット数として指定されてきました。本書では、異なるアルゴリズムを比較しやすくするために、ビット数のカウントの慣習に従います。</t>
        <t indent="0" pn="section-10.2-4">このドキュメントでは、LとMの値にわたるアルゴリズムの行列を定義します。制約のあるデバイスは通常、短いメッセージを使用し、受信者固有の暗号操作を避けたいと考えています。これにより、LとMの両方の値が小さくなることが望まれます。制約の少ないデバイスでは、より大きなメッセージを使用したいと考え、各操作ごとに新しいキーを生成することにも積極的です。これにより、LとMの値が大きくなることが望まれます。</t>
        <t indent="0" pn="section-10.2-5">Lには次の値が使用されます。</t>
        <t indent="0" pn="section-10.2-6">16ビット（2）：これにより、メッセージの長さは2^16バイト（64 KiB）に制限されます。これは制約のある世界のメッセージに十分な長さです。ノンスの長さは13バイトであり、繰り返すことなく2^(13*8)通りのノンスの値を許容します。</t>
        <t indent="0" pn="section-10.2-7">64ビット（8）：これにより、メッセージの長さは2^64バイトに制限されます。ノンスの長さは7バイトであり、繰り返しのないノンスの2^56通りの値が可能です。</t>
        <t indent="0" pn="section-10.2-8">次の値は M に使用されます：</t>
        <t indent="0" pn="section-10.2-9">64ビット（8）：これにより、64ビットの認証タグが生成されます。これは、変更されたメッセージが認証される確率が2^64の1の可能性があることを意味します。</t>
        <t indent="0" pn="section-10.2-10">128ビット（16）：これにより、128ビットの認証タグが生成されます。これは、変更されたメッセージが認証される確率が2^128のうち1であることを意味します。</t>
        <t indent="0" pn="section-10.2-11"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">値</td>
                  <td align="left">L</td>
                  <td align="left">M</td>
                  <td align="left">k</td>
                  <td align="left">説明         </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> AES-CCM-16-64-128  </td>
                <td align="left">10  </td>
                <td align="left">16  </td>
                <td align="left">64  </td>
                <td align="left">128  </td>
                <td align="left">AES-CCMモード         128ビットキー、64ビットタグ、13バイトのNonce  </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-16-64-256  </td>
                <td align="left">11  </td>
                <td align="left">16  </td>
                <td align="left">64  </td>
                <td align="left">256  </td>
                <td align="left">AES-CCMモード         256ビットキー、64ビットタグ、13バイトのNonce  </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-64-64-128  </td>
                <td align="left">12  </td>
                <td align="left">64  </td>
                <td align="left">64  </td>
                <td align="left">128  </td>
                <td align="left">AES-CCMモード         128ビットキー、64ビットタグ、7バイトのNonce   </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-64-64-256  </td>
                <td align="left">13  </td>
                <td align="left">64  </td>
                <td align="left">64  </td>
                <td align="left">256  </td>
                <td align="left">AES-CCMモード         256ビットキー、64ビットタグ、7バイトのNonce   </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-16-128-128   </td>
                <td align="left">30   </td>
                <td align="left">16   </td>
                <td align="left">128   </td>
                <td align="left">128   </td>
                <td align="left">AES-CCMモード         128ビットキー、         128ビットタグ、         13バイトのNonce       </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-16-128-256   </td>
                <td align="left">31   </td>
                <td align="left">16   </td>
                <td align="left">128   </td>
                <td align="left">256   </td>
                <td align="left">AES-CCMモード         256ビットキー、         128ビットタグ、         13バイトのNonce       </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-64-128-128   </td>
                <td align="left">32   </td>
                <td align="left">64   </td>
                <td align="left">128   </td>
                <td align="left">128   </td>
                <td align="left">AES-CCMモード         128ビットキー、         128ビットタグ、7バイトのNonce               </td>
              </tr>
              <tr>
                <td align="left"> AES-CCM-64-128-256   </td>
                <td align="left">33   </td>
                <td align="left">64   </td>
                <td align="left">128   </td>
                <td align="left">256   </td>
                <td align="left">AES-CCMモード         256ビットキー、         128ビットタグ、7バイトのNonce               </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-10.2-12"><artwork name="" type="" align="left" alt="">
               テーブル10: AES-CCMのアルゴリズム値
</artwork>
        </t>
        <t indent="0" pn="section-10.2-13">キーはキー構造または受信者構造から取得することができます。暗号化および復号化を行う実装は、キータイプ、キー長、およびアルゴリズムが関係するエンティティに対して正しいか適切であることを<bcp14>確認しなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-10.2-14">このアルゴリズムでCOSEキーを使用する場合、以下のチェックが行われます：<bcp14>MUST</bcp14></t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.2-15">
          <li pn="section-10.2-15.1">'kty' フィールドは存在しなければならず、それは 'Symmetric' でなければなりません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.2-16">
          <li pn="section-10.2-16.1">
            <bcp14>'alg' フィールドが存在する場合、使用されている AES-CCM アルゴリズムと一致しなければなりません（MUST）。</bcp14></li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.2-17">
          <li pn="section-10.2-17.1">
            <bcp14>'key_ops'</bcp14>フィールドが存在する場合、暗号化する際には、<bcp14>'encrypt'</bcp14>または<bcp14>'wrap key'</bcp14>を含める必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.2-18">
          <li pn="section-10.2-18.1">もし"key_ops"フィールドが存在する場合、復号化する際には"decrypt"または"unwrap key"を含めなければなりません（MUST）。</li>
        </ul>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-10.2.1">
          <name slugifiedName="name-security-considerations">セキュリティー上の考慮事項</name>
          <t indent="0" pn="section-10.2.1-1">AES-CCMを使用する場合、以下の制約は必ず適用される必要があります。「<bcp14>しなければなりません（MUST）</bcp14>」：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.2.1-2">
            <li pn="section-10.2.1-2.1">キーとノンスのペアは、暗号化されるメッセージごとに一意でなければなりません（MUST）。Lの値が一意のノンスの数に影響を与えることに注意してください。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.2.1-3">
            <li pn="section-10.2.1-3.1">AESブロック暗号が使用される合計回数は2^61回の操作を超えてはなりません（MUST NOT）。この制限は、MAC値の計算やストリーム暗号化の操作でブロック暗号が使用される回数の合計です。この制限が超えられる可能性がある環境では、明示的なチェックが必要です。</li>
          </ul>
          <t indent="0" pn="section-10.2.1-4"><xref target="RFC3610" format="default" sectionFormat="of" derivedContent="RFC3610"/>によれば、注目すべき他の考慮事項が存在します。平文の一部が非常に予測しやすい場合、事前計算攻撃を行う可能性があります。これにより、鍵サイズのセキュリティーは半分に減少します。この攻撃に対処する方法には、ノンス値にランダムな部分を追加するか、使用する鍵サイズを増やすことが含まれます。ノンスの一部をランダムな値に使用すると、単一の鍵が使用できるメッセージの数が減少します。鍵サイズを大きくすると、制約のあるデバイスでより多くのリソースが必要になる場合があります。詳細については、<xref target="RFC3610" format="default" sectionFormat="of" derivedContent="RFC3610"/>のセクション5および10を参照してください。</t>
        </section>
      </section>
      <section anchor="chacha20-and-poly1305" numbered="true" removeInRFC="false" toc="include" pn="section-10.3">
        <name slugifiedName="name-chacha20-and-poly1305">ChaCha20とPoly1305</name>
        <t indent="0" pn="section-10.3-1">ChaCha20とPoly1305を組み合わせたものは、<xref target="RFC7539" format="default" sectionFormat="of" derivedContent="RFC7539"/>で定義されているAEADモードです。これは、AESではない暗号方式であり、したがってAESで見つかった将来の脆弱性には影響を受けません。これらの暗号機能は、ソフトウェアのみで高速に動作するように設計されています。</t>
        <t indent="0" pn="section-10.3-2">ChaCha20/Poly1305 AEAD構造は、<xref target="RFC7539" format="default" sectionFormat="of" derivedContent="RFC7539"/>で定義されており、パラメーター化されていません。これは256ビットのキーと96ビットのノンスを取り、またプレーンテキストと追加データを入力として、オプションとして暗号文を生成します。このアルゴリズムに対して、Table 11で1つのアルゴリズム識別子を定義します。</t>
        <t indent="0" pn="section-10.3-3"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">値</td>
                  <td align="left">説明                           </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> ChaCha20/Poly1305 </td>
                <td align="left">24 </td>
                <td align="left">ChaCha20/Poly1305 w/ 256ビット鍵、      128ビットタグ                           </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-10.3-4"><artwork name="" type="" align="left" alt="">
                表11: AES-GCMのアルゴリズム値
</artwork>
        </t>
        <t indent="0" pn="section-10.3-5">キーはキー構造体または受信者構造体から取得することができます。 暗号化および復号化を実装する場合、キーの種類、キーの長さ、およびアルゴリズムが正しいかつ関連するエンティティに適切であることを<bcp14>しなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-10.3-6">このアルゴリズムに対してCOSEキーを使用する場合、以下のチェックが行われます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.3-7">
          <li pn="section-10.3-7.1">「kty」フィールドは存在しなければなりません（MUST）し、それは「Symmetric」である必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.3-8">
          <li pn="section-10.3-8.1">もし 'alg' フィールドが存在する場合、それは使用されているChaCha20/Poly1305アルゴリズムと一致しなければなりません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.3-9">
          <li pn="section-10.3-9.1">もし「key_ops」フィールドが存在する場合、暗号化時には必ず「encrypt」または「wrap key」を含む必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-10.3-10">
          <li pn="section-10.3-10.1">もし 'key_ops' フィールドが存在する場合、復号化する際には 'decrypt' または 'wrap key' を含まなければなりません。</li>
        </ul>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-10.3.1">
          <name slugifiedName="name-security-considerations">セキュリティー上の考慮事項</name>
          <t indent="0" pn="section-10.3.1-1">キーとノンスの値は、アルゴリズムの各呼び出し毎に固有のペアである<bcp14>しなければなりません（MUST）</bcp14>。ノンスのカウンタは、それらが固有であることを保証するための受け入れ可能な手段と見なされます。</t>
        </section>
      </section>
    </section>
    <section anchor="key-derivation-functions-(kdfs)" numbered="true" removeInRFC="false" toc="include" pn="section-11">
      <name slugifiedName="name-key-derivation-functions-(kdfs)">キー導出関数（KDF）</name>
      <t indent="0" pn="section-11-1">KDF（Key Derivation Functions）は、ある秘密値を取り、別の値を生成するために使用されます。秘密値には3つのバリエーションがあります：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11-2">
        <li pn="section-11-2.1">一様ランダムな秘密鍵：これは、適切な乱数生成器によって作成されるタイプの秘密鍵です。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11-3">
        <li pn="section-11-3.1">一様にランダムではない秘密：これは、鍵合意などの操作によって作成されるタイプの秘密です。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11-4">
        <li pn="section-11-4.1">ランダムでない秘密情報：これは、パスワードなどのために人々が生成する秘密のタイプです。</li>
      </ul>
      <t indent="0" pn="section-11-5">一般的なKDF（鍵導出関数）は、最初のタイプの秘密と非常にうまく機能し、第二のタイプの秘密にはかなりうまく対応できますが、最後のタイプの秘密には一般的にうまく対応できません。 このセクションのいずれのKDFも、パスワードに使用されるような秘密のタイプに対応するように設計されていません。 PBES2のような機能は、そのような秘密のタイプに使用する必要があります。</t>
      <t indent="0" pn="section-11-6">同じKDFは、異なる方式で最初の2つのタイプの秘密を処理するために設定できます。セクション11.1で定義されたKDFはそのような関数です。これは、HMACベースの抽出拡張キー導出関数（HKDF）のために定義されたアルゴリズムのセットに反映されています。</t>
      <t indent="0" pn="section-11-7">KDF を使用する際、含まれるコンポーネントの1つはコンテキスト情報です。コンテキスト情報は、同じ秘密から異なる鍵情報を派生させるために使用されます。コンテキストに基づく鍵材料の使用は、良いセキュリティーの実践とされています。</t>
      <t indent="0" pn="section-11-8">このドキュメントは、単一のコンテキスト構造と単一のKDFを定義します。これらの要素は、KDFプロセスが必要なこのドキュメントで定義されたすべての受信者アルゴリズムに使用されます。これらのアルゴリズムは、セクション12.1.2、12.4.1、および12.5.1で定義されています。</t>
      <section anchor="hmac-based-extract-and-expand-key-derivation-function-(hkdf)" numbered="true" removeInRFC="false" toc="include" pn="section-11.1">
        <name slugifiedName="name-hmac-based-extract-and-expand-key-derivation-function-(hkdf)">HMACベースの抽出および拡張キー導出関数（HKDF）</name>
        <t indent="0" pn="section-11.1-1">HKDFキー派生アルゴリズムは、<xref target="RFC5869" format="default" sectionFormat="of" derivedContent="RFC5869"/>で定義されています。</t>
        <t indent="0" pn="section-11.1-2">HKDFアルゴリズムは、次の入力を受け取ります：</t>
        <t indent="0" pn="section-11.1-3"><artwork name="" type="" align="left" alt="">
   secret -- 秘密の共有値です。秘密は事前に共有されるか、Diffie-Hellman（DH）鍵合意などの操作から派生することがあります。
</artwork>
        </t>
        <t indent="0" pn="section-11.1-4"><artwork name="" type="" align="left" alt="">
   salt -- 生成プロセスを変更するために使用されるオプションの値です。ソルト値は公開されるか、非公開にすることができます。ソルトがメッセージに含まれる公開の場合、表13に定義されている"ソルト"アルゴリズムヘッダーパラメーターが使用されます。[RFC5869]は、ソルトの長さは基になるハッシュ値の長さと同じであることを示唆していますが、ソルトの量が増えると、異なるキー値が生成されるため、セキュリティーが向上します。このパラメーターは、キーの計算に含まれており、別途認証する必要はありません。ソルト値は、送信されるメッセージごとに一意である必要はありません。
</artwork>
        </t>
        <t indent="0" pn="section-11.1-5"><artwork name="" type="" align="left" alt="">
   長さ -- 生成する必要のある出力のバイト数です。
</artwork>
        </t>
        <t indent="0" pn="section-11.1-6"><artwork name="" type="" align="left" alt="">
   context information -- 使用される値の文脈を説明する情報です。この情報を使用する材料の文脈に特化させることで、結果の材料が常にその使用に関連付けられます。この文書のKDF（鍵導出関数）で定義されている文脈の構造は、セクション11.2で使用します。
</artwork>
        </t>
        <t indent="0" pn="section-11.1-7"><artwork name="" type="" align="left" alt="">
   PRF -- <bcp14>The underlying pseudorandom function to be used in the HKDF algorithm.</bcp14>  <bcp14>The PRF is encoded into the HKDF algorithm selection.</bcp14>
          </artwork>
          <artwork name="" type="" align="left" alt="">
   PRF -- HKDFアルゴリズムで使用される基本の擬似乱数関数。<bcp14>このPRFはHKDFアルゴリズムの選択にエンコードされます。</bcp14>
          </artwork>
        </t>
        <t indent="0" pn="section-11.1-8">HKDFは、基のPRFとしてHMACを使用するように定義されています。ただし、制約のある世界により適した異なるKDFを提供するために、同じ構造で他の関数を使用することも可能です。具体的には、AES-CBC-MACをPRFとしてexpandステップに使用することができますが、extractステップには使用できません。適切な長さの良質なランダム共有秘密を使用する場合、extractステップはスキップできます。AESアルゴリズムのバージョンでは、必ずextractステップはスキップされます。</t>
        <t indent="0" pn="section-11.1-9">抽出ステップは、秘密が均一なランダムでない場合にはスキップすることはできません。例えば、ECDH鍵合意ステップの結果である場合などです。これにより、AES HKDFバージョンはECDHとは使用できません。抽出ステップをスキップすると、「salt」値はHKDF機能の一部として使用されません。</t>
        <t indent="0" pn="section-11.1-10">このドキュメントで定義されたアルゴリズムは、表12に記載されています。</t>
        <t indent="0" pn="section-11.1-11"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">PRF</td>
                  <td align="left">説明                     </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> HKDF SHA-256 </td>
                <td align="left">SHA-256を用いるHMAC</td>
                <td align="left">HKDFはPRFとしてHMAC SHA-256を使用します                             </td>
              </tr>
              <tr>
                <td align="left"> HKDF SHA-512 </td>
                <td align="left">SHA-512を用いるHMAC</td>
                <td align="left">HKDFはPRFとしてHMAC SHA-512を使用します                             </td>
              </tr>
              <tr>
                <td align="left"> HKDF AES-</td>
                <td align="left">AES-CBC-MAC-128</td>
                <td align="left">HKDFはPRFとしてAES-MACを使用します   </td>
              </tr>
              <tr>
                <td align="left"> MAC-128</td>
                <td align="left"/>
                <td align="left">128ビットキー付き                  </td>
              </tr>
              <tr>
                <td align="left"> HKDF AES-</td>
                <td align="left">AES-CBC-MAC-256</td>
                <td align="left">HKDFはPRFとしてAES-MACを使用します   </td>
              </tr>
              <tr>
                <td align="left"> MAC-256</td>
                <td align="left"/>
                <td align="left">256ビットキー付き                  </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-11.1-12"><artwork name="" type="" align="left" alt="">
                      Table 12: HKDF アルゴリズム
</artwork>
        </t>
        <t indent="0" pn="section-11.1-13"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前 </td>
                  <td align="left">ラベル</td>
                  <td align="left">タイプ</td>
                  <td align="left">アルゴリズム</td>
                  <td align="left">説明 </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> salt          </td>
                <td align="left">-20          </td>
                <td align="left">バイナリストリング          </td>
                <td align="left">direct+HKDF-SHA-256, direct +HKDF-SHA-512, direct+HKDF- AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH- ES+HKDF-512, ECDH- SS+HKDF-256, ECDH- SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH- ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH- SS+A256KW</td>
                <td align="left">ランダムなsalt </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-11.1-14"><artwork name="" type="" align="left" alt="">
　　　　　　　       テーブル13：HKDFアルゴリズムパラメーター
</artwork>
        </t>
      </section>
      <section anchor="context-information-structure" numbered="true" removeInRFC="false" toc="include" pn="section-11.2">
        <name slugifiedName="name-context-information-structure">コンテキスト情報構造</name>
        <t indent="0" pn="section-11.2-1">コンテキスト情報構造は、派生キー素材がトランザクションのコンテキストに「バインド」されることを保証するために使用されます。ここで使用されるコンテキスト情報構造は、<xref target="SP800-56A" format="default" sectionFormat="of" derivedContent="SP800-56A"/>で定義されています。コンテキスト情報構造のエンコーディングにCBORを使用することで、ASN.1の使用によって得られるフィールドの型と長さの分離と同じものを自動的に得ることができます。これにより、基本要素の長さをエンコードする必要がなくなります。JOSEで使用されているエンコーディングと同様に、（<xref target="RFC7518" section="4.6.2" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc7518#section-4.6.2" derivedContent="RFC7518"/>）。</t>
        <t indent="0" pn="section-11.2-2">コンテキスト情報構造は、キー導出を行っている2つのパーティであるPartyUとPartyVを参照しています。アプリケーションプロトコルが異なる定義を行っていない限り、メッセージを作成しているエンティティにPartyUを割り当て、メッセージを受信しているエンティティにPartyVを割り当てます。この関連付けを行うことで、コンテキスト情報が各方向で異なるため、異なるキーが各方向に導出されます。</t>
        <t indent="0" pn="section-11.2-3">コンテキスト構造は、両者に共通の情報に基づいて構築されます。この情報は、さまざまなソースから取得できます。</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.2-4">
          <li pn="section-11.2-4.1">アプリケーションによってフィールドを定義することができます。これは通常、当事者に固定の名前を割り当てるために使用されますが、ノンスなどの他のアイテムにも使用することができます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.2-5">
          <li pn="section-11.2-5.1">フィールドは出力の使用によって定義することができます。生成されているアルゴリズムや鍵のサイズの例がこれに該当します。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-11.2-6">
          <li pn="section-11.2-6.1">メッセージからパラメーターによってフィールドを定義することができます。表14に、コンテキスト構造に関連する値を運ぶために使用できるパラメーターのセットを定義します。アイデンティティや nonce の値などがこれにあたります。これらのパラメーターは、受信者構造の保護されていないバケットに配置することが想定されています。これらは保護されたバケットに含める必要はありません。なぜなら、コンテキスト構造に含まれることから、すでに暗号計算に含まれているからです。</li>
        </ul>
        <t indent="0" pn="section-11.2-7"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left">名前</td>
                  <td align="left">ラベル</td>
                  <td align="left">タイプ</td>
                  <td align="left">アルゴリズム</td>
                  <td align="left">説明</td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">PartyU</td>
                <td align="left">-21</td>
                <td align="left">bstr</td>
                <td align="left">direct+HKDF-SHA-256,</td>
                <td align="left">Party U</td>
              </tr>
              <tr>
                <td align="left">identity</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left">direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                <td align="left">identity情報</td>
              </tr>
              <tr>
                <td align="left">PartyU</td>
                <td align="left">-22</td>
                <td align="left">bstr</td>
                <td align="left">direct+HKDF-SHA-256,</td>
                <td align="left">Party U</td>
              </tr>
              <tr>
                <td align="left">nonce</td>
                <td align="left"/>
                <td align="left">/ int</td>
                <td align="left">direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                <td align="left">提供されたnonce</td>
              </tr>
              <tr>
                <td align="left">PartyU</td>
                <td align="left">-23</td>
                <td align="left">bstr</td>
                <td align="left">direct+HKDF-SHA-256,</td>
                <td align="left">Party U</td>
              </tr>
              <tr>
                <td align="left">other</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left">direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                <td align="left">提供されたその他の情報</td>
              </tr>
              <tr>
                <td align="left">PartyV</td>
                <td align="left">-24</td>
                <td align="left">bstr</td>
                <td align="left">direct+HKDF-SHA-256,</td>
                <td align="left">Party V</td>
              </tr>
              <tr>
                <td align="left">identity</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left">direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                <td align="left">identity情報</td>
              </tr>
              <tr>
                <td align="left">PartyV</td>
                <td align="left">-25</td>
                <td align="left">bstr</td>
                <td align="left">direct+HKDF-SHA-256,</td>
                <td align="left">Party V</td>
              </tr>
              <tr>
                <td align="left">nonce</td>
                <td align="left"/>
                <td align="left">/ int</td>
                <td align="left">direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                <td align="left">提供されたnonce</td>
              </tr>
              <tr>
                <td align="left">PartyV</td>
                <td align="left">-26</td>
                <td align="left">bstr</td>
                <td align="left">direct+HKDF-SHA-256,</td>
                <td align="left">Party V</td>
              </tr>
              <tr>
                <td align="left">other</td>
                <td align="left"/>
                <td align="left"/>
                <td align="left">direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                <td align="left">提供されたその他の情報</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-11.2-8"><artwork name="" type="" align="left" alt="">
               テーブル14: コンテキストアルゴリズムのパラメーター
</artwork>
        </t>
        <t indent="0" pn="section-11.2-9">私たちは、コンテキスト情報を保持するためのCBORオブジェクトを定義します。このオブジェクトはCOSE_KDF_Contextと呼ばれます。このオブジェクトはCBOR配列型を基にしています。配列内のフィールドは以下の通りです：</t>
        <t indent="0" pn="section-11.2-10">AlgorithmID（アルゴリズムID）：このフィールドは、キーマテリアルが使用されるアルゴリズムを示します。通常、これはキーラップアルゴリズム識別子またはコンテンツ暗号化アルゴリズム識別子のいずれかです。値は「COSE Algorithms（COSEアルゴリズム）」レジストリから取得されます。このフィールドは存在する必要があります。同じ環境で異なるアルゴリズムに使用される場合、各アルゴリズムごとに完全に異なるキーが生成されるため、このフィールドはコンテキスト情報に存在します。この実践により、アルゴリズムAが破損している場合、より容易に発見できるため、アルゴリズムBのために派生したキーはアルゴリズムAのために派生したキーとは異なります。</t>
        <t indent="0" pn="section-11.2-11">PartyUInfo：このフィールドには、パーティUに関する情報が格納されます。PartyUInfoはCBOR配列としてエンコードされます。PartyUInfoの要素は提示された順序でエンコードされます。PartyUInfo配列の要素は次の通りです：</t>
        <t indent="0" pn="section-11.2-12"><artwork name="" type="" align="left" alt="">
   identity: パーティUの識別情報を含みます。
    識別情報は2つの方法のいずれかで割り当てることができます。
    第一に、プロトコルはロールに基づいて識別子を割り当てることができます。
    たとえば、"クライアント"と"サーバー"の役割は、プロトコルの異なるエンティティに割り当てることができます。
    それぞれのエンティティは、送信または受信するデータに適切なラベルを使用します。
    プロトコルが識別子を割り当てる第二の方法は、名前ベースのシステム（例：DNS、X.509名）を使用する方法です。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-13"><artwork name="" type="" align="left" alt="">
      私たちは、メッセージ内で身元情報を伝達するために使用される 'パーティUの身元'アルゴリズムパラメーターを定義します。しかし、身元情報はプロトコルの一部としてしばしば知られており、明示的にではなく推測されることがあります。メッセージ内で身元情報が伝えられる場合、アプリケーションは提供された身元情報を検証する方法を持つべきです。身元情報は指定する必要はなく、その場合にはnilに設定されます。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-14"><artwork name="" type="" align="left" alt="">
   nonce:  これにはノンス値が含まれています。ノンスは、プロトコルから暗黙的に取得されるか、未保護のヘッダー内の値として運ばれることがあります。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-15"><artwork name="" type="" align="left" alt="">
      この値をメッセージで伝えるために使用できる「PartyUのnonce」というアルゴリズムパラメーターを定義しますが、nonceの値はアプリケーションまたは他の場所で決定される可能性があります。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-16"><artwork name="" type="" align="left" alt="">
      このオプションは明示する必要はありません。その場合は「nil」に設定されます。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-17"><artwork name="" type="" align="left" alt="">
   other:  この項目には、プロトコルによって定義された他の情報が含まれています。このオプションは指定する必要はなく、その場合にはnilに設定されます。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-18">PartyVInfo：このフィールドはパーティーVに関する情報を保持します。この構造体の内容は、PartyUInfoと同じですが、パーティーV用です。</t>
        <t indent="0" pn="section-11.2-19">SuppPubInfo：このフィールドには、双方の当事者に共有されている公開情報が含まれています。</t>
        <t indent="0" pn="section-11.2-20"><artwork name="" type="" align="left" alt="">
   keyDataLength:  これは望ましい出力値のビット数に設定されます。この規則により、もしアルゴリズムAが2つの異なるキー長を使用できる場合、より長いキーサイズの派生キーは、短いキーサイズのキーを接頭辞として含んでいないことを意味します。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-21"><artwork name="" type="" align="left" alt="">
   <bcp14>protected</bcp14>:<bcp14>要求されています（This field contains the protected parameter field.）</bcp14>  もしprotectedフィールドに要素がない場合、ゼロ長のbstrを使用してください。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-22"><artwork name="" type="" align="left" alt="">
   other: このフィールドは、アプリケーションによって定義された自由形式のデータを表します。例として、アプリケーションはここに配置するために異なる2つの文字列を定義し、データストリームと制御ストリームで異なるキーを生成することができます。このフィールドはオプションであり、アプリケーションがこの情報のための構造を定義している場合にのみ存在します。このフィールドを定義するアプリケーションは、データのエンコードにCBORを使用して、型と長さが正しく含まれるようにすることを推奨します。
</artwork>
        </t>
        <t indent="0" pn="section-11.2-23">SuppPrivInfo:  This field contains private information that is
   mutually known private information.  An example of this
   information would be a preexisting shared secret.  (This could,
   for example, be used in combination with an ECDH key agreement to
   provide a secondary proof of identity.)  The field is optional and
   will only be present if the application defines a structure for
   this information.  Applications that define this <bcp14>SHOULD</bcp14> use CBOR
   to encode the data so that types and lengths are correctly
   included.</t>
        <t indent="0" pn="section-11.2-24">次のCDDLフラグメントは、上記のテキストに対応します。</t>
        <t indent="0" pn="section-11.2-25">PartyInfo = ( identity : bstr / nil, nonce : bstr / int / nil, other : bstr / nil )

PartyInfo =（identity：bstr / nil、nonce：bstr / int / nil、other：bstr / nil）</t>
        <t indent="0" pn="section-11.2-26">COSE_KDF_Context = [ AlgorithmID : int / tstr, PartyUInfo : [ PartyInfo ], PartyVInfo : [ PartyInfo ], SuppPubInfo : [ keyDataLength : uint, protected : empty_or_serialized_map, ? other : bstr ], ? SuppPrivInfo : bstr ]

COSE_KDF_Context = [ AlgorithmID : int / tstr, PartyUInfo : [ PartyInfo ], PartyVInfo : [ PartyInfo ], SuppPubInfo : [ keyDataLength : uint, protected : empty_or_serialized_map, ? other : bstr ], ? SuppPrivInfo : bstr ]

COSE_KDF_Context = [ AlgorithmID : int / tstr, PartyUInfo : [ PartyInfo ], PartyVInfo : [ PartyInfo ], SuppPubInfo : [ keyDataLength : uint, protected : empty_or_serialized_map, ? other : bstr ], ? SuppPrivInfo : bstr ]</t>
      </section>
    </section>
    <section anchor="content-key-distribution-methods" numbered="true" removeInRFC="false" toc="include" pn="section-12">
      <name slugifiedName="name-content-key-distribution-methods">コンテンツのキー分配方法</name>
      <t indent="0" pn="section-12-1">受信者アルゴリズムのクラス（内容キー配布方法）は、さまざまなクラスに定義することができます。COSEは、多くの受信者アルゴリズムのクラスをサポートする能力を持っています。このセクションでは、いくつかのクラスがリストされ、それぞれのクラスに対して一連のアルゴリズムが指定されます。ここで使用される受信者アルゴリズムクラスの名前は、<xref target="RFC7516" format="default" sectionFormat="of" derivedContent="RFC7516"/>で定義されているものと同じです。他の仕様では、受信者アルゴリズムクラスに対して異なる用語を使用するか、一部の受信者アルゴリズムクラスをサポートしていない場合があります。</t>
      <section anchor="direct-encryption" numbered="true" removeInRFC="false" toc="include" pn="section-12.1">
        <name slugifiedName="name-direct-encryption">直接暗号化</name>
        <t indent="0" pn="section-12.1-1">直接暗号化クラスのアルゴリズムは、送信者と受信者の間で共有される秘密を、CEKとして直接または変更後に使用します。直接暗号化モードが使用される場合、そのモードはメッセージで<bcp14>しなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-12.1-2">受信者に対するCOSE_Recipient構造は、以下のように構成されます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1-3">
          <li pn="section-12.1-3.1">`<bcp14>`「protected」</bcp14> フィールドは、コンテンツキーの計算に使用されない限り、長さゼロのアイテムでなければなりません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1-4">
          <li pn="section-12.1-4.1">'alg'パラメーターは<bcp14>必ず存在</bcp14>しなければなりません（MUST）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1-5">
          <li pn="section-12.1-5.1">共有秘密を識別するパラメーターが存在するべきです（SHOULD）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1-6">
          <li pn="section-12.1-6.1">「'ciphertext'フィールドは長さゼロのアイテムでなければなりません（MUST）」</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1-7">
          <li pn="section-12.1-7.1">「recipients（受信者）」フィールドは存在してはなりません。</li>
        </ul>
        <section anchor="direct-key" numbered="true" removeInRFC="false" toc="include" pn="section-12.1.1">
          <name slugifiedName="name-direct-key">直接キー</name>
          <t indent="0" pn="section-12.1.1-1">この受信者アルゴリズムは最も簡単なものです。特定されたキーは、メッセージの下位レイヤーで直接使用されるキーとして使用されます。このアルゴリズムには定義されたアルゴリズムパラメーターはありません。アルゴリズム識別子の値は、テーブル15で割り当てられます。</t>
          <t indent="0" pn="section-12.1.1-2">このアルゴリズムを使用する場合、保護されたフィールドは長さゼロで<bcp14>しなければなりません（MUST）</bcp14>。キータイプは<bcp14>Symmetric</bcp14>で<bcp14>なければなりません（MUST）</bcp14>。</t>
          <t indent="0" pn="section-12.1.1-3"><center>
              <table align="center">
                <thead>
                  <tr>
                    <tr>
                      <td align="left"> 名前</td>
                      <td align="left">値</td>
                      <td align="left">説明</td>
                    </tr>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left"> 直接</td>
                    <td align="left">-6</td>
                    <td align="left">CEK の直接使用</td>
                  </tr>
                </tbody>
              </table>
            </center>
          </t>
          <t indent="0" pn="section-12.1.1-4"><artwork name="" type="" align="left" alt="">
                        表15: 直接キー
</artwork>
          </t>
          <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-12.1.1.1">
            <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
            <t indent="0" pn="section-12.1.1.1-1">この受信者アルゴリズムには、考慮すべきいくつかの潜在的な問題があります。</t>
            <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1.1.1-2">
              <li pn="section-12.1.1.1-2.1">これらのキーは、時間の経過とともに定期的に更新される方法を持っている必要があります。このドキュメントで指定されたすべてのコンテンツ暗号化アルゴリズムは、キーが使用される回数に制限があり、それを超えるとセキュリティーの大きな損失が発生します。</li>
            </ul>
            <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1.1.1-3">
              <li pn="section-12.1.1.1-3.1">これらのキーは、単一のアルゴリズムに割り当てる必要があります。単一のキーが複数の異なるアルゴリズムに使用される場合、時間の経過とともに数多くの攻撃が開発されてきました。これの一例としては、CBC暗号モードとCBC-MAC認証モードの両方に単一のキーを使用することが挙げられます。</li>
            </ul>
            <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1.1.1-4">
              <li pn="section-12.1.1.1-4.1">
                <bcp14>Breaking one message means all messages are broken. If an adversary succeeds in determining the key for a single message, then the key for all messages is also determined.</bcp14>
                <bcp14>1つのメッセージを破ると、すべてのメッセージが壊れます。もし敵が1つのメッセージの鍵を特定できれば、すべてのメッセージの鍵も特定されます。</bcp14></li>
            </ul>
          </section>
        </section>
        <section anchor="direct-key-with-kdf" numbered="true" removeInRFC="false" toc="include" pn="section-12.1.2">
          <name slugifiedName="name-direct-key-with-kdf">KDFを使用した直接鍵</name>
          <t indent="0" pn="section-12.1.2-1">These recipient algorithms take a common shared secret between the
two parties and applies the HKDF function (Section 11.1), using the
context structure defined in Section 11.2 to transform the shared
secret into the CEK.  The 'protected' field can be of non-zero
length.  Either the 'salt' parameter of HKDF or the 'PartyU nonce'
parameter of the context structure <bcp14>MUST</bcp14> be present.  The salt/nonce
parameter can be generated either randomly or deterministically.  The
requirement is that it be a unique value for the shared secret in
question.</t>
          <t indent="0" pn="section-12.1.2-2">もしソルト/ナンス値がランダムに生成される場合は、そのランダム値の長さがHKDFの基礎となるハッシュ関数と同じであることが推奨されます。ユニークであることを保証する方法はありませんが、高い確率でユニークであると考えられます。ソルト/ナンス値が決定論的に生成される場合は、ユニークであることが保証されるため、長さの要件はありません。</t>
          <t indent="0" pn="section-12.1.2-3">同じ鍵を使用する場合、各メッセージに新しい初期化ベクトル（IV）を使用する必要があります。 IVは予測可能な方法、ランダムな方法、または予測できない方法（すなわち、カウンタを暗号化する）で変更することができます。</t>
          <t indent="0" pn="section-12.1.2-4">キーに使用されるIVは、キーが生成されるのと同じHKDF機能から生成することもできます。IVを生成するためにHKDFが使用される場合、アルゴリズム識別子は「IV-GENERATION」に設定されます。</t>
          <t indent="0" pn="section-12.1.2-5">これらのアルゴリズムが使用される場合、キータイプは「対称」である<bcp14>しなければなりません（MUST）</bcp14>。</t>
          <t indent="0" pn="section-12.1.2-6">この文書で定義されているアルゴリズムのセットは、テーブル16に記載されています。</t>
          <t indent="0" pn="section-12.1.2-7"><table align="center">
              <thead>
                <tr>
                  <tr>
                    <td align="left"> 名前</td>
                    <td align="left">値</td>
                    <td align="left">KDF</td>
                    <td align="left">説明           </td>
                  </tr>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left"> direct+HKDF-SHA-256 </td>
                  <td align="left">-10 </td>
                  <td align="left">HKDF SHA-256</td>
                  <td align="left">HKDFとSHA-256で共有秘密情報を作成           </td>
                </tr>
                <tr>
                  <td align="left"> direct+HKDF-SHA-512 </td>
                  <td align="left">-11 </td>
                  <td align="left">HKDF SHA-512</td>
                  <td align="left">HKDFとSHA-512で共有秘密情報を作成           </td>
                </tr>
                <tr>
                  <td align="left"> direct+HKDF-AES-128 </td>
                  <td align="left">-12 </td>
                  <td align="left">HKDF AES- MAC-128</td>
                  <td align="left">AES- MAC 128ビット鍵を使用して共有秘密情報を作成       </td>
                </tr>
                <tr>
                  <td align="left"> direct+HKDF-AES-256 </td>
                  <td align="left">-13 </td>
                  <td align="left">HKDF AES- MAC-256</td>
                  <td align="left">AES- MAC 256ビット鍵を使用して共有秘密情報を作成       </td>
                </tr>
              </tbody>
            </table>
          </t>
          <t indent="0" pn="section-12.1.2-8"><artwork name="" type="" align="left" alt="">
                    テーブル16：KDFを使用した直接鍵
</artwork>
          </t>
          <t indent="0" pn="section-12.1.2-9">このアルゴリズムにCOSEキーを使用する場合、次のチェックが行われます：<bcp14>しなければなりません（MUST）</bcp14></t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1.2-10">
            <li pn="section-12.1.2-10.1">「kty」フィールドは<bcp14>しなければなりません（MUST）</bcp14>、また、<bcp14>「Symmetric」であること</bcp14>が<bcp14>要求されています（REQUIRED）</bcp14>。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1.2-11">
            <li pn="section-12.1.2-11.1">
              <bcp14>alg</bcp14>フィールドが存在する場合、使用されているアルゴリズムと一致しなければなりません（MUST）。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.1.2-12">
            <li pn="section-12.1.2-12.1">
              <bcp14>もし 'key_ops' フィールドが存在する場合、必ず 'deriveKey' または 'deriveBits' を含まなければなりません（MUST）。</bcp14></li>
          </ul>
          <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-12.1.2.1">
            <name slugifiedName="name-security-considerations">セキュリティーの考慮事項</name>
            <t indent="0" pn="section-12.1.2.1-1">共有秘密は、時間の経過とともに定期的に更新される手段を持つ必要があります。共有秘密は信頼の基盤となります。直接使用されない場合でも、定期的なローテーションの対象となるべきです。</t>
            <t indent="0" pn="section-12.1.2.1-2">これらの方法は完全な前方秘匿性を提供しないが、全ての生成された鍵に同じ共有秘密が使用されているため、任意の単一のメッセージの鍵が発見された場合、その導出された鍵を使用しているメッセージ（または一連のメッセージ）のみが危険にさらされる。新しい鍵導出ステップが新しい鍵を生成し、鍵を取得するのに同じ作業量が必要となる。</t>
          </section>
        </section>
      </section>
      <section anchor="key-wrap" numbered="true" removeInRFC="false" toc="include" pn="section-12.2">
        <name slugifiedName="name-key-wrap">キーラップ</name>
        <t indent="0" pn="section-12.2-1">キーラップモードでは、CEKはランダムに生成され、そのキーは送信者と受信者の間で共有された秘密鍵によって暗号化されます。COSEで現在定義されているすべてのキーラップアルゴリズムはAEアルゴリズムです。キーラップモードは、システムがランダムキーの生成を行う能力を持っている場合には、直接暗号化よりも優れていると考えられています。これは、共有鍵がいくらかの組織化されたデータではなく、実際に同じ内容を繰り返す可能性があるデータではなく、ランダムデータをラップするために使用されるためです。キーラップの使用により、直接暗号化アルゴリズムによって提供される弱いデータの起源が失われます。</t>
        <t indent="0" pn="section-12.2-2">受信者のためのCOSE_Encrypt構造は、以下のように構成されます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2-3">
          <li pn="section-12.2-3.1">キーラップアルゴリズムがAEアルゴリズムの場合、'protected'フィールドは存在しない必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2-4">
          <li pn="section-12.2-4.1">「受信者（recipients）」フィールドは通常存在しませんが、使用することができます。アプリケーションは、受信者フィールドが存在する場合に対応する必要があります。その受信者を復号化できないことは、それに対処する受け入れられる方法です。メッセージの処理に失敗することは、受け入れられる方法ではありません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2-5">
          <li pn="section-12.2-5.1">平文を暗号化するのは、通常、下位のレイヤー（通常はコンテンツレイヤー）からのキーです。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2-6">
          <li pn="section-12.2-6.1">少なくとも、「unprotected」フィールドには「alg」パラメーターを含む必要があり、共有シークレットを識別するパラメーターを含むべきです。</li>
        </ul>
        <section anchor="aes-key-wrap" numbered="true" removeInRFC="false" toc="include" pn="section-12.2.1">
          <name slugifiedName="name-aes-key-wrap">AESキーラップ</name>
          <t indent="0" pn="section-12.2.1-1">AES Key Wrapアルゴリズムは、<xref target="RFC3394" format="default" sectionFormat="of" derivedContent="RFC3394"/>で定義されています。このアルゴリズムは、64ビットの倍数である値をラップするためにAESキーを使用します。そのため、このドキュメントで定義されているコンテンツ暗号化アルゴリズムのキーをラップするために使用することができます。このアルゴリズムには、単一の固定パラメーターである初期値が必要です。これは、<xref target="RFC3394" section="2.2.3.1" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc3394#section-2.2.3.1" derivedContent="RFC3394"/>で指定された値に固定されています。呼び出しごとに異なる公開パラメーターはありません。保護されたヘッダーフィールドは<bcp14>空でなければなりません（MUST）</bcp14>。</t>
          <t indent="0" pn="section-12.2.1-2">キーは、キー構造または受信者構造から取得することができます。暗号化および復号化を行う実装は、キーの種別、キーの長さ、およびアルゴリズムが関係するエンティティに対して正しいか適切であることを<bcp14>確認する必要があります（MUST）</bcp14>。</t>
          <t indent="0" pn="section-12.2.1-3">このアルゴリズムでCOSEキーを使用する場合、以下のチェックが行われます：<bcp14>しなければなりません（MUST）</bcp14>。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2.1-4">
            <li pn="section-12.2.1-4.1">「'kty'フィールドは<bcp14>しなければなりません（MUST）</bcp14>、そして『Symmetric』である必要があります。」</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2.1-5">
            <li pn="section-12.2.1-5.1">
              <bcp14>「'alg'フィールドが存在する場合、使用されているAES Key Wrapアルゴリズムと一致しなければなりません」</bcp14></li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2.1-6">
            <li pn="section-12.2.1-6.1">
              <bcp14>もし 'key_ops' フィールドが存在する場合、暗号化する際には 'encrypt' または 'wrap key' のいずれかを含まなければなりません（MUST）。</bcp14></li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.2.1-7">
            <li pn="section-12.2.1-7.1">もし「key_ops」というフィールドが存在する場合、それが「decrypt」または「unwrap key」を含んでいなければなりません（MUST）。</li>
          </ul>
          <t indent="0" pn="section-12.2.1-8"><table align="center">
              <thead>
                <tr>
                  <tr>
                    <td align="left"> 名前</td>
                    <td align="left">値</td>
                    <td align="left">キーサイズ</td>
                    <td align="left">説明                 </td>
                  </tr>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left"> A128KW</td>
                  <td align="left">-3</td>
                  <td align="left">128</td>
                  <td align="left">128ビットキーを使用したAESキーラップ</td>
                </tr>
                <tr>
                  <td align="left"> A192KW</td>
                  <td align="left">-4</td>
                  <td align="left">192</td>
                  <td align="left">192ビットキーを使用したAESキーラップ</td>
                </tr>
                <tr>
                  <td align="left"> A256KW</td>
                  <td align="left">-5</td>
                  <td align="left">256</td>
                  <td align="left">256ビットキーを使用したAESキーラップ</td>
                </tr>
              </tbody>
            </table>
          </t>
          <t indent="0" pn="section-12.2.1-9"><artwork name="" type="" align="left" alt="">
               <bcp14>表 17: AESキーラップアルゴリズムの値</bcp14>
            </artwork>
          </t>
          <section anchor="security-considerations-for-aes-kw" numbered="true" removeInRFC="false" toc="include" pn="section-12.2.1.1">
            <name slugifiedName="name-security-considerations-for-aes-kw">AES-KWに対するセキュリティーに関する考慮事項</name>
            <t indent="0" pn="section-12.2.1.1-1">共有秘密は、時間の経過に伴って定期的に更新される方法が必要です。共有秘密は信頼の基盤です。</t>
          </section>
        </section>
      </section>
      <section anchor="key-transport" numbered="true" removeInRFC="false" toc="include" pn="section-12.3">
        <name slugifiedName="name-key-transport">主キー伝送</name>
        <t indent="0" pn="section-12.3-1">鍵伝送モードは、一部の規格では鍵暗号化モードとも呼ばれています。鍵伝送モードは、鍵を保護するために対称暗号化アルゴリズムではなく、非対称暗号化アルゴリズムを使用する点で鍵包装モードと異なります。このドキュメントでは、鍵伝送モードのアルゴリズムを定義していません。</t>
        <t indent="0" pn="section-12.3-2">キー転送アルゴリズムを使用する場合、受信者のためのCOSE_Encrypt構造体は、次のように編成されます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.3-3">
          <li pn="section-12.3-3.1">「'protected' フィールドは存在してはなりません（MUST NOT）」</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.3-4">
          <li pn="section-12.3-4.1">平文を暗号化するための鍵は、通常、下位の次のレイヤー（通常はコンテンツ層）から取得されます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.3-5">
          <li pn="section-12.3-5.1">少なくとも、「unprotected」フィールドには「alg」パラメーターが含まれている必要があり、非対称キーを識別するパラメーターが含まれるべきです。</li>
        </ul>
      </section>
      <section anchor="direct-key-agreement" numbered="true" removeInRFC="false" toc="include" pn="section-12.4">
        <name slugifiedName="name-direct-key-agreement">直接鍵確立</name>
        <t indent="0" pn="section-12.4-1">受信者アルゴリズムの「直接鍵合意」クラスは、共有秘密鍵を作成するために鍵合意手法を使用します。その後、共有秘密鍵にKDFを適用して、データの保護に使用される鍵を派生させます。この鍵は通常、CEKまたはMAC鍵として使用されますが、複数のレイヤーが使用されている場合には他の目的にも使用できます（付録Bを参照）。</t>
        <t indent="0" pn="section-12.4-2">最も一般的に使用される鍵合意アルゴリズムはディフィー・ヘルマンですが、他のバリアントも存在します。COSEはオンライン環境ではなく、ストアアンドフォワード環境を対象として設計されているため、DHの多くのバリアントはメッセージの受信者が動的鍵素材を提供できないため使用することができません。これの副作用の1つは、完全な順次送信保証（詳細はRFC4949を参照してください）が実現できないということです。COSEオブジェクトの受信者には常に静的鍵が使用されます。</t>
        <t indent="0" pn="section-12.4-3">サポートされているDHの2つのバリアントは次のとおりです：</t>
        <t indent="0" pn="section-12.4-4"><artwork name="" type="" align="left" alt="">
    一時的静的(Ephemeral-Static, ES) DH: 送信者がメッセージのために一回だけDH鍵を生成し、受信者に対して静的鍵を使用します。一時的送信者鍵の使用により、追加のランダム入力は不要であり、各メッセージごとにランダムに生成されます。
</artwork>
        </t>
        <t indent="0" pn="section-12.4-5"><artwork name="" type="" align="left" alt="">
   Static-Static DH: 送信者と受信者の両方で静的キーが使用される場合。静的キーの使用により、受信者はメッセージのデータの起源の弱いバージョンを取得できます。静的-静的鍵合意が使用される場合、メッセージごとに異なるキーが作成されることを保証するために、KDFの一部としてユニークなデータの一部が必要です。
</artwork>
        </t>
        <t indent="0" pn="section-12.4-6">直接鍵合意モードを使用する場合、メッセージには<bcp14>しなければなりません（MUST）</bcp14>、1つの受信者のみが存在する必要があります。この方法は鍵を直接生成するため、他の受信者との組み合わせが難しくなります。複数の受信者が必要な場合は、鍵包装を使用するバージョンを使う必要があります。</t>
        <t indent="0" pn="section-12.4-7">受信者のためのCOSE_Encrypt構造は、以下のように構成されます：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4-8">
          <li pn="section-12.4-8.1">少なくとも、ヘッダーは 'alg' パラメーターを含み、受信者の非対称キーを識別するパラメーターを含むべきです。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4-9">
          <li pn="section-12.4-9.1">ヘッダーは、静的-静的バージョンでは送信者のキーを識別するべきです。また、一時的-静的バージョンでは送信者の一時的なキーを含む必要があります。</li>
        </ul>
        <section anchor="ecdh" numbered="true" removeInRFC="false" toc="include" pn="section-12.4.1">
          <name slugifiedName="name-ecdh"><bcp14>MUST</bcp14> support elliptic curve Diffie-Hellman (ECDH) key exchange. ECDH provides secure key agreement between two parties. The parties each generate an elliptic curve public-private key pair and exchange their public keys. They then compute a shared secret key using their own private keys and the other party's public key. The shared secret key can be used for encryption and decryption. ECDH is widely used in cryptographic protocols for secure communication.</name>
          <t indent="0" pn="section-12.4.1-1">ECDHの数学的な詳細は、<xref target="RFC6090" format="default" sectionFormat="of" derivedContent="RFC6090"/>に記載されています。このドキュメントでは、そのアルゴリズムを<xref target="RFC7748" format="default" sectionFormat="of" derivedContent="RFC7748"/>で定義された2つの曲線に拡張して使用することができます。</t>
          <t indent="0" pn="section-12.4.1-2">ECDHは以下によってパラメーター化されます：</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-3">
            <li pn="section-12.4.1-3.1">Curve Type/Curve：選択された曲線は、共有秘密のサイズだけでなく、共有秘密の計算に使用される数学も制御します。選択された曲線はまた、曲線上の恒等点に対して何が起こり、曲線上の点の表現方法も制御します。この仕様では、複数の異なる曲線の使用を許可しています。曲線のセットは、表22で定義されています。計算された秘密を取得するために使用される数学は、選択された曲線に基づいており、ECDHアルゴリズムに基づいていません。そのため、各曲線ごとに新しいアルゴリズムを定義する必要はありません。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-4">
            <li pn="section-12.4.1-4.1">計算された秘密を共有秘密に変換する：計算された秘密がわかっている場合、生成された値はKDFを実行するためにバイト文字列に変換する必要があります。このドキュメントで定義されているすべての曲線において、x座標が使用されます。X25519とX448の曲線については、結果の値が既知の長さのバイト文字列であるため、直接使用されます。P-256、P-384、およびP-521の曲線については、x座標は[I-D.ietf-curdle-pkix]で定義されているI2OSP関数によって実行され、セクション8.1で定義されているnと同じ計算が行われます。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-5">
            <li pn="section-12.4.1-5.1">エフェメラル-スタティックまたはスタティック-スタティック: キー合意プロセスは、送信側の静的またはエフェメラルキーのいずれかを使用して行うことができます。エフェメラルキーを使用する場合、送信側はすべてのキー合意操作ごとに新しいエフェメラルキーを生成する<bcp14>しなければなりません（MUST）</bcp14>。エフェメラルキーは「エフェメラルキー」パラメーターに配置され、エフェメラルキーを使用するすべてのアルゴリズム識別子に対して存在する<bcp14>必要があります（MUST）</bcp14>。スタティックキーを使用する場合、送信側は新しいランダム値を生成するか、ユニークな値を作成する<bcp14>しなければなりません（MUST）</bcp14>。使用されるKDFでは、これはHKDFの場合「salt」パラメーター（Table 13）またはコンテキスト構造の「PartyU nonce」パラメーター（Table 14）のいずれか<bcp14>が存在しなければなりません（MUST）</bcp14>（両方が存在する場合も望ましい）。パラメーター内の値は使用されるキーペアごとにユニークで<bcp14>なければなりません（MUST）</bcp14>。静的キーを使用する場合、静的キーを受信者に識別させる必要があります。静的キーは、キー自体（「静的キー」）または静的キーのためのキー識別子（「静的キー ID」）を提供することによって識別できます。これらのパラメーターは、Table 19で定義されています。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-6">
            <li pn="section-12.4.1-6.1">鍵派生アルゴリズム：ECDH鍵合意プロセスの結果は一様なランダムな秘密を提供しません。したがって、使用可能な鍵を生成するために、KDFを実行する必要があります。秘密をKDFで処理することで、キーの使用方法や静的-静的鍵合意のためのワンタイム素材の導入も可能となります。このドキュメントで定義されているすべてのアルゴリズムは、セクション11.1で定義されているHKDFアルゴリズムのいずれかを使用し、セクション11.2で定義されているコンテキスト構造を利用します。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-7">
            <li pn="section-12.4.1-7.1">キーラップアルゴリズム: キーラップアルゴリズムは使用されません。これはTable 18に「なし」として表されます。コンテキスト構造のキーサイズは、コンテンツレイヤーの暗号化アルゴリズムのサイズです。</li>
          </ul>
          <t indent="0" pn="section-12.4.1-8">このドキュメントで定義されている直接ECDHアルゴリズムのセットは、テーブル18にあります。</t>
          <t indent="0" pn="section-12.4.1-9"><table align="center">
              <thead>
                <tr>
                  <tr>
                    <td align="left"> 名前 </td>
                    <td align="left">値 </td>
                    <td align="left">KDF </td>
                    <td align="left">暗号型 </td>
                    <td align="left">キーラップ </td>
                    <td align="left">説明   </td>
                  </tr>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left"> ECDH-ES +</td>
                  <td align="left">-25</td>
                  <td align="left">HKDF -</td>
                  <td align="left">はい</td>
                  <td align="left">なし</td>
                  <td align="left">ECDH ES との組み合わせ    </td>
                </tr>
                <tr>
                  <td align="left"> HKDF-256  </td>
                  <td align="left">  </td>
                  <td align="left">SHA-256  </td>
                  <td align="left">  </td>
                  <td align="left">  </td>
                  <td align="left">HKDF -         鍵を直接生成      </td>
                </tr>
                <tr>
                  <td align="left"> ECDH-ES +</td>
                  <td align="left">-26</td>
                  <td align="left">HKDF -</td>
                  <td align="left">はい</td>
                  <td align="left">なし</td>
                  <td align="left">ECDH ES との組み合わせ    </td>
                </tr>
                <tr>
                  <td align="left"> HKDF-512  </td>
                  <td align="left">  </td>
                  <td align="left">SHA-512  </td>
                  <td align="left">  </td>
                  <td align="left">  </td>
                  <td align="left">HKDF -         鍵を直接生成      </td>
                </tr>
                <tr>
                  <td align="left"> ECDH-SS +</td>
                  <td align="left">-27</td>
                  <td align="left">HKDF -</td>
                  <td align="left">いいえ</td>
                  <td align="left">なし</td>
                  <td align="left">ECDH SS との組み合わせ    </td>
                </tr>
                <tr>
                  <td align="left"> HKDF-256  </td>
                  <td align="left">  </td>
                  <td align="left">SHA-256  </td>
                  <td align="left">  </td>
                  <td align="left">  </td>
                  <td align="left">HKDF -         鍵を直接生成      </td>
                </tr>
                <tr>
                  <td align="left"> ECDH-SS +</td>
                  <td align="left">-28</td>
                  <td align="left">HKDF -</td>
                  <td align="left">いいえ</td>
                  <td align="left">なし</td>
                  <td align="left">ECDH SS との組み合わせ    </td>
                </tr>
                <tr>
                  <td align="left"> HKDF-512  </td>
                  <td align="left">  </td>
                  <td align="left">SHA-512  </td>
                  <td align="left">  </td>
                  <td align="left">  </td>
                  <td align="left">HKDF -         鍵を直接生成      </td>
                </tr>
              </tbody>
            </table>
          </t>
          <t indent="0" pn="section-12.4.1-10"><artwork name="" type="" align="left" alt="">
                   テーブル 18: ECDH アルゴリズム値
</artwork>
          </t>
          <t indent="0" pn="section-12.4.1-11"><table align="center">
              <thead>
                <tr>
                  <tr>
                    <td align="left"> 名前</td>
                    <td align="left">ラベル</td>
                    <td align="left">タイプ</td>
                    <td align="left">アルゴリズム</td>
                    <td align="left">説明  </td>
                  </tr>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">ephemeral</td>
                  <td align="left">-1</td>
                  <td align="left">COSE_Key</td>
                  <td align="left">ECDH-ES+HKDF-256,</td>
                  <td align="left">一時的    </td>
                </tr>
                <tr>
                  <td align="left">key</td>
                  <td align="left">   </td>
                  <td align="left">   </td>
                  <td align="left">ECDH-ES+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW</td>
                  <td align="left">送信者の公開鍵    </td>
                </tr>
                <tr>
                  <td align="left">static</td>
                  <td align="left">-2</td>
                  <td align="left">COSE_Key</td>
                  <td align="left">ECDH-SS+HKDF-256,</td>
                  <td align="left">静的       </td>
                </tr>
                <tr>
                  <td align="left">key</td>
                  <td align="left">   </td>
                  <td align="left">   </td>
                  <td align="left">ECDH-SS+HKDF-512, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                  <td align="left">送信者の公開鍵    </td>
                </tr>
                <tr>
                  <td align="left">static</td>
                  <td align="left">-3</td>
                  <td align="left">bstr</td>
                  <td align="left">ECDH-SS+HKDF-256,</td>
                  <td align="left">静的       </td>
                </tr>
                <tr>
                  <td align="left">key id</td>
                  <td align="left">   </td>
                  <td align="left">   </td>
                  <td align="left">ECDH-SS+HKDF-512, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW</td>
                  <td align="left">送信者の公開鍵識別子    </td>
                </tr>
              </tbody>
            </table>
          </t>
          <t indent="0" pn="section-12.4.1-12"><artwork name="" type="" align="left" alt="">
                テーブル19：ECDHアルゴリズムのパラメーター
</artwork>
          </t>
          <t indent="0" pn="section-12.4.1-13">この文書は、曲線P-256、P-384、P-521、X25519、およびX448とともに使用するためにこれらのアルゴリズムを定義しています。実装は、キータイプと曲線が正しいことを<bcp14>しなければなりません（MUST）</bcp14>。異なる曲線には異なるキータイプが制限されています。実装は、曲線とアルゴリズムが関係するエンティティに適切であることを<bcp14>しなければなりません（MUST）</bcp14>。</t>
          <t indent="0" pn="section-12.4.1-14">このアルゴリズムでCOSEキーを使用する場合、以下のチェックが行われます：<bcp14>しなければなりません（MUST）</bcp14></t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-15">
            <li pn="section-12.4.1-15.1">「'kty'フィールドは存在しなければならず、'EC2'または'OKP'でなければなりません。」</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-16">
            <li pn="section-12.4.1-16.1">
              <para>もし「alg」フィールドが存在する場合、それは使用されている鍵合意アルゴリズムと一致しなければなりません（MUST match）。</para>
            </li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-17">
            <li pn="section-12.4.1-17.1">もし「key_ops」フィールドが存在する場合、その中には必ず「秘密鍵の派生（derive key）」または「ビットの派生（derive bits）」が含まれなければなりません。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.4.1-18">
            <li pn="section-12.4.1-18.1">
              <bcp14>「key_ops」フィールドが存在する場合、公開鍵の場合は空でなければなりません（MUST）。</bcp14></li>
          </ul>
        </section>
        <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-12.4.2">
          <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
          <t indent="0" pn="section-12.4.2-1">外部エンティティから提供されるポイントが有効であるかを確認する方法があります。 'EC2' キー形式の場合、x 値と y 値が曲線上のポイントを形成しているかを確認することでこれを行うことができます。 'OKP' 形式の場合、ポイントの検証を行うための簡単な方法はありません。</t>
          <t indent="0" pn="section-12.4.2-2">鍵派生プロセスの一部として、両エンティティの公開鍵が提供されることが求められることが検討されました（<xref target="RFC7748" section="6.1" format="default" sectionFormat="of" derivedLink="https://www.rfc-editor.org/rfc/rfc7748#section-6.1" derivedContent="RFC7748"/>で推奨されています）。しかし、COSEはオンライン鍵交換ではなく、ストア・アンド・フォワード形式で使用されているため、これは実施されませんでした。この問題が発生するには、受信者の公開鍵が悪意を持って選択されるか、送信者が悪意を持っている必要があります。いずれの場合でも、すべてのセキュリティーは消滅します。</t>
          <t indent="0" pn="section-12.4.2-3">公開鍵に関連付けられた秘密鍵の所有の証明は、鍵が信頼できない場所から信頼できる場所に移動する際（エンドユーザーまたは鍵の信頼ステートメントを行うエンティティによって）、推奨されます。</t>
        </section>
      </section>
      <section anchor="key-agreement-with-key-wrap" numbered="true" removeInRFC="false" toc="include" pn="section-12.5">
        <name slugifiedName="name-key-agreement-with-key-wrap">キーラップを伴うキーアグリーメント</name>
        <t indent="0" pn="section-12.5-1">キー交換とキーラップは、ランダムに生成されたCEKを使用します。そのCEKは、キーラップアルゴリズムと、キー交換アルゴリズムによって計算される共有秘密から派生したキーを使用して暗号化されます。このための関数は次のとおりです：</t>
        <t indent="0" pn="section-12.5-2">encryptedKey = KeyWrap(KDF(DH-Shared, context), CEK) 受信者向けのCOSE_Encrypt構造体は、次のように構成されます:</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5-3">
          <li pn="section-12.5-3.1">「'protected' フィールドは、KDF コンテキスト構造に入力されます。」</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5-4">
          <li pn="section-12.5-4.1">平文を暗号化するのは、通常、下の階層からのキー（通常はコンテンツ層）です。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5-5">
          <li pn="section-12.5-5.1">レイヤーには、'alg'パラメーターが<bcp14>しなければなりません（MUST）</bcp14>存在している必要があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5-6">
          <li pn="section-12.5-6.1">受信者のキーを識別するパラメーターは、存在するべきです（SHOULD）。送信者のキーを識別するパラメーターは、存在するべきです（SHOULD）。</li>
        </ul>
        <section anchor="ecdh" numbered="true" removeInRFC="false" toc="include" pn="section-12.5.1">
          <name slugifiedName="name-ecdh">ECDH</name>
          <t indent="0" pn="section-12.5.1-1">これらのアルゴリズムは、表20で定義されています。</t>
          <t indent="0" pn="section-12.5.1-2">鍵合意を伴うECDHは、ECDHと同じパラメーターでパラメーター化されます。詳細はセクション12.4.1を参照してください。ただし、次の修正が行われます。</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5.1-3">
            <li pn="section-12.5.1-3.1">キーラップアルゴリズム：セクション12.2.1で定義されているいずれかのキーラップアルゴリズムがサポートされています。キーラップアルゴリズムに使用されるキーのサイズはKDFにフィードされます。識別子のセットは表20にあります。</li>
          </ul>
          <t indent="0" pn="section-12.5.1-4"><center>
              <table align="center">
                <thead>
                  <tr>
                    <tr>
                      <td align="left"> 名前 </td>
                      <td align="left">値 </td>
                      <td align="left">KDF </td>
                      <td align="left">エフェメラル - スタティック</td>
                      <td align="left">キーラップ</td>
                      <td align="left">説明   </td>
                    </tr>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left"> ECDH-ES +</td>
                    <td align="left">-29</td>
                    <td align="left">HKDF -</td>
                    <td align="left">はい</td>
                    <td align="left">A128KW</td>
                    <td align="left">ECDH ES w/    </td>
                  </tr>
                  <tr>
                    <td align="left"> A128KW   </td>
                    <td align="left">   </td>
                    <td align="left">SHA-256   </td>
                    <td align="left">   </td>
                    <td align="left">   </td>
                    <td align="left">連結KDFとAESキーラップ w/        128ビットキー   </td>
                  </tr>
                  <tr>
                    <td align="left"> ECDH-ES +</td>
                    <td align="left">-30</td>
                    <td align="left">HKDF -</td>
                    <td align="left">はい</td>
                    <td align="left">A192KW</td>
                    <td align="left">ECDH ES w/    </td>
                  </tr>
                  <tr>
                    <td align="left"> A192KW   </td>
                    <td align="left">   </td>
                    <td align="left">SHA-256   </td>
                    <td align="left">   </td>
                    <td align="left">   </td>
                    <td align="left">連結KDFとAESキーラップ w/        192ビットキー   </td>
                  </tr>
                  <tr>
                    <td align="left"> ECDH-ES +</td>
                    <td align="left">-31</td>
                    <td align="left">HKDF -</td>
                    <td align="left">はい</td>
                    <td align="left">A256KW</td>
                    <td align="left">ECDH ES w/    </td>
                  </tr>
                  <tr>
                    <td align="left"> A256KW   </td>
                    <td align="left">   </td>
                    <td align="left">SHA-256   </td>
                    <td align="left">   </td>
                    <td align="left">   </td>
                    <td align="left">連結KDFとAESキーラップ w/        256ビットキー   </td>
                  </tr>
                  <tr>
                    <td align="left"> ECDH-SS +</td>
                    <td align="left">-32</td>
                    <td align="left">HKDF -</td>
                    <td align="left">いいえ</td>
                    <td align="left">A128KW</td>
                    <td align="left">ECDH SS w/    </td>
                  </tr>
                  <tr>
                    <td align="left"> A128KW   </td>
                    <td align="left">   </td>
                    <td align="left">SHA-256   </td>
                    <td align="left">   </td>
                    <td align="left">   </td>
                    <td align="left">連結KDFとAESキーラップ w/        128ビットキー   </td>
                  </tr>
                  <tr>
                    <td align="left"> ECDH-SS +</td>
                    <td align="left">-33</td>
                    <td align="left">HKDF -</td>
                    <td align="left">いいえ</td>
                    <td align="left">A192KW</td>
                    <td align="left">ECDH SS w/    </td>
                  </tr>
                  <tr>
                    <td align="left"> A192KW   </td>
                    <td align="left">   </td>
                    <td align="left">SHA-256   </td>
                    <td align="left">   </td>
                    <td align="left">   </td>
                    <td align="left">連結KDFとAESキーラップ w/        192ビットキー   </td>
                  </tr>
                  <tr>
                    <td align="left"> ECDH-SS +</td>
                    <td align="left">-34</td>
                    <td align="left">HKDF -</td>
                    <td align="left">いいえ</td>
                    <td align="left">A256KW</td>
                    <td align="left">ECDH SS w/    </td>
                  </tr>
                  <tr>
                    <td align="left"> A256KW   </td>
                    <td align="left">   </td>
                    <td align="left">SHA-256   </td>
                    <td align="left">   </td>
                    <td align="left">   </td>
                    <td align="left">連結KDFとAESキーラップ w/        256ビットキー   </td>
                  </tr>
                </tbody>
              </table>
            </center>
          </t>
          <t indent="0" pn="section-12.5.1-5"><artwork name="" type="" align="left" alt="">
            テーブル20: キー保護付きECDHアルゴリズム値
</artwork>
          </t>
          <t indent="0" pn="section-12.5.1-6">このアルゴリズムのためにCOSEキーを使用する場合、以下のチェックが行われます：<bcp14>しなければなりません（MUST）</bcp14></t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5.1-7">
            <li pn="section-12.5.1-7.1">「kty」フィールドは存在しなければならず、そして「EC2」または「OKP」でなければなりません。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5.1-8">
            <li pn="section-12.5.1-8.1">
              <bcp14>「alg」フィールドが存在する場合、使用されている鍵共有アルゴリズムと一致しなければなりません（MUST）。</bcp14></li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5.1-9">
            <li pn="section-12.5.1-9.1">もし、'key_ops'フィールドが存在する場合、それはプライベートキーに対して'鍵の派生'または'ビットの派生'を含める必要があります。</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-12.5.1-10">
            <li pn="section-12.5.1-10.1">「'key_ops'フィールドが存在する場合、パブリックキーには空でなければなりません（MUST）。」</li>
          </ul>
        </section>
      </section>
    </section>
    <section anchor="key-object-parameters" numbered="true" removeInRFC="false" toc="include" pn="section-13">
      <name slugifiedName="name-key-object-parameters">キーオブジェクトパラメーター</name>
      <t indent="0" pn="section-13-1">COSE_Key オブジェクトは、単一のキーオブジェクトを保持する方法を定義します。ただし、個々のキータイプのメンバーが定義される必要があります。この文書のこのセクションでは、特定のキータイプの初期セットのメンバーを定義します。</t>
      <t indent="0" pn="section-13-2">各キータイプについて、公開メンバーと非公開メンバーの両方を定義します。公開メンバーは他の人が使用するために送信されるものです。非公開メンバーは個人が鍵をアーカイブするために使用されます。ただし、プロトコルにおいては、いくつかの状況で非公開キーがエンティティに配布される場合があります。例としては、乱数生成が不十分なエンティティ、マルチキャスト型の操作のための集中鍵作成、および共有シークレットが認可目的でベアラトークンとして使用されるプロトコルがあります。</t>
      <t indent="0" pn="section-13-3">キーの種類は、COSE_Keyオブジェクトの 'kty' メンバによって識別されます。このドキュメントでは、メンバに対して4つの値を定義します。</t>
      <t indent="0" pn="section-13-4"><table align="center">
          <thead>
            <tr>
              <tr>
                <td align="left"> 名前</td>
                <td align="left">値</td>
                <td align="left">説明                                   </td>
              </tr>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left"> OKP</td>
              <td align="left">1</td>
              <td align="left">オクテット鍵ペア                                </td>
            </tr>
            <tr>
              <td align="left"> EC2 </td>
              <td align="left">2 </td>
              <td align="left">xおよびy座標の楕円曲線鍵のペア                   </td>
            </tr>
            <tr>
              <td align="left"> 対称鍵</td>
              <td align="left">4</td>
              <td align="left">対称鍵                                </td>
            </tr>
            <tr>
              <td align="left"> 予約済み</td>
              <td align="left">0</td>
              <td align="left">この値は予約されています                            </td>
            </tr>
          </tbody>
        </table>
      </t>
      <t indent="0" pn="section-13-5"><artwork name="" type="" align="left" alt="">
                      テーブル21：キータイプの値
</artwork>
      </t>
      <section anchor="elliptic-curve-keys" numbered="true" removeInRFC="false" toc="include" pn="section-13.1">
        <name slugifiedName="name-elliptic-curve-keys">楕円曲線鍵</name>
        <t indent="0" pn="section-13.1-1">楕円曲線鍵には2つの異なる鍵構造が定義されています。1つのバージョンでは、x座標とy座標の両方を使用し、ポイントの圧縮（「EC2」）も可能です。これは、<xi:xref target="RFC5480" format="default" sectionFormat="of" derivedContent="RFC5480"/>で使用される従来のECポイント表現です。もう1つのバージョンでは、鍵合意操作にはy座標が再計算されるか必要ないため、x座標のみを使用します（「OKP」）。</t>
        <t indent="0" pn="section-13.1-2">アプリケーションは、曲線と鍵の種類が一致しているかどうかを確認し、一致していない場合は鍵を拒否する<bcp14>しなければなりません（MUST）</bcp14>。</t>
        <t indent="0" pn="section-13.1-3"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left">名前</td>
                  <td align="left">値</td>
                  <td align="left">キータイプ</td>
                  <td align="left">説明</td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">P-256</td>
                <td align="left">1</td>
                <td align="left">EC2</td>
                <td align="left">NIST P-256、またはsecp256r1とも呼ばれます</td>
              </tr>
              <tr>
                <td align="left">P-384</td>
                <td align="left">2</td>
                <td align="left">EC2</td>
                <td align="left">NIST P-384、またはsecp384r1とも呼ばれます</td>
              </tr>
              <tr>
                <td align="left">P-521</td>
                <td align="left">3</td>
                <td align="left">EC2</td>
                <td align="left">NIST P-521、またはsecp521r1とも呼ばれます</td>
              </tr>
              <tr>
                <td align="left">X25519</td>
                <td align="left">4</td>
                <td align="left">OKP</td>
                <td align="left">ECDHでの使用に適したX25519</td>
              </tr>
              <tr>
                <td align="left">X448</td>
                <td align="left">5</td>
                <td align="left">OKP</td>
                <td align="left">ECDHでの使用に適したX448</td>
              </tr>
              <tr>
                <td align="left">Ed25519</td>
                <td align="left">6</td>
                <td align="left">OKP</td>
                <td align="left">EdDSAでの使用に適したEd25519</td>
              </tr>
              <tr>
                <td align="left">Ed448</td>
                <td align="left">7</td>
                <td align="left">OKP</td>
                <td align="left">EdDSAでの使用に適したEd448</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-13.1-4"><artwork name="" type="" align="left" alt="">
                      表22: 楕円曲線
</artwork>
        </t>
        <section anchor="double-coordinate-curves" numbered="true" removeInRFC="false" toc="include" pn="section-13.1.1">
          <name slugifiedName="name-double-coordinate-curves">二重座標曲線</name>
          <t indent="0" pn="section-13.1.1-1">ECを送信する従来の方法は、x座標とy座標の両方またはx座標とy座標の符号ビットを送信することでした。後者の符号化は、IETFでは潜在的な知的財産権の問題のために推奨されていません。しかし、制約のある環境での操作において、y座標を送信しないことによってメッセージを縮小する能力は、潜在的に有用です。</t>
          <t indent="0" pn="section-13.1.1-2">EC鍵の両方の座標を持つ場合、'kty'メンバは2（EC2）に設定されます。このセクションで定義された鍵パラメーターは、表23にまとめられています。この鍵タイプのために定義されたメンバは以下の通りです。</t>
          <t indent="0" pn="section-13.1.1-3">crv：この項目は、鍵と一緒に使用する曲線の識別子を含んでいます。この鍵タイプのためにこのドキュメントで定義された曲線は、表22に見つけることができます。将来的に他の曲線が登録されることがあり、また、プライベートな曲線も使用することができます。</t>
          <t indent="0" pn="section-13.1.1-4">x: このフィールドには、楕円曲線上の点のx座標が含まれます。整数は、<xref target="SEC1" format="default" sectionFormat="of" derivedContent="SEC1"/> で定義されたようにオクテット文字列に変換されます。先頭のゼロのオクテットは<bcp14>しなければなりません（MUST）</bcp14>。</t>
          <t indent="0" pn="section-13.1.1-5">y:   This contains either the sign bit or the value of the
     y-coordinate for the EC point.  When encoding the value y, the
     integer is converted to an octet string (as defined in <xref target="SEC1" format="default" sectionFormat="of" derivedContent="SEC1"/>)
     and encoded as a CBOR bstr.  Leading zero octets <bcp14>MUST</bcp14> be
     preserved.  The compressed point encoding is also supported.
     Compute the sign bit as laid out in the Elliptic-Curve-Point-to-
     Octet-String Conversion function of <xref target="SEC1" format="default" sectionFormat="of" derivedContent="SEC1"/>.  If the sign bit is
     zero, then encode y as a CBOR false value; otherwise, encode y
     as a CBOR true value.  The encoding of the infinity point is not
     supported.</t>
          <t indent="0" pn="section-13.1.1-6">d: これには秘密鍵が含まれています。</t>
          <t indent="0" pn="section-13.1.1-7">公開鍵については、構造内に 'crv'、'x'、および 'y' が存在することが<bcp14>要求されています（REQUIRED）</bcp14>。秘密鍵については、構造内に 'crv' と 'd' が存在することが<bcp14>要求されています（REQUIRED）</bcp14>。秘密鍵については、'x' と 'y' も存在することが<bcp14>推奨されます（RECOMMENDED）</bcp14>が、必要な要素から再計算できるため、省略することでスペースを節約することができます。</t>
          <t indent="0" pn="section-13.1.1-8"><table align="center">
              <thead>
                <tr>
                  <tr>
                    <td align="left"> キーのタイプ</td>
                    <td align="left">名前</td>
                    <td align="left">ラベル</td>
                    <td align="left">CBORのタイプ</td>
                    <td align="left">説明</td>
                  </tr>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left"> 2 </td>
                  <td align="left">crv </td>
                  <td align="left">-1 </td>
                  <td align="left">int / tstr</td>
                  <td align="left">EC識別子-「COSE楕円曲線」レジストリから取得</td>
                </tr>
                <tr>
                  <td align="left"> 2</td>
                  <td align="left">x</td>
                  <td align="left">-2</td>
                  <td align="left">bstr</td>
                  <td align="left">x座標</td>
                </tr>
                <tr>
                  <td align="left"> 2 </td>
                  <td align="left">y </td>
                  <td align="left">-3 </td>
                  <td align="left">bstr / bool</td>
                  <td align="left">y座標</td>
                </tr>
                <tr>
                  <td align="left"> 2</td>
                  <td align="left">d</td>
                  <td align="left">-4</td>
                  <td align="left">bstr</td>
                  <td align="left">プライベートキー</td>
                </tr>
              </tbody>
            </table>
          </t>
          <t indent="0" pn="section-13.1.1-9"><artwork name="" type="" align="left" alt="">
                     テーブル23：ECキーパラメーター
</artwork>
          </t>
        </section>
      </section>
      <section anchor="octet-key-pair" numbered="true" removeInRFC="false" toc="include" pn="section-13.2">
        <name slugifiedName="name-octet-key-pair">オクテットキーペア</name>
        <t indent="0" pn="section-13.2-1">新しい鍵タイプがOctet Key Pairs (OKP)のために定義されています。このタイプの鍵が楕円曲線であるとは限りませんので、そのように想定しないでください。この鍵タイプは他の曲線タイプ（例えば、超楕円曲面に基づく数学）にも使用される可能性があります。</t>
        <t indent="0" pn="section-13.2-2">このセクションで定義された主なパラメーターは、表24にまとめられています。このキータイプに定義されたメンバーは以下の通りです：</t>
        <t indent="0" pn="section-13.2-3">crv: キーと一緒に使用される曲線の識別子を含んでいます。このキータイプに対してこのドキュメントで定義された曲線は、テーブル22にあります。将来的に他の曲線が登録されることがあり、また、プライベートな曲線も使用できます。</t>
        <t indent="0" pn="section-13.2-4">x：このフィールドは、ECポイントのx座標を含みます。オクテット文字列は、xのリトルエンディアンエンコーディングを表します。</t>
        <t indent="0" pn="section-13.2-5">d: これにはプライベートキーが含まれています。</t>
        <t indent="0" pn="section-13.2-6">公開鍵については、構造内に「crv」と「x」が存在することが「要求されています（REQUIRED）」。秘密鍵については、構造内に「crv」と「d」が存在することが「要求されています（REQUIRED）」。秘密鍵については、「x」も存在することが「推奨されます（RECOMMENDED）」が、必要な要素から再計算することができるため、省略するとスペースを節約できます。</t>
        <t indent="0" pn="section-13.2-7"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left">名前</td>
                  <td align="left">キーの種類</td>
                  <td align="left">ラベル</td>
                  <td align="left">タイプ</td>
                  <td align="left">説明</td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">crv</td>
                <td align="left">1</td>
                <td align="left">-1</td>
                <td align="left">int / tstr</td>
                <td align="left">EC識別子 - 「COSE Key Common Parameters」のレジストリから取得</td>
              </tr>
              <tr>
                <td align="left">x</td>
                <td align="left">1</td>
                <td align="left">-2</td>
                <td align="left">bstr</td>
                <td align="left">x座標</td>
              </tr>
              <tr>
                <td align="left">d</td>
                <td align="left">1</td>
                <td align="left">-4</td>
                <td align="left">bstr</td>
                <td align="left">秘密鍵</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-13.2-8"><artwork name="" type="" align="left" alt="">
                 テーブル24：オクテット鍵ペアパラメーター
</artwork>
        </t>
      </section>
      <section anchor="symmetric-keys" numbered="true" removeInRFC="false" toc="include" pn="section-13.3">
        <name slugifiedName="name-symmetric-keys">対称鍵</name>
        <t indent="0" pn="section-13.3-1"><bcp14>時折、エンティティ間で対称キーを転送する必要があります。このキー構造はその要件を満たすことができます。</bcp14></t>
        <t indent="0" pn="section-13.3-2">対称キーの場合、'kty'メンバーは4（'Symmetric'）に設定されます。このキータイプには定義されているメンバーはありません。</t>
        <t indent="0" pn="section-13.3-3">k: これにはキーの値が含まれています。</t>
        <t indent="0" pn="section-13.3-4">このキー構造には、公開メンバーのみを含む形式はありません。このキー構造が送信されることが予想されるため、誤ってまたは安全ではない状態で送信されないように注意する必要があります。対称キーの場合、構造内に 'k' が存在することが<bcp14>要求されています（REQUIRED）</bcp14>。</t>
        <t indent="0" pn="section-13.3-5"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前</td>
                  <td align="left">キータイプ</td>
                  <td align="left">ラベル</td>
                  <td align="left">タイプ</td>
                  <td align="left">説明 </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> k</td>
                <td align="left">4</td>
                <td align="left">-1</td>
                <td align="left">bstr</td>
                <td align="left">キーの値   </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-13.3-6"><artwork name="" type="" align="left" alt="">
                 テーブル25：対称鍵パラメーター
</artwork>
        </t>
      </section>
    </section>
    <section anchor="cbor-encoder-restrictions" numbered="true" removeInRFC="false" toc="include" pn="section-14">
      <name slugifiedName="name-cbor-encoder-restrictions">CBOR エンコーダの制約</name>
      <t indent="0" pn="section-14-1">CBOR Encoderの動作に制限を課す場所をできるだけ少なくする試みが行われてきました。次の制限に絞り込むことに成功しました：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-14-2">
        <li pn="section-14-2.1">制限は、Sig_structure、Enc_structure、およびMAC_structureのエンコーディングに適用されます。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-14-3">
        <li pn="section-14-3.1">「Canonical CBOR」（RFC 7049のセクション3.9）のルールは、これらの場所で使用しなければなりません（MUST）。適用する必要がある主なルールは、これらの構造体内のすべての長さが、確定長を使用して符号化され、最小長の符号化が使用されていることです。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-14-4">
        <li pn="section-14-4.1"> Applications MUST NOT generate messages with the same label used
   twice as a key in a single map.  Applications MUST NOT parse and
   process messages with the same label used twice as a key in a
   single map.  Applications can enforce the parse and process
   requirement by using parsers that will fail the parse step or by
   using parsers that will pass all keys to the application, and the
   application can perform the check for duplicate keys.</li>
      </ul>
    </section>
    <section anchor="application-profiling-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-15">
      <name slugifiedName="name-application-profiling-considerations">アプリケーションプロファイリングに関する考慮事項</name>
      <t indent="0" pn="section-15-1">この文書は、特定の使用法に対する実装要件ではなく、セキュリティーサービスの一連を提供するために設計されています。各個別のサービスの使用方法および相互運用性のためのアルゴリズムの使用方法に関する相互運用要件が示されています。必要なアルゴリズムとサービスについての要件は、各アプリケーションに委ねられています。</t>
      <t indent="0" pn="section-15-2">プロファイルの例は、2つのプロファイルが開発中である<xref target="OSCOAP" format="default" sectionFormat="of" derivedContent="OSCOAP"/>に見つけることができます。1つはコンテンツ自体を運ぶためのものであり、もう1つはCoAPヘッダーと組み合わせてコンテンツを運ぶためのものです。</t>
      <t indent="0" pn="section-15-3">このドキュメントのプロファイルが作成され、特定のアプリケーションの互換性要件が定義されることが意図されています。このセクションでは、このドキュメントのプロファイルを作成する際に考慮すべきガイドラインとトピックのセットを提供します。</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-15-4">
        <li pn="section-15-4.1">
          <bcp14>このドキュメントで定義されたメッセージのセットを使用する必要があるアプリケーションがあります。このメッセージのセットは、必要なセキュリティーサービスのセットと、必要なセキュリティーレベルにかなり直接対応しています。</bcp14></li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-15-5">
        <li pn="section-15-5.1">特定の目的のために、アプリケーションは新しいヘッダーパラメーターを定義することができます。アプリケーションはしばしば、使用するかどうかを選択するために特定のヘッダーパラメーターを選択することもあります。例えば、アプリケーションは通常、IVパラメーターまたはPartial IVパラメーターのどちらかを使用することを好むと述べるでしょう。Partial IVパラメーターが指定されている場合、アプリケーションはまた、IVの固定部分がどのように決定されるかを定義する必要があります。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-15-6">
        <li pn="section-15-6.1">アプリケーションが外部で定義された認証データを使用する場合、そのデータのエンコード方法を定義する必要があります。このドキュメントでは、データがバイトストリームとして提供されることを前提としています。詳細はセクション4.3に記載されています。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-15-7">
        <li pn="section-15-7.1">応用プログラムは使用するセキュリティーアルゴリズムのセットを特定する必要があります。必須の実装セットとして使用されるアルゴリズムを選択する際には、特定の目的に2つのアルゴリズムが選択される場合、異なるタイプのアルゴリズムを選ぶことが望ましいです。これにより、異なるMACアルゴリズムとしてHMAC- SHA512およびAES-CMACを選択する場合を例に挙げます。これら2つのアルゴリズムの構造は大きく異なります。これは、1つのアルゴリズムの弱体化が他のアルゴリズムの弱体化につながる可能性が低いことを意味します。もちろん、これらのアルゴリズムは同じレベルのセキュリティーを提供せず、したがって、望ましいセキュリティー機能のために比較できない場合があります。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-15-8">
        <li pn="section-15-8.1">アプリケーションは、複数のアルゴリズムやメッセージ構造が許可されている場合、一定の交渉や検出手法を提供する必要がある場合があります。この手法は、アルゴリズムのセットの事前設定を要求するだけのシンプルなものから、プロトコルに組み込まれた検出手法を提供するものまでさまざまです。S/MIMEは、アプリケーションが問題にアプローチするために追従できるさまざまな方法を提供しました。</li>
      </ul>
      <t indent="0" pn="section-15-9"><artwork name="" type="" align="left" alt="">
   *  メッセージに広告する（S/MIMEの機能）[RFC5751]。
</artwork>
      </t>
      <t indent="0" pn="section-15-10"><artwork name="" type="" align="left" alt="">
   *  証明書内の広告（機能拡張）
      [RFC4262]。
</artwork>
      </t>
      <t indent="0" pn="section-15-11"><artwork name="" type="" align="left" alt="">
   * S/MIMEの最小要件は、時間の経過とともに更新されています[RFC2633] [RFC5751]（[RFC2633]は[RFC5751]によって廃止されていることに注意してください）。
</artwork>
      </t>
    </section>
    <section anchor="iana-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-16">
      <name slugifiedName="name-iana-considerations">IANAの考慮事項</name>
      <section anchor="cbor-tag-assignment" numbered="true" removeInRFC="false" toc="include" pn="section-16.1">
        <name slugifiedName="name-cbor-tag-assignment">CBOR タグの割り当て</name>
        <t indent="0" pn="section-16.1-1">IANAは、「CBOR Tags」レジストリから以下のタグを割り当てました。COSE_Sign1、COSE_Encrypt0、およびCOSE_Mac0のタグは、値範囲1から23（符号化時は1バイト）に割り当てられました。COSE_Sign、COSE_Encrypt、およびCOSE_Macのタグは、値範囲24から255（符号化時は2バイト）に割り当てられました。</t>
        <t indent="0" pn="section-16.1-2">割り当てられたタグは表1に記載されています。</t>
      </section>
      <section anchor="cose-header-parameters-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.2">
        <name slugifiedName="name-cose-header-parameters-registry">COSEヘッダーパラメーターのレジストリ</name>
        <t indent="0" pn="section-16.2-1">IANAは、「COSEヘッダーパラメーター」という新しいレジストリを作成しました。「エキスパートレビューが必要です」の登録手続きを利用するため、このレジストリは作成されました<xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>。エキスパートへのガイドラインは、セクション16.11で提供されています。専門家のレビューに加えて、レジストリの一部には、仕様、おそらくは標準軌道のRFCが提供される必要があることに注意してください。</t>
        <t indent="0" pn="section-16.2-2">レジストリの列は次のとおりです：</t>
        <t indent="0" pn="section-16.2-3"><Name>名前:</Name>登録エントリーを参照および議論しやすくするために、名前が存在します。値はプロトコルで使用されません。名前はテーブル内で一意である必要があります。</t>
        <t indent="0" pn="section-16.2-4">ラベル：これはラベルに使用される値です。ラベルは整数または文字列です。テーブルへの登録は、要求されたラベルの値に基づいて行われます。1から255までの整数値および長さ1の文字列は、「標準処理」と指定されます。256から65535までの整数値および長さ2の文字列は、「仕様必須」と指定されます。65535より大きい整数値および長さ2より大きい文字列は、「専門家のレビュー」と指定されます。範囲が-1から-65536の整数値は、「COSEヘッダーアルゴリズムパラメーターレジストリに委任」と指定されます。-65536未満の整数値は、プライベート使用としてマークされます。</t>
        <t indent="0" pn="section-16.2-5">値の種類：これには、ラベルの値部分のCBORタイプが含まれています。</t>
        <t indent="0" pn="section-16.2-6">値レジストリ：これは、セットが制限されている場合に値が含まれるレジストリを指すポインターを含んでいます。</t>
        <t indent="0" pn="section-16.2-7">説明：ヘッダーフィールドの簡単な説明が含まれています。</t>
        <t indent="0" pn="section-16.2-8">参考：これは、ヘッダーフィールドを定義する仕様へのポインタを含んでいます（公開されている場合）。</t>
        <t indent="0" pn="section-16.2-9">登録内容の初期データは、テーブル2と27にあります。この登録の「参照」欄のすべてのエントリは、この文書を指しています。</t>
        <t indent="0" pn="section-16.2-10">付加的に、ラベル0は「予約済み」としてマークする必要があります。</t>
      </section>
      <section anchor="cose-header-algorithm-parameters-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.3">
        <name slugifiedName="name-cose-header-algorithm-parameters-registry">COSEヘッダーアルゴリズムパラメーター登録</name>
        <t indent="0" pn="section-16.3-1">IANAは、「COSEヘッダーアルゴリズムパラメーター」という新しいレジストリを作成しました。このレジストリは、「エキスパートレビューが必要な」という登録手続きを使用します。エキスパートレビューのガイドラインは、セクション16.11に提供されています。</t>
        <t indent="0" pn="section-16.3-2">登録の列は以下の通りです：</t>
        <t indent="0" pn="section-16.3-3">名前：登録エントリを参照し、議論する際に便宜上使用されます。値はプロトコルで使用されません。</t>
        <t indent="0" pn="section-16.3-4">アルゴリズム：このレジストリエントリが使用されるアルゴリズム（複数可）です。この値は、「COSEアルゴリズム」レジストリから取得されます。表の場合、アルゴリズム／ラベルの組み合わせは<bcp14>一意である必要があります（MUST）</bcp14>。</t>
        <t indent="0" pn="section-16.3-5">ラベル：ラベルに使用される値です。ラベルは-1から-65536の範囲内の整数です。</t>
        <t indent="0" pn="section-16.3-6">タイプ：これには、ラベルの値部分のCBORタイプが含まれています。</t>
        <t indent="0" pn="section-16.3-7">説明：これにはヘッダーフィールドの簡単な説明が含まれています。</t>
        <t indent="0" pn="section-16.3-8">参照：これには、ヘッダーフィールドを定義する仕様へのポインタが含まれています（公開時）。</t>
        <t indent="0" pn="section-16.3-9">レジストリの初期内容は、表13、表14、および表19で見つけることができます。このレジストリの「参照」列のすべてのエントリは、このドキュメントを指しています。</t>
      </section>
      <section anchor="cose-algorithms-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.4">
        <name slugifiedName="name-cose-algorithms-registry">COSEアルゴリズムレジストリ</name>
        <t indent="0" pn="section-16.4-1">IANAは、「COSEアルゴリズム」と題した新しいレジストリを作成しました。このレジストリは、「要求された専門家によるレビュー」登録手続きを使用するために作成されました。専門家へのガイドラインはセクション16.11に提供されています。なお、専門家によるレビューに加えて、レジストリの一部には、仕様書、潜在的にはスタンダードトラックRFCを提供する必要があることに注意してください。</t>
        <t indent="0" pn="section-16.4-2">レジストリの列は次のとおりです：</t>
        <t indent="0" pn="section-16.4-3">名前：理解を容易にするために文書内でアルゴリズムを識別するために使用可能な値です。名前<bcp14>はすべき (SHOULD)</bcp14>で一意であるべきです。ただし、アルゴリズムを識別するのに「名前」フィールドではなく、「値」フィールドが使用されます。</t>
        <t indent="0" pn="section-16.4-4">値：このアルゴリズムを識別するために使用される値です。アルゴリズムの値は<bcp14>しなければなりません（MUST）</bcp14>独自である必要があります。値は正の整数、負の整数、または文字列にすることができます。-256から255の整数値と長さ1の文字列は「標準アクション」として指定されています。-65536から65535の整数値と長さ2の文字列は「仕様要求」として指定されています。65535より大きい整数値と長さ2より大きい文字列は「専門家によるレビュー」として指定されています。-65536未満の整数値はプライベート使用としてマークされています。</t>
        <t indent="0" pn="section-16.4-5">説明：アルゴリズムの短い説明。</t>
        <t indent="0" pn="section-16.4-6">参考文献：アルゴリズムが定義されている文書（もし公開されている場合）。</t>
        <t indent="0" pn="section-16.4-7">推奨されます：IETFはアルゴリズムの使用について合意した推奨事項を持っていますか？適切な値は「はい」、「いいえ」、および「非推奨」です。</t>
        <t indent="0" pn="section-16.4-8">レジストリの最初の内容は、テーブル5、6、7、8、9、10、11、15、16、17、18、および20にあります。このレジストリの「参照」列のすべてのエントリは、この文書を指しています。また、このレジストリの「推奨」列のすべてのエントリは「はい」に設定されています。</t>
        <t indent="0" pn="section-16.4-9">さらに、ラベル0は「予約済み」としてマークされる必要があります。</t>
        <t indent="0" pn="section-16.4-10">注意：このドキュメントでのアルゴリズム識別子の割り当ては、第1層オブジェクト（COSE_Sign、COSE_Sign1、COSE_Encrypt、COSE_Encrypt0、COSE_Mac、COSE_Mac0）には正の数が使用されました。第2層オブジェクト（COSE_SignatureとCOSE_recipient）には負の数が使用されました。専門の審査者はこの慣行を考慮すべきですが、この前例に制約されることは期待されていません。</t>
      </section>
      <section anchor="cose-key-common-parameters-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.5">
        <name slugifiedName="name-cose-key-common-parameters-registry">COSEキーパラメーター共通レジストリ</name>
        <t indent="0" pn="section-16.5-1">IANAは、「COSE Key Common Parameters」という新しい登録表を作成しました。この登録表は、「Expert Review Required（専門家のレビューが必要）」の登録手続きを使用するために作成されました。専門家へのガイドラインはセクション16.11で提供されます。ただし、専門家のレビューに加えて、登録表の一部には仕様書（おそらくStandards Track RFC）が提供される必要があることに留意してください。</t>
        <t indent="0" pn="section-16.5-2">登録の列は次の通りです：</t>
        <t indent="0" pn="section-16.5-3">Name: これはアイテムの簡単な参照を可能にする説明的な名前です。エンコーディングで使用されることはありません。</t>
        <t indent="0" pn="section-16.5-4">ラベル：このアルゴリズムを識別するために使用される値。キーマップのラベルは<bcp14>しなければなりません（MUST）</bcp14>一意である必要があります。ラベルは正の整数、負の整数、または文字列であることができます。0から255までの整数値と長さ1の文字列は「標準アクション」とされます。256から65535までの整数値と長さ2の文字列は「仕様要求」とされます。65535より大きな整数値と長さ2より大きな文字列は「専門家によるレビュー」とされます。-65536から-1までの整数値は、「COSEキータイプパラメーターレジストリに委任された単一のアルゴリズムに固有のキーパラメーターに使用されます」。-65536未満の整数値は私的な使用としてマークされます。</t>
        <t indent="0" pn="section-16.5-5">CBOR タイプ：このフィールドには、そのフィールドの CBOR タイプが含まれています。</t>
        <t indent="0" pn="section-16.5-6"><bcp14>値レジストリ: もし存在する場合、このフィールドは値の出所を示します。</bcp14></t>
        <t indent="0" pn="section-16.5-7">解説：このフィールドには、フィールドの簡単な説明が含まれています。</t>
        <t indent="0" pn="section-16.5-8">参考：これは、存在する場合はフィールドの公開仕様へのポインタを含んでいます。</t>
        <t indent="0" pn="section-16.5-9">このレジストリは、初期状態ではTable 3の値で補完されています。このレジストリの「参照」列のすべてのエントリは、この文書を指しています。</t>
      </section>
      <section anchor="cose-key-type-parameters-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.6">
        <name slugifiedName="name-cose-key-type-parameters-registry">COSEキータイプパラメーターレジストリ</name>
        <t indent="0" pn="section-16.6-1">IANAは、「COSEキータイプパラメーター」という新しい登録簿を作成しました。登録簿は「専門家によるレビューが必要（Expert Review Required）」な手続きを使用するために作成されました。専門家によるレビューのガイドラインは、セクション16.11に提供されています。</t>
        <t indent="0" pn="section-16.6-2">テーブルの列は次のとおりです。</t>
        <t indent="0" pn="section-16.6-3">キータイプ：このフィールドにはキータイプの説明的な文字列が含まれます。これは、「COSEキー共通パラメーター」レジストリ内の値であり、COSEキー構造体の「kty」フィールドに配置されるべきです。</t>
        <t indent="0" pn="section-16.6-4">名前：これはアイテムへの参照を容易にするための説明的な名前です。エンコーディングでは使用されません。</t>
        <t indent="0" pn="section-16.6-5">ラベル：ラベルは、キータイプの各値で一意である必要があります。値の範囲は、-65536から-1までです。ラベルは、異なるキーに再利用されることが期待されています。</t>
        <t indent="0" pn="section-16.6-6">CBOR タイプ：このフィールドには、フィールドの CBOR タイプが含まれています。</t>
        <t indent="0" pn="section-16.6-7">説明：このフィールドには、フィールドの簡単な説明が含まれています。</t>
        <t indent="0" pn="section-16.6-8">Reference:  This contains a pointer to the public specification for
   the field if one exists.</t>
        <t indent="0" pn="section-16.6-9">この登録は最初にテーブル23、24、および25の値で補完されました。この登録の「参照」列のすべてのエントリは、この文書を指しています。</t>
      </section>
      <section anchor="cose-key-types-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.7">
        <name slugifiedName="name-cose-key-types-registry">COSEキータイプの登録</name>
        <t indent="0" pn="section-16.7-1">IANAは、新しい「COSEキータイプ」の登録機関を作成しました。この登録機関は、「専門家のレビューが必要」という登録手続きを使用するために作成されました。専門家のレビューのガイドラインは、セクション16.11に提供されています。</t>
        <t indent="0" pn="section-16.7-2">この表の列は：</t>
        <t indent="0" pn="section-16.7-3">名前：これは項目への簡単な参照を可能にする説明的な名前です。名前<bcp14>は必ず</bcp14>ユニークである必要があります。エンコーディングには使用されません。</t>
        <t indent="0" pn="section-16.7-4">Value:  This is the value used to identify the curve.  These values
   <bcp14>MUST</bcp14> be unique.  The value can be a positive integer, a negative
   integer, or a string.</t>
        <t indent="0" pn="section-16.7-5">説明：このフィールドには、曲線の簡単な説明が含まれています。</t>
        <t indent="0" pn="section-16.7-6">参考文献: もしあれば、カーブの公開仕様へのポインタを含みます。</t>
        <t indent="0" pn="section-16.7-7">このレジストリは、最初にテーブル21の値で初期設定されました。これらのエントリの仕様の列は、この文書になります。</t>
      </section>
      <section anchor="cose-elliptic-curves-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.8">
        <name slugifiedName="name-cose-elliptic-curves-registry">COSE楕円曲線レジストリ</name>
        <t indent="0" pn="section-16.8-1">IANA has created a new registry titled "COSE Elliptic Curves".  The
registry has been created to use the "Expert Review Required"
registration procedure.  Guidelines for the experts are provided in
Section 16.11.  It should be noted that, in addition to the expert
review, some portions of the registry require a specification,
potentially a Standards Track RFC, be supplied as well.</t>
        <t indent="0" pn="section-16.8-2">テーブルの列は次のとおりです:</t>
        <t indent="0" pn="section-16.8-3">Name:  This is a descriptive name that enables easier reference to
   the item.  It is not used in the encoding.</t>
        <t indent="0" pn="section-16.8-4">値：これは曲線を識別するために使用される値です。これらの値は「<bcp14>しなければなりません（MUST）</bcp14>」一意でなければなりません。整数値-256から255までは「標準アクション（Standards Action）」と指定されています。整数値256から65535および-65536から-257までは「仕様が必要（Specification Required）」と指定されています。65535を超える整数値は「専門家のレビュー（Expert Review）」と指定されています。-65536を下回る整数値は私用とマークされています。</t>
        <t indent="0" pn="section-16.8-5">主要なタイプ: この曲線で使用できるキータイプを指定します。</t>
        <t indent="0" pn="section-16.8-6">説明：このフィールドには、曲線の簡単な説明が含まれています。</t>
        <t indent="0" pn="section-16.8-7">参照：これは、存在する場合には曲線に対するパブリックな仕様へのポインタを含んでいます。</t>
        <t indent="0" pn="section-16.8-8">以下の英語のテキストを日本語に翻訳します。

<bcp14>推奨されます（RECOMMENDED）</bcp14>：IETFはアルゴリズムの使用についての合意された推奨事項を持っていますか？有効な値は「はい」、「いいえ」、および「非推奨」です。</t>
        <t indent="0" pn="section-16.8-9">このレジストリは、最初にテーブル22の値で初期化されました。このレジストリの「参照」列のすべてのエントリは、この文書を指します。 「推奨」列のすべてのエントリは「はい」に設定されています。</t>
      </section>
      <section anchor="media-type-registrations" numbered="true" removeInRFC="false" toc="include" pn="section-16.9">
        <name slugifiedName="name-media-type-registrations">メディアタイプの登録</name>
        <section anchor="cose-security-message" numbered="true" removeInRFC="false" toc="include" pn="section-16.9.1">
          <name slugifiedName="name-cose-security-message">COSEセキュリティーメッセージ</name>
          <t indent="0" pn="section-16.9.1-1">このセクションでは、「メディアタイプ（Media Types）」レジストリにおいて「application/cose」というメディアタイプを登録します。これらのメディアタイプは、コンテンツがCOSEメッセージであることを示すために使用されます。</t>
          <t indent="0" pn="section-16.9.1-2"><artwork name="" type="" align="left" alt="">
   タイプ名：アプリケーション
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-3"><artwork name="" type="" align="left" alt="">
   サブタイプ名：cose
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-4"><artwork name="" type="" align="left" alt="">
   必須パラメーター：なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-5"><artwork name="" type="" align="left" alt="">
   オプションのパラメーター: cose-type
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-6"><artwork name="" type="" align="left" alt="">
   エンコーディングの考慮事項：バイナリ
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-7"><artwork name="" type="" align="left" alt="">
   セキュリティーに関する考慮事項: RFC 8152 のセキュリティー考慮事項セクションを参照してください。
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-8"><artwork name="" type="" align="left" alt="">
   相互運用性に関する考慮事項：不適用（N/A）
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-9"><artwork name="" type="" align="left" alt="">
   Published specification: RFC 8152
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-10"><artwork name="" type="" align="left" alt="">
   このメディアタイプを使用するアプリケーション: HTTP(S)トランスポート上でセキュリティーコンテンツを送信するIoTアプリケーション。
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-11"><artwork name="" type="" align="left" alt="">
   フラグメント識別子に関する考慮事項：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-12"><artwork name="" type="" align="left" alt="">
   追加情報：
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-13"><artwork name="" type="" align="left" alt="">
   *  このタイプに対する非推奨のエイリアス名: N/A
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-14"><artwork name="" type="" align="left" alt="">
    * マジックナンバー: 不適用
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-15"><artwork name="" type="" align="left" alt="">
   *  ファイルの拡張子: cbor
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-16"><artwork name="" type="" align="left" alt="">
   * Macintoshのファイルタイプコード：ありません
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-17"><artwork name="" type="" align="left" alt="">
    さらに情報が必要な場合に連絡するための個人とメールアドレス：
   iesg@ietf.org
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-18"><artwork name="" type="" align="left" alt="">
   使用目的：共通
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-19"><artwork name="" type="" align="left" alt="">
   使用制限：N/A
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-20"><artwork name="" type="" align="left" alt="">
   Author: Jim Schaad, ietf@augustcellars.com
   Change Controller: IESG
</artwork>
            <artwork name="" type="" align="left" alt="">
   著者：Jim Schaad, ietf@augustcellars.com
   変更管理者：IESG
</artwork>
          </t>
          <t indent="0" pn="section-16.9.1-21"><artwork name="" type="" align="left" alt="">
仮登録はありませんか？
</artwork>
          </t>
        </section>
        <section anchor="cose-key-media-type" numbered="true" removeInRFC="false" toc="include" pn="section-16.9.2">
          <name slugifiedName="name-cose-key-media-type">COSEキーのメディアタイプ</name>
          <t indent="0" pn="section-16.9.2-1">このセクションでは、「Media Types」レジストリにおいて、'application/cose-key'および'application/cose-key-set'メディアタイプが登録されます。これらのメディアタイプは、それぞれ、コンテンツがCOSE_KeyまたはCOSE_KeySetオブジェクトであることを示すために使用されます。</t>
          <t indent="0" pn="section-16.9.2-2">'application/cose-key'を登録するためのテンプレートは次の通りです：</t>
          <t indent="0" pn="section-16.9.2-3"><artwork name="" type="" align="left" alt="">
   タイプ名: application
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-4"><artwork name="" type="" align="left" alt="">
   サブタイプ名：cose-key
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-5"><artwork name="" type="" align="left" alt="">
   必要なパラメーター：なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-6"><artwork name="" type="" align="left" alt="">
   オプションのパラメーター: N/A
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-7"><artwork name="" type="" align="left" alt="">
   エンコードに関する考慮事項：バイナリ
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-8"><artwork name="" type="" align="left" alt="">
   セキュリティーに関する考慮事項：RFC 8152のセキュリティーに関する考慮事項セクションを参照してください。
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-9"><artwork name="" type="" align="left" alt="">
   互換性に関する考慮事項：なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-10"><artwork name="" type="" align="left" alt="">
   公開仕様書: RFC 8152
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-11"><artwork name="" type="" align="left" alt="">
    このメディアタイプを使用するアプリケーション：IoTアプリケーション向けのCOSEベースのキーの配布。
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-12"><artwork name="" type="" align="left" alt="">
   URI フラグメント識別子に関する考慮事項: 不要
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-13"><artwork name="" type="" align="left" alt="">
   追加情報：
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-14"><artwork name="" type="" align="left" alt="">
   *  このタイプの非推奨のエイリアス名: なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-15"><artwork name="" type="" align="left" alt="">
   * 魔法の数字：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-16"><artwork name="" type="" align="left" alt="">
   *  ファイルの拡張子: cbor
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-17"><artwork name="" type="" align="left" alt="">
   *  Macintoshのファイルタイプコード：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-18"><artwork name="" type="" align="left" alt="">
   追加情報のための連絡先： 
   iesg@ietf.org
   意図された使用方法： COMMON
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-19"><artwork name="" type="" align="left" alt="">
   使用制限：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-20"><artwork name="" type="" align="left" alt="">
   作者：Jim Schaad, ietf@augustcellars.com
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-21"><artwork name="" type="" align="left" alt="">
   変更コントローラー：IESG
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-22"><artwork name="" type="" align="left" alt="">
   仮登録？  いいえ
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-23">「application/cose-key-set」を登録するためのテンプレートは以下の通りです:</t>
          <t indent="0" pn="section-16.9.2-24"><artwork name="" type="" align="left" alt="">
   タイプ名: アプリケーション
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-25"><artwork name="" type="" align="left" alt="">
   サブタイプ名：cose-key-set
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-26"><artwork name="" type="" align="left" alt="">
   必須のパラメーター：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-27"><artwork name="" type="" align="left" alt="">
   オプションのパラメーター：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-28"><artwork name="" type="" align="left" alt="">
   エンコーディングの考慮事項: バイナリ
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-29"><artwork name="" type="" align="left" alt="">
   セキュリティーに関する考慮事項：RFC 8152の「セキュリティーに関する考慮事項」セクションを参照してください。
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-30"><artwork name="" type="" align="left" alt="">
   相互運用性に関する考慮事項：なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-31"><artwork name="" type="" align="left" alt="">
   公開された仕様書：RFC 8152
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-32"><artwork name="" type="" align="left" alt="">
   このメディアタイプを使用するアプリケーション：IoTアプリケーション向けのCOSEベースのキーの配布。
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-33"><artwork name="" type="" align="left" alt="">
   フラグメント識別子に関する考慮事項：該当なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-34"><artwork name="" type="" align="left" alt="">
   付加情報：
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-35"><artwork name="" type="" align="left" alt="">
   *  このタイプに対する非推奨の別名: なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-36"><artwork name="" type="" align="left" alt="">
   *  マジックナンバー：N/A
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-37"><artwork name="" type="" align="left" alt="">
   *  File extension(s): cbor
</artwork>
            <artwork name="" type="" align="left" alt="">
   * ファイル拡張子：cbor
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-38"><artwork name="" type="" align="left" alt="">
   *  Macintoshファイルタイプコード：なし
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-39"><artwork name="" type="" align="left" alt="">
   さらなる情報に関しては、連絡するための担当者と電子メールアドレス：
   iesg@ietf.org
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-40"><artwork name="" type="" align="left" alt="">
   予定された使用法: COMMON
   使用制限: N/A
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-41"><artwork name="" type="" align="left" alt="">
   著者：Jim Schaad、ietf@augustcellars.com
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-42"><artwork name="" type="" align="left" alt="">
   変更コントローラー：IESG
</artwork>
          </t>
          <t indent="0" pn="section-16.9.2-43"><artwork name="" type="" align="left" alt="">
   仮登録？  いいえ
</artwork>
          </t>
        </section>
      </section>
      <section anchor="coap-content-formats-registry" numbered="true" removeInRFC="false" toc="include" pn="section-16.10">
        <name slugifiedName="name-coap-content-formats-registry">CoAP コンテンツ形式レジストリ</name>
        <t indent="0" pn="section-16.10-1">IANAは「CoAP Content-Formats」レジストリに以下のエントリを追加しました。</t>
        <t indent="0" pn="section-16.10-2"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left">メディア型</td>
                  <td align="left">エンコーディング</td>
                  <td align="left">ID</td>
                  <td align="left">参照</td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">application/cose; cose-type="cose-</td>
                <td align="left"/>
                <td align="left">98</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">sign"</td>
              </tr>
              <tr>
                <td align="left">application/cose; cose-type="cose-</td>
                <td align="left"/>
                <td align="left">18</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">sign1"</td>
              </tr>
              <tr>
                <td align="left">application/cose; cose-type="cose-</td>
                <td align="left"/>
                <td align="left">96</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">encrypt"</td>
              </tr>
              <tr>
                <td align="left">application/cose; cose-type="cose-</td>
                <td align="left"/>
                <td align="left">16</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">encrypt0"</td>
              </tr>
              <tr>
                <td align="left">application/cose; cose-type="cose-</td>
                <td align="left"/>
                <td align="left">97</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">mac"</td>
              </tr>
              <tr>
                <td align="left">application/cose; cose-type="cose-</td>
                <td align="left"/>
                <td align="left">17</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">mac0"</td>
              </tr>
              <tr>
                <td align="left">application/cose-key</td>
                <td align="left"/>
                <td align="left">101</td>
                <td align="left">[RFC8152]</td>
              </tr>
              <tr>
                <td align="left">application/cose-key-set</td>
                <td align="left"/>
                <td align="left">102</td>
                <td align="left">[RFC8152]</td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-16.10-3"><artwork name="" type="" align="left" alt="">
               テーブル26: COSEのCoAPコンテンツフォーマット
</artwork>
        </t>
      </section>
      <section anchor="expert-review-instructions" numbered="true" removeInRFC="false" toc="include" pn="section-16.11">
        <name slugifiedName="name-expert-review-instructions">専門家によるレビューの手順</name>
        <t indent="0" pn="section-16.11-1">このドキュメントで設定されたすべてのIANAレジストリは、専門家による審査によって定義されます。このセクションでは、専門家が何を探すべきかについて一般的なガイドラインが示されていますが、彼らは理由があって専門家として指定されているため、かなりの裁量を与えるべきです。</t>
        <t indent="0" pn="section-16.11-2">専門の査読者は、以下の点を考慮すべきです：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-16.11-3">
          <li pn="section-16.11-3.1">ポイントの使用がすでに登録されているものと重複しないこと、およびそのポイントが展開で使用される可能性があることを確認するため、登録要求のための十分な情報を入手するようにレビューアが推奨されます。ポイント乗っ取りは避けるべきです。プライベート利用としてタグ付けされたゾーンは、テスト目的や閉じた環境向けに予約されており、他の範囲のコードポイントはテスト用に割り当てるべきではありません。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-16.11-4">
          <li pn="section-16.11-4.1">規格トラックのポイント割り当てには仕様が必要です。仕様が必要な範囲には仕様が存在すべきですが、仕様が利用可能でない場合は、早期割り当ては許容されるものとされています。ファーストカム・ファーストサーブの範囲で相互運用可能に使用されることが期待される場合には、仕様が必要です。仕様が提供されていない場合、提供される説明にはポイントの使用目的を特定するために十分な情報が必要です。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-16.11-5">
          <li pn="section-16.11-5.1">専門家は、ポイントの割り当てを承認する際に、フィールドの予想使用法を考慮すべきです。標準トラックドキュメントの範囲があるという事実は、その範囲外のポイントが割り当てられないという意味ではありません。エンコードされた値の長さは、その長さのコードポイントが残っている数、使用するデバイスのサイズ、そのサイズにエンコードされる残りのコードポイント数と比較して考慮されるべきです。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-16.11-6">
          <li pn="section-16.11-6.1">アルゴリズムが登録される場合、自己満足のための登録は避けるべきです。<bcp14>これを実現する方法の一つは、アルゴリズムのセキュリティー解析に関する追加の文書提出を要求する</bcp14>ことです。<bcp14>また、Crypto Forum Research Group (CFRG)からのアルゴリズムに関する意見を求めることも検討されるべきです</bcp14>。<bcp14>コミュニティとメッセージの構造のセキュリティー要件を満たさないアルゴリズムは登録されるべきではありません</bcp14>。</li>
        </ul>
      </section>
    </section>
    <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-17">
      <name slugifiedName="name-security-considerations">セキュリティーに関する考慮事項</name>
      <t indent="0" pn="section-17-1"><bcp14>この仕様を実装する者は、考慮すべきセキュリティー上の検討事項がいくつか存在します。個別のアルゴリズムに特有のセキュリティー上の検討事項は、アルゴリズムの説明の隣に配置されます。ここで強調されている検討事項もありますが、追加の検討事項は参考文献にリストされている文書で見つけることができるでしょう。</bcp14></t>
      <t indent="0" pn="section-17-2">実装は、個人の秘密鍵情報を保護する必要があります。このドキュメントには、この問題について強調される必要があるいくつかのケースがあります。</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-3">
        <li pn="section-17-3.1">同じ鍵を2つの異なるアルゴリズムで使用すると、鍵に関する情報が漏れる可能性があります。そのため、鍵は単一のアルゴリズムに制限することが推奨されています。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-4">
        <li pn="section-17-4.1">2つ目の受信者アルゴリズムと組み合わせて「direct」を受信者アルゴリズムとして使用することにより、2つ目の受信者に直接鍵が露出します。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-5">
        <li pn="section-17-5.1">このドキュメントのいくつかのアルゴリズムは、キーが情報を漏洩せずに使用できる回数に制限を設けています。</li>
      </ul>
      <t indent="0" pn="section-17-6">ECDHおよび直接プラスKDF（キーラップなし）の使用によって、秘密鍵が直接漏洩することはありません。KDFの単方向関数がそれを防止するからです。ただし、対応が必要な別の問題があります。2つの受信者がいる場合、CEKは2つの受信者間で共有される必要があります。したがって、2番目の受信者は、弱い証明のために使用できる素材から派生したCEKを持っています。2番目の受信者は、同じCEKを使用してメッセージを作成し、最初の受信者に送信することができます。最初の受信者は、静的-静的ECDHまたは直接プラスKDFのどちらの場合も、CEKが正しい実体からではないものであっても、証明のためにCEKを使用できるという前提を立てるでしょう。キーラップステップが追加された場合、証明の必要性は示されず、これは問題ではありません。</t>
      <t indent="0" pn="section-17-7">以前にも言及されているが、複数のアルゴリズムに対して単一のキーを使用することは、キーに関する情報が漏洩する、攻撃者が整合性タグを偽造する、または暗号化された内容に関する情報を入手する機会を提供する場合があることが示されている。キーを単一のアルゴリズムにバインドすることで、これらの問題を防止することができる。キーの作成者とキーの利用者は、異なるアルゴリズムごとに新しいキーを作成するだけでなく、アルゴリズムの選択をキー素材の配布に含め、キーの構造とメッセージの構造の間でアルゴリズムの一致を厳密に強制することが強く推奨される。アルゴリズムが正しいことを確認するだけでなく、キーの形式もチェックする必要がある。'OKP' キーが期待される場所で 'EC2' キーを使用しないでください。</t>
      <t indent="0" pn="section-17-8">送信のためのキーを使用する前、または受信した情報に対して行動する前に、キーに関する信頼判断を行う必要があります。データやアクションは、キーに関連するエンティティが見る権限や要求する権限を持っているものでしょうか？この信頼判断には、いくつかの要素が関連しています。ここで強調されている要素のいくつかは、以下の通りです：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-9">
        <li pn="section-17-9.1">キー所有者に関連する権限は何ですか？</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-10">
        <li pn="section-17-10.1">現在のコンテキストでの暗号アルゴリズムは受け入れ可能ですか？</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-11">
        <li pn="section-17-11.1">キーに関連する制限（アルゴリズムや鮮度など）は確認され、正しいですか？</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-12">
        <li pn="section-17-12.1">現在のアプリケーションの状態を考慮して、リクエストが合理的なものであるかどうかですか？</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-17-13">
        <li pn="section-17-13.1">メッセージの一部であるセキュリティーに関する考慮事項が、アプリケーションや 'crit' パラメーターで指定されたとおりに適用されていますか？</li>
      </ul>
      <t indent="0" pn="section-17-14">このドキュメントでは、ノンス値を使用する大量のアルゴリズムが提案されています。このドキュメントで定義されているすべてのノンスには、ノンスがキーまたは他の条件のために一意の値である制約があります。これらのすべての場合において、ノンスが一意であり予測不可能である必要性は知られていません。そのような状況では、ノンスの作成にカウンタを使用することは合理的です。ノンスのパターンが予測不可能かつ一意であることを望む場合には、その目的のために作成されたキーを使用し、カウンタを暗号化してノンス値を生成することができます。</t>
      <t indent="0" pn="section-17-15">暗号化メッセージのトラフィック解析に基づくメッセージの長さに関する露出が始まりつつある領域の1つは、メッセージ構造の一部としてパディングを提供するための統一された方法を提供しないことです。この仕様では、このドキュメントで定義されているすべてのコンテンツ暗号化アルゴリズムに対して、長さに基づいて2つの異なる文字列（例えば、「YES」と「NO」）を観察者が区別できます。これは、トラフィック解析を防ぐために、アプリケーションがどのようにコンテンツのパディングを行うかを文書化することがアプリケーションの責任であることを意味します（例えば、文字列を「YES」と「NO 」と定義することができます）。</t>
    </section>
  </middle>
  <back>
    <references pn="section-18">
      <name slugifiedName="name-references">References</name>
      <references pn="section-18.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="AES-GCM" target="https://csrc.nist.gov/publications/nistpubs/800- 38D/SP-800-38D.pdf" quoteTitle="true" derivedAnchor="AES-GCM">
          <front>
            <title>Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC</title>
            <date year="2007" month="November"/>
          </front>
          <seriesInfo name="DOI">10.6028/NIST.SP.800-38D</seriesInfo>
        </reference>
        <reference anchor="COAP.Formats" target="http://www.iana.org/assignments/core-parameters/" quoteTitle="true" derivedAnchor="COAP.Formats">
          <front>
            <title>Constrained RESTful Environments (CoRE) Parameters</title>
          </front>
        </reference>
        <reference anchor="DSS" target="http://nvlpubs.nist.gov/nistpubs/FIPS/ NIST.FIPS.186-4.pdf" quoteTitle="true" derivedAnchor="DSS">
          <front>
            <title>Digital Signature Standard (DSS)</title>
            <date year="2013" month="July"/>
          </front>
          <seriesInfo name="FIPS PUB">186-4</seriesInfo>
          <seriesInfo name="DOI">10.6028/NIST.FIPS.186-4</seriesInfo>
        </reference>
        <reference anchor="MAC" target="http://csrc.nist.gov/publications/fips/fips113/ fips113.html" quoteTitle="true" derivedAnchor="MAC">
          <front>
            <title>Computer Data Authentication</title>
            <date year="1985" month="May"/>
          </front>
          <seriesInfo name="FIPS PUB">113</seriesInfo>
        </reference>
        <reference anchor="RFC2104" target="http://www.rfc-editor.org/info/rfc2104" quoteTitle="true" derivedAnchor="RFC2104">
          <front>
            <title>HMAC: Keyed- Hashing for Message Authentication</title>
            <date year="1997" month="February"/>
          </front>
          <seriesInfo name="RFC">2104</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC2104</seriesInfo>
        </reference>
        <reference anchor="RFC2119" target="http://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <date year="1997" month="March"/>
          </front>
          <seriesInfo name="BCP">14</seriesInfo>
          <seriesInfo name="RFC">2119</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC2119</seriesInfo>
        </reference>
        <reference anchor="RFC3394" target="http://www.rfc-editor.org/info/rfc3394" quoteTitle="true" derivedAnchor="RFC3394">
          <front>
            <title>Advanced Encryption Standard (AES) Key Wrap Algorithm</title>
            <date year="2002" month="September"/>
          </front>
          <seriesInfo name="RFC">3394</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC3394</seriesInfo>
        </reference>
        <reference anchor="RFC3610" target="http://www.rfc-editor.org/info/rfc3610" quoteTitle="true" derivedAnchor="RFC3610">
          <front>
            <title>Counter with CBC-MAC (CCM)</title>
            <date year="2003" month="September"/>
          </front>
          <seriesInfo name="RFC">3610</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC3610</seriesInfo>
        </reference>
        <reference anchor="RFC5869" target="http://www.rfc-editor.org/info/rfc5869" quoteTitle="true" derivedAnchor="RFC5869">
          <front>
            <title>HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</title>
            <date year="2010" month="May"/>
          </front>
          <seriesInfo name="RFC">5869</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5869</seriesInfo>
        </reference>
        <reference anchor="RFC6090" target="http://www.rfc-editor.org/info/rfc6090" quoteTitle="true" derivedAnchor="RFC6090">
          <front>
            <title>Fundamental Elliptic Curve Cryptography Algorithms</title>
            <date year="2011" month="February"/>
          </front>
          <seriesInfo name="RFC">6090</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC6090</seriesInfo>
        </reference>
        <reference anchor="RFC6979" target="http://www.rfc-editor.org/info/rfc6979" quoteTitle="true" derivedAnchor="RFC6979">
          <front>
            <title>Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)</title>
            <date year="2013" month="August"/>
          </front>
          <seriesInfo name="RFC">6979</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC6979</seriesInfo>
        </reference>
        <reference anchor="RFC7049" target="http://www.rfc-editor.org/info/rfc7049" quoteTitle="true" derivedAnchor="RFC7049">
          <front>
            <title>Concise Binary Object Representation (CBOR)</title>
            <date year="2013" month="October"/>
          </front>
          <seriesInfo name="RFC">7049</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7049</seriesInfo>
        </reference>
        <reference anchor="RFC7539" target="http://www.rfc-editor.org/info/rfc7539" quoteTitle="true" derivedAnchor="RFC7539">
          <front>
            <title>ChaCha20 and Poly1305 for IETF Protocols</title>
            <date year="2015" month="May"/>
          </front>
          <seriesInfo name="RFC">7539</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7539</seriesInfo>
        </reference>
        <reference anchor="RFC7748" target="http://www.rfc-editor.org/info/rfc7748" quoteTitle="true" derivedAnchor="RFC7748">
          <front>
            <title>Elliptic Curves for Security</title>
            <date year="2016" month="January"/>
          </front>
          <seriesInfo name="RFC">7748</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7748</seriesInfo>
        </reference>
        <reference anchor="RFC8032" target="http://www.rfc-editor.org/info/rfc8032" quoteTitle="true" derivedAnchor="RFC8032">
          <front>
            <title>Edwards-Curve Digital Signature Algorithm (EdDSA)</title>
            <date year="2017" month="January"/>
          </front>
          <seriesInfo name="RFC">8032</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC8032</seriesInfo>
        </reference>
        <reference anchor="RFC8174" target="http://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <date year="2017" month="May"/>
          </front>
          <seriesInfo name="BCP">14</seriesInfo>
          <seriesInfo name="RFC">8174</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC8174</seriesInfo>
        </reference>
        <reference anchor="SEC1" target="http://www.secg.org/sec1-v2.pdf" quoteTitle="true" derivedAnchor="SEC1">
          <front>
            <title>SEC 1: Elliptic Curve Cryptography</title>
            <date year="2009" month="May"/>
          </front>
        </reference>
      </references>
      <references pn="section-18.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="CDDL" quoteTitle="true" derivedAnchor="CDDL">
          <front>
            <title>CBOR data definition language (CDDL): a notational convention to express CBOR data structures</title>
            <date year="2017" month="March"/>
          </front>
        </reference>
        <reference anchor="OSCOAP" quoteTitle="true" derivedAnchor="OSCOAP">
          <front>
            <title>Object Security of CoAP (OSCOAP)</title>
            <date year="2017" month="May"/>
          </front>
        </reference>
        <reference anchor="PVSig" quoteTitle="true" derivedAnchor="PVSig">
          <front>
            <title>Formal Security Proofs for a Signature Scheme with Partial Message Recovery</title>
            <date year="2000" month="June"/>
          </front>
          <seriesInfo name="DOI">10.1007/3-540-45353-9_11</seriesInfo>
        </reference>
        <reference anchor="RFC2633" target="http://www.rfc-editor.org/info/rfc2633" quoteTitle="true" derivedAnchor="RFC2633">
          <front>
            <title>S/MIME Version 3 Message Specification</title>
            <date year="1999" month="June"/>
          </front>
          <seriesInfo name="RFC">2633</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC2633</seriesInfo>
        </reference>
        <reference anchor="RFC4231" target="http://www.rfc-editor.org/info/rfc4231" quoteTitle="true" derivedAnchor="RFC4231">
          <front>
            <title>Identifiers and Test Vectors for HMAC-SHA- 224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512</title>
            <date year="2005" month="December"/>
          </front>
          <seriesInfo name="RFC">4231</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC4231</seriesInfo>
        </reference>
        <reference anchor="RFC4262" target="http://www.rfc-editor.org/info/rfc4262" quoteTitle="true" derivedAnchor="RFC4262">
          <front>
            <title>X.509 Certificate Extension for Secure/ Multipurpose Internet Mail Extensions (S/MIME) Capabilities</title>
            <date year="2005" month="December"/>
          </front>
          <seriesInfo name="RFC">4262</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC4262</seriesInfo>
        </reference>
        <reference anchor="RFC4493" target="http://www.rfc-editor.org/info/rfc4493" quoteTitle="true" derivedAnchor="RFC4493">
          <front>
            <title>The AES-CMAC Algorithm</title>
            <date year="2006" month="June"/>
          </front>
          <seriesInfo name="RFC">4493</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC4493</seriesInfo>
        </reference>
        <reference anchor="RFC4949" target="http://www.rfc-editor.org/info/rfc4949" quoteTitle="true" derivedAnchor="RFC4949">
          <front>
            <title>Internet Security Glossary, Version 2</title>
            <date year="2007" month="August"/>
          </front>
          <seriesInfo name="RFC">4949</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC4949</seriesInfo>
        </reference>
        <reference anchor="RFC5116" target="http://www.rfc-editor.org/info/rfc5116" quoteTitle="true" derivedAnchor="RFC5116">
          <front>
            <title>An Interface and Algorithms for Authenticated Encryption</title>
            <date year="2008" month="January"/>
          </front>
          <seriesInfo name="RFC">5116</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5116</seriesInfo>
        </reference>
        <reference anchor="RFC5480" target="http://www.rfc-editor.org/info/rfc5480" quoteTitle="true" derivedAnchor="RFC5480">
          <front>
            <title>Elliptic Curve Cryptography Subject Public Key Information</title>
            <date year="2009" month="March"/>
          </front>
          <seriesInfo name="RFC">5480</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5480</seriesInfo>
        </reference>
        <reference anchor="RFC5652" target="http://www.rfc-editor.org/info/rfc5652" quoteTitle="true" derivedAnchor="RFC5652">
          <front>
            <title>Cryptographic Message Syntax (CMS)</title>
            <date year="2009" month="September"/>
          </front>
          <seriesInfo name="STD">70</seriesInfo>
          <seriesInfo name="RFC">5652</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5652</seriesInfo>
        </reference>
        <reference anchor="RFC5751" target="http://www.rfc-editor.org/info/rfc5751" quoteTitle="true" derivedAnchor="RFC5751">
          <front>
            <title>Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification</title>
            <date year="2010" month="January"/>
          </front>
          <seriesInfo name="RFC">5751</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5751</seriesInfo>
        </reference>
        <reference anchor="RFC5752" target="http://www.rfc-editor.org/info/rfc5752" quoteTitle="true" derivedAnchor="RFC5752">
          <front>
            <title>Multiple Signatures in Cryptographic Message Syntax (CMS)</title>
            <date year="2010" month="January"/>
          </front>
          <seriesInfo name="RFC">5752</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5752</seriesInfo>
        </reference>
        <reference anchor="RFC5990" target="http://www.rfc-editor.org/info/rfc5990" quoteTitle="true" derivedAnchor="RFC5990">
          <front>
            <title>Use of the RSA-KEM Key Transport Algorithm in the Cryptographic Message Syntax (CMS)</title>
            <date year="2010" month="September"/>
          </front>
          <seriesInfo name="RFC">5990</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC5990</seriesInfo>
        </reference>
        <reference anchor="RFC6151" target="http://www.rfc-editor.org/info/rfc6151" quoteTitle="true" derivedAnchor="RFC6151">
          <front>
            <title>Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms</title>
            <date year="2011" month="March"/>
          </front>
          <seriesInfo name="RFC">6151</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC6151</seriesInfo>
        </reference>
        <reference anchor="RFC6838" target="http://www.rfc-editor.org/info/rfc6838" quoteTitle="true" derivedAnchor="RFC6838">
          <front>
            <title>Media Type Specifications and Registration Procedures</title>
            <date year="2013" month="January"/>
          </front>
          <seriesInfo name="BCP">13</seriesInfo>
          <seriesInfo name="RFC">6838</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC6838</seriesInfo>
        </reference>
        <reference anchor="RFC7159" target="http://www.rfc-editor.org/info/rfc7159" quoteTitle="true" derivedAnchor="RFC7159">
          <front>
            <title>The JavaScript Object Notation (JSON) Data Interchange Format</title>
            <date year="2014" month="March"/>
          </front>
          <seriesInfo name="RFC">7159</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7159</seriesInfo>
        </reference>
        <reference anchor="RFC7252" target="http://www.rfc-editor.org/info/rfc7252" quoteTitle="true" derivedAnchor="RFC7252">
          <front>
            <title>The Constrained Application Protocol (CoAP)</title>
            <date year="2014" month="June"/>
          </front>
          <seriesInfo name="RFC">7252</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7252</seriesInfo>
        </reference>
        <reference anchor="RFC7515" target="http://www.rfc-editor.org/info/rfc7515" quoteTitle="true" derivedAnchor="RFC7515">
          <front>
            <title>JSON Web Signature (JWS)</title>
            <date year="2015" month="May"/>
          </front>
          <seriesInfo name="RFC">7515</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7515</seriesInfo>
        </reference>
        <reference anchor="RFC7516" target="http://www.rfc-editor.org/info/rfc7516" quoteTitle="true" derivedAnchor="RFC7516">
          <front>
            <title>JSON Web Encryption (JWE)</title>
            <date year="2015" month="May"/>
          </front>
          <seriesInfo name="RFC">7516</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7516</seriesInfo>
        </reference>
        <reference anchor="RFC7517" target="http://www.rfc-editor.org/info/rfc7517" quoteTitle="true" derivedAnchor="RFC7517">
          <front>
            <title>JSON Web Key (JWK)</title>
            <date year="2015" month="May"/>
          </front>
          <seriesInfo name="RFC">7517</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7517</seriesInfo>
        </reference>
        <reference anchor="RFC7518" target="http://www.rfc-editor.org/info/rfc7518" quoteTitle="true" derivedAnchor="RFC7518">
          <front>
            <title>JSON Web Algorithms (JWA)</title>
            <date year="2015" month="May"/>
          </front>
          <seriesInfo name="RFC">7518</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC7518</seriesInfo>
        </reference>
        <reference anchor="RFC8017" target="http://www.rfc-editor.org/info/rfc8017" quoteTitle="true" derivedAnchor="RFC8017">
          <front>
            <title>PKCS #1: RSA Cryptography Specifications Version 2.2</title>
            <date year="2016" month="November"/>
          </front>
          <seriesInfo name="RFC">8017</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC8017</seriesInfo>
        </reference>
        <reference anchor="RFC8018" target="http://www.rfc-editor.org/info/rfc8018" quoteTitle="true" derivedAnchor="RFC8018">
          <front>
            <title>PKCS #5: Password-Based Cryptography Specification Version 2.1</title>
            <date year="2017" month="January"/>
          </front>
          <seriesInfo name="RFC">8018</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC8018</seriesInfo>
        </reference>
        <reference anchor="RFC8126" target="http://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <date year="2017" month="June"/>
          </front>
          <seriesInfo name="BCP">26</seriesInfo>
          <seriesInfo name="RFC">8126</seriesInfo>
          <seriesInfo name="DOI">10.17487/RFC8126</seriesInfo>
        </reference>
        <reference anchor="SP800-56A" target="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/ NIST.SP.800-56Ar2.pdf" quoteTitle="true" derivedAnchor="SP800-56A">
          <front>
            <title>Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</title>
            <date year="2013" month="May"/>
          </front>
          <seriesInfo name="DOI">10.6028/NIST.SP.800-56Ar2</seriesInfo>
        </reference>
        <reference anchor="W3C.WebCrypto" target="https://www.w3.org/TR/WebCryptoAPI/" quoteTitle="true" derivedAnchor="W3C.WebCrypto">
          <front>
            <title>Web Cryptography API</title>
            <date year="2017" month="January"/>
          </front>
        </reference>
      </references>
    </references>
    <section anchor="guidelines-for-external-data-authentication-of-algorithms" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-guidelines-for-external-data-authentication-of-algorithms">アルゴリズムの外部データ認証のためのガイドライン</name>
      <t indent="0" pn="section-appendix.a-1">動作グループの一部は、COSEオブジェクトの各レベルにアルゴリズム識別子が必要であるというルールを緩和することを強く希望しています。この立場を支持するためには、2つの基本的な理由があります。まず、CoAP環境で最も一般的なメッセージからアルゴリズム識別子を省略すると、メッセージのサイズが小さくなります。さらに、アルゴリズム識別子が配置される異なる場所（メッセージ自体、アプリケーションの文、送信者が所有するキー構造、受信者が所有するキー構造）間で正確な完全なチェックが行われない場合に発生する潜在的なバグがあります。</t>
      <t indent="0" pn="section-appendix.a-2">この付録では、このオプションを使用するためにアプリケーションが指定する必要がある変更の方法と詳細について説明します。2つの異なる詳細セットが指定されています：アルゴリズム識別子を省略するために必要な詳細と、自身に関する属性を含まないカウンタシグネチャ属性の変種を使用するために必要な詳細です。</t>
      <section anchor="algorithm-identification" numbered="true" removeInRFC="false" toc="include" pn="section-a.1">
        <name slugifiedName="name-algorithm-identification">アルゴリズムの識別</name>
        <t indent="0" pn="section-a.1-1">このセクションでは、3つの推奨事項セットが示されています。最初の推奨事項セットは、COSEオブジェクトの単一のレイヤーに対して暗黙のアルゴリズムを特定する場合に適用されます。2番目の推奨事項セットは、COSEオブジェクトの複数のレイヤーに対して複数の暗黙のアルゴリズムを特定する場合に適用されます。3番目の推奨事項セットは、複数のCOSEオブジェクト構築に対して暗黙のアルゴリズムを特定する場合に適用されます。</t>
        <t indent="0" pn="section-a.1-2">RFC 2119のキーワードは故意に使用されていません。この仕様では推奨事項を提供することができますが、強制することはできません。</t>
        <t indent="0" pn="section-a.1-3">この一連の推奨事項は、アプリケーションが固定アルゴリズムをキー情報と一緒に配布し、単一のCOSEオブジェクトで使用する場合に適用されます。これは通常、COSEオブジェクトの中で最も小さいもの、具体的にはCOSE_Sign1、COSE_Mac0、COSE_Encrypt0に適用されますが、他の構造にも適用される可能性があります。</t>
        <t indent="0" pn="section-a.1-4">以下の項目に留意する必要があります:</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-5">
          <li pn="section-a.1-5.1">アプリケーションは、暗黙のアルゴリズムが使用されるCOSE構造のセットをリスト化する必要があります。アプリケーションは、これらの構造のいずれかに明示的なアルゴリズム識別子が受信された場合に、メッセージの拒否が行われるよう要求する必要があります。この要件は、どのアルゴリズムが使用されるべきか、暗黙のアルゴリズムか明示的なアルゴリズムかに関して、いかなる曖昧さも生じないようにするために述べられています。これは、転送されるアルゴリズム識別子が保護された属性である場合でも適用されます。これは、転送されるアルゴリズムが暗黙のアルゴリズムと同じである場合でも適用されます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-6">
          <li pn="section-a.1-6.1">アプリケーションは、アルゴリズム識別子を省略する際にコンテキストの一部と見なされる情報のセットを定義する必要があります。少なくとも、これにはキー識別子（必要な場合）、キー、アルゴリズム、およびそれが使用されるCOSE構造が含まれます。アプリケーションは、単一のキーを単一のアルゴリズムに制限する必要があります。このドキュメントの一部のアルゴリズムに関して指摘されているように、関連する異なるアルゴリズムで同じキーを使用することは、キーに関する情報の漏洩、データまたは偽造の可能性に関する情報の漏洩を引き起こす可能性があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-7">
          <li pn="section-a.1-7.1">多くの場合、アルゴリズム識別子を省略するアプリケーションでは、同じ理由でコンテキスト識別子も省略したいと考えることがあります。つまり、コンテキスト識別子を省略することでメッセージサイズが減少します（識別子の長さに応じて、大幅な削減になる可能性もあります）。これを行うアプリケーションでは、コンテキスト識別子が省略される状況や、これらの場合にコンテキスト識別子がどのように推論されるかを説明する必要があります（全てのキーを網羅的に検索することは通常許容されないとされます）。これを実現するための例として、コンテキストをトランザクション識別子に結び付ける方法が挙げられます。両者は元のメッセージで送信されますが、その後はトランザクション識別子のみが送信され、コンテキストはトランザクション識別子に結び付けられます。別の方法としては、ネットワークアドレスとコンテキストを関連付ける方法があります。単一のネットワークアドレスから送信されるすべてのメッセージは特定のコンテキストに関連付けられるものとみなされます（この場合、アドレスは通常、コンテキストの一部として配布されます）。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-8">
          <li pn="section-a.1-8.1">アプリケーションは、一意のキー識別子が作成されるように計算されることを保証するために、重要な努力をするまで、一意性に依存することはできません。アプリケーションがこれを行っても、異なるコンテキスト（つまり、異なるコンテキストプロバイダで実行する場合）でアプリケーションが実行される場合や、システムが異なるアプリケーションからのセキュリティーコンテキストを単一のストアに組み合わせる場合、一意性は侵害される可能性があります。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-9">
          <li pn="section-a.1-9.1">アプリケーションは、アルゴリズム識別子の保護の慣行を続ける必要があります。これは、保護属性フィールドに配置することによって行われないため、アプリケーションはこの値を含むアプリケーション固有の外部データ構造を定義する必要があります。この外部データフィールドは、コンテンツの暗号化、MAC、および署名アルゴリズムについて使用できます。キー値を導出するためにKDFを使用するアルゴリズムのSuppPrivInfoフィールドで使用することもできます。アプリケーションは、コンテキスト構造の一部である他の情報も保護したい場合があります。ただし、キーやベースIVなどのフィールドは、暗号計算に使用されるため保護されているため、外部データフィールドに含める必要はありません。</li>
        </ul>
        <t indent="0" pn="section-a.1-10">第2のケースは、複数の階層COSEオブジェクトに対して複数の暗黙のアルゴリズム識別子が指定されている場合です。これがどのように機能するかの例は、アプリケーションが指定する暗号化コンテキストです。これには、コンテンツ暗号化アルゴリズム、キーラップアルゴリズム、キー識別子、および共有シークレットが含まれます。送信者はコンテンツ層と受信者層の両方のアルゴリズム識別子を省略し、キー識別子のみを残します。受信者はその後、キー識別子を使用して暗黙のアルゴリズム識別子を取得します。</t>
        <t indent="0" pn="section-a.1-11">以下の追加事項が考慮される必要があります：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-12">
          <li pn="section-a.1-12.1">この機能をサポートしたいアプリケーションは、与えられたキーで使用するためのCOSEの構造と、セカンダリレイヤーに使用する構造とアルゴリズムを明確に特定できる構造を定義する必要があります。セカンダリレイヤーのキーは、受信者レイヤーから通常通りに計算されます。</li>
        </ul>
        <t indent="0" pn="section-a.1-13">3つ目のケースは、複数の暗黙のアルゴリズム識別子を持つことですが、これは関連性のないレイヤーまたは異なるCOSEオブジェクトを対象としています。 これが適用可能なさまざまなシナリオがあります。 これらのシナリオの一部は次のとおりです：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-14">
          <li pn="section-a.1-14.1">２つのコンテキストはペアとして配布されます。各コンテキストはCOSE_Encryptメッセージの使用に適しています。各コンテキストには異なる秘密鍵と初期化ベクトル（IV）が含まれ、場合によっては異なるアルゴリズムも使用されます。１つ目のコンテキストはパーティAからパーティBへのメッセージの送信用であり、２つ目のコンテキストはパーティBからパーティAへのメッセージの送信用です。これにより、各パーティは異なる秘密鍵を使用してメッセージを送信するため、反射攻撃が発生する可能性はありません。メッセージが自身に反射された場合、それは復号化に失敗します。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-15">
          <li pn="section-a.1-15.1">二つのコンテキストはペアとして配布されます。最初のコンテキストはメッセージの暗号化に使用され、2番目のコンテキストはメッセージに対してカウンタ署名を行うために使用されます。意図は、2番目のコンテキストが最初のコンテキストとは独立して他の実体に配布できることです。これにより、これらの実体はメッセージが内容を解読せずに個人から送信されたものであることを検証することができます。</li>
        </ul>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-16">
          <li pn="section-a.1-16.1">2つのコンテキストが対として配布されます。最初のコンテキストには、MAC付きメッセージを処理するためのキーが含まれており、2番目のコンテキストには、暗号化されたメッセージを処理するためのキーが含まれています。これにより、異なる種類のメッセージに異なるキーがあるが、キーを調整して使用することができるように、参加者へのキーの一元的な配布が可能となります。</li>
        </ul>
        <t indent="0" pn="section-a.1-17">これらの場合には、次の追加事項を考慮する必要があります：</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-a.1-18">
          <li pn="section-a.1-18.1">アプリケーションは、複数のコンテキストが関連付けられたままであることを保証する必要があります。もし1つのコンテキストが何らかの理由で無効になった場合、それに関連付けられているすべてのコンテキストも無効にされるべきです。</li>
        </ul>
      </section>
      <section anchor="counter-signature-without-headers" numbered="true" removeInRFC="false" toc="include" pn="section-a.2">
        <name slugifiedName="name-counter-signature-without-headers">ヘッダーなしのカウンタ署名</name>
        <t indent="0" pn="section-a.2-1">直接署名に関連する対向署名パラメーターを持ちたい人々のグループが存在し、そのため、認証されたバケットと非認証されたバケットをメッセージから削除することができます。この場合、重点はさらに小さいサイズです。なぜなら、対向署名の作成プロセスのすべての情報がメッセージに明示的に含まれているのではなく、暗黙的に含まれているからです。これには、上記で示されているアルゴリズム識別子だけでなく、署名構造から常に外部にあるキー識別などの項目も含まれます。つまり、対向署名の検証を行うエンティティは、明示的ではなく、文脈から使用するキーを推測する必要があります。これを行う一つの方法は、特定のポートからのすべてのデータ（または特定のURLへのデータ）を特定のキーによって検証するものと推定することです。（なお、キー識別子が署名値の一部である必要はなく、それは暗号目的を果たしません。キーが対向署名を検証する場合、そのキーに関連するエンティティが署名を作成したと推定されるべきです。）</t>
        <t indent="0" pn="section-a.2-2">「ベアカウンタ署名ヘッダーの署名を計算する場合、セクション4.4で定義されている同じSig_structureが使用されます。保護されたヘッダーフィールドはこのカウンタ署名ヘッダーには存在しないため、sign_protectedフィールドは省略されます。"CounterSignature0"の値はSig_structureのcontextフィールドに配置されます。」</t>
        <t indent="0" pn="section-a.2-3"><table align="center">
            <thead>
              <tr>
                <tr>
                  <td align="left"> 名前 </td>
                  <td align="left">ラベル </td>
                  <td align="left">値の種類</td>
                  <td align="left">値</td>
                  <td align="left">説明           </td>
                </tr>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"> カウンターサイン0  </td>
                <td align="left">9  </td>
                <td align="left">bstr  </td>
                <td align="left">  </td>
                <td align="left">暗黙の署名者およびヘッダーとのカウンター署名      </td>
              </tr>
            </tbody>
          </table>
        </t>
        <t indent="0" pn="section-a.2-4"><artwork name="" type="" align="left" alt="">
          テーブル27：CounterSignature0のヘッダーパラメーター
</artwork>
        </t>
      </section>
    </section>
    <section anchor="two-layers-of-recipient-information" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-two-layers-of-recipient-information">受信者情報の二つのレイヤー</name>
      <t indent="0" pn="section-appendix.b-1">現在定義されているすべての受信者アルゴリズムクラスは、COSE_Encrypt構造の2つのレイヤーのみを使用します。最初のレイヤーはメッセージの内容であり、2番目のレイヤーは内容キーの暗号化です。ただし、RSA Key Encapsulation Mechanism（RSA-KEM）（RFC5990の付録Aを参照）などの受信者アルゴリズムを使用する場合、COSE_Encrypt構造の3つのレイヤーを持つことは意味があります。</t>
      <t indent="0" pn="section-appendix.b-2">これらのレイヤーは以下の通りです：</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-3">
        <li pn="section-appendix.b-3.1">レイヤー0：コンテンツ暗号化レイヤーです。このレイヤーにはメッセージのペイロードが含まれています。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-4">
        <li pn="section-appendix.b-4.1">レイヤー1：CEKのKEKによる暗号化。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-5">
        <li pn="section-appendix.b-5.1">レイヤー2：RSAキーとキー派生関数を使用して長いランダムな秘密の暗号化を行い、その秘密をKEKに変換します。</li>
      </ul>
      <t indent="0" pn="section-appendix.b-6">これはトリプルレイヤーメッセージの例です。メッセージには以下のレイヤーがあります:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-7">
        <li pn="section-appendix.b-7.1">レイヤー0：128ビットの鍵を使用してAES-GCMで暗号化されたコンテンツを持っています。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-8">
        <li pn="section-appendix.b-8.1">レイヤー1：AESキーラップアルゴリズムを128ビットのキーで使用します。</li>
      </ul>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.b-9">
        <li pn="section-appendix.b-9.1">レイヤー2：ECDHエフェメラル-スタティックダイレクトを使用してレイヤー1キーを生成します。</li>
      </ul>
      <t indent="0" pn="section-appendix.b-10">実際に、この例は、ECDH-ES+A128KWアルゴリズムの使用の分解されたバージョンです。</t>
      <t indent="0" pn="section-appendix.b-11">バイナリファイルのサイズは183バイトです。</t>
      <t indent="0" pn="section-appendix.b-12">96（[/ protected / h'a10101' /{ \ alg \ 1:1 \ AES-GCM 128 \ } /、/ unprotected / {/ iv / 5:h'02d1f7e6f26c43d4868d87ce' }、/ ciphertext / h'64f84d913ba60a76070a9a48f26e97e863e2852948658f0811139868826e89218a75715b'、/ recipients / [ [/protected / h''、/unprotected / {/ alg / 1:-3 / A128KW / }、/ ciphertext / h'dbd43c4e9d719c27c6275c67d628d493f090593db8218f11'、/ recipients / [ [/protected / h'a1013818'/{\ alg \ 1:-25 \ ECDH-ES + HKDF-256 \ } /、/ unprotected / {/ ephemeral / -1:{/ kty / 1:2、/ crv / -1:1、/ x / -2:h'b2add44368ea6d641f9ca9af308b4079aeb519f11e9b8a55a600b21233e86e68'、/ y / -3:false }、/ kid / 4:'meriadoc.brandybuck@buckland.example' }、/ ciphertext / h'' ] ] ] ] ]</t>
    </section>
    <section anchor="examples" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-examples">例えば</name>
      <t indent="0" pn="section-appendix.c-1">この付録には、この文書で定義されたさまざまな機能やメッセージの種類を示す一連の例が含まれています。例を読みやすくするために、バイナリダンプではなく、拡張CBOR診断表現（<xref target="CDDL" format="default" sectionFormat="of" derivedContent="CDDL"/>で定義されています）を使用して表示されています。</t>
      <t indent="0" pn="section-appendix.c-2">A GitHub project has been created at &lt;https://github.com/cose-wg/
Examples&gt; that contains not only the examples presented in this
document, but a more complete set of testing examples as well.  Each
example is found in a JSON file that contains the inputs used to
create the example, some of the intermediate values that can be used
in debugging the example and the output of the example presented in
both a hex and a CBOR diagnostic notation format.  Some of the
examples at the site are designed failure testing cases; these are
clearly marked as such in the JSON file.  If errors in the examples
in this document are found, the examples on GitHub will be updated,
and a note to that effect will be placed in the JSON file.</t>
      <t indent="0" pn="section-appendix.c-3">As noted, the examples are presented using the CBOR's diagnostic
notation.  A Ruby-based tool exists that can convert between the
diagnostic notation and binary.  This tool can be installed with the
command line:</t>
      <t indent="0" pn="section-appendix.c-4">gem install cbor-diag</t>
      <t indent="0" pn="section-appendix.c-5">The diagnostic notation can be converted into binary files using the
following command line:</t>
      <t indent="0" pn="section-appendix.c-6">diag2cbor.rb &lt; inputfile &gt; outputfile</t>
      <t indent="0" pn="section-appendix.c-7">The examples can be extracted from the XML version of this document
via an XPath expression as all of the artwork is tagged with the
attribute type='CBORdiag'.  (Depending on the XPath evaluator one is
using, it may be necessary to deal with &amp;gt; as an entity.)</t>
      <t indent="0" pn="section-appendix.c-8">//artwork[@type='CDDL']/text()</t>
      <section anchor="examples-of-signed-messages" numbered="true" removeInRFC="false" toc="include" pn="section-c.1">
        <name slugifiedName="name-examples-of-signed-messages">Examples of Signed Messages</name>
        <section anchor="single-signature" numbered="true" removeInRFC="false" toc="include" pn="section-c.1.1">
          <name slugifiedName="name-single-signature">Single Signature</name>
          <t indent="0" pn="section-c.1.1-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.1-2">
            <li pn="section-c.1.1-2.1"> Signature Algorithm: ECDSA w/ SHA-256, Curve P-256</li>
          </ul>
          <t indent="0" pn="section-c.1.1-3">Size of binary file is 103 bytes</t>
          <t indent="0" pn="section-c.1.1-4">98(
  [
    / protected / h'',
    / unprotected / {},
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected / h'a10126' / {
            \ alg \ 1:-7 \ ECDSA 256 \
          } / ,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'e2aeafd40d69d19dfe6e52077c5d7ff4e408282cbefb
5d06cbf414af2e19d982ac45ac98b8544c908b4507de1e90b717c3d34816fe926a2b
98f53afd2fa0f30a'
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="multiple-signers" numbered="true" removeInRFC="false" toc="include" pn="section-c.1.2">
          <name slugifiedName="name-multiple-signers">Multiple Signers</name>
          <t indent="0" pn="section-c.1.2-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.2-2">
            <li pn="section-c.1.2-2.1"> Signature Algorithm: ECDSA w/ SHA-256, Curve P-256</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.2-3">
            <li pn="section-c.1.2-3.1"> Signature Algorithm: ECDSA w/ SHA-512, Curve P-521
Size of binary file is 277 bytes</li>
          </ul>
          <t indent="0" pn="section-c.1.2-4">98(
  [
    / protected / h'',
    / unprotected / {},
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected / h'a10126' / {
            \ alg \ 1:-7 \ ECDSA 256 \
          } / ,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'e2aeafd40d69d19dfe6e52077c5d7ff4e408282cbefb
5d06cbf414af2e19d982ac45ac98b8544c908b4507de1e90b717c3d34816fe926a2b
98f53afd2fa0f30a'
      ],
      [
        / protected / h'a1013823' / {
            \ alg \ 1:-36
          } / ,
        / unprotected / {
          / kid / 4:'bilbo.baggins@hobbiton.example'
        },
        / signature / h'00a2d28a7c2bdb1587877420f65adf7d0b9a06635dd1
de64bb62974c863f0b160dd2163734034e6ac003b01e8705524c5c4ca479a952f024
7ee8cb0b4fb7397ba08d009e0c8bf482270cc5771aa143966e5a469a09f613488030
c5b07ec6d722e3835adb5b2d8c44e95ffb13877dd2582866883535de3bb03d01753f
83ab87bb4f7a0297'
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="counter-signature" numbered="true" removeInRFC="false" toc="include" pn="section-c.1.3">
          <name slugifiedName="name-counter-signature">Counter Signature</name>
          <t indent="0" pn="section-c.1.3-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.3-2">
            <li pn="section-c.1.3-2.1"> Signature Algorithm: ECDSA w/ SHA-256, Curve P-256</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.3-3">
            <li pn="section-c.1.3-3.1"> The same parameters are used for both the signature and the
   counter signature.</li>
          </ul>
          <t indent="0" pn="section-c.1.3-4">Size of binary file is 180 bytes</t>
          <t indent="0" pn="section-c.1.3-5">98(
  [
    / protected / h'',
    / unprotected / {
      / countersign / 7:[
        / protected / h'a10126' / {
            \ alg \ 1:-7 \ ECDSA 256 \
          } / ,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'5ac05e289d5d0e1b0a7f048a5d2b643813ded50bc9e4
9220f4f7278f85f19d4a77d655c9d3b51e805a74b099e1e085aacd97fc29d72f887e
8802bb6650cceb2c'
      ]
    },
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected / h'a10126' / {
            \ alg \ 1:-7 \ ECDSA 256 \
          } / ,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'e2aeafd40d69d19dfe6e52077c5d7ff4e408282cbefb
5d06cbf414af2e19d982ac45ac98b8544c908b4507de1e90b717c3d34816fe926a2b
98f53afd2fa0f30a'
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="signature-with-criticality" numbered="true" removeInRFC="false" toc="include" pn="section-c.1.4">
          <name slugifiedName="name-signature-with-criticality">Signature with Criticality</name>
          <t indent="0" pn="section-c.1.4-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.4-2">
            <li pn="section-c.1.4-2.1"> Signature Algorithm: ECDSA w/ SHA-256, Curve P-256</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.1.4-3">
            <li pn="section-c.1.4-3.1"> There is a criticality marker on the &quot;reserved&quot; header parameter
Size of binary file is 125 bytes</li>
          </ul>
          <t indent="0" pn="section-c.1.4-4">98(
  [
    / protected / h'a2687265736572766564f40281687265736572766564' /
{
        &quot;reserved&quot;:false,
        \ crit \ 2:[
          &quot;reserved&quot;
        ]
      } / ,
    / unprotected / {},
    / payload / 'This is the content.',
    / signatures / [
      [
        / protected / h'a10126' / {
            \ alg \ 1:-7 \ ECDSA 256 \
          } / ,
        / unprotected / {
          / kid / 4:'11'
        },
        / signature / h'3fc54702aa56e1b2cb20284294c9106a63f91bac658d
69351210a031d8fc7c5ff3e4be39445b1a3e83e1510d1aca2f2e8a7c081c7645042b
18aba9d1fad1bd9c'
      ]
    ]
  ]
)</t>
        </section>
      </section>
      <section anchor="single-signer-examples" numbered="true" removeInRFC="false" toc="include" pn="section-c.2">
        <name slugifiedName="name-single-signer-examples">Single Signer Examples</name>
        <section anchor="single-ecdsa-signature" numbered="true" removeInRFC="false" toc="include" pn="section-c.2.1">
          <name slugifiedName="name-single-ecdsa-signature">Single ECDSA Signature</name>
          <t indent="0" pn="section-c.2.1-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.2.1-2">
            <li pn="section-c.2.1-2.1"> Signature Algorithm: ECDSA w/ SHA-256, Curve P-256
Size of binary file is 98 bytes</li>
          </ul>
          <t indent="0" pn="section-c.2.1-3">18(
  [
    / protected / h'a10126' / {
        \ alg \ 1:-7 \ ECDSA 256 \
      } / ,
    / unprotected / {
      / kid / 4:'11'
    },
    / payload / 'This is the content.',
    / signature / h'8eb33e4ca31d1c465ab05aac34cc6b23d58fef5c083106c4
d25a91aef0b0117e2af9a291aa32e14ab834dc56ed2a223444547e01f11d3b0916e5
a4c345cacb36'
  ]
)</t>
        </section>
      </section>
      <section anchor="examples-of-enveloped-messages" numbered="true" removeInRFC="false" toc="include" pn="section-c.3">
        <name slugifiedName="name-examples-of-enveloped-messages">Examples of Enveloped Messages</name>
        <section anchor="direct-ecdh" numbered="true" removeInRFC="false" toc="include" pn="section-c.3.1">
          <name slugifiedName="name-direct-ecdh">Direct ECDH</name>
          <t indent="0" pn="section-c.3.1-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.1-2">
            <li pn="section-c.3.1-2.1"> CEK: AES-GCM w/ 128-bit key</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.1-3">
            <li pn="section-c.3.1-3.1"> Recipient class: ECDH Ephemeral-Static, Curve P-256
Size of binary file is 151 bytes</li>
          </ul>
          <t indent="0" pn="section-c.3.1-4">96(
  [
    / protected / h'a10101' / {
        \ alg \ 1:1 \ AES-GCM 128 \
      } / ,
    / unprotected / {
      / iv / 5:h'c9cf4df2fe6c632bf7886413'
    },
    / ciphertext / h'7adbe2709ca818fb415f1e5df66f4e1a51053ba6d65a1a0
c52a357da7a644b8070a151b0',
    / recipients / [
      [
        / protected / h'a1013818' / {
            \ alg \ 1:-25 \ ECDH-ES + HKDF-256 \
          } / ,
        / unprotected / {
          / ephemeral / -1:{
            / kty / 1:2,
            / crv / -1:1,
            / x / -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbf
bf054e1c7b4d91d6280',
            / y / -3:true
          },
          / kid / 4:'meriadoc.brandybuck@buckland.example'
        },
        / ciphertext / h''
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="direct-plus-key-derivation" numbered="true" removeInRFC="false" toc="include" pn="section-c.3.2">
          <name slugifiedName="name-direct-plus-key-derivation">Direct Plus Key Derivation</name>
          <t indent="0" pn="section-c.3.2-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.2-2">
            <li pn="section-c.3.2-2.1"> CEK: AES-CCM w/ 128-bit key, truncate the tag to 64 bits</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.2-3">
            <li pn="section-c.3.2-3.1"> Recipient class: Use HKDF on a shared secret with the following
   implicit fields as part of the context.</li>
          </ul>
          <t indent="0" pn="section-c.3.2-4"><artwork name="" type="" align="left" alt=""><![CDATA[
   *  salt: "aabbccddeeffgghh"
]]></artwork>
</t>
          <t indent="0" pn="section-c.3.2-5"><artwork name="" type="" align="left" alt=""><![CDATA[
   *  PartyU identity: "lighting-client"
]]></artwork>
</t>
          <t indent="0" pn="section-c.3.2-6"><artwork name="" type="" align="left" alt=""><![CDATA[
   *  PartyV identity: "lighting-server"
   *  Supplementary Public Other: "Encryption Example 02"
]]></artwork>
</t>
          <t indent="0" pn="section-c.3.2-7">Size of binary file is 91 bytes</t>
          <t indent="0" pn="section-c.3.2-8">96(
  [
    / protected / h'a1010a' / {
        \ alg \ 1:10 \ AES-CCM-16-64-128 \
      } / ,
    / unprotected / {
      / iv / 5:h'89f52f65a1c580933b5261a76c'
    },
    / ciphertext / h'753548a19b1307084ca7b2056924ed95f2e3b17006dfe93
1b687b847',
    / recipients / [
      [
        / protected / h'a10129' / {
            \ alg \ 1:-10
          } / ,
        / unprotected / {
          / salt / -20:'aabbccddeeffgghh',
          / kid / 4:'our-secret'
        },
        / ciphertext / h''
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="counter-signature-on-encrypted-content" numbered="true" removeInRFC="false" toc="include" pn="section-c.3.3">
          <name slugifiedName="name-counter-signature-on-encrypted-content">Counter Signature on Encrypted Content</name>
          <t indent="0" pn="section-c.3.3-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.3-2">
            <li pn="section-c.3.3-2.1"> CEK: AES-GCM w/ 128-bit key</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.3-3">
            <li pn="section-c.3.3-3.1"> Recipient class: ECDH Ephemeral-Static, Curve P-256
Size of binary file is 326 bytes</li>
          </ul>
          <t indent="0" pn="section-c.3.3-4">96(
  [
    / protected / h'a10101' / {
        \ alg \ 1:1 \ AES-GCM 128 \
      } / ,
    / unprotected / {
      / iv / 5:h'c9cf4df2fe6c632bf7886413',
      / countersign / 7:[
        / protected / h'a1013823' / {
            \ alg \ 1:-36
          } / ,
        / unprotected / {
          / kid / 4:'bilbo.baggins@hobbiton.example'
        },
        / signature / h'00929663c8789bb28177ae28467e66377da12302d7f9
594d2999afa5dfa531294f8896f2b6cdf1740014f4c7f1a358e3a6cf57f4ed6fb02f
cf8f7aa989f5dfd07f0700a3a7d8f3c604ba70fa9411bd10c2591b483e1d2c31de00
3183e434d8fba18f17a4c7e3dfa003ac1cf3d30d44d2533c4989d3ac38c38b71481c
c3430c9d65e7ddff'
      ]
    },
    / ciphertext / h'7adbe2709ca818fb415f1e5df66f4e1a51053ba6d65a1a0
c52a357da7a644b8070a151b0',
    / recipients / [
      [
        / protected / h'a1013818' / {
            \ alg \ 1:-25 \ ECDH-ES + HKDF-256 \
          } / ,
        / unprotected / {
          / ephemeral / -1:{
            / kty / 1:2,
            / crv / -1:1,
            / x / -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbf
bf054e1c7b4d91d6280',
            / y / -3:true
          },
          / kid / 4:'meriadoc.brandybuck@buckland.example'
        },
        / ciphertext / h''
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="encrypted-content-with-external-data" numbered="true" removeInRFC="false" toc="include" pn="section-c.3.4">
          <name slugifiedName="name-encrypted-content-with-external-data">Encrypted Content with External Data</name>
          <t indent="0" pn="section-c.3.4-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.4-2">
            <li pn="section-c.3.4-2.1"> CEK: AES-GCM w/ 128-bit key</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.4-3">
            <li pn="section-c.3.4-3.1"> Recipient class: ECDH static-Static, Curve P-256 with AES Key Wrap</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.3.4-4">
            <li pn="section-c.3.4-4.1"> Externally Supplied AAD: h'0011bbcc22dd44ee55ff660077'</li>
          </ul>
          <t indent="0" pn="section-c.3.4-5">Size of binary file is 173 bytes</t>
          <t indent="0" pn="section-c.3.4-6">96(
  [
    / protected / h'a10101' / {
        \ alg \ 1:1 \ AES-GCM 128 \
      } / ,
    / unprotected / {
      / iv / 5:h'02d1f7e6f26c43d4868d87ce'
    },
    / ciphertext / h'64f84d913ba60a76070a9a48f26e97e863e28529d8f5335
e5f0165eee976b4a5f6c6f09d',
    / recipients / [
      [
        / protected / h'a101381f' / {
            \ alg \ 1:-32 \ ECHD-SS+A128KW \
          } / ,
        / unprotected / {
          / static kid / -3:'peregrin.took@tuckborough.example',
          / kid / 4:'meriadoc.brandybuck@buckland.example',
          / U nonce / -22:h'0101'
        },
        / ciphertext / h'41e0d76f579dbd0d936a662d54d8582037de2e366fd
e1c62'
      ]
    ]
  ]
)</t>
        </section>
      </section>
      <section anchor="examples-of-encrypted-messages" numbered="true" removeInRFC="false" toc="include" pn="section-c.4">
        <name slugifiedName="name-examples-of-encrypted-messages">Examples of Encrypted Messages</name>
        <section anchor="simple-encrypted-message" numbered="true" removeInRFC="false" toc="include" pn="section-c.4.1">
          <name slugifiedName="name-simple-encrypted-message">Simple Encrypted Message</name>
          <t indent="0" pn="section-c.4.1-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.4.1-2">
            <li pn="section-c.4.1-2.1"> CEK: AES-CCM w/ 128-bit key and a 64-bit tag
Size of binary file is 52 bytes</li>
          </ul>
          <t indent="0" pn="section-c.4.1-3">16(
  [
    / protected / h'a1010a' / {
        \ alg \ 1:10 \ AES-CCM-16-64-128 \
      } / ,
    / unprotected / {
      / iv / 5:h'89f52f65a1c580933b5261a78c'
    },
    / ciphertext / h'5974e1b99a3a4cc09a659aa2e9e7fff161d38ce71cb45ce
460ffb569'
  ]
)</t>
        </section>
        <section anchor="encrypted-message-with-a-partial-iv" numbered="true" removeInRFC="false" toc="include" pn="section-c.4.2">
          <name slugifiedName="name-encrypted-message-with-a-partial-iv">Encrypted Message with a Partial IV</name>
          <t indent="0" pn="section-c.4.2-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.4.2-2">
            <li pn="section-c.4.2-2.1"> CEK: AES-CCM w/ 128-bit key and a 64-bit tag</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.4.2-3">
            <li pn="section-c.4.2-3.1"> Prefix for IV is 89F52F65A1C580933B52</li>
          </ul>
          <t indent="0" pn="section-c.4.2-4">Size of binary file is 41 bytes</t>
          <t indent="0" pn="section-c.4.2-5">16(
  [
    / protected / h'a1010a' / {
        \ alg \ 1:10 \ AES-CCM-16-64-128 \
      } / ,
    / unprotected / {
      / partial iv / 6:h'61a7'
    },
    / ciphertext / h'252a8911d465c125b6764739700f0141ed09192de139e05
3bd09abca'
  ]
)</t>
        </section>
      </section>
      <section anchor="examples-of-maced-messages" numbered="true" removeInRFC="false" toc="include" pn="section-c.5">
        <name slugifiedName="name-examples-of-maced-messages">Examples of MACed Messages</name>
        <section anchor="shared-secret-direct-mac" numbered="true" removeInRFC="false" toc="include" pn="section-c.5.1">
          <name slugifiedName="name-shared-secret-direct-mac">Shared Secret Direct MAC</name>
          <t indent="0" pn="section-c.5.1-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.1-2">
            <li pn="section-c.5.1-2.1"> MAC: AES-CMAC, 256-bit key, truncated to 64 bits</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.1-3">
            <li pn="section-c.5.1-3.1"> Recipient class: direct shared secret
Size of binary file is 57 bytes</li>
          </ul>
          <t indent="0" pn="section-c.5.1-4">97(
  [
    / protected / h'a1010f' / {
        \ alg \ 1:15 \ AES-CBC-MAC-256//64 \
      } / ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'9e1226ba1f81b848',
    / recipients / [
      [
        / protected / h'',
        / unprotected / {
          / alg / 1:-6 / direct /,
          / kid / 4:'our-secret'
        },
        / ciphertext / h''
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="ecdh-direct-mac" numbered="true" removeInRFC="false" toc="include" pn="section-c.5.2">
          <name slugifiedName="name-ecdh-direct-mac">ECDH Direct MAC</name>
          <t indent="0" pn="section-c.5.2-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.2-2">
            <li pn="section-c.5.2-2.1"> MAC: HMAC w/SHA-256, 256-bit key</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.2-3">
            <li pn="section-c.5.2-3.1"> Recipient class: ECDH key agreement, two static keys, HKDF w/
   context structure</li>
          </ul>
          <t indent="0" pn="section-c.5.2-4">Size of binary file is 214 bytes</t>
          <t indent="0" pn="section-c.5.2-5">97(
  [
    / protected / h'a10105' / {
        \ alg \ 1:5 \ HMAC 256//256 \
      } / ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'81a03448acd3d305376eaa11fb3fe416a955be2cbe7ec96f012c99
4bc3f16a41',
    / recipients / [
      [
        / protected / h'a101381a' / {
            \ alg \ 1:-27 \ ECDH-SS + HKDF-256 \
          } / ,
        / unprotected / {
          / static kid / -3:'peregrin.took@tuckborough.example',
          / kid / 4:'meriadoc.brandybuck@buckland.example',
          / U nonce / -22:h'4d8553e7e74f3c6a3a9dd3ef286a8195cbf8a23d
19558ccfec7d34b824f42d92bd06bd2c7f0271f0214e141fb779ae2856abf585a583
68b017e7f2a9e5ce4db5'
        },
        / ciphertext / h''
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="wrapped-mac" numbered="true" removeInRFC="false" toc="include" pn="section-c.5.3">
          <name slugifiedName="name-wrapped-mac">Wrapped MAC</name>
          <t indent="0" pn="section-c.5.3-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.3-2">
            <li pn="section-c.5.3-2.1"> MAC: AES-MAC, 128-bit key, truncated to 64 bits</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.3-3">
            <li pn="section-c.5.3-3.1"> Recipient class: AES Key Wrap w/ a pre-shared 256-bit key
Size of binary file is 109 bytes</li>
          </ul>
          <t indent="0" pn="section-c.5.3-4">97(
  [
    / protected / h'a1010e' / {
        \ alg \ 1:14 \ AES-CBC-MAC-128//64 \
      } / ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'36f5afaf0bab5d43',
    / recipients / [
      [
        / protected / h'',
        / unprotected / {
          / alg / 1:-5 / A256KW /,
          / kid / 4:'018c0ae5-4d9b-471b-bfd6-eef314bc7037'
        },
        / ciphertext / h'711ab0dc2fc4585dce27effa6781c8093eba906f227
b6eb0'
      ]
    ]
  ]
)</t>
        </section>
        <section anchor="multi-recipient-maced-message" numbered="true" removeInRFC="false" toc="include" pn="section-c.5.4">
          <name slugifiedName="name-multi-recipient-maced-message">Multi-Recipient MACed Message</name>
          <t indent="0" pn="section-c.5.4-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.4-2">
            <li pn="section-c.5.4-2.1"> MAC: HMAC w/ SHA-256, 128-bit key</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.5.4-3">
            <li pn="section-c.5.4-3.1"> Recipient class: Uses three different methods</li>
          </ul>
          <t indent="0" pn="section-c.5.4-4"><artwork name="" type="" align="left" alt=""><![CDATA[
   1.  ECDH Ephemeral-Static, Curve P-521, AES Key Wrap w/ 128-bit
       key
]]></artwork>
</t>
          <t indent="0" pn="section-c.5.4-5"><artwork name="" type="" align="left" alt=""><![CDATA[
   2.  AES Key Wrap w/ 256-bit key
]]></artwork>
</t>
          <t indent="0" pn="section-c.5.4-6">Size of binary file is 309 bytes</t>
          <t indent="0" pn="section-c.5.4-7">97(
  [
    / protected / h'a10105' / {
        \ alg \ 1:5 \ HMAC 256//256 \
      } / ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'bf48235e809b5c42e995f2b7d5fa13620e7ed834e337f6aa43df16
1e49e9323e',
    / recipients / [
      [
        / protected / h'a101381c' / {
            \ alg \ 1:-29 \ ECHD-ES+A128KW \
          } / ,
        / unprotected / {
          / ephemeral / -1:{
            / kty / 1:2,
            / crv / -1:3,
            / x / -2:h'0043b12669acac3fd27898ffba0bcd2e6c366d53bc4db
71f909a759304acfb5e18cdc7ba0b13ff8c7636271a6924b1ac63c02688075b55ef2
d613574e7dc242f79c3',
            / y / -3:true
          },
          / kid / 4:'bilbo.baggins@hobbiton.example'
        },
        / ciphertext / h'339bc4f79984cdc6b3e6ce5f315a4c7d2b0ac466fce
a69e8c07dfbca5bb1f661bc5f8e0df9e3eff5'
      ],
      [
        / protected / h'',
        / unprotected / {
          / alg / 1:-5 / A256KW /,
          / kid / 4:'018c0ae5-4d9b-471b-bfd6-eef314bc7037'
        },
        / ciphertext / h'0b2c7cfce04e98276342d6476a7723c090dfdd15f9a
518e7736549e998370695e6d6a83b4ae507bb'
      ]
    ]
  ]
)</t>
        </section>
      </section>
      <section anchor="examples-of-mac0-messages" numbered="true" removeInRFC="false" toc="include" pn="section-c.6">
        <name slugifiedName="name-examples-of-mac0-messages">Examples of MAC0 Messages</name>
        <section anchor="shared-secret-direct-mac" numbered="true" removeInRFC="false" toc="include" pn="section-c.6.1">
          <name slugifiedName="name-shared-secret-direct-mac">Shared Secret Direct MAC</name>
          <t indent="0" pn="section-c.6.1-1">This example uses the following:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.6.1-2">
            <li pn="section-c.6.1-2.1"> MAC: AES-CMAC, 256-bit key, truncated to 64 bits</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.6.1-3">
            <li pn="section-c.6.1-3.1"> Recipient class: direct shared secret</li>
          </ul>
          <t indent="0" pn="section-c.6.1-4">Size of binary file is 37 bytes</t>
          <t indent="0" pn="section-c.6.1-5">17(
  [
    / protected / h'a1010f' / {
        \ alg \ 1:15 \ AES-CBC-MAC-256//64 \
      } / ,
    / unprotected / {},
    / payload / 'This is the content.',
    / tag / h'726043745027214f'
  ]
)</t>
          <t indent="0" pn="section-c.6.1-6">Note that this example uses the same inputs as Appendix C.5.1.</t>
        </section>
      </section>
      <section anchor="cose-keys" numbered="true" removeInRFC="false" toc="include" pn="section-c.7">
        <name slugifiedName="name-cose-keys">COSE Keys</name>
        <section anchor="public-keys" numbered="true" removeInRFC="false" toc="include" pn="section-c.7.1">
          <name slugifiedName="name-public-keys">Public Keys</name>
          <t indent="0" pn="section-c.7.1-1">This is an example of a COSE Key Set.  This example includes the
public keys for all of the previous examples.</t>
          <t indent="0" pn="section-c.7.1-2">In order the keys are:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.1-3">
            <li pn="section-c.7.1-3.1"> An EC key with a kid of &quot;meriadoc.brandybuck@buckland.example&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.1-4">
            <li pn="section-c.7.1-4.1"> An EC key with a kid of &quot;peregrin.took@tuckborough.example&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.1-5">
            <li pn="section-c.7.1-5.1"> An EC key with a kid of &quot;bilbo.baggins@hobbiton.example&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.1-6">
            <li pn="section-c.7.1-6.1"> An EC key with a kid of &quot;11&quot;
Size of binary file is 481 bytes</li>
          </ul>
          <t indent="0" pn="section-c.7.1-7">[
  {
    -1:1,
    -2:h'65eda5a12577c2bae829437fe338701a10aaa375e1bb5b5de108de439c0
8551d',
    -3:h'1e52ed75701163f7f9e40ddf9f341b3dc9ba860af7e0ca7ca7e9eecd008
4d19c',
    1:2,
    2:'meriadoc.brandybuck@buckland.example'
  },
  {
    -1:1,
    -2:h'bac5b11cad8f99f9c72b05cf4b9e26d244dc189f745228255a219a86d6a
09eff',
    -3:h'20138bf82dc1b6d562be0fa54ab7804a3a64b6d72ccfed6b6fb6ed28bbf
c117e',
    1:2,
    2:'11'
  },
  {
    -1:3,
    -2:h'0072992cb3ac08ecf3e5c63dedec0d51a8c1f79ef2f82f94f3c737bf5de
7986671eac625fe8257bbd0394644caaa3aaf8f27a4585fbbcad0f2457620085e5c8
f42ad',
    -3:h'01dca6947bce88bc5790485ac97427342bc35f887d86d65a089377e247e
60baa55e4e8501e2ada5724ac51d6909008033ebc10ac999b9d7f5cc2519f3fe1ea1
d9475',
    1:2,
    2:'bilbo.baggins@hobbiton.example'
  },
  {
    -1:1,
    -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbfbf054e1c7b4d91
d6280',
    -3:h'f01400b089867804b8e9fc96c3932161f1934f4223069170d924b7e03bf
822bb',
    1:2,
    2:'peregrin.took@tuckborough.example'
  }
]</t>
        </section>
        <section anchor="private-keys" numbered="true" removeInRFC="false" toc="include" pn="section-c.7.2">
          <name slugifiedName="name-private-keys">Private Keys</name>
          <t indent="0" pn="section-c.7.2-1">This is an example of a COSE Key Set.  This example includes the
private keys for all of the previous examples.</t>
          <t indent="0" pn="section-c.7.2-2">In order the keys are:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.2-3">
            <li pn="section-c.7.2-3.1"> An EC key with a kid of &quot;meriadoc.brandybuck@buckland.example&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.2-4">
            <li pn="section-c.7.2-4.1"> A shared-secret key with a kid of &quot;our-secret&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.2-5">
            <li pn="section-c.7.2-5.1"> An EC key with a kid of &quot;peregrin.took@tuckborough.example&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.2-6">
            <li pn="section-c.7.2-6.1"> A shared-secret key with a kid of &quot;018c0ae5-4d9b-471b-
   bfd6-eef314bc7037&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.2-7">
            <li pn="section-c.7.2-7.1"> An EC key with a kid of &quot;bilbo.baggins@hobbiton.example&quot;</li>
          </ul>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-c.7.2-8">
            <li pn="section-c.7.2-8.1"> An EC key with a kid of &quot;11&quot;</li>
          </ul>
          <t indent="0" pn="section-c.7.2-9">Size of binary file is 816 bytes</t>
          <t indent="0" pn="section-c.7.2-10">[
  {
    1:2,
    2:'meriadoc.brandybuck@buckland.example',
    -1:1,
    -2:h'65eda5a12577c2bae829437fe338701a10aaa375e1bb5b5de108de439c0
8551d',
    -3:h'1e52ed75701163f7f9e40ddf9f341b3dc9ba860af7e0ca7ca7e9eecd008
4d19c',
    -4:h'aff907c99f9ad3aae6c4cdf21122bce2bd68b5283e6907154ad911840fa
208cf'
  },
  {
    1:2,
    2:'11',
    -1:1,
    -2:h'bac5b11cad8f99f9c72b05cf4b9e26d244dc189f745228255a219a86d6a
09eff',
    -3:h'20138bf82dc1b6d562be0fa54ab7804a3a64b6d72ccfed6b6fb6ed28bbf
c117e',
    -4:h'57c92077664146e876760c9520d054aa93c3afb04e306705db609030850
7b4d3'
  },
  {
    1:2,
    2:'bilbo.baggins@hobbiton.example',
    -1:3,
    -2:h'0072992cb3ac08ecf3e5c63dedec0d51a8c1f79ef2f82f94f3c737bf5de
7986671eac625fe8257bbd0394644caaa3aaf8f27a4585fbbcad0f2457620085e5c8
f42ad',
    -3:h'01dca6947bce88bc5790485ac97427342bc35f887d86d65a089377e247e
60baa55e4e8501e2ada5724ac51d6909008033ebc10ac999b9d7f5cc2519f3fe1ea1
d9475',
    -4:h'00085138ddabf5ca975f5860f91a08e91d6d5f9a76ad4018766a476680b
55cd339e8ab6c72b5facdb2a2a50ac25bd086647dd3e2e6e99e84ca2c3609fdf177f
eb26d'
  },
  {
    1:4,
    2:'our-secret',
    -1:h'849b57219dae48de646d07dbb533566e976686457c1491be3a76dcea6c4
27188'
  },
  {
    1:2,
    -1:1,
    2:'peregrin.took@tuckborough.example',
    -2:h'98f50a4ff6c05861c8860d13a638ea56c3f5ad7590bbfbf054e1c7b4d91
d6280',
    -3:h'f01400b089867804b8e9fc96c3932161f1934f4223069170d924b7e03bf
822bb',
    -4:h'02d1f7e6f26c43d4868d87ceb2353161740aacf1f7163647984b522a848
df1c3'
  },
  {
    1:4,
    2:'our-secret2',
    -1:h'849b5786457c1491be3a76dcea6c4271'
  },
  {
    1:4,
    2:'018c0ae5-4d9b-471b-bfd6-eef314bc7037',
    -1:h'849b57219dae48de646d07dbb533566e976686457c1491be3a76dcea6c4
27188'
  }
]
Acknowledgments</t>
          <t indent="0" pn="section-c.7.2-11">This document is a product of the COSE working group of the IETF.</t>
          <t indent="0" pn="section-c.7.2-12">The following individuals are to blame for getting me started on this
project in the first place: Richard Barnes, Matt Miller, and Martin
Thomson.</t>
          <t indent="0" pn="section-c.7.2-13">The initial version of the specification was based to some degree on
the outputs of the JOSE and S/MIME working groups.</t>
          <t indent="0" pn="section-c.7.2-14">The following individuals provided input into the final form of the
document: Carsten Bormann, John Bradley, Brain Campbell, Michael B.
Jones, Ilari Liusvaara, Francesca Palombini, Ludwig Seitz, and Goran
Selander.</t>
        </section>
      </section>
    </section>
  </back>
</rfc>
